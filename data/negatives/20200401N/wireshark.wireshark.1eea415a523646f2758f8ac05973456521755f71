commit 1eea415a523646f2758f8ac05973456521755f71
Author: Dario Lombardo <lomato@gmail.com>
Date:   Tue Jul 5 16:30:28 2016 +0200

    bgp: add return check (CID 1354417).
    
    Change-Id: Id8be1d5f6346686087d747167ec44df2b88dd35e
    Reviewed-on: https://code.wireshark.org/review/16304
    Reviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>
    Petri-Dish: Alexis La Goutte <alexis.lagoutte@gmail.com>
    Tested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>
    Reviewed-by: Dario Lombardo <lomato@gmail.com>

diff --git a/epan/dissectors/packet-bgp.c b/epan/dissectors/packet-bgp.c
index 2b324d6c63..a5b6ff3875 100644
--- a/epan/dissectors/packet-bgp.c
+++ b/epan/dissectors/packet-bgp.c
@@ -3502,8 +3502,9 @@ static int decode_bgp_link_nlri_prefix_descriptors(tvbuff_t *tvb,
             break;
 
             case BGP_NLRI_TLV_IP_REACHABILITY_INFORMATION:
-                decode_prefix4(tlv_sub_tree, pinfo, tlv_sub_item, hf_bgp_ls_nlri_ip_reachability_prefix_ip,
-                               tvb, offset + 4, 0, "Reachability");
+                if (decode_prefix4(tlv_sub_tree, pinfo, tlv_sub_item, hf_bgp_ls_nlri_ip_reachability_prefix_ip,
+                               tvb, offset + 4, 0, "Reachability") == -1)
+                    return diss_length;
             break;
         }
 

