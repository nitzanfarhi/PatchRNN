commit 40b7e6071815fc416a4efc5dc1616f5460a3aacb
Author: Carl Eugen Hoyos <ceffmpeg@gmail.com>
Date:   Fri Jun 22 00:08:13 2018 +0200

    lavf/amr: Make the heuristic for auto-detection even stricter.
    
    Fixes ticket #7270.

diff --git a/libavformat/amr.c b/libavformat/amr.c
index f954803d46..6cc06bceac 100644
--- a/libavformat/amr.c
+++ b/libavformat/amr.c
@@ -201,7 +201,7 @@ static int amrnb_probe(AVProbeData *p)
             i++;
         }
     }
-    if (valid > 100 && valid > invalid)
+    if (valid > 100 && valid >> 4 > invalid)
         return AVPROBE_SCORE_EXTENSION / 2 + 1;
     return 0;
 }
@@ -258,8 +258,8 @@ static int amrwb_probe(AVProbeData *p)
             i++;
         }
     }
-    if (valid > 100 && valid > invalid)
-        return AVPROBE_SCORE_EXTENSION / 2 - 1;
+    if (valid > 100 && valid >> 4 > invalid)
+        return AVPROBE_SCORE_EXTENSION / 2 + 1;
     return 0;
 }
 

