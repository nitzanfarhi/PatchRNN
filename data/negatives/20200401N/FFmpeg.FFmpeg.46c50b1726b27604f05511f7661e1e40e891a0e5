commit 46c50b1726b27604f05511f7661e1e40e891a0e5
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Sat Jun 16 01:54:11 2012 +0200

    vf_pad: check that we have write permission before writing in the buffer.
    
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavfilter/vf_pad.c b/libavfilter/vf_pad.c
index 413fde1f6c..08a1f8e668 100644
--- a/libavfilter/vf_pad.c
+++ b/libavfilter/vf_pad.c
@@ -284,7 +284,7 @@ static void start_frame(AVFilterLink *inlink, AVFilterBufferRef *inpicref)
           )
             break;
     }
-    pad->needs_copy= plane < 4 && outpicref->data[plane];
+    pad->needs_copy= plane < 4 && outpicref->data[plane] || !(outpicref->perms & AV_PERM_WRITE);
     if(pad->needs_copy){
         av_log(inlink->dst, AV_LOG_DEBUG, "Direct padding impossible allocating new frame\n");
         avfilter_unref_buffer(outpicref);

