commit c8890941d63df786bb7a8cab92677416499bb7c3
Author: Michael Niedermayer <michael@niedermayer.cc>
Date:   Fri Aug 21 02:16:31 2015 +0200

    ffmpeg: Check for RAWVIDEO and do not relay only on AVFMT_RAWPICTURE
    
    The null muxer has AVFMT_RAWPICTURE set but can be fed with non-raw material
    
    related to Ticket4778
    
    Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>

diff --git a/ffmpeg.c b/ffmpeg.c
index 4bd5f60267..530b3aa73e 100644
--- a/ffmpeg.c
+++ b/ffmpeg.c
@@ -1880,7 +1880,9 @@ static void do_streamcopy(InputStream *ist, OutputStream *ost, const AVPacket *p
     }
     av_copy_packet_side_data(&opkt, pkt);
 
-    if (ost->st->codec->codec_type == AVMEDIA_TYPE_VIDEO && (of->ctx->oformat->flags & AVFMT_RAWPICTURE)) {
+    if (ost->st->codec->codec_type == AVMEDIA_TYPE_VIDEO &&
+        ost->st->codec->codec_id == AV_CODEC_ID_RAWVIDEO &&
+        (of->ctx->oformat->flags & AVFMT_RAWPICTURE)) {
         /* store AVPicture in AVPacket, as expected by the output format */
         int ret = avpicture_fill(&pict, opkt.data, ost->st->codec->pix_fmt, ost->st->codec->width, ost->st->codec->height);
         if (ret < 0) {

