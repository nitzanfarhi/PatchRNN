commit f4b0e03374c84318d61619cf5920e40a7cd15176
Author: Aaron Puchert <aaronpuchert@alice-dsl.net>
Date:   Thu Feb 5 23:26:01 2015 +0100

    Don't forget offset for scale*index w/o base

diff --git a/libr/asm/p/asm_x86_new.c b/libr/asm/p/asm_x86_new.c
index e6f08efdc..4f4a72d8c 100644
--- a/libr/asm/p/asm_x86_new.c
+++ b/libr/asm/p/asm_x86_new.c
@@ -870,7 +870,8 @@ static int write_asm(ut8 *data, Opcode *opcode_ptr, Operand *operands) {
 		if (mod != 3 && rm == 4)
 			data[l++] = make_SIB(scale, index, base);
 
-		if (regmem_op->type & OT_MEMORY && (mod > 0 || (mod == 0 && rm == 5))) {
+		if (regmem_op->type & OT_MEMORY &&
+				(mod > 0 || (mod == 0 && rm == 5) || (mod == 0 && rm == 4 && base == 5))) {
 			if (mod == 1) {
 				data[l++] = *(ut8 *)&regmem_op->offset;
 			}

