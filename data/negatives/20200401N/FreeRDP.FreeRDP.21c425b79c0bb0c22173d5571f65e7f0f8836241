commit 21c425b79c0bb0c22173d5571f65e7f0f8836241
Author: Bernhard Miklautz <bernhard.miklautz@thincast.com>
Date:   Thu Apr 3 11:43:51 2014 +0200

    sec-rdp: limit server side key size to 2048 bit
    
    Current code doesn't handle keys > 2048 bit properly in multiple places.
    To prevent problems make sure that no larger keys are used for now.

diff --git a/libfreerdp/core/peer.c b/libfreerdp/core/peer.c
index 191739f8a..e1662d335 100644
--- a/libfreerdp/core/peer.c
+++ b/libfreerdp/core/peer.c
@@ -52,6 +52,13 @@ static BOOL freerdp_peer_initialize(freerdp_peer* client)
 			fprintf(stderr, "%s: inavlid RDP key file %s\n", __FUNCTION__, settings->RdpKeyFile);
 			return FALSE;
 		}
+		if (settings->RdpServerRsaKey->ModulusLength > 256)
+		{
+			fprintf(stderr, "%s: Key sizes > 2048 are currently not supported for RDP security.\n", __FUNCTION__);
+			fprintf(stderr, "%s: Set a different key file than %s\n", __FUNCTION__, settings->RdpKeyFile);
+			exit(1);
+		}
+
 	}
 
 	return TRUE;

