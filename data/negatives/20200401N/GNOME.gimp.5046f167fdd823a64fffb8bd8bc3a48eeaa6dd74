commit 5046f167fdd823a64fffb8bd8bc3a48eeaa6dd74
Author: Michael Natterer <mitch@gimp.org>
Date:   Sun Dec 11 16:39:01 2011 +0100

    app: remove checks for grab time consistency
    
    because tests need to be able to pass GDK_CURRENT_TIME here, which is
    a legal argument to grab functions. Fixes distcheck.

diff --git a/app/display/gimpdisplayshell-grab.c b/app/display/gimpdisplayshell-grab.c
index b0febc16b4..2ca9c1a064 100644
--- a/app/display/gimpdisplayshell-grab.c
+++ b/app/display/gimpdisplayshell-grab.c
@@ -34,7 +34,6 @@ gimp_display_shell_pointer_grab (GimpDisplayShell *shell,
 {
   g_return_val_if_fail (GIMP_IS_DISPLAY_SHELL (shell), FALSE);
   g_return_val_if_fail (shell->pointer_grabbed == FALSE, FALSE);
-  g_return_val_if_fail (shell->pointer_grab_time == 0, FALSE);
 
   if (event)
     {
@@ -67,7 +66,6 @@ gimp_display_shell_pointer_ungrab (GimpDisplayShell *shell,
 {
   g_return_if_fail (GIMP_IS_DISPLAY_SHELL (shell));
   g_return_if_fail (shell->pointer_grabbed == TRUE);
-  g_return_if_fail (event == NULL || shell->pointer_grab_time != 0);
 
   gtk_grab_remove (shell->canvas);
 
@@ -91,7 +89,6 @@ gimp_display_shell_keyboard_grab (GimpDisplayShell *shell,
   g_return_val_if_fail (GIMP_IS_DISPLAY_SHELL (shell), FALSE);
   g_return_val_if_fail (event != NULL, FALSE);
   g_return_val_if_fail (shell->keyboard_grabbed == FALSE, FALSE);
-  g_return_val_if_fail (shell->keyboard_grab_time == 0, FALSE);
 
   status = gdk_keyboard_grab (gtk_widget_get_window (shell->canvas),
                               FALSE,
@@ -117,7 +114,6 @@ gimp_display_shell_keyboard_ungrab (GimpDisplayShell *shell,
   g_return_if_fail (GIMP_IS_DISPLAY_SHELL (shell));
   g_return_if_fail (event != NULL);
   g_return_if_fail (shell->keyboard_grabbed == TRUE);
-  g_return_if_fail (shell->keyboard_grab_time != 0);
 
   gdk_display_keyboard_ungrab (gtk_widget_get_display (shell->canvas),
                                shell->keyboard_grab_time);

