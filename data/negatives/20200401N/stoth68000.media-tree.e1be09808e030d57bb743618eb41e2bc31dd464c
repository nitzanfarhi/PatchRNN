commit e1be09808e030d57bb743618eb41e2bc31dd464c
Author: James Bottomley <JBottomley@Parallels.com>
Date:   Wed Jul 24 12:43:18 2013 -0700

    [SCSI] isci: fix breakage caused by >16byte CDB patch
    
    Oops, apparently no-one I cc'd at intel actually bothered to check this
    patch for the isci driver:
    
    commit e73823f7a2c921dcf068d34ea03bd682498d9e42
    Author: James Bottomley <JBottomley@Parallels.com>
    Date:   Tue May 7 15:38:18 2013 -0700
    
        [SCSI] libsas: implement > 16 byte CDB support
    
    sci_swab32_cpy needs multiples of four, so for commands that aren't that, it's
    rounding the wrong way.  fix by doing (len+3)/4 instead of len/4.
    
    Reported-by: Tony Luck <tony.luck@intel.com>
    Tested-by: Tony Luck <tony.luck@intel.com>
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>

diff --git a/drivers/scsi/isci/request.c b/drivers/scsi/isci/request.c
index 7b082157eb79..99d2930b18c8 100644
--- a/drivers/scsi/isci/request.c
+++ b/drivers/scsi/isci/request.c
@@ -185,7 +185,7 @@ static void sci_io_request_build_ssp_command_iu(struct isci_request *ireq)
 	cmd_iu->_r_c = 0;
 
 	sci_swab32_cpy(&cmd_iu->cdb, task->ssp_task.cmd->cmnd,
-		       task->ssp_task.cmd->cmd_len / sizeof(u32));
+		       (task->ssp_task.cmd->cmd_len+3) / sizeof(u32));
 }
 
 static void sci_task_request_build_ssp_task_iu(struct isci_request *ireq)

