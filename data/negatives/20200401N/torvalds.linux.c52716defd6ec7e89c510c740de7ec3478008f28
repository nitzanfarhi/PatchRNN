commit c52716defd6ec7e89c510c740de7ec3478008f28
Author: Christophe Vu-Brugier <cvubrugier@yahoo.fr>
Date:   Tue Jun 10 17:53:22 2014 +0200

    target/sbc: Check that the LBA and number of blocks are correct in VERIFY
    
    This patch extracts LBA + sectors for VERIFY, and adds a goto check_lba
    to perform the end-of-device checking.
    
    (Update patch to drop lba_check usage - nab)
    
    Signed-off-by: Christophe Vu-Brugier <cvubrugier@yahoo.fr>
    Signed-off-by: Nicholas Bellinger <nab@linux-iscsi.org>

diff --git a/drivers/target/target_core_sbc.c b/drivers/target/target_core_sbc.c
index 7675d2aaa0f7..97a33603795d 100644
--- a/drivers/target/target_core_sbc.c
+++ b/drivers/target/target_core_sbc.c
@@ -914,8 +914,10 @@ sbc_parse_cdb(struct se_cmd *cmd, struct sbc_ops *ops)
 		break;
 	case VERIFY:
 		size = 0;
+		sectors = transport_get_sectors_10(cdb);
+		cmd->t_task_lba = transport_lba_32(cdb);
 		cmd->execute_cmd = sbc_emulate_noop;
-		break;
+		goto check_lba;
 	case REZERO_UNIT:
 	case SEEK_6:
 	case SEEK_10:

