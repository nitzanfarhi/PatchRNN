commit a687ab022b0e7028e5bb07fab580eda3fd9b590f
Author: Bram Matthys <syzop@vulnscan.org>
Date:   Fri Feb 10 13:11:12 2017 +0100

    Fix 'MODE yournick +r' being interpreted as 'MODE yournick +s' (#4846).

diff --git a/src/modules/m_mode.c b/src/modules/m_mode.c
index d25a0132..3519c361 100644
--- a/src/modules/m_mode.c
+++ b/src/modules/m_mode.c
@@ -1639,7 +1639,6 @@ CMD_FUNC(_m_umode)
 		  case ' ':
 		  case '\t':
 			  break;
-		  case 'r':
 		  case 's':
 			  if (what == MODE_DEL) {
 				if (parc >= 4 && sptr->user->snomask) {

