commit 9a3bf97315aa121441777bf1bc4bea3c5e00af29
Author: Viktor Dukhovni <openssl-users@dukhovni.org>
Date:   Thu May 7 13:43:36 2015 -0400

    Fix typo in valid_star
    
    Reviewed-by: Rich Salz <rsalz@akamai.com>

diff --git a/crypto/x509v3/v3_utl.c b/crypto/x509v3/v3_utl.c
index 81227e0d01..debd8078ca 100644
--- a/crypto/x509v3/v3_utl.c
+++ b/crypto/x509v3/v3_utl.c
@@ -795,7 +795,7 @@ static const unsigned char *valid_star(const unsigned char *p, size_t len,
          */
         if (p[i] == '*') {
             int atstart = (state & LABEL_START);
-            int atend = (i == len - 1 || p[i + i] == '.');
+            int atend = (i == len - 1 || p[i + 1] == '.');
             /*-
              * At most one wildcard per pattern.
              * No wildcards in IDNA labels.

