commit 46b66d7077b89fb4917ceef19b3f7dd86055c94a
Author: Xi Wang <xi.wang@gmail.com>
Date:   Sun Aug 26 16:37:07 2012 +0000

    decnet: fix shutdown parameter checking
    
    The allowed value of "how" is SHUT_RD/SHUT_WR/SHUT_RDWR (0/1/2),
    rather than SHUTDOWN_MASK (3).
    
    Signed-off-by: Xi Wang <xi.wang@gmail.com>
    Acked-by: Steven Whitehouse <swhiteho@redhat.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/net/decnet/af_decnet.c b/net/decnet/af_decnet.c
index 2ba1a2814c24..307c322d53bb 100644
--- a/net/decnet/af_decnet.c
+++ b/net/decnet/af_decnet.c
@@ -1313,10 +1313,10 @@ static int dn_shutdown(struct socket *sock, int how)
 	if (scp->state == DN_O)
 		goto out;
 
-	if (how != SHUTDOWN_MASK)
+	if (how != SHUT_RDWR)
 		goto out;
 
-	sk->sk_shutdown = how;
+	sk->sk_shutdown = SHUTDOWN_MASK;
 	dn_destroy_sock(sk);
 	err = 0;
 

