commit a918dfdb3363c17757066ec4afa61679cb0a7da1
Author: Takashi Kojo <kojo@wolfsssl.com>
Date:   Sun Jul 30 12:19:49 2017 +0900

    discard session chain in SSL_clear

diff --git a/src/ssl.c b/src/ssl.c
index a71454c3..6089b93c 100644
--- a/src/ssl.c
+++ b/src/ssl.c
@@ -14518,7 +14518,9 @@ int wolfSSL_EVP_MD_type(const WOLFSSL_EVP_MD *md)
                 return WOLFSSL_FAILURE;
 #endif
         }
-
+#ifdef SESSION_CERTS
+        ssl->session.chain.count = 0;
+#endif
 #ifdef KEEP_PEER_CERT
         FreeX509(&ssl->peerCert);
         InitX509(&ssl->peerCert, 0, ssl->heap);

