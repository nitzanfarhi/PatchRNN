commit e39e64ac0cdeca3798a6bf186f873be20e2f57b4
Author: Chris Mason <chris.mason@fusionio.com>
Date:   Mon Jul 23 15:23:45 2012 -0400

    Btrfs: don't wait around for new log writers on an SSD
    
    Waiting on spindles improves performance, but ssds want all the
    IO as quickly as we can push it down.
    
    Signed-off-by: Chris Mason <chris.mason@fusionio.com>

diff --git a/fs/btrfs/transaction.c b/fs/btrfs/transaction.c
index b72b068183ec..8c35847d0fee 100644
--- a/fs/btrfs/transaction.c
+++ b/fs/btrfs/transaction.c
@@ -1330,7 +1330,8 @@ int btrfs_commit_transaction(struct btrfs_trans_handle *trans,
 		spin_unlock(&root->fs_info->trans_lock);
 	}
 
-	if (now < cur_trans->start_time || now - cur_trans->start_time < 1)
+	if (!btrfs_test_opt(root, SSD) &&
+	    (now < cur_trans->start_time || now - cur_trans->start_time < 1))
 		should_grow = 1;
 
 	do {

