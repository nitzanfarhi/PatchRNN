commit 4d14d5934ea878baefc9c0f63386515e4aae9aa4
Author: cristy <urban-warrior@git.imagemagick.org>
Date:   Tue Apr 3 12:58:43 2012 +0000

diff --git a/MagickCore/profile.c b/MagickCore/profile.c
index 901ce2c45..3a3444dad 100644
--- a/MagickCore/profile.c
+++ b/MagickCore/profile.c
@@ -6696,8 +6696,10 @@ MagickPrivate MagickBooleanType SyncImageProfiles(Image *image)
       format=(ssize_t) ReadProfileShort(endian,q+2);
       if ((format-1) >= EXIF_NUM_FORMATS)
         break;
-      components=(int) ReadProfileLong(endian,q+4);
+      components=(ssize_t) ((int) ReadProfileLong(endian,q+4));
       number_bytes=(size_t) components*format_bytes[format];
+      if (number_bytes < components)
+        break;  /* prevent overflow */
       if (number_bytes <= 4)
         p=q+8;
       else

