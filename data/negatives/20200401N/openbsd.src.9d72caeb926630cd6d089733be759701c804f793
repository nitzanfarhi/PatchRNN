commit 9d72caeb926630cd6d089733be759701c804f793
Author: jason <jason@openbsd.org>
Date:   Tue Jan 16 05:34:15 2001 +0000

    bzero the sets before FD_SET'n them

diff --git a/usr.sbin/pppoe/client.c b/usr.sbin/pppoe/client.c
index 8ccd2d01f7f..d0ed24ab813 100644
--- a/usr.sbin/pppoe/client.c
+++ b/usr.sbin/pppoe/client.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: client.c,v 1.7 2001/01/16 05:01:39 jason Exp $	*/
+/*	$OpenBSD: client.c,v 1.8 2001/01/16 05:34:15 jason Exp $	*/
 
 /*
  * Copyright (c) 2000 Network Security Technologies, Inc. http://www.netsec.net
@@ -116,7 +116,7 @@ client_mode(bfd, sysname, srvname, myea)
 		if (max > oldmax) {
 			if (fdsp != NULL)
 				free(fdsp);
-			fdsp = (fd_set *)calloc(howmany(max, NFDBITS),
+			fdsp = (fd_set *)malloc(howmany(max, NFDBITS) *
 			    sizeof(fd_mask));
 			if (fdsp == NULL) {
 				r = -1;
@@ -124,6 +124,7 @@ client_mode(bfd, sysname, srvname, myea)
 			}
 			max = oldmax;
 		}
+		bzero(fdsp, howmany(max, NFDBITS) * sizeof(fd_mask));
 
 		if (pppfd >= 0)
 			FD_SET(pppfd, fdsp);
diff --git a/usr.sbin/pppoe/server.c b/usr.sbin/pppoe/server.c
index 14aba8cc7da..e6c76348440 100644
--- a/usr.sbin/pppoe/server.c
+++ b/usr.sbin/pppoe/server.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: server.c,v 1.3 2001/01/16 05:01:40 jason Exp $	*/
+/*	$OpenBSD: server.c,v 1.4 2001/01/16 05:34:15 jason Exp $	*/
 
 /*
  * Copyright (c) 2000 Network Security Technologies, Inc. http://www.netsec.net
@@ -103,12 +103,14 @@ reselect:
 		if (n > oldmax) {
 			if (fdsp != NULL)
 				free(fdsp);
-			fdsp = (fd_set *)calloc(howmany(n, NFDBITS),
+			fdsp = (fd_set *)malloc(howmany(n, NFDBITS) *
 			    sizeof(fd_mask));
 			if (fdsp == NULL)
 				break;
 			oldmax = n;
 		}
+		bzero(fdsp, howmany(n, NFDBITS) * sizeof(fd_mask));
+
 		FD_SET(bpffd, fdsp);
 		LIST_FOREACH(ses, &session_master.sm_sessions, s_next) {
 			if (ses->s_fd != -1)

