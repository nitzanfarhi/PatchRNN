commit 89fe8d203c1ee7879944c6ac4f88fea64fc630ef
Author: jmagne <jmagne@c9f7a03b-bd48-0410-a16d-cbbf54688b0b>
Date:   Sat Jan 24 01:13:26 2009 +0000

    Fix for Bug#459539, 330J token support.
    
    git-svn-id: svn+ssh://svn.fedorahosted.org/svn/pki/trunk@187 c9f7a03b-bd48-0410-a16d-cbbf54688b0b

diff --git a/pki/base/tps/src/channel/Secure_Channel.cpp b/pki/base/tps/src/channel/Secure_Channel.cpp
index 3dc13d2b2..cbc0d8527 100644
--- a/pki/base/tps/src/channel/Secure_Channel.cpp
+++ b/pki/base/tps/src/channel/Secure_Channel.cpp
@@ -1343,7 +1343,7 @@ int Secure_Channel::StartEnrollment(BYTE p1, BYTE p2, Buffer *wrapped_challenge,
     RA::Debug("Secure_Channel::GenerateKey",
         "Secure_Channel::GenerateKey");
     generate_key_apdu = new Generate_Key_APDU(p1, p2, alg, keysize, option,
-        0x85, *wrapped_challenge, *key_check);
+        alg, *wrapped_challenge, *key_check);
     rc = ComputeAPDU(generate_key_apdu);
     if (rc == -1)
       goto loser;

