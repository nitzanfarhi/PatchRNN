commit 2f034f255c49050e894ab9b88087c09ebe249f3f
Author: Luca Barbato <lu_zero@gentoo.org>
Date:   Mon Jul 22 12:44:19 2013 +0200

    4xm: Reject not a multiple of 16 dimension
    
    Reported-by: Mateusz "j00ru" Jurczyk and Gynvael Coldwind
    CC: libav-stable@libav.org

diff --git a/libavcodec/4xm.c b/libavcodec/4xm.c
index a4e6965fe0..1489c32426 100644
--- a/libavcodec/4xm.c
+++ b/libavcodec/4xm.c
@@ -807,6 +807,12 @@ static int decode_frame(AVCodecContext *avctx, void *data,
     if (buf_size < 20)
         return AVERROR_INVALIDDATA;
 
+    if (avctx->width % 16 || avctx->height % 16) {
+        av_log(avctx, AV_LOG_ERROR,
+               "Dimensions non-multiple of 16 are invalid.\n");
+        return AVERROR_INVALIDDATA;
+    }
+
     if (buf_size < AV_RL32(buf + 4) + 8) {
         av_log(f->avctx, AV_LOG_ERROR, "size mismatch %d %d\n",
                buf_size, AV_RL32(buf + 4));

