commit 71b7a152daff34fb393c5f81eff8c79a8b6635f4
Author: Steve Lime <sdlime@gmail.com>
Date:   Fri Jul 13 05:00:54 2001 +0000

    Fixed error with embeded scalebars and legends.
    
    
    git-svn-id: http://svn.osgeo.org/mapserver/trunk@586 7532c77e-422f-0410-93f4-f0b67bdd69e2

diff --git a/maplegend.c b/maplegend.c
index e6435108..2465ce66 100644
--- a/maplegend.c
+++ b/maplegend.c
@@ -264,6 +264,7 @@ int msEmbedLegend(mapObj *map, gdImagePtr img)
   map->layers[l].class[0].symbol = s;
   map->layers[l].class[0].color = 0;
   map->layers[l].class[0].label.force = MS_TRUE;
+  map->layers[l].class[0].label.size = map->layers[l].class[0].label.sizescaled = MS_MEDIUM; // must set a size to have a valid label definition
 
   if(map->legend.postlabelcache) // add it directly to the image
     msDrawMarkerSymbol(&map->symbolset, img, &point, map->layers[l].class[0].symbol, 0, -1, -1, 10);
diff --git a/mapscale.c b/mapscale.c
index 3534d19b..73e0e3fc 100644
--- a/mapscale.c
+++ b/mapscale.c
@@ -249,6 +249,7 @@ int msEmbedScalebar(mapObj *map, gdImagePtr img)
   map->layers[l].class[0].symbol = s;
   map->layers[l].class[0].color = 0;
   map->layers[l].class[0].label.force = MS_TRUE;
+  map->layers[l].class[0].label.size = map->layers[l].class[0].label.sizescaled = MS_MEDIUM; // must set a size to have a valid label definition
 
   if(map->scalebar.postlabelcache) // add it directly to the image
     msDrawMarkerSymbol(&map->symbolset, img, &point, map->layers[l].class[0].symbol, 0, -1, -1, 10);

