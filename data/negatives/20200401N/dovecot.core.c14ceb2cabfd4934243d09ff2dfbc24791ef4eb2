commit c14ceb2cabfd4934243d09ff2dfbc24791ef4eb2
Author: Timo Sirainen <tss@iki.fi>
Date:   Fri Dec 17 13:16:01 2010 +0000

    snarf: Make sure destination mailbox is open when syncing it.

diff --git a/src/plugins/snarf/snarf-plugin.c b/src/plugins/snarf/snarf-plugin.c
index 7d2253054..0210cedcd 100644
--- a/src/plugins/snarf/snarf-plugin.c
+++ b/src/plugins/snarf/snarf-plugin.c
@@ -37,6 +37,10 @@ static int snarf(struct mailbox *srcbox, struct mailbox *destbox)
 	enum mail_error error;
 	int ret;
 
+	/* make sure the destination mailbox has been opened */
+	if (mailbox_open(destbox) < 0)
+		return -1;
+
 	if (mailbox_sync(srcbox, MAILBOX_SYNC_FLAG_FULL_READ) < 0)
 		return -1;
 

