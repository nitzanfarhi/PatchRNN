commit 6bcf2e4195f000194f11a37433caa7890663bd22
Author: Timo Sirainen <timo.sirainen@dovecot.fi>
Date:   Thu Mar 16 00:25:19 2017 +0200

    auth: oauth2 - introspection lookup error should be internal failure
    
    Not the default, which is "password mismatch".

diff --git a/src/auth/db-oauth2.c b/src/auth/db-oauth2.c
index f2382b929..5c30700ef 100644
--- a/src/auth/db-oauth2.c
+++ b/src/auth/db-oauth2.c
@@ -524,6 +524,7 @@ db_oauth2_introspect_continue(struct oauth2_introspection_result *result,
 
 	if (!result->success) {
 		/* fail here */
+		req->result = PASSDB_RESULT_INTERNAL_FAILURE;
 		req->failed = TRUE;
 		db_oauth2_callback(req, FALSE, result->error);
 		return;

