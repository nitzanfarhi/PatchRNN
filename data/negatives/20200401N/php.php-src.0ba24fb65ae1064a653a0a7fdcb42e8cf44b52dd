commit 0ba24fb65ae1064a653a0a7fdcb42e8cf44b52dd
Author: Ilia Alshanetsky <iliaa@php.net>
Date:   Mon Oct 31 23:44:40 2005 +0000

    Additional open_basedir/safe_mode checks.

diff --git a/ext/curl/interface.c b/ext/curl/interface.c
index 2a3a796c6b..75e4b5ba68 100644
--- a/ext/curl/interface.c
+++ b/ext/curl/interface.c
@@ -119,7 +119,7 @@ static void _php_curl_close(zend_rsrc_list_entry *rsrc TSRMLS_DC);
 			RETURN_FALSE; 																		\
 		} 																						\
 																								\
-		if (tmp_url->query || php_check_open_basedir(tmp_url->path TSRMLS_CC) || 									\
+		if (tmp_url->query || tmp_url->fragment || php_check_open_basedir(tmp_url->path TSRMLS_CC) || 									\
 			(PG(safe_mode) && !php_checkuid(tmp_url->path, "rb+", CHECKUID_CHECK_MODE_PARAM))	\
 		) { 																					\
 			php_url_free(tmp_url); 																\

