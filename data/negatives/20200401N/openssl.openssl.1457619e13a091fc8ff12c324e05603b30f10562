commit 1457619e13a091fc8ff12c324e05603b30f10562
Author: Ben Laurie <ben@openssl.org>
Date:   Fri Dec 26 17:17:21 2008 +0000

    Remove misleading dead code. Constify. (Coverity ID 142)

diff --git a/crypto/dsa/dsa.h b/crypto/dsa/dsa.h
index 27bc5b91ca..7e6d84a37e 100644
--- a/crypto/dsa/dsa.h
+++ b/crypto/dsa/dsa.h
@@ -131,7 +131,7 @@ struct dsa_method
 	char *app_data;
 	/* If this is non-NULL, it is used to generate DSA parameters */
 	int (*dsa_paramgen)(DSA *dsa, int bits,
-			unsigned char *seed, int seed_len,
+			const unsigned char *seed, int seed_len,
 			int *counter_ret, unsigned long *h_ret,
 			BN_GENCB *cb);
 	/* If this is non-NULL, it is used to generate DSA keys */
@@ -220,7 +220,7 @@ DSA *	DSA_generate_parameters(int bits,
 
 /* New version */
 int	DSA_generate_parameters_ex(DSA *dsa, int bits,
-		unsigned char *seed,int seed_len,
+		const unsigned char *seed,int seed_len,
 		int *counter_ret, unsigned long *h_ret, BN_GENCB *cb);
 
 int	DSA_generate_key(DSA *a);
diff --git a/crypto/dsa/dsa_gen.c b/crypto/dsa/dsa_gen.c
index 2435fc8bc7..0fcd25f8b0 100644
--- a/crypto/dsa/dsa_gen.c
+++ b/crypto/dsa/dsa_gen.c
@@ -82,7 +82,7 @@
 #include "dsa_locl.h"
 
 int DSA_generate_parameters_ex(DSA *ret, int bits,
-		unsigned char *seed_in, int seed_len,
+		const unsigned char *seed_in, int seed_len,
 		int *counter_ret, unsigned long *h_ret, BN_GENCB *cb)
 	{
 	if(ret->meth->dsa_paramgen)
@@ -110,7 +110,7 @@ int DSA_generate_parameters_ex(DSA *ret, int bits,
 	}
 
 int dsa_builtin_paramgen(DSA *ret, size_t bits, size_t qbits,
-	const EVP_MD *evpmd, unsigned char *seed_in, size_t seed_len,
+	const EVP_MD *evpmd, const unsigned char *seed_in, size_t seed_len,
 	int *counter_ret, unsigned long *h_ret, BN_GENCB *cb)
 	{
 	int ok=0;
@@ -149,11 +149,7 @@ int dsa_builtin_paramgen(DSA *ret, size_t bits, size_t qbits,
 		seed_len = qsize;	/* App. 2.2 of FIPS PUB 186 allows larger SEED,
 					 * but our internal buffers are restricted to 160 bits*/
 	if (seed_in != NULL)
-		{
 		memcpy(seed, seed_in, seed_len);
-		/* set seed_in to NULL to avoid it being copied back */
-		seed_in = NULL;
-		}
 
 	if ((ctx=BN_CTX_new()) == NULL)
 		goto err;
@@ -335,7 +331,6 @@ err:
 			ok=0;
 			goto err;
 			}
-		if (seed_in != NULL) memcpy(seed_in,seed, qsize);
 		if (counter_ret != NULL) *counter_ret=counter;
 		if (h_ret != NULL) *h_ret=h;
 		}
diff --git a/crypto/dsa/dsa_locl.h b/crypto/dsa/dsa_locl.h
index f1bbf72fb8..2b8cfee3db 100644
--- a/crypto/dsa/dsa_locl.h
+++ b/crypto/dsa/dsa_locl.h
@@ -55,5 +55,5 @@
 #include <openssl/dsa.h>
 
 int dsa_builtin_paramgen(DSA *ret, size_t bits, size_t qbits,
-	const EVP_MD *evpmd, unsigned char *seed_in, size_t seed_len,
+	const EVP_MD *evpmd, const unsigned char *seed_in, size_t seed_len,
 	int *counter_ret, unsigned long *h_ret, BN_GENCB *cb);

