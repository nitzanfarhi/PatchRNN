commit e11eb2a5f69c0fb5a813ea7321b062c8c81e83bb
Author: D. Hugh Redelmeier <hugh@mimosa.com>
Date:   Sat Sep 6 23:51:17 2014 -0400

    pluto: undo bug introduced in 0395c26ac17af9b02e4f1b84d7279288fc985ced
    bonus: fix comment that prompted the error

diff --git a/programs/pluto/kernel.c b/programs/pluto/kernel.c
index b0a22ae12..c82969f65 100644
--- a/programs/pluto/kernel.c
+++ b/programs/pluto/kernel.c
@@ -1732,10 +1732,13 @@ static bool setup_half_ipsec_sa(struct state *st, bool inbound)
 		case IKEv2_ENCR_AES_GCM_8:
 		case IKEv2_ENCR_AES_GCM_12:
 		case IKEv2_ENCR_AES_GCM_16:
+			/* keymat contains 4 bytes of salt */
+			enc_key_len += AES_GCM_SALT_BYTES;
+			break;
 		case IKEv2_ENCR_AES_CCM_8:
 		case IKEv2_ENCR_AES_CCM_12:
 		case IKEv2_ENCR_AES_CCM_16:
-			/* keymat contains 4 bytes of salt */
+			/* keymat contains 3 bytes of salt */
 			enc_key_len += AES_CCM_SALT_BYTES;
 			break;
 		}

