commit de2803bc52d6f746dfe0cb7baaee26bece292560
Author: Gerald Combs <gerald@wireshark.org>
Date:   Tue Jul 26 15:59:54 2005 +0000

    Don't add a new data source if we don't have any data.
    
    svn path=/trunk/; revision=15089

diff --git a/epan/dissectors/packet-radius.c b/epan/dissectors/packet-radius.c
index 3416043cd9..e61273cc0f 100644
--- a/epan/dissectors/packet-radius.c
+++ b/epan/dissectors/packet-radius.c
@@ -533,7 +533,7 @@ static void dissect_attribute_value_pairs(proto_tree *tree, packet_info *pinfo,
 					last_eap = TRUE;
 				}
 
-				if (last_eap) {
+				if (last_eap && eap_buffer) {
 					gboolean save_writable;
 
 					proto_item_append_text(avp_item,

