commit 031e9068ccc7109b8cd9e3b352d651fcb4722de3
Author: uau <uau@b3059339-0415-0410-9bf9-f77b7e298cf2>
Date:   Tue Nov 14 06:35:55 2006 +0000

    Move endpos handling from page flip code to a saner location, change < to <=
    If the shown frame was already at exactly the end pos we don't want to
    show one more frame after it.
    
    
    git-svn-id: svn://svn.mplayerhq.hu/mplayer/trunk@20911 b3059339-0415-0410-9bf9-f77b7e298cf2

diff --git a/mplayer.c b/mplayer.c
index 83ebaf1d78..79e7d621a4 100644
--- a/mplayer.c
+++ b/mplayer.c
@@ -4458,11 +4458,6 @@ if(time_frame>0.001 && !(vo_flags&256))
 
         current_module="flip_page";
         if (!frame_time_remaining) {
-
-         // FIXME: add size based support for -endpos
-         if ( end_at.type == END_AT_TIME && end_at.pos < sh_video->pts )
-              eof = PT_NEXT_ENTRY;
-
          if(blit_frame){
 	   unsigned int t2=GetTimer();
 	   double tt;
@@ -4513,6 +4508,11 @@ if(auto_quality>0){
   set_video_quality(sh_video,output_quality);
 }
 
+// FIXME: add size based support for -endpos
+ if (end_at.type == END_AT_TIME &&
+         !frame_time_remaining && end_at.pos <= sh_video->pts)
+     eof = PT_NEXT_ENTRY;
+
 } // end if(sh_video)
 
 //============================ Handle PAUSE ===============================

