commit 02136f796c452a33168879322465a7ec0c921ebc
Author: Ken Wilson <Ken_Wilson@securecomputing.com>
Date:   Thu Jan 8 15:36:19 2009 +1000

    Get openswan to send the remote host address to PAM during XAUTH
    so that it may be used for better logging/authentication purposes
    at the PAM end.

diff --git a/programs/pluto/xauth.c b/programs/pluto/xauth.c
index 29f54d267..cb82462e5 100644
--- a/programs/pluto/xauth.c
+++ b/programs/pluto/xauth.c
@@ -917,6 +917,9 @@ int do_pam_authentication(void *varg)
 
     retval = pam_start("pluto", arg->name.ptr, &conv, &pamh);
 
+	/* Send the remote host address to PAM */
+    if (retval == PAM_SUCCESS) 
+        retval = pam_set_item(pamh, PAM_RHOST, pluto_ip_str(&arg->st->st_remoteaddr));
     /*  Two factor authentication - Check that the user is valid, 
 	and then check if they are permitted access */
     if (retval == PAM_SUCCESS)

