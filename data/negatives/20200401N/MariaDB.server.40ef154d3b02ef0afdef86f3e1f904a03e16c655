commit 40ef154d3b02ef0afdef86f3e1f904a03e16c655
Author: Zardosht Kasheff <zardosht@tokutek.com>
Date:   Wed Apr 17 00:00:22 2013 -0400

    [t:4745], only call toku_update_descriptor in deserialize_brtheader_versioned if we are upgrading header
    
    git-svn-id: file:///svn/toku/tokudb@42069 c7de825b-a66e-492c-adef-691d508d4ae1

diff --git a/newbrt/brt-serialize.c b/newbrt/brt-serialize.c
index 02ec34cb746..2d8594112e4 100644
--- a/newbrt/brt-serialize.c
+++ b/newbrt/brt-serialize.c
@@ -3059,11 +3059,13 @@ deserialize_brtheader_versioned(int fd, struct rbuf *rb, struct brt_header **brt
     // anymore.  Since the header is going to think it's the current
     // version if it gets written out, we need to write the descriptor in
     // the new format (without those bytes) before that happens.
+    if (version <= BRT_LAYOUT_VERSION_13) {
     int r = toku_update_descriptor(h, &h->cmp_descriptor, fd);
-    if (r != 0) {
-        errno = r;
-        e = DS_ERRNO;
-        goto exit;
+        if (r != 0) {
+            errno = r;
+            e = DS_ERRNO;
+            goto exit;
+        }
     }
 exit:
     if (e != DS_OK && h != NULL) {

