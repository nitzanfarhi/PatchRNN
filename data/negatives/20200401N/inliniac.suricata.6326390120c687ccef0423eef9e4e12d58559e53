commit 6326390120c687ccef0423eef9e4e12d58559e53
Author: Victor Julien <victor@inliniac.net>
Date:   Tue Oct 16 15:39:34 2012 +0200

    stream: accept ack with next_seq + 1 on last_ack state

diff --git a/src/stream-tcp.c b/src/stream-tcp.c
index b8018262..fd504c18 100644
--- a/src/stream-tcp.c
+++ b/src/stream-tcp.c
@@ -3408,7 +3408,7 @@ static int StreamTcpPakcetStateLastAck(ThreadVars *tv, Packet *p,
                     "%" PRIu32 ", ACK %" PRIu32 "", ssn, p->payload_len,
                     TCP_GET_SEQ(p), TCP_GET_ACK(p));
 
-            if (TCP_GET_SEQ(p) != ssn->client.next_seq) {
+            if (TCP_GET_SEQ(p) != ssn->client.next_seq && TCP_GET_SEQ(p) != ssn->client.next_seq + 1) {
                 SCLogDebug("ssn %p: -> SEQ mismatch, packet SEQ %" PRIu32 ""
                         " != %" PRIu32 " from stream", ssn,
                         TCP_GET_SEQ(p), ssn->client.next_seq);

