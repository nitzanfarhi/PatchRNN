commit b438f940d3541f478c6b37106ed095f1be7959ef
Author: Tom Herbert <therbert@google.com>
Date:   Mon Jul 29 11:07:42 2013 -0700

    flow_dissector: add support for IPPROTO_IPV6
    
    Support IPPROTO_IPV6 similar to IPPROTO_IPIP
    
    Signed-off-by: Tom Herbert <therbert@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/net/core/flow_dissector.c b/net/core/flow_dissector.c
index 3259446f3026..ade9ff1c1980 100644
--- a/net/core/flow_dissector.c
+++ b/net/core/flow_dissector.c
@@ -141,6 +141,9 @@ ipv6:
 	case IPPROTO_IPIP:
 		proto = htons(ETH_P_IP);
 		goto ip;
+	case IPPROTO_IPV6:
+		proto = htons(ETH_P_IPV6);
+		goto ipv6;
 	default:
 		break;
 	}

