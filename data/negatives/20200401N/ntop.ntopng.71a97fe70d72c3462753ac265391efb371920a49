commit 71a97fe70d72c3462753ac265391efb371920a49
Author: Luca Deri <deri@ntop.org>
Date:   Wed Sep 5 17:19:10 2018 +0200

    Minor cleanup

diff --git a/src/LuaEngine.cpp b/src/LuaEngine.cpp
index b03d1f02..95b5c179 100644
--- a/src/LuaEngine.cpp
+++ b/src/LuaEngine.cpp
@@ -6586,10 +6586,12 @@ static int ntop_list_reports(lua_State* vm) {
     struct dirent *ent;
 
     while ((ent = readdir(dir)) != NULL) {
-      char filepath[MAX_PATH];
+      char filepath[MAX_PATH+3];
+      struct stat buf;
+      
       snprintf(filepath, sizeof(filepath), "%s/%s", fullpath, ent->d_name);
       ntop->fixPath(filepath);
-      struct stat buf;
+
       if(!stat(filepath, &buf) && !S_ISDIR(buf.st_mode))
 	lua_push_str_table_entry(vm, ent->d_name, (char*)"");
     }
diff --git a/src/NetworkInterface.cpp b/src/NetworkInterface.cpp
index 25507e56..696fda13 100644
--- a/src/NetworkInterface.cpp
+++ b/src/NetworkInterface.cpp
@@ -733,6 +733,7 @@ NetworkInterface::~NetworkInterface() {
 
   deleteDataStructures();
 
+  if(db)             delete db;
   if(host_pools)     delete host_pools;     /* note: this requires ndpi_struct */
   if(ifDescription)  free(ifDescription);
   if(discovery)      delete discovery;
@@ -762,7 +763,6 @@ NetworkInterface::~NetworkInterface() {
 
   delete frequentProtocols;
   delete frequentMacs;
-  if(db) delete db;
 
 #ifdef NTOPNG_PRO
   if(policer)               delete(policer);

