commit cae9c79772028b2af2ca8a3c9ac98412db312875
Author:  <Dao-Gang.Qu@sun.com>
Date:   Wed Jan 6 10:36:29 2010 +0800

    Bug #49137      Replication failure on SBR/MBR + multi-table DROP TEMPORARY TABLE
    
    Fixed valgrind failure on PB2.

diff --git a/sql/log_event.cc b/sql/log_event.cc
index 35d53c4fede..ad5c4bfeef8 100644
--- a/sql/log_event.cc
+++ b/sql/log_event.cc
@@ -2110,8 +2110,8 @@ compare_errors:
       has already been dropped. To ignore such irrelevant "table does
       not exist errors", we silently clear the error if TEMPORARY was used.
     */
-    if (thd->lex->drop_temporary &&
-        thd->net.last_errno == ER_BAD_TABLE_ERROR && !expected_error)
+    if (thd->net.last_errno == ER_BAD_TABLE_ERROR &&
+        !expected_error && thd->lex->drop_temporary)
       thd->clear_error();
     /*
       If we expected a non-zero error code, and we don't get the same error

