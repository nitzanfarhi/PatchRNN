commit 10cbda97e73c7d537d7174eadb2d098484f8f1da
Author: Jens Axboe <jens.axboe@oracle.com>
Date:   Fri Feb 27 20:14:20 2009 +0100

    cciss: add BUILD_BUG_ON() for catching bad CommandList_struct alignment
    
    The hardware requires 64-bit alignment of commands, so add a build bug
    check for that. The recent commit 8a3173de4ab4cdacc43675dc5c077f9a5bf17f5f
    didn't change the size of the command, but other additions/changes may and
    thus break badly at runtime.
    
    Signed-off-by: Jens Axboe <jens.axboe@oracle.com>

diff --git a/drivers/block/cciss.c b/drivers/block/cciss.c
index 4f9b6d792017..5d0e135824f9 100644
--- a/drivers/block/cciss.c
+++ b/drivers/block/cciss.c
@@ -3898,6 +3898,13 @@ static struct pci_driver cciss_pci_driver = {
  */
 static int __init cciss_init(void)
 {
+	/*
+	 * The hardware requires that commands are aligned on a 64-bit
+	 * boundary. Given that we use pci_alloc_consistent() to allocate an
+	 * array of them, the size must be a multiple of 8 bytes.
+	 */
+	BUILD_BUG_ON(sizeof(CommandList_struct) % 8);
+
 	printk(KERN_INFO DRIVER_NAME "\n");
 
 	/* Register for our PCI devices */

