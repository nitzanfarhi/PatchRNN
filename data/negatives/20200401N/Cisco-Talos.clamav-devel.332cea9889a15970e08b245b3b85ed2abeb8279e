commit 332cea9889a15970e08b245b3b85ed2abeb8279e
Author: David Raynor <draynor@sourcefire.com>
Date:   Fri Aug 9 15:12:26 2013 -0400

    libclamunrar: cid #10445 & #10454

diff --git a/libclamunrar/unrarvm.c b/libclamunrar/unrarvm.c
index b3c394ce5..29944cbea 100644
--- a/libclamunrar/unrarvm.c
+++ b/libclamunrar/unrarvm.c
@@ -2,6 +2,7 @@
  *  Extract RAR archives
  *
  *  Copyright (C) 2005-2006 trog@uncon.org
+ *  Patches added by Sourcefire, Inc. Copyright (C) 2007-2013
  *
  *  This code is based on the work of Alexander L. Roshal (C)
  *
@@ -994,6 +995,9 @@ static void rarvm_optimize(struct rarvm_prepared_program *prg)
 			default: /* make gcc happy */
 				break;
 		}
+		if (cmd->op_code > VM_PRINT) {
+			continue; /* don't re-optimize, unlikely anyway */
+		}
 		if ((vm_cmdflags[cmd->op_code] & VMCF_CHFLAGS) == 0) {
 			continue;
 		}

