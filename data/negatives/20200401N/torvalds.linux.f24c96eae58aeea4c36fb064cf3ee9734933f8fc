commit f24c96eae58aeea4c36fb064cf3ee9734933f8fc
Author: Lee, Chun-Yi <joeyli.kernel@gmail.com>
Date:   Thu Jan 3 10:37:45 2013 +0800

    acer-wmi: avoid the warning of 'devices' may be used uninitialized
    
    Fengguang Wu run kernel build test to platform-drivers-x86/linux-next git tree
    on x86_64 architecture and found a warning that was introduced by
    727651bf738b6b917335025d09323d0962eda114 commit:
    
    drivers/platform/x86/acer-wmi.c: In function âWMID_set_capabilitiesâ:
    drivers/platform/x86/acer-wmi.c:1211: warning: âdevicesâ may be used
    uninitialized in this function
    
    This patch fixes the above warning message.
    
    Cc: Carlos Corbacho <carlos@strangeworlds.co.uk>
    Cc: Matthew Garrett <mjg@redhat.com>
    Cc: Dmitry Torokhov <dtor@mail.ru>
    Cc: Corentin Chary <corentincj@iksaif.net>
    Cc: Fengguang Wu <fengguang.wu@intel.com>
    Signed-off-by: Lee, Chun-Yi <jlee@suse.com>
    Signed-off-by: Matthew Garrett <matthew.garrett@nebula.com>

diff --git a/drivers/platform/x86/acer-wmi.c b/drivers/platform/x86/acer-wmi.c
index 563dc3f0e3e7..c9076bdaf2c1 100644
--- a/drivers/platform/x86/acer-wmi.c
+++ b/drivers/platform/x86/acer-wmi.c
@@ -1222,6 +1222,9 @@ static acpi_status WMID_set_capabilities(void)
 			devices = *((u32 *) obj->buffer.pointer);
 		} else if (obj->type == ACPI_TYPE_INTEGER) {
 			devices = (u32) obj->integer.value;
+		} else {
+			kfree(out.pointer);
+			return AE_ERROR;
 		}
 	} else {
 		kfree(out.pointer);

