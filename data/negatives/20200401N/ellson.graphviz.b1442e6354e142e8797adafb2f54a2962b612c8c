commit b1442e6354e142e8797adafb2f54a2962b612c8c
Author: erg <devnull@localhost>
Date:   Tue May 19 16:56:38 2009 +0000

    Need to allocate storage to save previous locale.

diff --git a/lib/common/emit.c b/lib/common/emit.c
index ec2abc6ce..1becc1f97 100644
--- a/lib/common/emit.c
+++ b/lib/common/emit.c
@@ -2878,7 +2878,7 @@ static void gv_fixLocale (int set)
     if (set) {
 	cnt++;
 	if (cnt == 1) {
-	    save_locale = setlocale (LC_NUMERIC, NULL);
+	    save_locale = strdup (setlocale (LC_NUMERIC, NULL));
 	    setlocale (LC_NUMERIC, "C");
 	}
     }
@@ -2886,6 +2886,7 @@ static void gv_fixLocale (int set)
 	cnt--;
 	if (cnt == 0) {
 	    setlocale (LC_NUMERIC, save_locale);
+	    free (save_locale);
 	}
     }
 }

