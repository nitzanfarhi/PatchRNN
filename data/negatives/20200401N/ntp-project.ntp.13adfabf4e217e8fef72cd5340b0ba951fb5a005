commit 13adfabf4e217e8fef72cd5340b0ba951fb5a005
Author:  <mayer@tecotoo.>
Date:   Sat Jul 3 16:56:20 2004 -0400

    handle empty sockets and unknown address family

diff --git a/libntp/socktoa.c b/libntp/socktoa.c
index 34de7848a..ac86aae7b 100644
--- a/libntp/socktoa.c
+++ b/libntp/socktoa.c
@@ -31,9 +31,12 @@ socktoa(
 
 	LIB_GETBUF(buffer);
 
-	if (sock == NULL) printf("null");
+	if (sock == NULL)
+		strcpy(buffer, "null");
+	else
+	{
 
-	switch(sock->ss_family) {
+		switch(sock->ss_family) {
 
 		case AF_INET :
 			inet_ntop(AF_INET, &GET_INADDR(*sock), buffer,
@@ -43,6 +46,9 @@ socktoa(
 		case AF_INET6 :
 			inet_ntop(AF_INET6, &GET_INADDR6(*sock), buffer,
 			    LIB_BUFLENGTH);
+		default:
+			strcpy(buffer, "unknown");
+		}
 	}
   	return buffer;
 }

