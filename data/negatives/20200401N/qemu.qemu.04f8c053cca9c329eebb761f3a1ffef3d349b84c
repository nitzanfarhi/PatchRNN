commit 04f8c053cca9c329eebb761f3a1ffef3d349b84c
Author: Luiz Capitulino <lcapitulino@redhat.com>
Date:   Tue Apr 6 16:39:42 2010 -0300

    QMP: Check "arguments" member's type
    
    Otherwise the following input crashes QEMU:
    
    { "execute": "migrate", "arguments": "tcp:0:4446" }
    
    Signed-off-by: Luiz Capitulino <lcapitulino@redhat.com>

diff --git a/monitor.c b/monitor.c
index 0611b29d1a..ef8429861b 100644
--- a/monitor.c
+++ b/monitor.c
@@ -4437,6 +4437,9 @@ static void handle_qmp_command(JSONMessageParser *parser, QList *tokens)
     obj = qdict_get(input, "arguments");
     if (!obj) {
         args = qdict_new();
+    } else if (qobject_type(obj) != QTYPE_QDICT) {
+        qerror_report(QERR_QMP_BAD_INPUT_OBJECT_MEMBER, "arguments", "object");
+        goto err_input;
     } else {
         args = qobject_to_qdict(obj);
         QINCREF(args);

