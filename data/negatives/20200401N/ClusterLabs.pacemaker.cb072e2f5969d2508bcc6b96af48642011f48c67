commit cb072e2f5969d2508bcc6b96af48642011f48c67
Author: Andrew Beekhof <andrew@beekhof.net>
Date:   Wed Jan 2 09:50:25 2008 +0100

    Medium: crmd: Check we are present in the membership table _and_ active
    
    Mercurial revision: fd4462cd190bfc86849f5906ba30ef0af04d17f8

diff --git a/crmd/callbacks.c b/crmd/callbacks.c
index 19283ee64..d2c0cc50c 100644
--- a/crmd/callbacks.c
+++ b/crmd/callbacks.c
@@ -158,7 +158,7 @@ crmd_ha_msg_callback(HA_Message * msg, void* private_data)
 
 	crm_debug_2("HA[inbound]: %s from %s", op, from);
 
-	if(crm_peer_cache == NULL || g_hash_table_size(crm_peer_cache) == 0) {
+	if(crm_peer_cache == NULL || crm_active_members() == 0) {
 		crm_debug("Ignoring HA messages until we are"
 			  " connected to the CCM (%s op from %s)", op, from);
 		crm_log_message_adv(

