commit 29e69f32ca0b3269267b96c32ba3b46b171ec6d2
Author: Bill Brophy <bill.brophy@bull.com>
Date:   Fri Jul 18 10:44:32 2014 -0700

    When creating reservation with CoreCnt check that Slurm
    uses SelectType=select/cons_res otherwise don't send the
    request to slurmctld and return an error.

diff --git a/src/scontrol/create_res.c b/src/scontrol/create_res.c
index 27399ce1e3..46f3ba55b9 100644
--- a/src/scontrol/create_res.c
+++ b/src/scontrol/create_res.c
@@ -301,8 +301,17 @@ scontrol_parse_res_options(int argc, char *argv[], const char *msg,
 			   strncasecmp(tag, "CPUCount",  MAX(taglen,5)) == 0) {
 
 			char *endptr = NULL, *core_cnt, *tok, *ptrptr = NULL;
+			char *type = NULL;
 			int node_inx = 0;
 
+			type = slurm_get_select_type();
+			if (!strcasecmp(type, "select/linear")) {
+				error("Invalid to use CoreCnt or CPUCnt with "
+				      "SelectType=select/linear");
+				xfree(type);
+				return -1;
+			}
+			xfree(type);
 			core_cnt = xstrdup(val);
 			tok = strtok_r(core_cnt, ",", &ptrptr);
 			while (tok) {

