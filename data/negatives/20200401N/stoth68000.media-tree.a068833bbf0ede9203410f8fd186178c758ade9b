commit a068833bbf0ede9203410f8fd186178c758ade9b
Author: Joakim Tjernlund <Joakim.Tjernlund@transmode.se>
Date:   Mon Apr 20 21:07:48 2015 +0200

    pppoe: Lacks DST MAC address check
    
    A pppoe session is identified by its session ID and MAC address.
    Currently pppoe does not check if the received pkg has the correct
    MAC address. This is a problem when the eth I/F is in promisc mode
    as then any DST MAC address is accepted.
    
    Signed-off-by: Joakim Tjernlund <joakim.tjernlund@transmode.se>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/drivers/net/ppp/pppoe.c b/drivers/net/ppp/pppoe.c
index ff059e1d8ac6..aa1dd926623a 100644
--- a/drivers/net/ppp/pppoe.c
+++ b/drivers/net/ppp/pppoe.c
@@ -380,6 +380,9 @@ static int pppoe_rcv_core(struct sock *sk, struct sk_buff *skb)
 	 * can't change.
 	 */
 
+	if (skb->pkt_type == PACKET_OTHERHOST)
+		goto abort_kfree;
+
 	if (sk->sk_state & PPPOX_BOUND) {
 		ppp_input(&po->chan, skb);
 	} else if (sk->sk_state & PPPOX_RELAY) {

