commit c32b90dec78afe0db51ff0afa6448c01524105fa
Author: Lennart Poettering <lennart@poettering.net>
Date:   Thu May 3 16:17:58 2012 +0200

    systemctl: print a nice error message if an unprivileged user calls systemctl reboot -ff

diff --git a/src/systemctl/systemctl.c b/src/systemctl/systemctl.c
index e2550adb5..cbe6848d0 100644
--- a/src/systemctl/systemctl.c
+++ b/src/systemctl/systemctl.c
@@ -1788,6 +1788,11 @@ static int start_special(DBusConnection *bus, char **args) {
 
         a = verb_to_action(args[0]);
 
+        if (arg_force >= 2 && geteuid() != 0) {
+                log_error("Must be root.");
+                return -EPERM;
+        }
+
         if (arg_force >= 2 &&
             (a == ACTION_HALT ||
              a == ACTION_POWEROFF ||

