commit 4541dbe154c0703cf47c43389b3544884f5f3522
Author: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
Date:   Wed May 25 11:34:52 2011 +0200

    tridentfb: use display information in info not in var for panning
    
    We must not use any information in the passed var besides xoffset,
    yoffset and vmode as otherwise applications might abuse it.
    
    Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>

diff --git a/drivers/video/tridentfb.c b/drivers/video/tridentfb.c
index c6c77562839d..34cf019bba44 100644
--- a/drivers/video/tridentfb.c
+++ b/drivers/video/tridentfb.c
@@ -987,8 +987,8 @@ static int tridentfb_pan_display(struct fb_var_screeninfo *var,
 	unsigned int offset;
 
 	debug("enter\n");
-	offset = (var->xoffset + (var->yoffset * var->xres_virtual))
-		* var->bits_per_pixel / 32;
+	offset = (var->xoffset + (var->yoffset * info->var.xres_virtual))
+		* info->var.bits_per_pixel / 32;
 	set_screen_start(par, offset);
 	debug("exit\n");
 	return 0;

