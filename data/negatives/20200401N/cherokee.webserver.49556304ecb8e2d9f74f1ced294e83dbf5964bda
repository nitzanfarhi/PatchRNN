commit 49556304ecb8e2d9f74f1ced294e83dbf5964bda
Author: alobbs <alvaro@alobbs.com>
Date:   Thu Jul 1 05:41:31 2010 +0000

    Fixes an issue processing the X-forwarded-for header. Bug #924:
    http://bugs.cherokee-project.com/924 - Thanks to Juan J. Martinez for
    the patch.
    
    git-svn-id: svn://cherokee-project.com/cherokee/trunk@5264 5dc97367-97f1-0310-9951-d761b3857238

diff --git a/cherokee/logger.c b/cherokee/logger.c
index c76fbe38..4a57208c 100644
--- a/cherokee/logger.c
+++ b/cherokee/logger.c
@@ -160,7 +160,7 @@ parse_x_real_ip (cherokee_logger_t *logger, cherokee_connection_t *conn)
 		}
 
 		p = val;
-		while (*p) {
+		while (*p && (p - val < len)) {
 			if ((*p == ' ') || (*p == ',')) {
 				len = p - val;
 				break;

