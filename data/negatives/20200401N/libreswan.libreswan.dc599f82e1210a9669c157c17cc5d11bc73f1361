commit dc599f82e1210a9669c157c17cc5d11bc73f1361
Author: Paul Wouters <pwouters@redhat.com>
Date:   Fri May 23 00:46:28 2014 -0400

    pluto: ensure type=passthrough is not rejected for missing ESP/AH
    
    This extra check was recently introduced and caused passthrough
    conns to be rejected.

diff --git a/programs/pluto/connections.c b/programs/pluto/connections.c
index 90e3a5478..b72af02bd 100644
--- a/programs/pluto/connections.c
+++ b/programs/pluto/connections.c
@@ -1140,13 +1140,18 @@ void add_connection(const struct whack_message *wm)
 
 	switch (wm->policy & (POLICY_AUTHENTICATE  | POLICY_ENCRYPT)) {
 	case LEMPTY:
+		if (!NEVER_NEGOTIATE(wm->policy)) {
+			loglog(RC_LOG_SERIOUS,
+				"Connection without AH or ESP cannot negotiate");
+			return;
+		}
+		break;
 	case POLICY_AUTHENTICATE | POLICY_ENCRYPT:
 		loglog(RC_LOG_SERIOUS,
 			"Must specify either AH or ESP.\n");
 		return;
 	}
 
-	/* ??? illegible assignment inside condition */
 	if (wm->ike != NULL) {
 		char err_buf[256];	/* ??? big enough? */
 

