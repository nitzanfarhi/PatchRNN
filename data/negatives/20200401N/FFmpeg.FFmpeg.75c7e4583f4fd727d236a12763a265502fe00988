commit 75c7e4583f4fd727d236a12763a265502fe00988
Author: Carl Eugen Hoyos <cehoyos@ag.or.at>
Date:   Sat Mar 16 20:13:44 2013 +0100

    Do not (re-)set libx264 parameter b_tff if interlaced encoding was not requested.
    
    Reconfiguring can break x264 lossless encoding.
    
    Fixes ticket #2165.

diff --git a/libavcodec/libx264.c b/libavcodec/libx264.c
index a394213680..7e8fa65818 100644
--- a/libavcodec/libx264.c
+++ b/libavcodec/libx264.c
@@ -175,7 +175,7 @@ static int X264_frame(AVCodecContext *ctx, AVPacket *pkt, const AVFrame *frame,
             frame->pict_type == AV_PICTURE_TYPE_P ? X264_TYPE_P :
             frame->pict_type == AV_PICTURE_TYPE_B ? X264_TYPE_B :
                                             X264_TYPE_AUTO;
-        if (x4->params.b_tff != frame->top_field_first) {
+        if (x4->params.b_interlaced && x4->params.b_tff != frame->top_field_first) {
             x4->params.b_tff = frame->top_field_first;
             x264_encoder_reconfig(x4->enc, &x4->params);
         }

