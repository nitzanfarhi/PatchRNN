commit 3642bd88c5ac4dc645c9215bdc98936fcebf47f5
Author: mikeb <mikeb@openbsd.org>
Date:   Fri Jan 20 14:09:00 2017 +0000

    Reset various pointers in ikev2_msg_cleanup
    
    From and OK markus@, OK reyk

diff --git a/sbin/iked/ikev2_msg.c b/sbin/iked/ikev2_msg.c
index 921f223e87a..a41f771db19 100644
--- a/sbin/iked/ikev2_msg.c
+++ b/sbin/iked/ikev2_msg.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: ikev2_msg.c,v 1.47 2017/01/20 13:58:05 mikeb Exp $	*/
+/*	$OpenBSD: ikev2_msg.c,v 1.48 2017/01/20 14:09:00 mikeb Exp $	*/
 
 /*
  * Copyright (c) 2010-2013 Reyk Floeter <reyk@openbsd.org>
@@ -184,6 +184,11 @@ ikev2_msg_cleanup(struct iked *env, struct iked_message *msg)
 		ibuf_release(msg->msg_id.id_buf);
 		ibuf_release(msg->msg_cert.id_buf);
 
+		msg->msg_nonce = NULL;
+		msg->msg_ke = NULL;
+		msg->msg_auth.id_buf = NULL;
+		msg->msg_id.id_buf = NULL;
+		msg->msg_cert.id_buf = NULL;
 		config_free_proposals(&msg->msg_proposals, 0);
 	}
 

