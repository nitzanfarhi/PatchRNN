commit 0a98b21f657b2bfc822619c33bb8f9991df742d6
Author: yoav <yoav@monfort.co.il>
Date:   Mon Dec 31 00:44:30 2012 +0200

    Add error check for writing RDB checksum
    
    Closes #857

diff --git a/src/rdb.c b/src/rdb.c
index 89e77e6f..afaef268 100644
--- a/src/rdb.c
+++ b/src/rdb.c
@@ -688,7 +688,7 @@ int rdbSave(char *filename) {
      * loading code skips the check in this case. */
     cksum = rdb.cksum;
     memrev64ifbe(&cksum);
-    rioWrite(&rdb,&cksum,8);
+    if (rioWrite(&rdb,&cksum,8) == 0) goto werr;
 
     /* Make sure data will not remain on the OS's output buffers */
     if (fflush(fp) == EOF) goto werr;

