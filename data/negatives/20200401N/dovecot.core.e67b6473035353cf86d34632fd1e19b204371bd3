commit e67b6473035353cf86d34632fd1e19b204371bd3
Author: Timo Sirainen <tss@iki.fi>
Date:   Wed Aug 1 14:33:01 2007 +0300

    FETCH/STORE n:* should give a BAD error if there are no messages in mailbox.
    
    --HG--
    branch : HEAD

diff --git a/src/imap/imap-search.c b/src/imap/imap-search.c
index 5829a4294..db2090c64 100644
--- a/src/imap/imap-search.c
+++ b/src/imap/imap-search.c
@@ -450,7 +450,7 @@ static int imap_search_get_msgset_arg(struct client_command_context *cmd,
 	arg = p_new(cmd->pool, struct mail_search_arg, 1);
 	arg->type = SEARCH_SEQSET;
 	arg->value.seqset = imap_messageset_parse(cmd->pool, messageset);
-	if (arg->value.seqset == NULL ||
+	if (arg->value.seqset == NULL || cmd->client->messages_count == 0 ||
 	    (arg->value.seqset->seq2 > cmd->client->messages_count &&
 	     arg->value.seqset->seq2 != (uint32_t)-1)) {
 		*error_r = "Invalid messageset";

