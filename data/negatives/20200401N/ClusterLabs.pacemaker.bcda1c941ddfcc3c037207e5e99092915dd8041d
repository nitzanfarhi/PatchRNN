commit bcda1c941ddfcc3c037207e5e99092915dd8041d
Author: David Vossel <dvossel@redhat.com>
Date:   Thu Aug 22 13:33:10 2013 -0500

    Fix: pengine: Order demote/promote of resources on remote nodes to happen only once the connection is up

diff --git a/pengine/allocate.c b/pengine/allocate.c
index cf8f4d481..bfa8e7be4 100644
--- a/pengine/allocate.c
+++ b/pengine/allocate.c
@@ -1578,6 +1578,8 @@ apply_remote_node_ordering(pe_working_set_t *data_set)
         container = remote_rsc->container;
         if (safe_str_eq(action->task, "monitor") ||
             safe_str_eq(action->task, "start") ||
+            safe_str_eq(action->task, "promote") ||
+            safe_str_eq(action->task, "demote") ||
             safe_str_eq(action->task, CRM_OP_LRM_REFRESH) ||
             safe_str_eq(action->task, CRM_OP_CLEAR_FAILCOUNT) ||
             safe_str_eq(action->task, "delete")) {

