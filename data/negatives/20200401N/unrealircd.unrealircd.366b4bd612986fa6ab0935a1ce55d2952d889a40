commit 366b4bd612986fa6ab0935a1ce55d2952d889a40
Author: William Pitcock <nenolod@dereferenced.org>
Date:   Mon May 6 04:06:37 2013 +0000

    - Show operator login name to other operators when whoising a local operator. (#2301)

diff --git a/src/modules/m_whois.c b/src/modules/m_whois.c
index 6892713c..3f90d3fd 100644
--- a/src/modules/m_whois.c
+++ b/src/modules/m_whois.c
@@ -293,9 +293,16 @@ DLLFUNC int  m_whois(aClient *cptr, aClient *sptr, int parc, char *parv[])
 				else
 					strlcat(buf, "a Local IRC Operator", sizeof buf);
 				if (buf[0])
-					sendto_one(sptr,
-					    rpl_str(RPL_WHOISOPERATOR), me.name,
-					    parv[0], name, buf);
+				{
+					if (IsOper(sptr) && MyClient(acptr))
+						sendto_one(sptr,
+						    ":%s 313 %s %s :is %s (%s)", me.name,
+						    parv[0], name, buf, acptr->user->operlogin);
+					else
+						sendto_one(sptr,
+						    rpl_str(RPL_WHOISOPERATOR), me.name,
+						    parv[0], name, buf);
+				}
 			}
 
 			if (IsHelpOp(acptr) && !hideoper && !user->away)

