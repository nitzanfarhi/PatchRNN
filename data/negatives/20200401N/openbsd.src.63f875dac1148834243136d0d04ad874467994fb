commit 63f875dac1148834243136d0d04ad874467994fb
Author: deraadt <deraadt@openbsd.org>
Date:   Mon Jan 10 03:23:30 2011 +0000

    OK, this is getting silly, but we might as well zero the entropy buffer
    supplied by root (it can be large enough to overwhelm the entropy buffer,
    and we are doing a re-key almost immediately)

diff --git a/sys/dev/rnd.c b/sys/dev/rnd.c
index cdc6269aa13..60eaf9f3446 100644
--- a/sys/dev/rnd.c
+++ b/sys/dev/rnd.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: rnd.c,v 1.133 2011/01/10 02:44:18 deraadt Exp $	*/
+/*	$OpenBSD: rnd.c,v 1.134 2011/01/10 03:23:30 deraadt Exp $	*/
 
 /*
  * Copyright (c) 2011 Theo de Raadt.
@@ -793,6 +793,7 @@ randomwrite(dev_t dev, struct uio *uio, int flags)
 	if (newdata)
 		arc4_init(NULL, NULL);
 
+	bzero(buf, POOLBYTES);
 	free(buf, M_TEMP);
 	return ret;
 }

