commit 1b3281c0736443e8b38f3c056eb602d446cc318b
Author: Gerald Jelinek <Gerald.Jelinek@Sun.COM>
Date:   Tue Jun 15 14:16:12 2010 -0700

    6565738 zonecfg import fails when using capped-memory
    6831546 zonecfg add net does not autocomplete defrouter

diff --git a/usr/src/cmd/zonecfg/zonecfg.c b/usr/src/cmd/zonecfg/zonecfg.c
index 3827d53026..90ec478673 100644
--- a/usr/src/cmd/zonecfg/zonecfg.c
+++ b/usr/src/cmd/zonecfg/zonecfg.c
@@ -400,6 +400,7 @@ static const char *net_res_scope_cmds[] = {
 	"info",
 	"set address=",
 	"set physical=",
+	"set defrouter=",
 	NULL
 };
 
@@ -1887,6 +1888,17 @@ export_func(cmd_t *cmd)
 	}
 	(void) zonecfg_enddevent(handle);
 
+	if (zonecfg_getmcapent(handle, &mcaptab) == Z_OK) {
+		char buf[128];
+
+		(void) fprintf(of, "%s %s\n", cmd_to_str(CMD_ADD),
+		    rt_to_str(RT_MCAP));
+		bytes_to_units(mcaptab.zone_physmem_cap, buf, sizeof (buf));
+		(void) fprintf(of, "%s %s=%s\n", cmd_to_str(CMD_SET),
+		    pt_to_str(PT_PHYSICAL), buf);
+		(void) fprintf(of, "%s\n", cmd_to_str(CMD_END));
+	}
+
 	if ((err = zonecfg_setrctlent(handle)) != Z_OK) {
 		zone_perror(zone, err, B_FALSE);
 		goto done;
@@ -1949,17 +1961,6 @@ export_func(cmd_t *cmd)
 		(void) fprintf(of, "%s\n", cmd_to_str(CMD_END));
 	}
 
-	if (zonecfg_getmcapent(handle, &mcaptab) == Z_OK) {
-		char buf[128];
-
-		(void) fprintf(of, "%s %s\n", cmd_to_str(CMD_ADD),
-		    rt_to_str(RT_MCAP));
-		bytes_to_units(mcaptab.zone_physmem_cap, buf, sizeof (buf));
-		(void) fprintf(of, "%s %s=%s\n", cmd_to_str(CMD_SET),
-		    pt_to_str(PT_PHYSICAL), buf);
-		(void) fprintf(of, "%s\n", cmd_to_str(CMD_END));
-	}
-
 	if ((err = zonecfg_setadminent(handle)) != Z_OK) {
 		zone_perror(zone, err, B_FALSE);
 		goto done;

