commit 09ea583507435ca877bca582bad775b7dc53c641
Author: Richard Russon <rich@flatcap.org>
Date:   Tue Jun 6 17:19:06 2017 +0100

    fix: don't pass colour-codes to filters
    
    If the index_format string is being passed to an external filter, then
    don't embed our secret colour-codes.
    
    Fixes: #221

diff --git a/hdrline.c b/hdrline.c
index fc6172991..460348234 100644
--- a/hdrline.c
+++ b/hdrline.c
@@ -143,6 +143,10 @@ static size_t add_index_color(char *buf, size_t buflen, format_flag flags, char
   if (!(flags & MUTT_FORMAT_INDEX))
     return 0;
 
+  /* this item is going to be passed to an external filter */
+  if (flags & MUTT_FORMAT_NOFILTER)
+    return 0;
+
   if (color == MT_COLOR_INDEX)
   { /* buf might be uninitialized other cases */
     len = mutt_strlen(buf);

