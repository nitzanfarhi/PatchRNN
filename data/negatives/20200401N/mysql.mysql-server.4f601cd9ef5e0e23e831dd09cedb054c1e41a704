commit 4f601cd9ef5e0e23e831dd09cedb054c1e41a704
Author: heikki@hundin.mysql.fi <>
Date:   Wed Mar 10 11:05:02 2004 +0200

    buf0lru.c:
      Add typecasts to ulong because ulint is __int64 in Win 64-bits
      Better error message to the .err log if we have to crash the server because the buffer pool is exhausted by the lock table or the adaptive hash index

diff --git a/innobase/buf/buf0lru.c b/innobase/buf/buf0lru.c
index a8729efb999..1d49833969f 100644
--- a/innobase/buf/buf0lru.c
+++ b/innobase/buf/buf0lru.c
@@ -227,9 +227,13 @@ loop:
 
 	   	fprintf(stderr,
 "  InnoDB: ERROR: over 9 / 10 of the buffer pool is occupied by\n"
-"InnoDB: lock heaps or the adaptive hash index!\n"
+"InnoDB: lock heaps or the adaptive hash index! Check that your\n"
+"InnoDB: transactions do not set too many row locks.\n"
+"InnoDB: Your buffer pool size is %lu MB. Maybe you should make\n"
+"InnoDB: the buffer pool bigger?\n"
 "InnoDB: We intentionally generate a seg fault to print a stack trace\n"
-"InnoDB: on Linux!\n");
+"InnoDB: on Linux!\n",
+		(ulong)(buf_pool->curr_size / (1024 * 1024 / UNIV_PAGE_SIZE)));
 
 		ut_a(0);
 	   
@@ -250,7 +254,7 @@ loop:
 "InnoDB: the buffer pool bigger?\n"
 "InnoDB: Starting the InnoDB Monitor to print diagnostics, including\n"
 "InnoDB: lock heap and hash index sizes.\n",
-			buf_pool->curr_size / (1024 * 1024 / UNIV_PAGE_SIZE));
+		(ulong)(buf_pool->curr_size / (1024 * 1024 / UNIV_PAGE_SIZE)));
 
 			srv_print_innodb_monitor = TRUE;
 			os_event_set(srv_lock_timeout_thread_event);

