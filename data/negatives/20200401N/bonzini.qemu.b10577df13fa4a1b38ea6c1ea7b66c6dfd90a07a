commit b10577df13fa4a1b38ea6c1ea7b66c6dfd90a07a
Author: Stefan Hajnoczi <stefanha@redhat.com>
Date:   Thu Aug 22 15:28:36 2013 +0200

    win32-aio: drop win32_aio_flush_cb()
    
    The io_flush argument to qemu_aio_set_event_notifier() has been removed
    since the block layer learnt to drain requests by itself.  Fix the
    Windows build for win32-aio.o by updating the
    qemu_aio_set_event_notifier() call and dropping win32_aio_flush_cb().
    
    Reviewed-by: Stefan Weil <sw@weilnetz.de>
    Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>

diff --git a/block/win32-aio.c b/block/win32-aio.c
index fcb7c754da..5d1d199b61 100644
--- a/block/win32-aio.c
+++ b/block/win32-aio.c
@@ -105,13 +105,6 @@ static void win32_aio_completion_cb(EventNotifier *e)
     }
 }
 
-static int win32_aio_flush_cb(EventNotifier *e)
-{
-    QEMUWin32AIOState *s = container_of(e, QEMUWin32AIOState, e);
-
-    return (s->count > 0) ? 1 : 0;
-}
-
 static void win32_aio_cancel(BlockDriverAIOCB *blockacb)
 {
     QEMUWin32AIOCB *waiocb = (QEMUWin32AIOCB *)blockacb;
@@ -201,8 +194,7 @@ QEMUWin32AIOState *win32_aio_init(void)
         goto out_close_efd;
     }
 
-    qemu_aio_set_event_notifier(&s->e, win32_aio_completion_cb,
-                                win32_aio_flush_cb);
+    qemu_aio_set_event_notifier(&s->e, win32_aio_completion_cb);
 
     return s;
 

