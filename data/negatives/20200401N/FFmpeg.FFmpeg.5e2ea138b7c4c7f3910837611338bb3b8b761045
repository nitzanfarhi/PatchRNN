commit 5e2ea138b7c4c7f3910837611338bb3b8b761045
Author: Reimar Döffinger <Reimar.Doeffinger@gmx.de>
Date:   Sat Aug 27 14:37:14 2011 +0200

    MJPEG: emulate EOI also on two consecutive SOI.
    
    Fixes issue #362.
    
    Signed-off-by: Reimar Döffinger <Reimar.Doeffinger@gmx.de>

diff --git a/libavcodec/mjpegdec.c b/libavcodec/mjpegdec.c
index da0c5a959d..eac30e6e2d 100644
--- a/libavcodec/mjpegdec.c
+++ b/libavcodec/mjpegdec.c
@@ -1442,6 +1442,10 @@ int ff_mjpeg_decode_frame(AVCodecContext *avctx,
 
                     s->restart_count = 0;
                     /* nothing to do on SOI */
+                    if (s->got_picture) {
+                        av_log(avctx, AV_LOG_WARNING, "EOI missing, emulating\n");
+                        goto eoi_parser;
+                    }
                     break;
                 case DQT:
                     ff_mjpeg_decode_dqt(s);

