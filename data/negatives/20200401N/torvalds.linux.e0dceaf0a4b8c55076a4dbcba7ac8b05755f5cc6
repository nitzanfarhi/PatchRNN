commit e0dceaf0a4b8c55076a4dbcba7ac8b05755f5cc6
Author: Mark Fasheh <mark.fasheh@oracle.com>
Date:   Thu Aug 9 16:52:30 2007 -0700

    ocfs2: set non-default s_time_gran during mount
    
    We need to manually set this to '1' during mount, otherwise inode_setattr()
    will chop off the nanosecond portion of our timestamps.
    
    Signed-off-by: Mark Fasheh <mark.fasheh@oracle.com>

diff --git a/fs/ocfs2/super.c b/fs/ocfs2/super.c
index c3c89e26567c..f2fc9a795deb 100644
--- a/fs/ocfs2/super.c
+++ b/fs/ocfs2/super.c
@@ -1291,6 +1291,7 @@ static int ocfs2_initialize_super(struct super_block *sb,
 	sb->s_fs_info = osb;
 	sb->s_op = &ocfs2_sops;
 	sb->s_export_op = &ocfs2_export_ops;
+	sb->s_time_gran = 1;
 	sb->s_flags |= MS_NOATIME;
 	/* this is needed to support O_LARGEFILE */
 	cbits = le32_to_cpu(di->id2.i_super.s_clustersize_bits);

