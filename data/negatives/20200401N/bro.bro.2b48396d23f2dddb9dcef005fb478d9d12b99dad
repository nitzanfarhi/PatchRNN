commit 2b48396d23f2dddb9dcef005fb478d9d12b99dad
Author: Seth Hall <seth@icir.org>
Date:   Fri Jul 5 02:00:35 2013 -0400

    Check file_over_new_connetion to fire for each connection (including the first).

diff --git a/src/file_analysis/File.cc b/src/file_analysis/File.cc
index e68ee5523..c1ad92c0e 100644
--- a/src/file_analysis/File.cc
+++ b/src/file_analysis/File.cc
@@ -116,11 +116,8 @@ void File::UpdateConnectionFields(Connection* conn)
 
 	Val* conns = val->Lookup(conns_idx);
 
-	bool is_first = false;
-
 	if ( ! conns )
 		{
-		is_first = true;
 		conns = empty_connection_table();
 		val->Assign(conns_idx, conns);
 		}
@@ -131,7 +128,7 @@ void File::UpdateConnectionFields(Connection* conn)
 		Val* conn_val = conn->BuildConnVal();
 		conns->AsTableVal()->Assign(idx, conn_val);
 
-		if ( ! is_first && FileEventAvailable(file_over_new_connection) )
+		if ( FileEventAvailable(file_over_new_connection) )
 			{
 			val_list* vl = new val_list();
 			vl->append(val->Ref());

