commit 5f75819249eb91f7c654d46897febd938c920d0b
Author: Glen Low <glen.low@pixelglow.com>
Date:   Thu Dec 5 22:43:06 2013 +0800

    Quartz: formats ico:quartz and icns:quartz for Mac OS X

diff --git a/plugin/quartz/gvdevice_quartz.c b/plugin/quartz/gvdevice_quartz.c
index 9c7ee40db..32bdc5e6d 100644
--- a/plugin/quartz/gvdevice_quartz.c
+++ b/plugin/quartz/gvdevice_quartz.c
@@ -87,6 +87,8 @@ gvplugin_installed_t gvdevice_quartz_types_for_cairo[] = {
 	{FORMAT_BMP, "bmp:cairo", 9, &quartz_engine, &device_features_quartz},
 	{FORMAT_GIF, "gif:cairo", 9, &quartz_engine, &device_features_quartz},
 	{FORMAT_EXR, "exr:cairo", 9, &quartz_engine, &device_features_quartz},
+	{FORMAT_ICNS, "icns:cairo", 9, &quartz_engine, &device_features_quartz},
+	{FORMAT_ICO, "ico:cairo", 9, &quartz_engine, &device_features_quartz},
 	{FORMAT_JPEG, "jpe:cairo", 9, &quartz_engine, &device_features_quartz},
 	{FORMAT_JPEG, "jpeg:cairo", 9, &quartz_engine, &device_features_quartz},
 	{FORMAT_JPEG, "jpg:cairo", 9, &quartz_engine, &device_features_quartz},
diff --git a/plugin/quartz/gvplugin_quartz.c b/plugin/quartz/gvplugin_quartz.c
index 947b0a771..1e1fa6da6 100644
--- a/plugin/quartz/gvplugin_quartz.c
+++ b/plugin/quartz/gvplugin_quartz.c
@@ -51,6 +51,10 @@ CFStringRef format_to_uti(format_type format)
 			return CFSTR("com.ilm.openexr-image");
 		case FORMAT_GIF:
 			return CFSTR("com.compuserve.gif");
+		case FORMAT_ICNS:
+			return CFSTR("com.apple.icns");
+		case FORMAT_ICO:
+			return CFSTR("com.microsoft.ico");
 		case FORMAT_JPEG:
 			return CFSTR("public.jpeg");
 		case FORMAT_JPEG2000:
diff --git a/plugin/quartz/gvplugin_quartz.h b/plugin/quartz/gvplugin_quartz.h
index 7a1aa09d6..6aa810be0 100644
--- a/plugin/quartz/gvplugin_quartz.h
+++ b/plugin/quartz/gvplugin_quartz.h
@@ -32,6 +32,8 @@ typedef enum {
 	FORMAT_BMP,
 	FORMAT_EXR,
 	FORMAT_GIF,
+	FORMAT_ICNS,
+	FORMAT_ICO,
 	FORMAT_JPEG,
 	FORMAT_JPEG2000,
 	FORMAT_PDF,
diff --git a/plugin/quartz/gvrender_quartz.c b/plugin/quartz/gvrender_quartz.c
index cdf8c4cd1..2382dd1a7 100644
--- a/plugin/quartz/gvrender_quartz.c
+++ b/plugin/quartz/gvrender_quartz.c
@@ -496,6 +496,8 @@ gvplugin_installed_t gvdevice_quartz_types[] = {
     {FORMAT_BMP, "bmp:quartz", 8, NULL, &device_features_quartz},
     {FORMAT_GIF, "gif:quartz", 8, NULL, &device_features_quartz},
     {FORMAT_EXR, "exr:quartz", 8, NULL, &device_features_quartz},
+    {FORMAT_ICNS, "icns:quartz", 8, NULL, &device_features_quartz},
+    {FORMAT_ICO, "ico:quartz", 8, NULL, &device_features_quartz},
     {FORMAT_JPEG, "jpe:quartz", 8, NULL, &device_features_quartz},
     {FORMAT_JPEG, "jpeg:quartz", 8, NULL, &device_features_quartz},
     {FORMAT_JPEG, "jpg:quartz", 8, NULL, &device_features_quartz},

