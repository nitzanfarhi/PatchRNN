commit 8e8d957ff82859f5d65b5977d837cd610da5b431
Author: Oran Agra <oran@redislabs.com>
Date:   Tue Feb 13 15:47:06 2018 +0200

    fix to latency monitor reporting wrong max latency
    
    in some cases LATENCY HISTORY reported latency that was
    higher than the max latency reported by LATENCY LATEST / DOCTOR

diff --git a/src/latency.c b/src/latency.c
index 9e9f1f13..1f43f906 100644
--- a/src/latency.c
+++ b/src/latency.c
@@ -115,6 +115,7 @@ void latencyAddSample(char *event, mstime_t latency) {
     if (ts->samples[prev].time == now) {
         if (latency > ts->samples[prev].latency)
             ts->samples[prev].latency = latency;
+        if (latency > ts->max) ts->max = latency;
         return;
     }
 

