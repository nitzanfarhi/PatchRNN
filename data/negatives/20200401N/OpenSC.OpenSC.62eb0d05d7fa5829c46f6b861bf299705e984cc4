commit 62eb0d05d7fa5829c46f6b861bf299705e984cc4
Author: Viktor Tarasov <viktor.tarasov@gmail.com>
Date:   Mon Jun 11 19:59:36 2012 +0200

    jcop: coverity scan warning RETURN_LOCAL
    
    CID 402623: Pointer to local outside scope (RETURN_LOCAL)

diff --git a/src/libopensc/card-jcop.c b/src/libopensc/card-jcop.c
index 637f6905..7dbc29b9 100644
--- a/src/libopensc/card-jcop.c
+++ b/src/libopensc/card-jcop.c
@@ -641,7 +641,8 @@ static int jcop_set_security_env(sc_card_t *card,
                         tmp.algorithm_ref |= 0x10;
                 if (tmp.algorithm_flags & SC_ALGORITHM_RSA_HASH_MD5)
                         tmp.algorithm_ref |= 0x20;
-		env=&tmp;
+
+		memcpy(env, &tmp, sizeof(struct sc_security_env));
 	}
 	
         sc_format_apdu(card, &apdu, SC_APDU_CASE_3_SHORT, 0x22, 0xC1, 0);

