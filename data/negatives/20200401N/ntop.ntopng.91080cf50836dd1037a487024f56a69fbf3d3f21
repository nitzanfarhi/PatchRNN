commit 91080cf50836dd1037a487024f56a69fbf3d3f21
Author: Luca Deri <deri@ntop.org>
Date:   Mon Sep 11 22:24:29 2017 +0200

    Fixed glitch in host pools

diff --git a/include/HostPools.h b/include/HostPools.h
index f580d068..9f592854 100644
--- a/include/HostPools.h
+++ b/include/HostPools.h
@@ -72,13 +72,13 @@ public:
   bool findIpPool(IpAddress *ip, u_int16_t vlan_id, u_int16_t *found_pool, patricia_node_t **found_node);
   bool findMacPool(u_int8_t *mac, u_int16_t vlan_id, u_int16_t *found_pool);
   bool findMacPool(Mac *mac, u_int16_t *found_pool);
-
+  void lua(lua_State *vm);
+  
 #ifdef NTOPNG_PRO
   void incPoolStats(u_int32_t when, u_int16_t host_pool_id, u_int16_t ndpi_proto,
 		    ndpi_protocol_category_t category_id, u_int64_t sent_packets, u_int64_t sent_bytes,
 		    u_int64_t rcvd_packets, u_int64_t rcvd_bytes);
   void updateStats(struct timeval *tv);
-  void lua(lua_State *vm);
   void luaStats(lua_State *vm);
 
   inline bool getProtoStats(u_int16_t host_pool_id, u_int16_t ndpi_proto, u_int64_t *bytes, u_int32_t *duration) {
diff --git a/src/Host.cpp b/src/Host.cpp
index 6ab7d646..032634af 100644
--- a/src/Host.cpp
+++ b/src/Host.cpp
@@ -64,6 +64,8 @@ Host::~Host() {
 
   serialize2redis(); /* possibly dumps counters and data to redis */
 
+  if(host_pool_id != NO_HOST_POOL_ID) iface->decPoolNumMembers(host_pool_id);
+  
   if(mac)           mac->decUses();
   if(as)            as->decUses();
   if(vlan)          vlan->decUses();

