commit 66bc05e5ae5ba73858dc19fc209b45af6538af8d
Author: Rich Prohaska <prohaska@tokutek.com>
Date:   Mon Sep 24 16:26:11 2012 +0000

    refs #5524 get basic tokudb running in mariadb 10
    
    git-svn-id: file:///svn/mysql/tokudb-engine/tokudb-engine@48232 c7de825b-a66e-492c-adef-691d508d4ae1

diff --git a/storage/tokudb/hatoku_cmp.h b/storage/tokudb/hatoku_cmp.h
index 973fd6605d6..7658374a777 100644
--- a/storage/tokudb/hatoku_cmp.h
+++ b/storage/tokudb/hatoku_cmp.h
@@ -171,7 +171,7 @@ static inline const uchar* unpack_toku_field_blob(
 }
 
 static inline uint get_null_offset(TABLE* table, Field* field) {
-#if MYSQL_VERSION_ID >= 50606
+#if 50606 <= MYSQL_VERSION_ID && MYSQL_VERSION_ID <= 50699
     return field->null_offset(table->record[0]);
 #else
     return (uint) ((uchar*) field->null_ptr - (uchar*) table->record[0]);
diff --git a/storage/tokudb/hatoku_defines.h b/storage/tokudb/hatoku_defines.h
index 5ee1bf4cd90..cf1086850f3 100644
--- a/storage/tokudb/hatoku_defines.h
+++ b/storage/tokudb/hatoku_defines.h
@@ -29,26 +29,33 @@
 #endif
 #endif
 
-#if 50600 <= MYSQL_VERSION_ID && MYSQL_VERSION_ID <= 50699
+#if 100000 <= MYSQL_VERSION_ID && MYSQL_VERSION_ID <= 100099
+#define TOKU_INCLUDE_ALTER_56 0
+#define TOKU_INCLUDE_ROW_TYPE_COMPRESSION 0
+#define TOKU_INCLUDE_XA 0
+#define TOKU_PARTITION_WRITE_FRM_DATA 0
+
+#elif 50600 <= MYSQL_VERSION_ID && MYSQL_VERSION_ID <= 50699
 #define TOKU_INCLUDE_ALTER_56 1
 #define TOKU_INCLUDE_ROW_TYPE_COMPRESSION 1
 #define TOKU_INCLUDE_XA 1
 #define TOKU_PARTITION_WRITE_FRM_DATA 0
-#endif
 
-#if 50500 <= MYSQL_VERSION_ID && MYSQL_VERSION_ID <= 50599
+#elif 50500 <= MYSQL_VERSION_ID && MYSQL_VERSION_ID <= 50599
 #define TOKU_INCLUDE_ALTER_56 1
 #define TOKU_INCLUDE_ALTER_55 1
 #define TOKU_INCLUDE_ROW_TYPE_COMPRESSION 1
 #define TOKU_INCLUDE_XA 1
 #define TOKU_PARTITION_WRITE_FRM_DATA 1
-#endif
 
-#if 50100 <= MYSQL_VERSION_ID && MYSQL_VERSION_ID < 50299
+#elif 50100 <= MYSQL_VERSION_ID && MYSQL_VERSION_ID < 50299
 #define TOKU_INCLUDE_ALTER_51 1
 #define TOKU_INCLUDE_ROW_TYPE_COMPRESSION 1
 #define TOKU_INCLUDE_XA 1
 #define TOKU_PARTITION_WRITE_FRM_DATA 0
+
+#else
+#error
 #endif
 
 #if !defined(HA_CLUSTERING)

