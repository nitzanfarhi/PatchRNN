commit 30dc7ef3adab20f1d23ccc1ba96039a7b84b49c0
Author: Manuel Pégourié-Gonnard <mpg@elzevir.fr>
Date:   Wed Jul 17 14:03:42 2013 +0200

    Reset max_fragment_length in ssl_session_reset()

diff --git a/library/ssl_tls.c b/library/ssl_tls.c
index b2d3dc85a..9a1590c58 100644
--- a/library/ssl_tls.c
+++ b/library/ssl_tls.c
@@ -2870,6 +2870,9 @@ int ssl_session_reset( ssl_context *ssl )
     ssl->out_msglen = 0;
     ssl->out_left = 0;
 
+    ssl->mfl_code = SSL_MAX_FRAG_LEN_NONE;
+    ssl->max_frag_len = SSL_MAX_CONTENT_LEN;
+
     ssl->transform_in = NULL;
     ssl->transform_out = NULL;
 

