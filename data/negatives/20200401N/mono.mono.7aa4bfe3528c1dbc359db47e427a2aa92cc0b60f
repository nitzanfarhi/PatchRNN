commit 7aa4bfe3528c1dbc359db47e427a2aa92cc0b60f
Author: cherusker <prince.cherusker@gmail.com>
Date:   Sat Jun 24 15:03:01 2017 +0200

    Check return value of asn1_generalizedtime_to_tm ()

diff --git a/mono/btls/btls-util.c b/mono/btls/btls-util.c
index 955b8c85aec..57fa0fa7813 100644
--- a/mono/btls/btls-util.c
+++ b/mono/btls/btls-util.c
@@ -27,13 +27,19 @@ mono_btls_util_asn1_time_to_ticks (ASN1_TIME *time)
 	ASN1_GENERALIZEDTIME *gtime;
 	struct tm tm;
 	int64_t epoch;
+	int ret;
 	
 	memset (&tm, 0, sizeof (tm));
 
 	gtime = ASN1_TIME_to_generalizedtime (time, NULL);
-	/* FIXME: check return value of  asn1_generalizedtime_to_tm () */
-	asn1_generalizedtime_to_tm (&tm, gtime);
+	ret = asn1_generalizedtime_to_tm (&tm, gtime);
 	ASN1_GENERALIZEDTIME_free (gtime);
+
+	/* FIXME: check the return value in managed code */
+	if (ret == 0) {
+		return 0;
+	}
+
 	epoch = btls_timegm64 (&tm);
 
 	return epoch;

