commit d732b5aa671d03f28dc7efbfb380f46f54d33636
Author: Török Edvin <edwin@clamav.net>
Date:   Mon Aug 9 22:40:48 2010 +0300

    Reenable JIT selfcheck.
    
    Lost in startup.cbc conversion.

diff --git a/libclamav/bytecode.c b/libclamav/bytecode.c
index 76f54ab27..af0482711 100644
--- a/libclamav/bytecode.c
+++ b/libclamav/bytecode.c
@@ -2322,8 +2322,10 @@ int cli_bytecode_prepare(struct cl_engine *engine, struct cli_all_bc *bcs, unsig
     }
     cli_bytecode_context_destroy(ctx);
 
+
     if (engine->bytecode_mode != CL_BYTECODE_MODE_INTERPRETER &&
 	engine->bytecode_mode != CL_BYTECODE_MODE_OFF) {
+	selfcheck(1, bcs->engine);
 	rc = cli_bytecode_prepare_jit(bcs);
 	if (rc == CL_SUCCESS) {
 	    jitok = 1;

