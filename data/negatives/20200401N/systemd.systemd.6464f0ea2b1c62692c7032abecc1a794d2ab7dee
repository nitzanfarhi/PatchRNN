commit 6464f0ea2b1c62692c7032abecc1a794d2ab7dee
Author: Kay Sievers <kay.sievers@suse.de>
Date:   Sat Apr 8 18:19:10 2006 +0200

    udevtrigger: fix event order
    
    Thanks for the fix to:
      Thomas de Grenier de Latour <degrenier@easyconnect.fr>

diff --git a/udevtrigger.c b/udevtrigger.c
index bc8453a82..2d5772fd6 100644
--- a/udevtrigger.c
+++ b/udevtrigger.c
@@ -74,16 +74,17 @@ LIST_HEAD(device_last_list);
 static int device_list_insert(const char *path)
 {
 	struct list_head *device_list = &device_default_list;
+	const char *devpath = &path[strlen(sysfs_path)];
 	int i;
 
 	for (i = 0; first_list[i] != NULL; i++) {
-		if (strncmp(path, first_list[i], strlen(first_list[i])) == 0) {
+		if (strncmp(devpath, first_list[i], strlen(first_list[i])) == 0) {
 			device_list = &device_first_list;
 			break;
 		}
 	}
 	for (i = 0; last_list[i] != NULL; i++) {
-		if (strncmp(path, last_list[i], strlen(last_list[i])) == 0) {
+		if (strncmp(devpath, last_list[i], strlen(last_list[i])) == 0) {
 			device_list = &device_last_list;
 			break;
 		}

