commit df760a0a4b393cef3265d7d30c67a001de152764
Author: Daniel Stenberg <daniel@haxx.se>
Date:   Thu Sep 4 13:31:49 2003 +0000

    no user or password set, bail out

diff --git a/lib/http_ntlm.c b/lib/http_ntlm.c
index bb17f371b..763cb96cb 100644
--- a/lib/http_ntlm.c
+++ b/lib/http_ntlm.c
@@ -311,6 +311,10 @@ CURLcode Curl_output_ntlm(struct connectdata *conn,
     passwdp = conn->passwd;
     ntlm = &conn->ntlm;
   }
+
+  if(!userp || !passwdp)
+    /* no user, no auth */
+    return CURLE_OK;
   
   switch(ntlm->state) {
   case NTLMSTATE_TYPE1:

