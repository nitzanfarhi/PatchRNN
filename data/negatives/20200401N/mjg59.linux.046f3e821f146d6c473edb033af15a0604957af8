commit 046f3e821f146d6c473edb033af15a0604957af8
Author: Stefan Weinhuber <wein@de.ibm.com>
Date:   Mon Mar 5 23:35:52 2007 +0100

    [S390] dasd: Use default recovery for SNSS requests
    
    For extended error reporting we sometimes have to start an
    Sense Subsystem Status request (SNSS). When this request needs
    to be recovered for some reason, the recovery request will
    fail with 'command reject'.
    Our usual recovery procedure will retry the failed request by
    creating a new request and chaining the failed request from that
    one. SNSS requests, though, must not be chained from anything,
    so the recovery request will fail permanently.
    Use the default recovery for SNSS request, which will just restart
    the original request without further ado.
    
    Signed-off-by: Stefan Weinhuber <wein@de.ibm.com>
    Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>

diff --git a/drivers/s390/block/dasd_eer.c b/drivers/s390/block/dasd_eer.c
index 4b8a95fba1e5..a1dc8c466ec9 100644
--- a/drivers/s390/block/dasd_eer.c
+++ b/drivers/s390/block/dasd_eer.c
@@ -461,6 +461,7 @@ int dasd_eer_enable(struct dasd_device *device)
 	cqr->device = device;
 	cqr->retries = 255;
 	cqr->expires = 10 * HZ;
+	clear_bit(DASD_CQR_FLAGS_USE_ERP, &cqr->flags);
 
 	cqr->cpaddr->cmd_code = DASD_ECKD_CCW_SNSS;
 	cqr->cpaddr->count = SNSS_DATA_SIZE;

