commit 15ecc7c4a490165a2491120f367a374dcbb67c0a
Author: David Beer <dbeer@adaptivecomputing.com>
Date:   Wed Nov 12 11:43:43 2014 -0700

    TRQ-2971. Add an additional check for an appropriate value.

diff --git a/src/lib/Libdis/disrl_.c b/src/lib/Libdis/disrl_.c
index 74df2e751..12ac9152f 100644
--- a/src/lib/Libdis/disrl_.c
+++ b/src/lib/Libdis/disrl_.c
@@ -108,6 +108,15 @@ int disrl_(
   if (dis_umaxd == 0)
     disiui_();
 
+  if (count >= dis_umaxd)
+    {
+    if (count > dis_umaxd)
+      goto overflow;
+
+    if (memcmp(scratch, dis_umax, dis_umaxd) > 0)
+      goto overflow;
+    }
+
   switch (c = tcp_getc(chan, pbs_tcp_timeout))
     {
 
@@ -305,6 +314,7 @@ int disrl_(
       break;
     }  /* END switch (c = tcp_getc(chan)) */
 
+overflow:
   *ldval = HUGE_VAL;
 
   return(DIS_OVERFLOW);
diff --git a/src/lib/Libdis/disrsl_.c b/src/lib/Libdis/disrsl_.c
index 519d310e3..4b6dc220a 100644
--- a/src/lib/Libdis/disrsl_.c
+++ b/src/lib/Libdis/disrsl_.c
@@ -128,6 +128,15 @@ int disrsl_(
       disiui_();
     }
 
+  if (count >= ulmaxdigs)
+    {
+    if (count > ulmaxdigs)
+      goto overflow;
+
+    if (memcmp(scratch, ulmax, ulmaxdigs) > 0)
+      goto overflow;
+    }
+
   c = tcp_getc(chan, pbs_tcp_timeout);
 
   /* FORMAT:  +2+1+0+0+64+2079+22+251175826.teva.westgrid.ubc2+362+21+8Job_Name+02+11run32_.2557+02+ ... */

