commit 8f5393d716f99d2edb16ce7c2f7ba5e077765292
Author: Philipp Lohmann <pl@openoffice.org>
Date:   Thu May 10 18:33:14 2001 +0000

    handle empty tokens in longer strings correctly

diff --git a/sal/rtl/source/strtmpl.c b/sal/rtl/source/strtmpl.c
index 6e0f41792584..18fe1ff56cca 100644
--- a/sal/rtl/source/strtmpl.c
+++ b/sal/rtl/source/strtmpl.c
@@ -2,9 +2,9 @@
  *
  *  $RCSfile: strtmpl.c,v $
  *
- *  $Revision: 1.6 $
+ *  $Revision: 1.7 $
  *
- *  last change: $Author: th $ $Date: 2001-05-09 12:55:34 $
+ *  last change: $Author: pl $ $Date: 2001-05-10 19:33:14 $
  *
  *  The Contents of this file are made available subject to the terms of
  *  either of the following licenses
@@ -1680,7 +1680,11 @@ sal_Int32 SAL_CALL IMPL_RTL_STRINGNAME( getToken )( IMPL_RTL_STRINGDATA** ppThis
     if ( (nToken < 0) || (nTokCount < nToken) || (pCharStr == pCharStrStart) )
     {
         IMPL_RTL_STRINGNAME( new )( ppThis );
-        return -1;
+        if( (nToken < 0) || (nTokCount < nToken ) )
+            return -1;
+        else if( nLen > 0 )
+            return nIndex+1;
+        else return -1;
     }
     else
     {

