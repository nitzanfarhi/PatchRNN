commit 4c60c5b9873e5bf04409062455ac5572e6b90936
Author: deraadt <deraadt@openbsd.org>
Date:   Sun Nov 15 02:49:59 2015 +0000

    pledge "stdio rpath wpath cpath tmppath fattr"
    ok guenther

diff --git a/libexec/ld.so/ldconfig/ldconfig.c b/libexec/ld.so/ldconfig/ldconfig.c
index f007002a0d3..28909689a15 100644
--- a/libexec/ld.so/ldconfig/ldconfig.c
+++ b/libexec/ld.so/ldconfig/ldconfig.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: ldconfig.c,v 1.34 2015/01/18 04:48:24 deraadt Exp $	*/
+/*	$OpenBSD: ldconfig.c,v 1.35 2015/11/15 02:49:59 deraadt Exp $	*/
 
 /*
  * Copyright (c) 1993,1995 Paul Kranenburg
@@ -102,6 +102,9 @@ main(int argc, char *argv[])
 	int i, c;
 	int rval = 0;
 
+	if (pledge("stdio rpath wpath cpath tmppath fattr", NULL) == -1)
+		err(1, "pledge");
+
 	while ((c = getopt(argc, argv, "DmPrRsSUv")) != -1) {
 		switch (c) {
 		case 'R':

