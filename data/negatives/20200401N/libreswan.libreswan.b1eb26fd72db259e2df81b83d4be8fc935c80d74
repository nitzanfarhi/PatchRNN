commit b1eb26fd72db259e2df81b83d4be8fc935c80d74
Author: Tuomo Soini <tis@foobar.fi>
Date:   Mon Nov 14 19:54:11 2016 +0200

    Re-enable commit c2ea09114589251c4a1aa615038bf86c3cd9b367.
    
    After commit 01d8ece19bd632b2b181cc407a3831f6ef092b41 fixing real issue
    causing passert on ikev1 rekey c2ea09114589251c4a1aa615038bf86c3cd9b367
    is again safe commit.
    
    Revert "Revert "pluto: Fix ca name and generalName leak lsbz#276 [Bill Rios]""
    
    This reverts commit 14348a4e3433881a56ac8463c2d052ba03428197.
    After commit 01d8ece19bd632b2b181cc407a3831f6ef092b41

diff --git a/programs/pluto/x509.c b/programs/pluto/x509.c
index 622631287..48ce46e71 100644
--- a/programs/pluto/x509.c
+++ b/programs/pluto/x509.c
@@ -915,6 +915,7 @@ void ikev1_decode_cr(struct msg_digest *md)
 				gn->kind = GN_DIRECTORY_NAME;
 				gn->next = requested_ca;
 				requested_ca = gn;
+				st->st_requested_ca = requested_ca;
 			}
 
 			DBG(DBG_X509 | DBG_CONTROL, {
@@ -969,6 +970,7 @@ void ikev2_decode_cr(struct msg_digest *md)
 				gn->name = ca_name;
 				gn->next = requested_ca;
 				requested_ca = gn;
+				st->st_requested_ca = requested_ca;
 			}
 
 			DBG(DBG_X509, {

