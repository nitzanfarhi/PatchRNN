commit a91ae4e6bd1d4c751a297ca0a1bf519c2b5a7014
Author: Andrew Beekhof <andrew@beekhof.net>
Date:   Thu Jun 28 14:03:32 2007 +0200

    crmd: Provide useful feedback when the metadata is unreadable
    
    Mercurial revision: 0cef14146c9de6c72df9709c16f055487366683f

diff --git a/crm/crmd/lrm.c b/crm/crmd/lrm.c
index 0b8ba0b62..b0106a90a 100644
--- a/crm/crmd/lrm.c
+++ b/crm/crmd/lrm.c
@@ -315,6 +315,12 @@ get_rsc_restart_list(lrm_rsc_t *rsc, lrm_op_t *op)
 	}
 	
 	metadata = string2xml(metadata_str);
+	if(metadata == NULL) {
+		crm_err("Metadata for %s::%s:%s is not valid XML",
+			rsc->provider, rsc->class, rsc->type);
+		return NULL;
+	}
+
 	actions = find_xml_node(metadata, "actions", TRUE);
 	
 	xml_child_iter_filter(

