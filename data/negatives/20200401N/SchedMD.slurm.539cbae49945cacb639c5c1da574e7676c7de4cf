commit 539cbae49945cacb639c5c1da574e7676c7de4cf
Author: Brian Christiansen <brian@schedmd.com>
Date:   Mon Aug 6 15:27:33 2018 -0600

    Use correct units on slurmd side
    
    when validating memory limits
    
    Continuation of b502d1790ac

diff --git a/src/slurmd/slurmd/req.c b/src/slurmd/slurmd/req.c
index 2dbba00fbf..ac36f5d0fe 100644
--- a/src/slurmd/slurmd/req.c
+++ b/src/slurmd/slurmd/req.c
@@ -2986,10 +2986,10 @@ _enforce_job_mem_limit(void)
 			     stepd->jobid, stepd->stepid,
 			     step_rss, step_vsize);
 #endif
-			step_rss /= 1024;	/* KB to MB */
+			step_rss /= 1048576;	/* B to MB */
 			step_rss = MAX(step_rss, 1);
 			job_mem_info_ptr[job_inx].mem_used += step_rss;
-			step_vsize /= 1024;	/* KB to MB */
+			step_vsize /= 1048576;	/* B to MB */
 			step_vsize = MAX(step_vsize, 1);
 			job_mem_info_ptr[job_inx].vsize_used += step_vsize;
 		}

