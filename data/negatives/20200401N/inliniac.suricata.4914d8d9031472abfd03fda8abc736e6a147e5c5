commit 4914d8d9031472abfd03fda8abc736e6a147e5c5
Author: Victor Julien <victor@inliniac.net>
Date:   Fri Sep 25 08:42:09 2009 +0200

    Small stream fixes.

diff --git a/src/app-layer-parser.c b/src/app-layer-parser.c
index 2a6ef234..4bceba5e 100644
--- a/src/app-layer-parser.c
+++ b/src/app-layer-parser.c
@@ -43,9 +43,9 @@ static void AlpResultElmtPoolFree(void *e) {
 
 static AppLayerParserResultElmt *AlpGetResultElmt(void) {
     AppLayerParserResultElmt *e = (AppLayerParserResultElmt *)PoolGet(al_result_pool);
-    if (e == NULL)
+    if (e == NULL) {
         return NULL;
-
+    }
     e->next = NULL;
     return e;
 }
diff --git a/src/detect-isdataat.h b/src/detect-isdataat.h
old mode 100755
new mode 100644
diff --git a/src/stream-tcp-reassemble.c b/src/stream-tcp-reassemble.c
index 742e3d12..2dcb250b 100644
--- a/src/stream-tcp-reassemble.c
+++ b/src/stream-tcp-reassemble.c
@@ -912,7 +912,7 @@ static void StreamTcpSetupMsg(TcpSession *ssn, TcpStream *stream, Packet *p, Str
 static int StreamTcpReassembleCheckLimit(TcpSession *ssn, TcpStream *stream, Packet *p) {
 
     /* some states mean we reassemble no matter how much data we have */
-    if (ssn->state == TCP_TIME_WAIT)
+    if (ssn->state >= TCP_TIME_WAIT)
         return 1;
 
     /* check if we have enough data to send to L7 */

