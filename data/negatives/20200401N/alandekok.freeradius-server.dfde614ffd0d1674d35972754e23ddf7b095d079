commit dfde614ffd0d1674d35972754e23ddf7b095d079
Author: aland <aland>
Date:   Fri Jun 27 15:17:52 2003 +0000

            Use the correct variable to check the status
    
            Patch from Dan Carver

diff --git a/src/modules/rlm_sql/drivers/rlm_sql_postgresql/sql_postgresql.c b/src/modules/rlm_sql/drivers/rlm_sql_postgresql/sql_postgresql.c
index f260bfac9..0068e7b41 100644
--- a/src/modules/rlm_sql/drivers/rlm_sql_postgresql/sql_postgresql.c
+++ b/src/modules/rlm_sql/drivers/rlm_sql_postgresql/sql_postgresql.c
@@ -169,7 +169,7 @@ static int sql_init_socket(SQLSOCK *sqlsocket, SQL_CONFIG *config) {
 	pg_sock->result=NULL;
 	pg_sock->conn=PQconnectdb(connstring);
 
-	if (PQstatus(sqlsocket->conn) == CONNECTION_BAD) {
+	if (PQstatus(pg_sock->conn) == CONNECTION_BAD) {
 		radlog(L_ERR, "rlm_sql_postgresql: Couldn't connect socket to PostgreSQL server %s@%s:%s", config->sql_login, config->sql_server, config->sql_db);
 		radlog(L_ERR, "rlm_sql_postgresql: Postgresql error '%s'", PQerrorMessage(pg_sock->conn));
 		PQfinish(pg_sock->conn);

