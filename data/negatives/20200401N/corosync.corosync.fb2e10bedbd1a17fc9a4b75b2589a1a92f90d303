commit fb2e10bedbd1a17fc9a4b75b2589a1a92f90d303
Author: Steven Dake <sdake@redhat.com>
Date:   Sun Sep 9 06:15:31 2007 +0000

    Patch to log security warnings when invalid identifier is used in message
    header for a totem message.
    
    
    git-svn-id: http://svn.fedorahosted.org/svn/corosync/trunk@1425 fd59a12c-fef9-0310-b244-a6a79926bd2f

diff --git a/exec/totemsrp.c b/exec/totemsrp.c
index 9f72e668..d7258d93 100644
--- a/exec/totemsrp.c
+++ b/exec/totemsrp.c
@@ -4042,7 +4042,12 @@ void main_deliver_fn (
 		log_printf (instance->totemsrp_log_level_security, "Received message is too short...  ignoring %d.\n", msg_len);
 		return;
 	}
-
+	
+	if ((int)message_header->type >= totemsrp_message_handlers.count) {
+		log_printf (instance->totemsrp_log_level_security, "Type of received message is wrong...  ignoring %d.\n", (int)message_header->type);
+		return;
+	}
+	
 	/*
 	 * Handle incoming message
 	 */

