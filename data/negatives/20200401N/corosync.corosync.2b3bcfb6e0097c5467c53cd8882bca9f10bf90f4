commit 2b3bcfb6e0097c5467c53cd8882bca9f10bf90f4
Author: Mark Haverkamp <markh@osdl.org>
Date:   Mon Jun 27 21:33:30 2005 +0000

    saEvtEventAttributesSet needs to check that the priority value passed in
    is valid.
    
    
    git-svn-id: http://svn.fedorahosted.org/svn/corosync/trunk@712 fd59a12c-fef9-0310-b244-a6a79926bd2f

diff --git a/lib/evt.c b/lib/evt.c
index 33328b2f..9604745b 100644
--- a/lib/evt.c
+++ b/lib/evt.c
@@ -1392,6 +1392,11 @@ saEvtEventAttributesSet(
 	struct event_data_instance *edi;
 	int i;
 
+	if (priority < SA_EVT_HIGHEST_PRIORITY ||
+			priority > SA_EVT_LOWEST_PRIORITY) {
+		return SA_AIS_ERR_INVALID_PARAM;
+	}
+
 	error = saHandleInstanceGet(&event_handle_db, eventHandle,
 			(void*)&edi);
 	if (error != SA_AIS_OK) {

