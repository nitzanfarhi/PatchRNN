commit 145023f57262d21474e35b4a6069cf95136339d4
Author: Luca Barbato <lu_zero@gentoo.org>
Date:   Thu Jun 6 16:58:57 2013 +0200

    4xm: reject frames not compatible with the declared version
    
    Reported-by: Mateusz "j00ru" Jurczyk and Gynvael Coldwind
    CC: libav-stable@libav.org

diff --git a/libavcodec/4xm.c b/libavcodec/4xm.c
index 1e706448c..3d8906bff 100644
--- a/libavcodec/4xm.c
+++ b/libavcodec/4xm.c
@@ -837,6 +837,9 @@ static int decode_frame(AVCodecContext *avctx, void *data,
                 av_log(f->avctx, AV_LOG_ERROR, "cframe id mismatch %d %d\n",
                        id, avctx->frame_number);
 
+            if (f->version <= 1)
+                return AVERROR_INVALIDDATA;
+
             cfrm->size = cfrm->id = 0;
             frame_4cc  = AV_RL32("pfrm");
         } else

