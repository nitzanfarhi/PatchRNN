commit e6c2a198b3b5acab59a43a2e2c49bf758c089c7a
Author: Joachim Metz <joachim.metz@gmail.com>
Date:   Fri Nov 30 07:31:25 2012 +0100

    Changes of version: 20121129

diff --git a/evttools/export_handle.c b/evttools/export_handle.c
index 09adc5c..13bd19b 100644
--- a/evttools/export_handle.c
+++ b/evttools/export_handle.c
@@ -981,6 +981,19 @@ int export_handle_message_string_fprint(
 
 				continue;
 			}
+			/* Replace %% = % */
+			if( ( message_string->string )[ message_string_index + 1 ] == (libcstring_system_character_t) '%' )
+			{
+				fprintf(
+				 export_handle->notify_stream,
+				 "%%" );
+
+				last_character = (libcstring_system_character_t) '%';
+
+				message_string_index += 2;
+
+				continue;
+			}
 			/* Replace %b = space */
 			if( ( message_string->string )[ message_string_index + 1 ] == (libcstring_system_character_t) 'b' )
 			{
@@ -1165,8 +1178,9 @@ int export_handle_message_string_fprint(
 					 export_handle->notify_stream,
 					 "%" PRIc_LIBCSTRING_SYSTEM "",
 					 ( message_string->string )[ message_string_index ] );
+
+					last_character = ( message_string->string )[ message_string_index ];
 				}
-				last_character = ( message_string->string )[ message_string_index ];
 			}
 			message_string_index += 1;
 		}

