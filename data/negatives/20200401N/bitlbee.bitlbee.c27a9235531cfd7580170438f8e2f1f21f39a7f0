commit c27a9235531cfd7580170438f8e2f1f21f39a7f0
Author: dequis <dx@dxzone.com.ar>
Date:   Fri Oct 10 23:20:52 2014 -0300

    Remove MSNXMPP specific code
    
    The MSN XMPP gateway was shutdown december 2013 and isn't coming back.

diff --git a/protocols/jabber/jabber.c b/protocols/jabber/jabber.c
index dab4afdf..4b5cb3a1 100644
--- a/protocols/jabber/jabber.c
+++ b/protocols/jabber/jabber.c
@@ -147,9 +147,7 @@ static void jabber_login( account_t *acc )
 		
 		jd->fd = jd->r_inpa = jd->w_inpa = -1;
 		
-		if( strstr( jd->server, ".live.com" ) )
-			jd->oauth2_service = &oauth2_service_mslive;
-		else if( strstr( jd->server, ".facebook.com" ) )
+		if( strstr( jd->server, ".facebook.com" ) )
 			jd->oauth2_service = &oauth2_service_facebook;
 		else
 			jd->oauth2_service = &oauth2_service_google;
diff --git a/protocols/jabber/jabber.h b/protocols/jabber/jabber.h
index 21769a3b..e6aa3ba3 100644
--- a/protocols/jabber/jabber.h
+++ b/protocols/jabber/jabber.h
@@ -337,7 +337,6 @@ int sasl_oauth2_refresh( struct im_connection *ic, const char *refresh_token );
 
 extern const struct oauth2_service oauth2_service_google;
 extern const struct oauth2_service oauth2_service_facebook;
-extern const struct oauth2_service oauth2_service_mslive;
 
 /* conference.c */
 struct groupchat *jabber_chat_join( struct im_connection *ic, const char *room, const char *nick, const char *password );
diff --git a/protocols/jabber/sasl.c b/protocols/jabber/sasl.c
index 12111fc7..a4d1f6c1 100644
--- a/protocols/jabber/sasl.c
+++ b/protocols/jabber/sasl.c
@@ -46,15 +46,6 @@ const struct oauth2_service oauth2_service_facebook =
 	"126828914005625",
 	"4b100f0f244d620bf3f15f8b217d4c32",
 };
-const struct oauth2_service oauth2_service_mslive =
-{
-	"https://oauth.live.com/authorize",
-	"https://oauth.live.com/token",
-	"http://www.bitlbee.org/main.php/Messenger/oauth2.html",
-	"wl.offline_access%20wl.messenger",
-	"000000004C06FCD1",
-	"IRKlBPzJJAWcY-TbZjiTEJu9tn7XCFaV",
-};
 
 xt_status sasl_pkt_mechanisms( struct xt_node *node, gpointer data )
 {
@@ -62,7 +53,7 @@ xt_status sasl_pkt_mechanisms( struct xt_node *node, gpointer data )
 	struct jabber_data *jd = ic->proto_data;
 	struct xt_node *c, *reply;
 	char *s;
-	int sup_plain = 0, sup_digest = 0, sup_gtalk = 0, sup_fb = 0, sup_ms = 0;
+	int sup_plain = 0, sup_digest = 0, sup_gtalk = 0, sup_fb = 0;
 	int want_oauth = FALSE;
 	GString *mechs;
 	
@@ -97,8 +88,6 @@ xt_status sasl_pkt_mechanisms( struct xt_node *node, gpointer data )
 			sup_gtalk = 1;
 		else if( c->text && g_strcasecmp( c->text, "X-FACEBOOK-PLATFORM" ) == 0 )
 			sup_fb = 1;
-		else if( c->text && g_strcasecmp( c->text, "X-MESSENGER-OAUTH2" ) == 0 )
-			sup_ms = 1;
 		
 		if( c->text )
 			g_string_append_printf( mechs, " %s", c->text );
@@ -108,7 +97,7 @@ xt_status sasl_pkt_mechanisms( struct xt_node *node, gpointer data )
 	
 	if( !want_oauth && !sup_plain && !sup_digest )
 	{
-		if( !sup_gtalk && !sup_fb && !sup_ms )
+		if( !sup_gtalk && !sup_fb )
 			imcb_error( ic, "This server requires OAuth "
 			                "(supported schemes:%s)", mechs->str );
 		else
@@ -141,12 +130,6 @@ xt_status sasl_pkt_mechanisms( struct xt_node *node, gpointer data )
 		reply->text_len = strlen( reply->text );
 		g_free( s );
 	}
-	else if( sup_ms && want_oauth )
-	{
-		xt_add_attr( reply, "mechanism", "X-MESSENGER-OAUTH2" );
-		reply->text = g_strdup( jd->oauth2_access_token );
-		reply->text_len = strlen( jd->oauth2_access_token );
-	}
 	else if( sup_fb && want_oauth )
 	{
 		xt_add_attr( reply, "mechanism", "X-FACEBOOK-PLATFORM" );

