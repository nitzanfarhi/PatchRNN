commit bb4b7624d9dd17dcda44703d5d69292a85fe2d4d
Author: James Almer <jamrial@gmail.com>
Date:   Sat Sep 23 02:15:16 2017 -0300

    avformat/apngenc: use av_packet_alloc()
    
    Signed-off-by: James Almer <jamrial@gmail.com>

diff --git a/libavformat/apngenc.c b/libavformat/apngenc.c
index 378a9b3b36..d4191c02cc 100644
--- a/libavformat/apngenc.c
+++ b/libavformat/apngenc.c
@@ -228,7 +228,7 @@ static int apng_write_packet(AVFormatContext *format_context, AVPacket *packet)
     int ret;
 
     if (!apng->prev_packet) {
-        apng->prev_packet = av_malloc(sizeof(*apng->prev_packet));
+        apng->prev_packet = av_packet_alloc();
         if (!apng->prev_packet)
             return AVERROR(ENOMEM);
 

