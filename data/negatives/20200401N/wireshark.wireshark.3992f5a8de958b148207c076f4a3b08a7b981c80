commit 3992f5a8de958b148207c076f4a3b08a7b981c80
Author: Uli Heilmeier <uh@heilmeier.eu>
Date:   Thu Mar 24 11:57:56 2016 +0100

    GTPv2: Fix length of Presence Reporting Area Identifier field
    
    Specs (http://www.etsi.org/deliver/etsi_ts/129200_129299/129274/13.04.00_60/ts_129274v130400p.pdf
    , page 281 ) lists 3 Bytes for field Presence Reporting Area Identifier.
    
    Bug: 12284
    Change-Id: I404c5133fa0975b5c9a245b8e4b952c7eb4d2818
    Reviewed-on: https://code.wireshark.org/review/14608
    Reviewed-by: Pascal Quantin <pascal.quantin@gmail.com>

diff --git a/epan/dissectors/packet-gtpv2.c b/epan/dissectors/packet-gtpv2.c
index a6fb749410..fa21fd8864 100644
--- a/epan/dissectors/packet-gtpv2.c
+++ b/epan/dissectors/packet-gtpv2.c
@@ -5834,12 +5834,12 @@ dissect_gtpv2_pres_rep_area_action(tvbuff_t *tvb, packet_info *pinfo, proto_tree
     if (length == 1)
         return;
     /* Octet 6 to 8     Presence Reporting Area Identifier */
-    proto_tree_add_item(tree, hf_gtpv2_pres_rep_area_id, tvb, offset, 2, ENC_BIG_ENDIAN);
-    offset+=2;
-    if (length == 3)
+    proto_tree_add_item(tree, hf_gtpv2_pres_rep_area_id, tvb, offset, 3, ENC_BIG_ENDIAN);
+    offset+=3;
+    if (length == 4)
         return;
 
-    new_tvb = tvb_new_subset_length(tvb, offset, length-3);
+    new_tvb = tvb_new_subset_length(tvb, offset, length-4);
 
     /* Share the rest of the dissection with the AVP dissector */
     dissect_diameter_3gpp_presence_reporting_area_elements_list(new_tvb, pinfo, tree, NULL);
@@ -8359,7 +8359,7 @@ void proto_register_gtpv2(void)
         },
         { &hf_gtpv2_pres_rep_area_id,
           {"Presence Reporting Area Identifier", "gtpv2.pres_rep_area_action.pres_rep_area_id",
-           FT_UINT16, BASE_HEX, NULL, 0x0,
+           FT_UINT24, BASE_HEX, NULL, 0x0,
            NULL, HFILL}
         },
         { &hf_gtpv2_pres_rep_area_act_no_tai,

