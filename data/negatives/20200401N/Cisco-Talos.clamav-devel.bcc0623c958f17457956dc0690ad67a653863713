commit bcc0623c958f17457956dc0690ad67a653863713
Author: Mickey Sola <msola@sourcefire.com>
Date:   Tue Jun 20 17:29:05 2017 -0400

    mspack - add cli_debug_flag to internal mspack

diff --git a/libclamav/libmspack-0.5alpha/mspack/system.h b/libclamav/libmspack-0.5alpha/mspack/system.h
index 9a1d8323d..d885760a4 100644
--- a/libclamav/libmspack-0.5alpha/mspack/system.h
+++ b/libclamav/libmspack-0.5alpha/mspack/system.h
@@ -34,7 +34,9 @@ extern "C" {
 
 #ifdef DEBUG
 # include <stdio.h>
+# include <stdint.h>
 
+extern uint8_t cli_debug_flag;
 /* Old GCCs don't have __func__, but __FUNCTION__:
  * http://gcc.gnu.org/onlinedocs/gcc/Function-Names.html
  */
@@ -46,8 +48,11 @@ extern "C" {
 #  endif
 # endif
 /* Adding custom clamav debug code. */
-# define D(x) do {   printf("LibClamAV debug: %s:%d (%s)", __FILE__, __LINE__, __func__); \
-                     printf x ; fputc('\n', stdout); fflush(stdout);} while (0);
+# define D(x) do {   if(cli_debug_flag) { \
+                        printf("LibClamAV debug: %s:%d (%s)", __FILE__, __LINE__, __func__); \
+                        printf x ; fputc('\n', stdout); fflush(stdout); \
+                     } \
+                  } while (0);
 
 #else
 # define D(x)

