commit 8d727af8c4d309463cd463689b50ffb299b61964
Author: antirez <antirez@gmail.com>
Date:   Fri Apr 8 14:19:52 2011 +0200

    update state when FAIL is cleared from a node

diff --git a/src/cluster.c b/src/cluster.c
index e2b82044..70c34aab 100644
--- a/src/cluster.c
+++ b/src/cluster.c
@@ -943,6 +943,7 @@ void clusterCron(void) {
                 node->flags &= ~REDIS_NODE_PFAIL;
             } else if (node->flags & REDIS_NODE_FAIL && !node->numslaves) {
                 node->flags &= ~REDIS_NODE_FAIL;
+                clusterUpdateState();
             }
         } else {
             /* Timeout reached. Set the noad se possibly failing if it is

