commit e6c4d3d43d4d00a0ed945c77e6b89c74b38120d7
Author: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
Date:   Tue Jun 14 09:24:45 2011 +0000

    fbdev: da8xx: use display information in info not in var for panning
    
    We must not use any information in the passed var besides xoffset,
    yoffset and vmode as otherwise applications might abuse it.
    
    Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
    Cc: Sudhakar Rajashekhara <sudhakar.raj@ti.com>
    Cc: Martin Ambrose <martin@ti.com>
    Signed-off-by: Paul Mundt <lethal@linux-sh.org>

diff --git a/drivers/video/da8xx-fb.c b/drivers/video/da8xx-fb.c
index fcdac872522d..8d4e4ebd9977 100644
--- a/drivers/video/da8xx-fb.c
+++ b/drivers/video/da8xx-fb.c
@@ -877,8 +877,8 @@ static int da8xx_pan_display(struct fb_var_screeninfo *var,
 
 			start	= fix->smem_start +
 				new_var.yoffset * fix->line_length +
-				new_var.xoffset * var->bits_per_pixel / 8;
-			end	= start + var->yres * fix->line_length - 1;
+				new_var.xoffset * fbi->var.bits_per_pixel / 8;
+			end	= start + fbi->var.yres * fix->line_length - 1;
 			par->dma_start	= start;
 			par->dma_end	= end;
 		}

