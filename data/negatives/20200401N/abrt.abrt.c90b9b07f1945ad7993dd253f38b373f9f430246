commit c90b9b07f1945ad7993dd253f38b373f9f430246
Author: Zdenek Prikryl <zdeny@dhcp-lab-218.englab.brq.redhat.com>
Date:   Wed Feb 4 17:08:12 2009 +0100

    better test of MW

diff --git a/lib/MiddleWare/test.cpp b/lib/MiddleWare/test.cpp
index 380af469..0397996c 100644
--- a/lib/MiddleWare/test.cpp
+++ b/lib/MiddleWare/test.cpp
@@ -30,29 +30,32 @@ int main(int argc, char** argv)
 {
 
 
-	try
-	{
-		CMiddleWare middleWare(PLUGINS_CONF_DIR, PLUGINS_LIB_DIR);
-		CDebugDump* dd;
-
-		middleWare.LoadPlugins();
-		middleWare.UnLoadPlugin("Mailx");
-
-		dd = new CDebugDump(DEBUG_DUMPS_DIR);
-
-		dd->Delete();
-		dd->Create();
-		dd->SaveTextFile("UUID", middleWare.GetUUID("CCpp", (void*)"data"));
-		char pid[100];
-		sprintf(pid, "%d", getpid());
-		dd->SaveProc(pid);
-
-		delete dd;
-	}
-	catch (std::string sError)
-	{
-		std::cerr << sError << std::endl;
-	}
-
-	return 0;
+    try
+    {
+        CMiddleWare middleWare(PLUGINS_CONF_DIR, PLUGINS_LIB_DIR, "CrashCatcher.conf");
+        CDebugDump dd;
+
+        middleWare.RegisterPlugin("CCpp");
+        middleWare.RegisterPlugin("SQLite3");
+
+        char pid[100];
+        sprintf(pid, "%d", getpid());
+
+        dd.Create(std::string(DEBUG_DUMPS_DIR)+"/"+pid);
+        dd.SaveProc(pid);
+        dd.SaveText(FILENAME_LANGUAGE, "CCpp");
+        dd.SaveBinary(FILENAME_BINARYDATA1, "ass0-9as", sizeof("ass0-9as"));
+        dd.SaveText(FILENAME_TIME, "1111111111");
+        dd.SaveText(FILENAME_EXECUTABLE, "test");
+        dd.SaveText(FILENAME_PACKAGE, "test-1.0-1.f10");
+
+        middleWare.SaveDebugDumpToDatabase(std::string(DEBUG_DUMPS_DIR)+"/"+pid);
+
+    }
+    catch (std::string sError)
+    {
+        std::cerr << sError << std::endl;
+    }
+
+    return 0;
 }

