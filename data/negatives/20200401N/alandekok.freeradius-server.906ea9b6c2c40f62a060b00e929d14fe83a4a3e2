commit 906ea9b6c2c40f62a060b00e929d14fe83a4a3e2
Author: aland <aland>
Date:   Tue Jun 4 17:54:28 2002 +0000

            When parsing tags, only allow numeric tags.  If we see anything
            else, we give a parse error.

diff --git a/src/lib/valuepair.c b/src/lib/valuepair.c
index dd0fe6d47..ae7c2f27b 100644
--- a/src/lib/valuepair.c
+++ b/src/lib/valuepair.c
@@ -516,12 +516,15 @@ VALUE_PAIR *pairmake(const char *attribute, const char *value, int operator)
 		         /* Wildcard tag for check items */
 		         tag = TAG_ANY;
 			 *ts = 0;
-		 } else {
+		 } else if ((ts[1] >= 0) && (ts[1] <= '9')) {
 		         /* It's not a wild card tag */
 		         tag = strtol(ts + 1, &tc, 0);
 			 if (tc && !*tc && TAG_VALID_ZERO(tag))
-			        *ts = 0;
+				 *ts = 0;
 			 else tag = 0;
+		 } else {
+			 librad_log("Invalid tag for attribute %s", attribute);
+			 return NULL;
 		 }
 		 found_tag = 1;
 	}

