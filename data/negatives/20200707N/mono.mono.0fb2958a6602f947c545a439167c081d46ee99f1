commit 0fb2958a6602f947c545a439167c081d46ee99f1
Author: Rob Wilkens <RobWilkens@gmail.com>
Date:   Mon Jun 25 20:17:24 2012 -0400

    For Bug 2014: map FcntlCommand to local system command for fcntl_lock
    
    In support/fcntl.c - every time fcntl() was called, it would first map the
    cmd from mono's version of it to the system header file version of it.
    The only time this wasn't happening was in Mono_Posix_Syscall_fcntl_lock()
    and now it does it there too.  This seems to resolve Bug 2014 on both
    64-bit linux and on Mac OS X (64-bit).

diff --git a/support/fcntl.c b/support/fcntl.c
index d7e9c481180..013d9cd4167 100644
--- a/support/fcntl.c
+++ b/support/fcntl.c
@@ -69,6 +69,9 @@ Mono_Posix_Syscall_fcntl_lock (gint32 fd, gint32 cmd, struct Mono_Posix_Flock *l
 	if (Mono_Posix_FromFlock (lock, &_lock) == -1)
 		return -1;
 
+	if (Mono_Posix_FromFcntlCommand (cmd, &cmd) == -1)
+		return -1;
+
 	r = fcntl (fd, cmd, &_lock);
 
 	if (Mono_Posix_ToFlock (&_lock, lock) == -1)

