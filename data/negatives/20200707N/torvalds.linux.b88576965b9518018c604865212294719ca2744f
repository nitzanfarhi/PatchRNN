commit b88576965b9518018c604865212294719ca2744f
Author: Simon Baatz <gmbnomis@gmail.com>
Date:   Sun Jun 9 22:14:14 2013 +0200

    mmc: mxcmmc: handle mmc_of_parse() errors during probe
    
    Signed-off-by: Simon Baatz <gmbnomis@gmail.com>
    Signed-off-by: Chris Ball <cjb@laptop.org>

diff --git a/drivers/mmc/host/mxcmmc.c b/drivers/mmc/host/mxcmmc.c
index 786448a10f15..c174c6a0d224 100644
--- a/drivers/mmc/host/mxcmmc.c
+++ b/drivers/mmc/host/mxcmmc.c
@@ -1067,7 +1067,9 @@ static int mxcmci_probe(struct platform_device *pdev)
 		goto out_release_mem;
 	}
 
-	mmc_of_parse(mmc);
+	ret = mmc_of_parse(mmc);
+	if (ret)
+		goto out_free;
 	mmc->ops = &mxcmci_ops;
 
 	/* For devicetree parsing, the bus width is read from devicetree */

