commit c4e02893c9fdceba99db38397590967709e6a74e
Author: Steve Morgan <smorgan@sourcefire.com>
Date:   Mon Sep 17 12:36:17 2012 -0700

    fix write() on a file desriptor of -1, bb#5784

diff --git a/clamd/server-th.c b/clamd/server-th.c
index 908795575..3c7f1c9c3 100644
--- a/clamd/server-th.c
+++ b/clamd/server-th.c
@@ -639,6 +639,7 @@ static int handle_stream(client_conn_t *conn, struct fd_buf *buf, const struct o
 			pthread_mutex_unlock(&exit_mutex);
 		    }
 		    *error = 1;
+		    return -1;
 		} else {
 		    pos = 4;
 		    memmove (buf->buffer, &buf->buffer[pos], buf->off - pos);

