commit 045a1ee38706c147ee4cf5ef112a91197b09c6ff
Author: pancake <pancake@nopcode.org>
Date:   Mon Dec 22 01:11:16 2014 +0100

    Disable self:// in sandbox mode

diff --git a/libr/io/p/io_self.c b/libr/io/p/io_self.c
index 72d02ae2b..30b667bfb 100644
--- a/libr/io/p/io_self.c
+++ b/libr/io/p/io_self.c
@@ -124,6 +124,8 @@ static int __plugin_open(RIO *io, const char *file, ut8 many) {
 
 static RIODesc *__open(RIO *io, const char *file, int rw, int mode) {
 	int ret, pid = getpid ();
+	if (r_sandbox_enable (0))
+		return NULL;
 	io->va = R_TRUE; // nop
 	ret = update_self_regions (pid);
 	if (ret) {

