commit b19ceaad0dee6bca619ba2de19003b50e1a8cb01
Author: Peter Crosthwaite <peter.crosthwaite@xilinx.com>
Date:   Tue Apr 16 10:24:39 2013 +1000

    petalogix_ml605_mmu: Attach ethernet to machine
    
    Explicitly make the ethernet a child of the machine. This is needed to set
    and use links pre-realize. Also makes the ethernet initialization consistent
    with its peer DMA.
    
    Signed-off-by: Peter Crosthwaite <peter.crosthwaite@xilinx.com>
    Reviewed-by: Andreas FÃ¤rber <afaerber@suse.de>
    Acked-by: Edgar E. Iglesias <edgar.iglesias@xilinx.com>
    Signed-off-by: Edgar E. Iglesias <edgar.iglesias@gmail.com>

diff --git a/hw/microblaze/petalogix_ml605_mmu.c b/hw/microblaze/petalogix_ml605_mmu.c
index 70e7886c37..a5e9b358a5 100644
--- a/hw/microblaze/petalogix_ml605_mmu.c
+++ b/hw/microblaze/petalogix_ml605_mmu.c
@@ -134,6 +134,8 @@ petalogix_ml605_init(QEMUMachineInitArgs *args)
     dma = qdev_create(NULL, "xlnx.axi-dma");
 
     /* FIXME: attach to the sysbus instead */
+    object_property_add_child(qdev_get_machine(), "xilinx-eth", OBJECT(eth0),
+                              NULL);
     object_property_add_child(qdev_get_machine(), "xilinx-dma", OBJECT(dma),
                               NULL);
 

