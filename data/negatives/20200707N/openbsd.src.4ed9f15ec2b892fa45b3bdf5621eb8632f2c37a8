commit 4ed9f15ec2b892fa45b3bdf5621eb8632f2c37a8
Author: dhartmei <dhartmei@openbsd.org>
Date:   Wed Oct 24 09:07:38 2001 +0000

    Reset states counter when clearing states.

diff --git a/sys/net/pf.c b/sys/net/pf.c
index 84e0d8ec9ce..38388fbbb14 100644
--- a/sys/net/pf.c
+++ b/sys/net/pf.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: pf.c,v 1.163 2001/10/15 16:22:21 dhartmei Exp $ */
+/*	$OpenBSD: pf.c,v 1.164 2001/10/24 09:07:38 dhartmei Exp $ */
 
 /*
  * Copyright (c) 2001 Daniel Hartmeier
@@ -1885,6 +1885,7 @@ pfioctl(dev_t dev, u_long cmd, caddr_t addr, int flags, struct proc *p)
 		    n = pf_tree_next(n))
 			n->state->expire = 0;
 		pf_purge_expired_states();
+		pf_status.states = 0;
 		splx(s);
 		break;
 	}

