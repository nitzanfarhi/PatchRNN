commit 17ad7b24c890a9816bd3e7b737c44ba7505aea67
Author: Baptiste Coudurier <baptiste.coudurier@gmail.com>
Date:   Wed Apr 8 03:38:59 2009 +0000

    force sample for qcelp when not stored in mov, fix #968
    
    Originally committed as revision 18374 to svn://svn.ffmpeg.org/ffmpeg/trunk

diff --git a/libavformat/mov.c b/libavformat/mov.c
index 188b43c67..7317f5411 100644
--- a/libavformat/mov.c
+++ b/libavformat/mov.c
@@ -1034,6 +1034,9 @@ static int mov_read_stsd(MOVContext *c, ByteIOContext *pb, MOVAtom atom)
 #endif
     /* no ifdef since parameters are always those */
     case CODEC_ID_QCELP:
+        // force sample rate for qcelp when not stored in mov
+        if (st->codec->codec_tag != MKTAG('Q','c','l','p'))
+            st->codec->sample_rate = 8000;
         st->codec->frame_size= 160;
         st->codec->channels= 1; /* really needed */
         break;

