commit fe65e704534de5d0661ebc3466a2b9018945f694
Author: Gabriel Paubert <paubert@iram.es>
Date:   Mon Jan 19 17:18:09 2009 -0800

    mv643xx_eth: prevent interrupt storm on ifconfig down
    
    Contrary to what the docs say, the 'extended interrupt cause' bit in
    the interrupt cause register (bit 1) appears to not be maskable on at
    least some of the mv643xx_eth platforms, making writing zeroes to the
    interrupt mask register but not the extended interrupt mask register
    insufficient to stop interrupts from occuring.  Therefore, also write
    zeroes to the extended interrupt mask register when shutting down the
    port.
    
    This fixes the interrupt storm seen on the Pegasos board when shutting
    down the interface.
    
    Signed-off-by: Lennert Buytenhek <buytenh@marvell.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/drivers/net/mv643xx_eth.c b/drivers/net/mv643xx_eth.c
index 8c6979a26d61..5f31bbb614af 100644
--- a/drivers/net/mv643xx_eth.c
+++ b/drivers/net/mv643xx_eth.c
@@ -2212,6 +2212,7 @@ static int mv643xx_eth_stop(struct net_device *dev)
 	struct mv643xx_eth_private *mp = netdev_priv(dev);
 	int i;
 
+	wrlp(mp, INT_MASK_EXT, 0x00000000);
 	wrlp(mp, INT_MASK, 0x00000000);
 	rdlp(mp, INT_MASK);
 

