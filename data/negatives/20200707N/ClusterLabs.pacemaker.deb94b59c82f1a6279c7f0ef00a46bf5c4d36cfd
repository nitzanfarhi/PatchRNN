commit deb94b59c82f1a6279c7f0ef00a46bf5c4d36cfd
Author: Jan Pokorn√Ω <jpokorny@redhat.com>
Date:   Wed Aug 17 16:53:31 2016 +0200

    Med: schemas.c: avoid downgrade validate-with in a corner case
    
    When update_validation is called with CIB without validate-with
    attribute or with its value made up, and there's no validation
    success, the result would previously be a CIB with validate-with
    set to pacemaker-0.6, which would hardly help anything.

diff --git a/lib/common/schemas.c b/lib/common/schemas.c
index e094e8b8d..e8494e9e0 100644
--- a/lib/common/schemas.c
+++ b/lib/common/schemas.c
@@ -837,7 +837,7 @@ update_validation(xmlNode **xml_blob, int *best, int max, gboolean transform,
         }
     }
 
-    if (*best > match) {
+    if (*best > match && *best) {
         crm_info("%s the configuration from %s to %s",
                    transform?"Transformed":"Upgraded",
                    value ? value : "<none>", known_schemas[*best].name);

