commit 824906a5416baed3842cb19bc24f4cb672c96ca8
Author: Michael Niedermayer <michael@niedermayer.cc>
Date:   Wed May 4 21:31:18 2016 +0200

    avformat/utils: Do not detect video codecs when audio is expected
    
    Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>

diff --git a/libavformat/utils.c b/libavformat/utils.c
index 72396af97f..52395d4592 100644
--- a/libavformat/utils.c
+++ b/libavformat/utils.c
@@ -315,6 +315,9 @@ static int set_codec_from_probe_data(AVFormatContext *s, AVStream *st,
                fmt->name, score);
         for (i = 0; fmt_id_type[i].name; i++) {
             if (!strcmp(fmt->name, fmt_id_type[i].name)) {
+                if (fmt_id_type[i].type != AVMEDIA_TYPE_AUDIO &&
+                    st->codecpar->sample_rate)
+                    continue;
                 st->codecpar->codec_id   = fmt_id_type[i].id;
                 st->codecpar->codec_type = fmt_id_type[i].type;
                 st->internal->need_context_update = 1;

