commit 3f5a2a713aad28480d86b0add00c68484b54febc
Author: Luca Tettamanti <kronos.it@gmail.com>
Date:   Wed Sep 22 10:42:31 2010 +0000

    atl1: zero out CMB and SBM in atl1_free_ring_resources
    
    They are allocated in atl1_setup_ring_resources, zero out the pointers
    in atl1_free_ring_resources (like the other resources).
    
    Signed-off-by: Luca Tettamanti <kronos.it@gmail.com>
    Acked-by: Chris Snook <chris.snook@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/drivers/net/atlx/atl1.c b/drivers/net/atlx/atl1.c
index bbd6e3009be0..c73be2848319 100644
--- a/drivers/net/atlx/atl1.c
+++ b/drivers/net/atlx/atl1.c
@@ -1251,6 +1251,12 @@ static void atl1_free_ring_resources(struct atl1_adapter *adapter)
 
 	rrd_ring->desc = NULL;
 	rrd_ring->dma = 0;
+
+	adapter->cmb.dma = 0;
+	adapter->cmb.cmb = NULL;
+
+	adapter->smb.dma = 0;
+	adapter->smb.smb = NULL;
 }
 
 static void atl1_setup_mac_ctrl(struct atl1_adapter *adapter)

