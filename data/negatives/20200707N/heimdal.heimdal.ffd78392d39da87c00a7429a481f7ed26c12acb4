commit ffd78392d39da87c00a7429a481f7ed26c12acb4
Author: Love Hörnquist Åstrand <lha@kth.se>
Date:   Sun Jul 27 12:09:39 2008 +0000

    close-on-exec
    
    git-svn-id: svn://svn.h5l.se/heimdal/trunk/heimdal@23449 ec53bebd-3082-4978-b11e-865c3cabbd6b

diff --git a/lib/krb5/kuserok.c b/lib/krb5/kuserok.c
index 5db6cb344..9467ed95b 100644
--- a/lib/krb5/kuserok.c
+++ b/lib/krb5/kuserok.c
@@ -56,6 +56,7 @@ check_one_file(krb5_context context,
     f = fopen (filename, "r");
     if (f == NULL)
 	return errno;
+    rk_cloexec_file(f);
     
     /* check type and mode of file */
     if (fstat(fileno(f), &st) != 0) {

