commit 166fae499b8c2c347337a348f0a38d1d0a0b4a7c
Author: pk34663 <none@none>
Date:   Tue Nov 7 01:17:17 2006 -0800

    6489339 snoop segv's whilst decoding LDAP traffic

diff --git a/usr/src/cmd/cmd-inet/usr.sbin/snoop/snoop_ldap.c b/usr/src/cmd/cmd-inet/usr.sbin/snoop/snoop_ldap.c
index da5d9c61eb..2877ad75c6 100644
--- a/usr/src/cmd/cmd-inet/usr.sbin/snoop/snoop_ldap.c
+++ b/usr/src/cmd/cmd-inet/usr.sbin/snoop/snoop_ldap.c
@@ -2,9 +2,8 @@
  * CDDL HEADER START
  *
  * The contents of this file are subject to the terms of the
- * Common Development and Distribution License, Version 1.0 only
- * (the "License").  You may not use this file except in compliance
- * with the License.
+ * Common Development and Distribution License (the "License").
+ * You may not use this file except in compliance with the License.
  *
  * You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
  * or http://www.opensolaris.org/os/licensing.
@@ -19,8 +18,9 @@
  *
  * CDDL HEADER END
  */
+
 /*
- * Copyright 2005 Sun Microsystems, Inc.  All rights reserved.
+ * Copyright 2006 Sun Microsystems, Inc.  All rights reserved.
  * Use is subject to license terms.
  */
 
@@ -843,7 +843,7 @@ decpdu(int pdulen, asndefTp ASNDESC, int ctxnum)
 	int		stlv;	/* sub-tlv length */
 	int		oix;	/* oid table index */
 	int		effnb;	/* effectively traced octet nb */
-	int		i, j;
+	int		i = 0, j = 0;
 	int		ai = -2;
 	asndefTp SASNDESC = 0;
 	asndefTp TMPDESC = 0;

