commit 787d0ca1021ec049d1f928991624a58130ca324c
Author: root <devnull@localhost>
Date:   Thu Feb 22 20:01:56 1996 +0000

    require ':' after preamble parts
    warn user about unknown premable parts "Fields"
    sanity check for internal error
    
    CVS patchset: 402
    CVS date: 1996/02/22 20:01:56

diff --git a/build/spec.c b/build/spec.c
index 3415ef4ff..9c378ef96 100644
--- a/build/spec.c
+++ b/build/spec.c
@@ -468,8 +468,12 @@ static int find_preamble_line(char *line, char **s)
     while (p->token && strncasecmp(line, p->token, p->len)) {
         p++;
     }
-    if (!p) return 0;
+    if (!p->token) return 0;
     *s = line + p->len;
+    *s += strspn(*s, " \t");
+    if (**s != ':') {
+	return 0;
+    }
     *s += strspn(*s, ": \t");
     return p->tag;
 }
@@ -783,11 +787,18 @@ Spec parseSpec(FILE *f, char *specfile)
 		      }
 		      break;
 		  default:
-		    message(MESS_DEBUG, "Skipping: %s\n", line);
+		      /* message(MESS_DEBUG, "Skipping: %s\n", line); */
+		      /* This shouldn't happen? */
+		      error(RPMERR_INTERNAL, "Bogus token");
+		      return NULL;
 		}		
 	    } else {
 	        /* Not a recognized preamble part */
-	        message(MESS_DEBUG, "Unknown Field: %s\n", line);
+		s1 = line;
+		while (*s1 && *s1 != ' ' && *s1 != '\t') s1++;
+		if (*s1) {
+		    message(MESS_WARNING, "Unknown Field: %s\n", line);
+		}
 	    }
 	    break;
 	  case PREP_PART:

