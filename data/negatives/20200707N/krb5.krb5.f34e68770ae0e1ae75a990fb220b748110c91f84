commit f34e68770ae0e1ae75a990fb220b748110c91f84
Author: Tom Yu <tlyu@mit.edu>
Date:   Fri Dec 22 01:19:55 2006 +0000

            * src/lib/krb5/krb/get_in_tkt.c (krb5_get_init_creds): Fix
            ordering bug in previous patch.
    
    ticket: 5123
    
    git-svn-id: svn://anonsvn.mit.edu/krb5/trunk@19007 dc483132-0cff-0310-8789-dd5450dbe970

diff --git a/src/lib/krb5/krb/get_in_tkt.c b/src/lib/krb5/krb/get_in_tkt.c
index 8470724ea..12476d3fa 100644
--- a/src/lib/krb5/krb/get_in_tkt.c
+++ b/src/lib/krb5/krb/get_in_tkt.c
@@ -1134,13 +1134,14 @@ krb5_get_init_creds(krb5_context context,
 		/* No preauth supplied, so can't query the plug-ins. */
 		ret = KRB5KRB_ERR_GENERIC;
 	    }
-	    krb5_free_error(context, err_reply);
-	    err_reply = NULL;
 	    if (ret) {
 		/* couldn't come up with anything better */
 		ret = err_reply->error + ERROR_TABLE_BASE_krb5;
-		goto cleanup;
 	    }
+	    krb5_free_error(context, err_reply);
+	    err_reply = NULL;
+	    if (ret)
+		goto cleanup;
 	}
 
         if (encoded_previous_request != NULL) {

