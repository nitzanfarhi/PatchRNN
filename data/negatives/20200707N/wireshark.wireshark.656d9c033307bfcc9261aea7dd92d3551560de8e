commit 656d9c033307bfcc9261aea7dd92d3551560de8e
Author: Guy Harris <guy@alum.mit.edu>
Date:   Thu Nov 6 09:13:26 2003 +0000

    Update a comment.
    
    Catch another case where we need to check for a null decrypted_tvb.
    
    svn path=/trunk/; revision=8894

diff --git a/packet-dcerpc.c b/packet-dcerpc.c
index fc280ec789..ff1e4e94f3 100644
--- a/packet-dcerpc.c
+++ b/packet-dcerpc.c
@@ -3,7 +3,7 @@
  * Copyright 2001, Todd Sabin <tas@webspan.net>
  * Copyright 2003, Tim Potter <tpot@samba.org>
  *
- * $Id: packet-dcerpc.c,v 1.151 2003/11/06 07:44:13 sahlberg Exp $
+ * $Id: packet-dcerpc.c,v 1.152 2003/11/06 09:13:26 guy Exp $
  *
  * Ethereal - Network traffic analyzer
  * By Gerald Combs <gerald@ethereal.com>
@@ -1935,7 +1935,7 @@ dcerpc_try_handoff (packet_info *pinfo, proto_tree *tree,
             pinfo->current_proto = saved_proto;
             pinfo->private_data = saved_private_data;
         } else {
-            /* No subdissector - show it as *decrypted* stub data. */
+            /* No subdissector - show it as stub data. */
             if(decrypted_tvb){
                show_stub_data (decrypted_tvb, 0, tree, auth_info, FALSE);
             } else {
@@ -2576,6 +2576,12 @@ dissect_dcerpc_cn_stub (tvbuff_t *tvb, int offset, packet_info *pinfo,
        thus we must reassemble it.
     */
 
+    /* Do we have any non-encrypted data to reassemble? */
+    if (decrypted_tvb == NULL) {
+      /* No.  We can't even try to reassemble.  */
+      goto end_cn_stub;
+    }
+
     /* if this is the first fragment we need to start reassembly
     */
     if(hdr->flags&PFC_FIRST_FRAG){

