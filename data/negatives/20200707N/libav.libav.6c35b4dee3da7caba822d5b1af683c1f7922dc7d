commit 6c35b4dee3da7caba822d5b1af683c1f7922dc7d
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Sun Jun 25 21:22:25 2006 +0000

    10l
    
    Originally committed as revision 5527 to svn://svn.ffmpeg.org/ffmpeg/trunk

diff --git a/libavcodec/flacenc.c b/libavcodec/flacenc.c
index d88b11d4c..29d3ce1fd 100644
--- a/libavcodec/flacenc.c
+++ b/libavcodec/flacenc.c
@@ -331,7 +331,7 @@ write_utf8(PutBitContext *pb, uint32_t val)
         return;
     }
 
-    bytes= (av_log2(val)-1) / 5;
+    bytes= (av_log2(val)+4) / 5;
     shift = (bytes - 1) * 6;
     put_bits(pb, 8, (256 - (256>>bytes)) | (val >> shift));
     while(shift >= 6){

