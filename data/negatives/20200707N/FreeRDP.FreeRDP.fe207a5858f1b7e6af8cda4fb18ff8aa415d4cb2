commit fe207a5858f1b7e6af8cda4fb18ff8aa415d4cb2
Author: Anthony Tong <atong@trustedcs.com>
Date:   Fri Sep 2 11:08:50 2011 -0400

    Revert "The previous malloc fix was too large."
    
    This reverts commit 82e62778bc28dacc4b860c94e7bdceac8512b7fe.

diff --git a/libfreerdp-core/orders.c b/libfreerdp-core/orders.c
index ef124f5da..573782490 100644
--- a/libfreerdp-core/orders.c
+++ b/libfreerdp-core/orders.c
@@ -751,11 +751,11 @@ void update_read_polyline_order(STREAM* s, ORDER_INFO* orderInfo, POLYLINE_ORDER
 	if (orderInfo->fieldFlags & ORDER_FIELD_07)
 	{
 		stream_read_uint8(s, polyline->cbData);
-fprintf(stderr, "TONG %d %d %d\n", sizeof(DELTA_POINT*), polyline->cbData, polyline->numPoints);
+
 		if (polyline->points == NULL)
-			polyline->points = (DELTA_POINT*) xmalloc(sizeof(DELTA_POINT) * polyline->numPoints);
+			polyline->points = (DELTA_POINT*) xmalloc(sizeof(DELTA_POINT) * polyline->cbData);
 		else
-			polyline->points = (DELTA_POINT*) xrealloc(polyline->points, sizeof(DELTA_POINT) * polyline->numPoints);
+			polyline->points = (DELTA_POINT*) xrealloc(polyline->points, sizeof(DELTA_POINT) * polyline->cbData);
 
 		update_read_delta_points(s, polyline->points, polyline->numPoints, polyline->xStart, polyline->yStart);
 	}

