commit 0f23174c5c21f90929b3ee39fee48b774949510d
Author: Lennart Poettering <lennart@poettering.net>
Date:   Thu Jan 7 12:47:07 2016 +0100

    resolved: use dns_answer_size() where appropriate to handle NULL DnsAnswer

diff --git a/src/resolve/resolved-dns-dnssec.c b/src/resolve/resolved-dns-dnssec.c
index f2b4bebce..e71939d99 100644
--- a/src/resolve/resolved-dns-dnssec.c
+++ b/src/resolve/resolved-dns-dnssec.c
@@ -542,7 +542,7 @@ int dnssec_verify_rrset(
         }
 
         /* Collect all relevant RRs in a single array, so that we can look at the RRset */
-        list = newa(DnsResourceRecord *, a->n_rrs);
+        list = newa(DnsResourceRecord *, dns_answer_size(a));
 
         DNS_ANSWER_FOREACH(rr, a) {
                 r = dns_resource_key_equal(key, rr->key);

