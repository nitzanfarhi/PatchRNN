commit af8020e7fd6e85672ce41698469f4bacf1f424c2
Author: Tomoyuki Sahara <tsahara@iij.ad.jp>
Date:   Thu Jun 14 13:52:37 2018 +0900

    sa_family_t is not defined on windows.

diff --git a/mrbgems/mruby-socket/src/socket.c b/mrbgems/mruby-socket/src/socket.c
index 951bece7..89c31c76 100644
--- a/mrbgems/mruby-socket/src/socket.c
+++ b/mrbgems/mruby-socket/src/socket.c
@@ -681,7 +681,7 @@ mrb_socket_sockaddr_family(mrb_state *mrb, mrb_value klass)
   mrb_value str;
 
   mrb_get_args(mrb, "S", &str);
-  if ((size_t)RSTRING_LEN(str) < offsetof(struct sockaddr, sa_family) + sizeof(sa_family_t)) {
+  if ((size_t)RSTRING_LEN(str) < offsetof(struct sockaddr, sa_family) + sizeof(sa->sa_family)) {
     mrb_raisef(mrb, E_SOCKET_ERROR, "invalid sockaddr (too short)");
   }
   sa = (const struct sockaddr *)RSTRING_PTR(str);

