commit 98ec464f0cfbf45bfd204725665f527533b82ff3
Author: Guy Harris <guy@alum.mit.edu>
Date:   Thu Dec 8 09:07:13 2016 +0000

    Revert "Revert "Don't use a local variable's address in set_address().""
    
    This reverts commit 92a2c184b09ce41a1ab717963750bb5543099742.
    
    Actually, that address *is* attached to a pinfo structure.
    
    Change-Id: I183135f9cf10a6714045091d2ae02d2799093bae
    Reviewed-on: https://code.wireshark.org/review/19143
    Reviewed-by: Guy Harris <guy@alum.mit.edu>

diff --git a/epan/dissectors/packet-infiniband.c b/epan/dissectors/packet-infiniband.c
index 424b196b16..ad501244f3 100644
--- a/epan/dissectors/packet-infiniband.c
+++ b/epan/dissectors/packet-infiniband.c
@@ -3005,7 +3005,7 @@ create_conv_and_add_proto_data(packet_info *pinfo, guint64 service_id,
     conversation_add_proto_data(conv, proto_infiniband, proto_data);
 
     /* next, register the conversation using the LIDs */
-    set_address(addr, AT_IB, sizeof(guint16), &lid);
+    set_address(addr, AT_IB, sizeof(guint16), wmem_memdup(pinfo->pool, &lid, sizeof lid));
     conv = conversation_new(pinfo->num, addr, addr,
                             PT_IBQP, port, port, options);
     conversation_add_proto_data(conv, proto_infiniband, proto_data);

