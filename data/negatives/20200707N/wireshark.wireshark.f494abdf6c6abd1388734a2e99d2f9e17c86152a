commit f494abdf6c6abd1388734a2e99d2f9e17c86152a
Author: Evan Huus <eapache@gmail.com>
Date:   Sat Feb 7 22:03:38 2015 -0500

    qnet6: don't calculate crc if length is negative
    
    Bug: 10941
    Change-Id: I8c844487fa8ed1fb93ad9f69315fe1559238c845
    Reviewed-on: https://code.wireshark.org/review/7018
    Reviewed-by: Evan Huus <eapache@gmail.com>

diff --git a/epan/dissectors/packet-qnet6.c b/epan/dissectors/packet-qnet6.c
index 6059fa85de..7e87c1dcb6 100644
--- a/epan/dissectors/packet-qnet6.c
+++ b/epan/dissectors/packet-qnet6.c
@@ -4163,7 +4163,7 @@ dissect_qnet6(tvbuff_t * tvb, packet_info * pinfo, proto_tree * tree, void * dat
       /*
        * data after header
        */
-      if (cklen != 0)
+      if (cklen > 0)
         {
           crc = crc32_mpeg2_seed(tvb_get_ptr(tvb, 36 + 2, cklen), cklen, ~crc);
           crc = ~crc;

