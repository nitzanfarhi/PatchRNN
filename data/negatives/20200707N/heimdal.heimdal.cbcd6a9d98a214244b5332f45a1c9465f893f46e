commit cbcd6a9d98a214244b5332f45a1c9465f893f46e
Author: Johan Danielsson <joda@pdc.kth.se>
Date:   Thu Dec 2 14:49:20 1999 +0000

    (process_msg): check for short reads
    
    
    git-svn-id: svn://svn.h5l.se/heimdal/trunk/heimdal@7460 ec53bebd-3082-4978-b11e-865c3cabbd6b

diff --git a/lib/kadm5/ipropd_master.c b/lib/kadm5/ipropd_master.c
index c96633287..a825deb1e 100644
--- a/lib/kadm5/ipropd_master.c
+++ b/lib/kadm5/ipropd_master.c
@@ -271,6 +271,11 @@ process_msg (krb5_context context, slave *s, int log_fd,
     if (ret)
 	return 1;
 
+    if(in->length == 0) {
+	krb5_warnx(context, "process_msg: short message");
+	return 1;
+    }
+
     ret = krb5_rd_priv (context, s->ac, &in, &out, NULL);
     krb5_data_free (&in);
     if (ret) {

