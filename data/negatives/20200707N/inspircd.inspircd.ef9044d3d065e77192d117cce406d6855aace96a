commit ef9044d3d065e77192d117cce406d6855aace96a
Author: frostycoolslug <frostycoolslug@e03df62e-2008-0410-955e-edbf42e46eb7>
Date:   Mon Apr 5 23:27:16 2004 +0000

    Fixed Small bug in PASS command
    
    
    git-svn-id: http://svn.inspircd.org/repository/trunk/inspircd@396 e03df62e-2008-0410-955e-edbf42e46eb7

diff --git a/src/inspircd.cpp b/src/inspircd.cpp
index 77a24b568..36dd5963e 100644
--- a/src/inspircd.cpp
+++ b/src/inspircd.cpp
@@ -3260,6 +3260,12 @@ bool IsDenied(userrec *user)
 
 void handle_pass(char **parameters, int pcnt, userrec *user)
 {
+	// Check to make sure they havnt registered -- Fix by FCS
+	if (user->registered == 7)
+	{
+		WriteServ(user->fd,"462 %s :You may not reregister",user->nick);
+		return;
+	}
 	if (!strcasecmp(parameters[0],Passwd(user)))
 	{
 		user->haspassed = true;

