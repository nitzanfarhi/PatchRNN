commit 7635b03adf3d7b84da7649b81efa91e6ebf11b85
Author: Li Zefan <lizf@cn.fujitsu.com>
Date:   Fri Apr 3 15:31:34 2009 +0800

    blktrace: small cleanup in blk_msg_write()
    
    Signed-off-by: Li Zefan <lizf@cn.fujitsu.com>
    Cc: Arnaldo Carvalho de Melo <acme@redhat.com>
    Cc: "Alan D. Brunelle" <alan.brunelle@hp.com>
    Cc: Jens Axboe <jens.axboe@oracle.com>
    LKML-Reference: <49D5BB56.7000807@cn.fujitsu.com>
    Signed-off-by: Ingo Molnar <mingo@elte.hu>

diff --git a/kernel/trace/blktrace.c b/kernel/trace/blktrace.c
index a400b861fad3..73d7860b72e2 100644
--- a/kernel/trace/blktrace.c
+++ b/kernel/trace/blktrace.c
@@ -327,7 +327,7 @@ static ssize_t blk_msg_write(struct file *filp, const char __user *buffer,
 	char *msg;
 	struct blk_trace *bt;
 
-	if (count > BLK_TN_MAX_MSG - 1)
+	if (count >= BLK_TN_MAX_MSG)
 		return -EINVAL;
 
 	msg = kmalloc(count + 1, GFP_KERNEL);

