commit 594c3808d44936432baa4a3ea98bf996e43efba0
Author: Ilia Alshanetsky <iliaa@php.net>
Date:   Thu Dec 19 17:06:36 2002 +0000

    Fixed bug #21098.

diff --git a/ext/standard/datetime.c b/ext/standard/datetime.c
index 1d0d6f1e75..c4c4dd763f 100644
--- a/ext/standard/datetime.c
+++ b/ext/standard/datetime.c
@@ -196,7 +196,7 @@ void php_mktime(INTERNAL_FUNCTION_PARAMETERS, int gm)
 	t = mktime(ta); 
 
 #ifdef PHP_WIN32
-	if (t < 0) {
+	if (t - chgsecs < 0) {
 		php_error_docref(NULL TSRMLS_CC, E_WARNING, "Windows does not support negative values for this function");
 		RETURN_LONG(-1);
 	}

