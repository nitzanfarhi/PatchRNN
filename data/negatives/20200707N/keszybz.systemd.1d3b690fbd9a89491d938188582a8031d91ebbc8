commit 1d3b690fbd9a89491d938188582a8031d91ebbc8
Author: Lennart Poettering <lennart@poettering.net>
Date:   Wed Jul 30 02:04:07 2014 +0200

    resolved: don't allow adding of ANY class/type RRs to local zones

diff --git a/src/resolve/resolved-dns-zone.c b/src/resolve/resolved-dns-zone.c
index 2325ddfe7..12a8512c7 100644
--- a/src/resolve/resolved-dns-zone.c
+++ b/src/resolve/resolved-dns-zone.c
@@ -165,6 +165,11 @@ int dns_zone_put(DnsZone *z, DnsResourceRecord *rr) {
         assert(z);
         assert(rr);
 
+        if (rr->key->class == DNS_CLASS_ANY)
+                return -EINVAL;
+        if (rr->key->type == DNS_TYPE_ANY)
+                return -EINVAL;
+
         existing = dns_zone_get(z, rr);
         if (existing)
                 return 0;

