commit 9ae1fb3e0d9fe4e34ee18986b118e02e6247e3d6
Author: Johan Danielsson <joda@pdc.kth.se>
Date:   Thu Apr 1 17:02:55 1999 +0000

    (encrypt_internal): free checksum
    
    
    git-svn-id: svn://svn.h5l.se/heimdal/trunk/heimdal@5829 ec53bebd-3082-4978-b11e-865c3cabbd6b

diff --git a/lib/krb5/crypto.c b/lib/krb5/crypto.c
index a884c9424..9803b883c 100644
--- a/lib/krb5/crypto.c
+++ b/lib/krb5/crypto.c
@@ -1655,9 +1655,11 @@ encrypt_internal(krb5_context context,
     if(ret) {
 	memset(p, 0, block_sz);
 	free(p);
+	free_Checksum(&cksum);
 	return ret;
     }
     memcpy(p + et->confoundersize, cksum.checksum.data, cksum.checksum.length);
+    free_Checksum(&cksum);
     ret = _key_schedule(context, &crypto->key);
     if(ret) {
 	memset(p, 0, block_sz);

