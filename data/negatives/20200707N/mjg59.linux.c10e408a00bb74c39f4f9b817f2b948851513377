commit c10e408a00bb74c39f4f9b817f2b948851513377
Author: Mathias Fr√∂hlich <Mathias.Froehlich@web.de>
Date:   Thu Mar 1 06:44:35 2012 +0100

    i915: Add option to bypass vbt table.
    
    This change enables the use of displays where the vbt table just
    contains inappropriate values, but either the vesa defaults or
    the video=... modes do something sensible with the attached display.
    
    The problem happens with an embedded board that contains vbt bios
    tables that do not match the attached display.  Using this change and
    the appropriate kernel boot command line they are able to use an
    otherwise completely unusable secondary display on that embedded
    board.
    
    Reviewed-by: Paul Menzel <paulepanter@users.sourceforge.net>
    Signed-off-by: Mathias Froehlich <Mathias.Froehlich@web.de>
    Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>

diff --git a/drivers/gpu/drm/i915/i915_drv.c b/drivers/gpu/drm/i915/i915_drv.c
index 0694e170a338..0e797d3cb5f4 100644
--- a/drivers/gpu/drm/i915/i915_drv.c
+++ b/drivers/gpu/drm/i915/i915_drv.c
@@ -89,8 +89,8 @@ MODULE_PARM_DESC(lvds_use_ssc,
 int i915_vbt_sdvo_panel_type __read_mostly = -1;
 module_param_named(vbt_sdvo_panel_type, i915_vbt_sdvo_panel_type, int, 0600);
 MODULE_PARM_DESC(vbt_sdvo_panel_type,
-		"Override selection of SDVO panel mode in the VBT "
-		"(default: auto)");
+		"Override/Ignore selection of SDVO panel mode in the VBT "
+		"(-2=ignore, -1=auto [default], index in VBT BIOS table)");
 
 static bool i915_try_reset __read_mostly = true;
 module_param_named(reset, i915_try_reset, bool, 0600);
diff --git a/drivers/gpu/drm/i915/intel_bios.c b/drivers/gpu/drm/i915/intel_bios.c
index 8168d8f8a634..0ae76d6b6eab 100644
--- a/drivers/gpu/drm/i915/intel_bios.c
+++ b/drivers/gpu/drm/i915/intel_bios.c
@@ -255,6 +255,11 @@ parse_sdvo_panel_data(struct drm_i915_private *dev_priv,
 	int index;
 
 	index = i915_vbt_sdvo_panel_type;
+	if (index == -2) {
+		DRM_DEBUG_KMS("Ignore SDVO panel mode from BIOS VBT tables.\n");
+		return;
+	}
+
 	if (index == -1) {
 		struct bdb_sdvo_lvds_options *sdvo_lvds_options;
 

