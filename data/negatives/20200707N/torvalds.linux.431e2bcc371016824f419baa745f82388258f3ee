commit 431e2bcc371016824f419baa745f82388258f3ee
Author: Thomas Gleixner <tglx@linutronix.de>
Date:   Tue Jul 26 16:08:19 2011 -0700

    rtc: limit frequency
    
    Due to the hrtimer self rearming mode a user can DoS the machine simply
    because it's starved by hrtimer events.
    
    The RTC hrtimer is self rearming.  We really need to limit the frequency
    to something sensible.
    
    Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
    Cc: John Stultz <john.stultz@linaro.org>
    Cc: Ingo Molnar <mingo@elte.hu>
    Cc: Ben Greear <greearb@candelatech.com>
    Cc: <stable@kernel.org>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

diff --git a/drivers/rtc/interface.c b/drivers/rtc/interface.c
index b6bf57f25cc9..601b053bc0e5 100644
--- a/drivers/rtc/interface.c
+++ b/drivers/rtc/interface.c
@@ -688,7 +688,7 @@ int rtc_irq_set_freq(struct rtc_device *rtc, struct rtc_task *task, int freq)
 	int err = 0;
 	unsigned long flags;
 
-	if (freq <= 0)
+	if (freq <= 0 || freq > 5000)
 		return -EINVAL;
 
 	spin_lock_irqsave(&rtc->irq_task_lock, flags);

