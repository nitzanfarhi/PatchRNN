commit 6532cb71fb31436b8d31818a056f45b8f95dfb31
Author: Marek Belisko <marek.belisko@gmail.com>
Date:   Fri May 3 07:53:23 2013 +0200

    clk: si5351: Set initial clkout rate when defined in platform data.
    
    clock-frequency property from platform data was read but never used.
    Apply defined rate when clock is registered.
    
    Signed-off-by: Marek Belisko <marek.belisko@streamunlimited.com>
    Acked-by: Sebastian Hesselbarth <sebastian.hesselbarth@gmail.com>
    Signed-off-by: Mike Turquette <mturquette@linaro.org>
    [mturquette@linaro.org: add missing changelog]
    Cc: stable@kernel.org
    
    Signed-off-by: Mike Turquette <mturquette@linaro.org>

diff --git a/drivers/clk/clk-si5351.c b/drivers/clk/clk-si5351.c
index cf39e530e6e2..24f553673b72 100644
--- a/drivers/clk/clk-si5351.c
+++ b/drivers/clk/clk-si5351.c
@@ -1477,6 +1477,16 @@ static int si5351_i2c_probe(struct i2c_client *client,
 			return -EINVAL;
 		}
 		drvdata->onecell.clks[n] = clk;
+
+		/* set initial clkout rate */
+		if (pdata->clkout[n].rate != 0) {
+			int ret;
+			ret = clk_set_rate(clk, pdata->clkout[n].rate);
+			if (ret != 0) {
+				dev_err(&client->dev, "Cannot set rate : %d\n",
+					ret);
+			}
+		}
 	}
 
 	ret = of_clk_add_provider(client->dev.of_node, of_clk_src_onecell_get,

