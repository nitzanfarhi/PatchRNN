commit b8102d8f6150b0438ba91cd53ff86a5391e8bdcf
Author: Panu Matilainen <pmatilai@redhat.com>
Date:   Tue Jul 14 11:24:02 2009 +0300

    Dont accept '-' in manifests (RhBug:461353)

diff --git a/lib/manifest.c b/lib/manifest.c
index 91f2f6703..06405c952 100644
--- a/lib/manifest.c
+++ b/lib/manifest.c
@@ -94,8 +94,8 @@ rpmRC rpmReadPackageManifest(FD_t fd, int * argcPtr, char *** argvPtr)
 	    s++;
 	if (*s == '\0') continue;
 
-	/* Insure that file contains only ASCII */
-	if (*s < 32) {
+	/* Sanity checks: skip obviously binary lines and dash (for stdin) */
+	if (*s < 32 || strcmp(s, "-") == 0) {
 	    rpmrc = RPMRC_NOTFOUND;
 	    goto exit;
 	}

