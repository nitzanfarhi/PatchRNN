commit c3c8f1ea549710411c9a5d5cea0fc00d0af37998
Author: Aaron Turner <synfinatic@gmail.com>
Date:   Sat Nov 9 06:15:16 2002 +0000

    fix segfault when in cache mode and we shouldn't send the packet

diff --git a/do_packets.c b/do_packets.c
index 57387b89..64a33e9b 100644
--- a/do_packets.c
+++ b/do_packets.c
@@ -151,6 +151,10 @@ do_packets(int fd, int (*get_next)(int, struct packet *))
 			}
 		}
 
+		/* sometimes we should not send the packet */
+		if (l == CACHE_NOSEND)
+			continue;
+
 		/* Untruncate packet? Only for IP packets */
 		if (options.trunc) {
 #if USE_LIBNET_VERSION == 10

