commit 410efda80b101d427aafcc151b44c8cf0197461d
Author: Vicent Marti <tanoku@gmail.com>
Date:   Wed Oct 28 10:28:43 2015 +0100

    pool: Take into account malloc overhead & pool page size

diff --git a/src/pool.c b/src/pool.c
index 78277eb40..fe6c42987 100644
--- a/src/pool.c
+++ b/src/pool.c
@@ -21,7 +21,8 @@ uint32_t git_pool__system_page_size(void)
 		size_t page_size;
 		if (git__page_size(&page_size) < 0)
 			page_size = 4096;
-		size = page_size - 2 * sizeof(void *); /* allow space for malloc overhead */
+		/* allow space for malloc overhead */
+		size = page_size - (2 * sizeof(void *)) - sizeof(git_pool_page);
 	}
 
 	return size;

