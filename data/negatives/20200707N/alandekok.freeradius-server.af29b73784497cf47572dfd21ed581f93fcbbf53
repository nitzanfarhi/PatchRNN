commit af29b73784497cf47572dfd21ed581f93fcbbf53
Author: kkalev <kkalev>
Date:   Sun Dec 14 00:18:48 2003 +0000

    A minor patch to return if pairmake() fails by James Nedila

diff --git a/src/modules/rlm_attr_rewrite/rlm_attr_rewrite.c b/src/modules/rlm_attr_rewrite/rlm_attr_rewrite.c
index bb35a5ff7..6c22e1d47 100644
--- a/src/modules/rlm_attr_rewrite/rlm_attr_rewrite.c
+++ b/src/modules/rlm_attr_rewrite/rlm_attr_rewrite.c
@@ -337,6 +337,11 @@ to_do_again:
 	}
 	else{
 		attr_vp = pairmake(data->attribute,replace_STR,0);
+		if (attr_vp == NULL){
+			DEBUG2("rlm_attr_rewrite: Could not add new attribute %s with value '%s'",
+				data->attribute,replace_STR);
+			return ret;
+		}
 		switch(data->searchin){
 			case RLM_REGEX_INPACKET:
 				pairadd(&request->packet->vps,attr_vp);

