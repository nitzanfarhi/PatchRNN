commit 9e21ca890d6f418a0be0b41c1b4061d9602233b3
Author: Alexander van Gessel <ai0867@gmail.com>
Date:   Mon Jul 20 03:21:49 2009 +0100

    Don't show 'recruit' in the context menu unless...
    
    ...the leader is actually on a keep.

diff --git a/src/actions.cpp b/src/actions.cpp
index 370714f3c0..0bd69bc33b 100644
--- a/src/actions.cpp
+++ b/src/actions.cpp
@@ -199,6 +199,9 @@ bool can_recruit_on(const gamemap& map, const map_location& leader, const map_lo
 	if(!map.is_castle(loc))
 		return false;
 
+	if(!map.is_keep(leader))
+		return false;
+
 	castle_cost_calculator calc(map);
 	// The limit computed in the third argument is more than enough for
 	// any convex castle on the map. Strictly speaking it could be

