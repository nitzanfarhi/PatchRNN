commit 19fd67096bda04469124bd3d40bf437d92175462
Author: wm4 <wm4@nowhere>
Date:   Wed Aug 6 20:00:39 2014 +0200

    vo_direct3d: allow resizing before video init
    
    This can just happen in the time between VO creation, and the first call
    to vo_reconfig. It seems the recent threading changes exposed this bug.
    
    Fixes #986.

diff --git a/video/out/vo_direct3d.c b/video/out/vo_direct3d.c
index 34ddafdd1e..c942c964f5 100644
--- a/video/out/vo_direct3d.c
+++ b/video/out/vo_direct3d.c
@@ -793,7 +793,7 @@ static bool resize_d3d(d3d_priv *priv)
             return 0;
     }
 
-    if (!priv->d3d_device)
+    if (!priv->d3d_device || !priv->image_format)
         return 1;
 
     if (!create_d3d_surfaces(priv))

