commit 9f51a0e6ca2ce276215ea6afe186cde0919d7762
Author: unknown <venu@myvenu.com>
Date:   Fri Nov 22 10:21:29 2002 -0800

    merge
    
    
    libmysql/libmysql.c:
      merge .

diff --git a/libmysql/libmysql.c b/libmysql/libmysql.c
index 0912f8997f9..47df7acb0b1 100644
--- a/libmysql/libmysql.c
+++ b/libmysql/libmysql.c
@@ -242,7 +242,7 @@ my_bool my_connect(my_socket s, const struct sockaddr *name,
   {
     tv.tv_sec = (long) timeout;
     tv.tv_usec = 0;
-#if defined(HPUX) && defined(THREAD)
+#if defined(HPUX10) && defined(THREAD)
     if ((res = select(s+1, NULL, (int*) &sfds, NULL, &tv)) >= 0)
       break;
 #else
@@ -928,7 +928,9 @@ static const char *default_options[]=
   "connect-timeout", "local-infile", "disable-local-infile",
   "replication-probe", "enable-reads-from-master", "repl-parse-query",
   "ssl-cipher","protocol",
-  "shared_memory_base_name",
+red_memory_base_name",
+
+
  NullS
 };
 
@@ -1737,6 +1739,7 @@ mysql_ssl_set(MYSQL *mysql __attribute__((unused)) ,
   Free strings in the SSL structure and clear 'use_ssl' flag.
   NB! Errors are not reported until you do mysql_real_connect.
 **************************************************************************/
+
 static void
 mysql_ssl_free(MYSQL *mysql __attribute__((unused)))
 {
@@ -1807,6 +1810,7 @@ mysql_real_connect(MYSQL *mysql,const char *host, const char *user,
 #endif
   init_sigpipe_variables
   DBUG_ENTER("mysql_real_connect");
+  LINT_INIT(host_info);
 
   DBUG_PRINT("enter",("host: %s  db: %s  user: %s",
 		      host ? host : "(Null)",
@@ -2188,15 +2192,18 @@ Try also with PIPE or TCP/IP
 				       options->ssl_capath,
 				       options->ssl_cipher)))
     {
-      /* TODO: Change to SSL error */
-      net->last_errno= CR_SERVER_LOST;
+      net->last_errno= CR_SSL_CONNECTION_ERROR;
       strmov(net->last_error,ER(net->last_errno));    
       goto error;
     }
     DBUG_PRINT("info", ("IO layer change in progress..."));
-    /* TODO:  Add proper error checking here, with return error message */
-    sslconnect((struct st_VioSSLConnectorFd*)(mysql->connector_fd),
-	       mysql->net.vio, (long) (mysql->options.connect_timeout));
+    if(sslconnect((struct st_VioSSLConnectorFd*)(mysql->connector_fd),
+	        mysql->net.vio, (long) (mysql->options.connect_timeout)))
+    {
+      net->last_errno= CR_SSL_CONNECTION_ERROR;
+      strmov(net->last_error,ER(net->last_errno));
+      goto error;    
+    }
     DBUG_PRINT("info", ("IO layer change done!"));
   }
 #endif /* HAVE_OPENSSL */

