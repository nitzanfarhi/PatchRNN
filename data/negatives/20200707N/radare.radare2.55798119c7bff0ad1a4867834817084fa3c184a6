commit 55798119c7bff0ad1a4867834817084fa3c184a6
Author: condret <condret@runas-racer.com>
Date:   Thu Mar 19 01:39:24 2015 +0100

    fix #2206

diff --git a/libr/io/p/io_ihex.c b/libr/io/p/io_ihex.c
index 6081b4aa9..0e973231d 100644
--- a/libr/io/p/io_ihex.c
+++ b/libr/io/p/io_ihex.c
@@ -48,8 +48,8 @@ static int __write(RIO *io, RIODesc *fd, const ut8 *buf, int count) {
 	Rihex *rih;
 	RBufferSparse *rbs;
 	RListIter *iter;
-	
-	if (fd == NULL || fd->data == NULL || (count<=0))
+
+	if (fd == NULL || fd->data == NULL || (fd->flags & R_IO_WRITE) == 0 ||(count<=0))
 		return -1;
 	rih = fd->data;
 	pathname = fd->name + 7;
@@ -73,7 +73,7 @@ static int __write(RIO *io, RIODesc *fd, const ut8 *buf, int count) {
 		ut16 tsiz =0;
 		if (rbs->size == 0)
 			continue;
-		
+
 		if (addh0 != addh1) {
 			//we cross a 64k boundary, so write in two steps
 			//04 record (ext address)

