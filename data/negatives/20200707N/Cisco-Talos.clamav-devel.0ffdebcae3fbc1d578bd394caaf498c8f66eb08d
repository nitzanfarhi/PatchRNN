commit 0ffdebcae3fbc1d578bd394caaf498c8f66eb08d
Author: Steven Morgan <smorgan@sourcefire.com>
Date:   Mon Jun 9 17:21:55 2014 -0400

    bz10893: fixes bug for hash calculations when using --allmatch.

diff --git a/libclamav/matcher.c b/libclamav/matcher.c
index 0e9b5aea9..aa04cb33a 100644
--- a/libclamav/matcher.c
+++ b/libclamav/matcher.c
@@ -921,7 +921,7 @@ int cli_fmap_scandesc(cli_ctx *ctx, cli_file_t ftype, uint8_t ftonly, struct cli
                     type = ret;
             }
 
-            if(hdb && !SCAN_ALL) {
+            if(hdb) {
                 const void *data = buff + maxpatlen * (offset!=0);
                 uint32_t data_len = bytes - maxpatlen * (offset!=0);
 

