commit ca220afe0f738f2353d16c96dd16ab279ffdcf74
Author: Daniel-Constantin Mierla <miconda@gmail.com>
Date:   Thu May 14 14:29:12 2015 +0200

    textops: safety check to know there is a string to add via lump

diff --git a/modules/textops/textops.c b/modules/textops/textops.c
index 97f6980b5..7c5e2af50 100644
--- a/modules/textops/textops.c
+++ b/modules/textops/textops.c
@@ -2111,6 +2111,11 @@ int add_hf_helper(struct sip_msg* msg, str *str1, str *str2,
 	len=s0.len;
 	if (str2) len+= str2->len + REQ_LINE(msg).uri.len;
 
+	if(len==0) {
+		LM_INFO("nothing to add\n");
+		return -1;
+	}
+
 	s  = (char*)pkg_malloc(len);
 	if (!s) {
 		LM_ERR("no pkg memory left\n");

