commit a734fe1378c727cb779a0e5e84599aaf6277bbf9
Author: Rainer Gerhards <rgerhards@adiscon.com>
Date:   Tue Nov 5 09:55:10 2013 +0100

    support force termination in script engine

diff --git a/runtime/ruleset.c b/runtime/ruleset.c
index c54715fcf..5f9b500e8 100644
--- a/runtime/ruleset.c
+++ b/runtime/ruleset.c
@@ -340,6 +340,11 @@ scriptExec(struct cnfstmt *root, msg_t *pMsg, wti_t *pWti)
 	struct cnfstmt *stmt;
 
 	for(stmt = root ; stmt != NULL ; stmt = stmt->next) {
+		if(*pWti->pbShutdownImmediate) {
+			DBGPRINTF("scriptExec: ShutdownImmediate set, "
+				  "force terminating\n");	
+			goto done;
+		}
 		if(Debug) {
 			cnfstmtPrintOnly(stmt, 2, 0);
 		}

