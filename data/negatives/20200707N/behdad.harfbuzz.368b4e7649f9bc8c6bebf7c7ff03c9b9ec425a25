commit 368b4e7649f9bc8c6bebf7c7ff03c9b9ec425a25
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Mon Aug 6 23:06:04 2012 -0400

    Minor

diff --git a/src/hb-font.cc b/src/hb-font.cc
index f0683e4d..409b9e88 100644
--- a/src/hb-font.cc
+++ b/src/hb-font.cc
@@ -200,7 +200,6 @@ hb_font_get_glyph_name_nil (hb_font_t *font,
   if (font->parent)
     return hb_font_get_glyph_name (font->parent, glyph, name, size);
 
-  snprintf (name, size, "gid%u", glyph);
   return false;
 }
 
@@ -411,7 +410,10 @@ hb_font_get_glyph_name (hb_font_t *font,
 			hb_codepoint_t glyph,
 			char *name, unsigned int size)
 {
-  return font->get_glyph_name (glyph, name, size);
+  hb_bool_t ret = font->get_glyph_name (glyph, name, size);
+  if (!ret)
+    snprintf (name, size, "gid%u", glyph);
+  return ret;
 }
 
 hb_bool_t

