commit 414d4ee117b45834e6e02f32cda9c9472dd89e1d
Author: Timo Sirainen <timo.sirainen@dovecot.fi>
Date:   Tue Jan 26 17:53:28 2016 +0200

    pop3-migration: Don't even try to match message sizes with pop3_migration_skip_size_check=yes
    
    This skipped the header check for mailboxes that had only a single mail.

diff --git a/src/plugins/pop3-migration/pop3-migration-plugin.c b/src/plugins/pop3-migration/pop3-migration-plugin.c
index b1c542e48..d327ba425 100644
--- a/src/plugins/pop3-migration/pop3-migration-plugin.c
+++ b/src/plugins/pop3-migration/pop3-migration-plugin.c
@@ -582,6 +582,9 @@ static bool pop3_uidl_assign_by_size(struct mailbox *box)
 	struct imap_msg_map *imap_map;
 	unsigned int i, pop3_count, imap_count, count;
 
+	if (mstorage->skip_size_check)
+		return FALSE;
+
 	pop3_map = array_get_modifiable(&mstorage->pop3_uidl_map, &pop3_count);
 	imap_map = array_get_modifiable(&mbox->imap_msg_map, &imap_count);
 	count = I_MIN(pop3_count, imap_count);

