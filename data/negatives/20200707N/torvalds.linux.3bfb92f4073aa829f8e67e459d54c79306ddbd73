commit 3bfb92f4073aa829f8e67e459d54c79306ddbd73
Author: Sven Wegener <sven.wegener@stealer.net>
Date:   Fri Sep 5 16:53:49 2008 +0200

    ipvs: Reject ipv6 link-local addresses for destinations
    
    We can't use non-local link-local addresses for destinations, without
    knowing the interface on which we can reach the address. Reject them for
    now.
    
    Signed-off-by: Sven Wegener <sven.wegener@stealer.net>
    Acked-by: Julius Volz <juliusv@google.com>
    Signed-off-by: Simon Horman <horms@verge.net.au>

diff --git a/net/ipv4/ipvs/ip_vs_ctl.c b/net/ipv4/ipvs/ip_vs_ctl.c
index d2dc05a843f5..e53efe41f01d 100644
--- a/net/ipv4/ipvs/ip_vs_ctl.c
+++ b/net/ipv4/ipvs/ip_vs_ctl.c
@@ -838,7 +838,8 @@ ip_vs_new_dest(struct ip_vs_service *svc, struct ip_vs_dest_user_kern *udest,
 #ifdef CONFIG_IP_VS_IPV6
 	if (svc->af == AF_INET6) {
 		atype = ipv6_addr_type(&udest->addr.in6);
-		if (!(atype & IPV6_ADDR_UNICAST) &&
+		if ((!(atype & IPV6_ADDR_UNICAST) ||
+			atype & IPV6_ADDR_LINKLOCAL) &&
 			!__ip_vs_addr_is_local_v6(&udest->addr.in6))
 			return -EINVAL;
 	} else

