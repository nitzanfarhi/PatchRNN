commit eeb93d02c5d8819c74f6d4da08325cff8c6a9376
Author: Sebastian Hesselbarth <sebastian.hesselbarth@gmail.com>
Date:   Thu Sep 26 02:08:17 2013 +0200

    clocksource: of: Respect device tree node status
    
    Clocksource devices provided by DT can be disabled (status != "okay").
    Instead of registering clocksource drivers for disabled nodes, respect
    the device's status by skiping disabled nodes.
    
    Signed-off-by: Sebastian Hesselbarth <sebastian.hesselbarth@gmail.com>
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

diff --git a/drivers/clocksource/clksrc-of.c b/drivers/clocksource/clksrc-of.c
index 37f5325bec95..b9ddd9e3a2f5 100644
--- a/drivers/clocksource/clksrc-of.c
+++ b/drivers/clocksource/clksrc-of.c
@@ -30,6 +30,9 @@ void __init clocksource_of_init(void)
 	clocksource_of_init_fn init_func;
 
 	for_each_matching_node_and_match(np, __clksrc_of_table, &match) {
+		if (!of_device_is_available(np))
+			continue;
+
 		init_func = match->data;
 		init_func(np);
 	}

