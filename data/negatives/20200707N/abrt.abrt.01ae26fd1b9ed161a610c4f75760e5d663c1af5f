commit 01ae26fd1b9ed161a610c4f75760e5d663c1af5f
Author: Denys Vlasenko <vda.linux@googlemail.com>
Date:   Thu Oct 4 13:05:43 2012 +0200

    abrt-hook-ccpp: save /proc/sys/crypto/fips_enabled value if it isn't "0". Closes rhbz#747870
    
    Signed-off-by: Denys Vlasenko <vda.linux@googlemail.com>

diff --git a/src/hooks/abrt-hook-ccpp.c b/src/hooks/abrt-hook-ccpp.c
index 15501bb8..100df3c5 100644
--- a/src/hooks/abrt-hook-ccpp.c
+++ b/src/hooks/abrt-hook-ccpp.c
@@ -721,6 +721,14 @@ int main(int argc, char** argv)
         dd_save_text(dd, FILENAME_ENVIRON, environ ? : "");
         free(environ);
 
+        char *fips_enabled = xmalloc_fopen_fgetline_fclose("/proc/sys/crypto/fips_enabled");
+        if (fips_enabled)
+        {
+            if (strcmp(fips_enabled, "0") != 0)
+                dd_save_text(dd, "fips_enabled", fips_enabled);
+            free(fips_enabled);
+        }
+
         dd_save_text(dd, FILENAME_ABRT_VERSION, VERSION);
 
         if (src_fd_binary > 0)

