commit 62dc2e82f5778a5fd172576d2bce91653fb19072
Author: Bron Gondwana <brong@opera.com>
Date:   Thu Feb 24 16:29:29 2011 +0100

    mailbox: set header size on create so appends work

diff --git a/imap/mailbox.c b/imap/mailbox.c
index e46ec2610..c4ce86096 100644
--- a/imap/mailbox.c
+++ b/imap/mailbox.c
@@ -2773,6 +2773,10 @@ int mailbox_create(const char *name,
     mailbox->i.options = options;
     mailbox->i.highestmodseq = 1;
 
+    /* initialise header size field so appends calculate the
+     * correct map size */
+    mailbox->index_size = INDEX_HEADER_SIZE;
+
     mailbox->header_dirty = 1;
     if (!uniqueid) {
 	mailbox_make_uniqueid(mailbox);

