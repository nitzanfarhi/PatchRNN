commit e3262c5fcd6d6c09ff30bf7ff04b4e89970e3339
Author: sth <sth@c6295689-39f2-0310-b995-f0e70906c6a9>
Date:   Wed Jun 4 12:24:19 2003 +0000

    added a check for CKA_CERTIFICATE_TYPE to attr_extract()
    
    
    git-svn-id: https://www.opensc-project.org/svnp/opensc/trunk@1180 c6295689-39f2-0310-b995-f0e70906c6a9

diff --git a/src/pkcs11/misc.c b/src/pkcs11/misc.c
index baf3bdb1..bf5c2297 100644
--- a/src/pkcs11/misc.c
+++ b/src/pkcs11/misc.c
@@ -221,6 +221,8 @@ CK_RV attr_extract(CK_ATTRIBUTE_PTR pAttr, void *ptr, size_t *sizep)
 			size = sizeof(CK_KEY_TYPE); break;
 		case CKA_PRIVATE:
 			size = sizeof(CK_BBOOL); break;
+		case CKA_CERTIFICATE_TYPE:
+			size = sizeof(CKA_CERTIFICATE_TYPE); break;
 		default:
 			return CKR_FUNCTION_FAILED;
 		}

