commit 63be9bada8036d50906b8381ac237d17f544c7d5
Author: Paul Wouters <paul@xelerance.com>
Date:   Sun Dec 27 23:11:29 2009 -0500

    send_notification() in ikev1_main.c did a wrong check on out_raw when
    spisize > 0. Patch by Seong-hun Lim

diff --git a/programs/pluto/ikev1_main.c b/programs/pluto/ikev1_main.c
index b5f4f8fae..b3366f625 100644
--- a/programs/pluto/ikev1_main.c
+++ b/programs/pluto/ikev1_main.c
@@ -2527,7 +2527,7 @@ send_notification(struct state *sndst, u_int16_t type, struct state *encst,
 	}
 
 	if(spisize > 0) {
-	    if(out_raw(spi, spisize, &not_pbs, "spi")) {
+	    if(!out_raw(spi, spisize, &not_pbs, "spi")) {
 		openswan_log("failed to build notification for spisize=%d\n", (int)spisize);
 		return;
 	    }

