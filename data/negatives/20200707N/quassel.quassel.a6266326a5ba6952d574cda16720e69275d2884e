commit a6266326a5ba6952d574cda16720e69275d2884e
Author: Daniel Albers <daniel@lbers.com>
Date:   Mon Aug 4 12:04:58 2008 +0200

    /j and /join only prepend # when channel names start with letters or numbers

diff --git a/src/core/corealiasmanager.cpp b/src/core/corealiasmanager.cpp
index af3353fd..8fcdb022 100644
--- a/src/core/corealiasmanager.cpp
+++ b/src/core/corealiasmanager.cpp
@@ -54,5 +54,5 @@ CoreAliasManager::~CoreAliasManager() {
 
 void CoreAliasManager::loadDefaults() {
   // Default Aliases:
-  addAlias("j", "/join #$1");
+  addAlias("j", "/join $1");
 }
diff --git a/src/core/userinputhandler.cpp b/src/core/userinputhandler.cpp
index 7dec1dc2..bc3bb654 100644
--- a/src/core/userinputhandler.cpp
+++ b/src/core/userinputhandler.cpp
@@ -156,9 +156,15 @@ void UserInputHandler::handleJoin(const BufferInfo &bufferInfo, const QString &m
   QStringList params = msg.trimmed().split(" ");
   QStringList chans = params[0].split(",");
   QStringList keys;
+  int i;
+  for(i = 0; i < chans.count(); i++) {
+    if (chans.at(i)[0].isLetterOrNumber())
+      chans[i].prepend(QChar('#'));
+  }
+  params[0] = chans.join(",");
   if(params.count() > 1) keys = params[1].split(",");
   emit putCmd("JOIN", serverEncode(params)); // FIXME handle messages longer than 512 bytes!
-  int i = 0;
+  i = 0;
   for(; i < keys.count(); i++) {
     if(i >= chans.count()) break;
     networkConnection()->addChannelKey(chans[i], keys[i]);

