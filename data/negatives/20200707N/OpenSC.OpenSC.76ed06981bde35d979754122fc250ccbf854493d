commit 76ed06981bde35d979754122fc250ccbf854493d
Author: Uri Blumenthal <uri@ll.mit.edu>
Date:   Tue Dec 22 13:31:42 2015 -0500

    Made sure attribute CKA_TOKEN is set to TRUE.

diff --git a/src/pkcs11/framework-pkcs15.c b/src/pkcs11/framework-pkcs15.c
index e468bd21..23249a7c 100644
--- a/src/pkcs11/framework-pkcs15.c
+++ b/src/pkcs11/framework-pkcs15.c
@@ -3878,6 +3878,9 @@ pkcs15_pubkey_get_attribute(struct sc_pkcs11_session *session, void *object, CK_
 		*(CK_OBJECT_CLASS*)attr->pValue = CKO_PUBLIC_KEY;
 		break;
 	case CKA_TOKEN:
+		check_attribute_buffer(attr, sizeof(CK_BBOOL));
+		*(CK_BBOOL*)attr->pValue = TRUE;
+		break;
 	case CKA_SENSITIVE:
 		/* By PKCS#11 v2.20 public key cannot have SENSITIVE attr TRUE */
 		check_attribute_buffer(attr, sizeof(CK_BBOOL));

