commit 4654bf44a767b4c3894d3f9e09ba29445877bad9
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Sun Sep 2 05:01:08 2012 +0200

    flvdec: fix creation of lots of phantom data streams
    
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavformat/flvdec.c b/libavformat/flvdec.c
index 822f38104f..c7b692273f 100644
--- a/libavformat/flvdec.c
+++ b/libavformat/flvdec.c
@@ -720,8 +720,9 @@ static int flv_read_packet(AVFormatContext *s, AVPacket *pkt)
                 flv_same_video_codec(st->codec, flags)) {
                 break;
             }
-        } else if (st->id == stream_type) {
-            break;
+        } else if (stream_type == FLV_STREAM_TYPE_DATA) {
+            if (st->codec->codec_type == AVMEDIA_TYPE_DATA)
+                break;
         }
     }
     if(i == s->nb_streams){

