commit 8e37a1deb30c51e2e2ef5726f550b698303bc029
Author: Daniel Kang <daniel.d.kang@gmail.com>
Date:   Mon Jan 10 10:36:14 2011 +0000

    Check for vectable ID > 0, fixes issue 2508.
    
    Patch by Daniel Kang, daniel.d.kang at gmail
    
    Originally committed as revision 26294 to svn://svn.ffmpeg.org/ffmpeg/trunk

diff --git a/libavcodec/truemotion1.c b/libavcodec/truemotion1.c
index d6ea4c1a6..338b4dcc1 100644
--- a/libavcodec/truemotion1.c
+++ b/libavcodec/truemotion1.c
@@ -387,7 +387,7 @@ static int truemotion1_decode_header(TrueMotion1Context *s)
     if ((header.compression & 1) && header.header_type)
         sel_vector_table = pc_tbl2;
     else {
-        if (header.vectable < 4)
+        if (header.vectable > 0 && header.vectable < 4)
             sel_vector_table = tables[header.vectable - 1];
         else {
             av_log(s->avctx, AV_LOG_ERROR, "invalid vector table id (%d)\n", header.vectable);

