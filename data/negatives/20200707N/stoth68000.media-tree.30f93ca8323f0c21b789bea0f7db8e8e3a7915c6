commit 30f93ca8323f0c21b789bea0f7db8e8e3a7915c6
Author: Viresh Kumar <viresh.kumar@linaro.org>
Date:   Mon Aug 17 08:16:51 2015 +0530

    regulator: core: Define regulator_set_voltage_triplet()
    
    Voltage tolerance isn't necessarily same on both sides of the target
    voltage and regulator_set_voltage_tol() wouldn't be suitable in such
    cases.
    
    Add another routine regulator_set_voltage_triplet(), which accepts
    target, min and max voltages as arguments.
    
    This first tries to set the voltage between the target voltage and the
    upper limit, then fall back on the full range. The idea behind this is
    to set regulator's voltage as close to the target voltage, as possible.
    
    Based on regulator_set_voltage_tol().
    
    Signed-off-by: Viresh Kumar <viresh.kumar@linaro.org>
    Signed-off-by: Mark Brown <broonie@kernel.org>

diff --git a/include/linux/regulator/consumer.h b/include/linux/regulator/consumer.h
index f8a689ed62a5..e325d4606b62 100644
--- a/include/linux/regulator/consumer.h
+++ b/include/linux/regulator/consumer.h
@@ -552,6 +552,16 @@ static inline int regulator_count_voltages(struct regulator *regulator)
 }
 #endif
 
+static inline int regulator_set_voltage_triplet(struct regulator *regulator,
+						int min_uV, int target_uV,
+						int max_uV)
+{
+	if (regulator_set_voltage(regulator, target_uV, max_uV) == 0)
+		return 0;
+
+	return regulator_set_voltage(regulator, min_uV, max_uV);
+}
+
 static inline int regulator_set_voltage_tol(struct regulator *regulator,
 					    int new_uV, int tol_uV)
 {

