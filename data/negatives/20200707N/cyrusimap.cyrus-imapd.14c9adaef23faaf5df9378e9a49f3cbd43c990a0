commit 14c9adaef23faaf5df9378e9a49f3cbd43c990a0
Author: Bron Gondwana <brong@fastmail.fm>
Date:   Thu Sep 6 16:37:53 2018 +1000

    jmap Email/set: don't lose seen state if only adding new items

diff --git a/imap/jmap_mail.c b/imap/jmap_mail.c
index e3f4250ab..def47d249 100644
--- a/imap/jmap_mail.c
+++ b/imap/jmap_mail.c
@@ -8896,6 +8896,9 @@ static void _email_bulkupdate_exec_setflags(struct email_bulkupdate *bulk)
                         if (!seqset_ismember(del_seenseq, uid))
                             seqset_add(new_seenseq, uid, 1);
                 }
+                else {
+                    seqset_join(new_seenseq, plan->old_seenseq);
+                }
                 if (add_seenseq->len)
                     seqset_join(new_seenseq, add_seenseq);
                 struct seendata sd = SEENDATA_INITIALIZER;

