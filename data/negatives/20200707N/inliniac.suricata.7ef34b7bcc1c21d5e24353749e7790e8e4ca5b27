commit 7ef34b7bcc1c21d5e24353749e7790e8e4ca5b27
Author: Victor Julien <victor@inliniac.net>
Date:   Sun Oct 30 08:56:41 2011 +0100

    Exlcude DSIZE LT case from setting the 'need payload' mask bit as it can include 0, which means no payload.

diff --git a/src/detect.c b/src/detect.c
index 2bfbfe72..7d89bc77 100644
--- a/src/detect.c
+++ b/src/detect.c
@@ -2239,8 +2239,12 @@ static int SignatureCreateMask(Signature *s) {
             {
                 DetectDsizeData *ds = (DetectDsizeData *)sm->ctx;
                 switch (ds->mode) {
-                    case DETECTDSIZE_RA:
                     case DETECTDSIZE_LT:
+                        /* LT will include 0, so no payload.
+                         * if GT is used in the same rule the
+                         * flag will be set anyway. */
+                        break;
+                    case DETECTDSIZE_RA:
                     case DETECTDSIZE_GT:
                         s->mask |= SIG_MASK_REQUIRE_PAYLOAD;
                         SCLogDebug("sig requires payload");

