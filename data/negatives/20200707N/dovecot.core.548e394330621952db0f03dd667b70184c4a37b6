commit 548e394330621952db0f03dd667b70184c4a37b6
Author: Timo Sirainen <tss@iki.fi>
Date:   Fri Sep 30 23:25:58 2005 +0300

    i_stream_stat() should return NULL for closed istreams
    
    --HG--
    branch : HEAD

diff --git a/src/lib/istream.c b/src/lib/istream.c
index d48f2413f..d7b5c269e 100644
--- a/src/lib/istream.c
+++ b/src/lib/istream.c
@@ -114,6 +114,9 @@ const struct stat *i_stream_stat(struct istream *stream)
 {
 	struct _istream *_stream = stream->real_stream;
 
+	if (stream->closed)
+		return NULL;
+
 	return _stream->stat(_stream);
 }
 

