commit 0a4273f338a038da541e9f647e41f928fdc44338
Author: Michael Mann <mmann78@netscape.net>
Date:   Sat Feb 18 15:29:56 2017 -0500

    Only cleanup open_routines if not NULL
    
    Change-Id: I76ea675625ef2812f51bad0c37f6c58060897f55
    Reviewed-on: https://code.wireshark.org/review/20172
    Petri-Dish: Michael Mann <mmann78@netscape.net>
    Tested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>
    Reviewed-by: Michael Mann <mmann78@netscape.net>

diff --git a/wiretap/file_access.c b/wiretap/file_access.c
index 5b3e75ea61..4448b36355 100644
--- a/wiretap/file_access.c
+++ b/wiretap/file_access.c
@@ -2724,12 +2724,14 @@ cleanup_open_routines(void)
 	guint i;
 	struct open_info *i_open;
 
-	for (i = 0, i_open = open_routines; i < open_info_arr->len; i++, i_open++) {
-		if (i_open->extensions != NULL)
-			g_strfreev(i_open->extensions_set);
-	}
+	if (open_routines != NULL) {
+		for (i = 0, i_open = open_routines; i < open_info_arr->len; i++, i_open++) {
+			if (i_open->extensions != NULL)
+				g_strfreev(i_open->extensions_set);
+		}
 
-	g_array_free(open_info_arr, TRUE);
+		g_array_free(open_info_arr, TRUE);
+	}
 }
 
 /*

