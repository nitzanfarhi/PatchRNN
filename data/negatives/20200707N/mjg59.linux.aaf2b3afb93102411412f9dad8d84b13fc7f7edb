commit aaf2b3afb93102411412f9dad8d84b13fc7f7edb
Author: Insu Yun <wuninsu@gmail.com>
Date:   Mon Feb 15 21:19:57 2016 -0500

    gpio-mcp23s08: correctly handling failed allocation
    
    Since devm_kzalloc can be failed in memory pressure,
    it needs to check and return -ENOMEM
    
    Signed-off-by: Insu Yun <wuninsu@gmail.com>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

diff --git a/drivers/gpio/gpio-mcp23s08.c b/drivers/gpio/gpio-mcp23s08.c
index c767879e4dd9..f8d4abcff573 100644
--- a/drivers/gpio/gpio-mcp23s08.c
+++ b/drivers/gpio/gpio-mcp23s08.c
@@ -803,6 +803,8 @@ static int mcp230xx_probe(struct i2c_client *client,
 			pdata = devm_kzalloc(&client->dev,
 					sizeof(struct mcp23s08_platform_data),
 					GFP_KERNEL);
+			if (!pdata)
+				return -ENOMEM;
 			pdata->base = -1;
 		}
 	}

