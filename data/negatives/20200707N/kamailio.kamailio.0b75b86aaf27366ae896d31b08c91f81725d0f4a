commit 0b75b86aaf27366ae896d31b08c91f81725d0f4a
Author: Bogdan-Andrei Iancu <bogdan@voice-system.ro>
Date:   Wed Mar 3 13:09:58 2004 +0000

     - in failure route, msg->parsed_uri_ok must be reset!!! since msg_parsed_uri is
        not cloned (and cannot be cloned)!

diff --git a/modules/tm/t_reply.c b/modules/tm/t_reply.c
index 14895200f..47f536bcd 100644
--- a/modules/tm/t_reply.c
+++ b/modules/tm/t_reply.c
@@ -457,6 +457,9 @@ static inline int fake_req(struct sip_msg *faked_req,
 	/* if we set msg_id to something different from current's message
 	 * id, the first t_fork will properly clean new branch URIs */
 	faked_req->id=shmem_msg->id-1;
+	/* msg->parsed_uri_ok must be reset since msg_parsed_uri is
+	 * not cloned (and cannot be cloned) */
+	faked_req->parsed_uri_ok = 0;
 
 	/* new_uri can change -- make a private copy */
 	if (shmem_msg->new_uri.s!=0 && shmem_msg->new_uri.len!=0) {

