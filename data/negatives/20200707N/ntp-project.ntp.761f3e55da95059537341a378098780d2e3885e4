commit 761f3e55da95059537341a378098780d2e3885e4
Author:  <mayer@tecotoo.>
Date:   Sun Oct 24 22:37:46 2004 -0400

    Don't allow null interfaces

diff --git a/ntpd/ntp_peer.c b/ntpd/ntp_peer.c
index 164b5b8f8..952e91ab4 100644
--- a/ntpd/ntp_peer.c
+++ b/ntpd/ntp_peer.c
@@ -591,6 +591,14 @@ newpeer(
 	else
 		peer->dstadr = findinterface(srcadr);
 
+	/*
+	 * If we can't find an interface to use we return a NULL
+	 */
+	if (peer->dstadr == NULL)
+	{
+		msyslog(LOG_ERR, "Cannot find suitable interface for address %s", stoa(srcadr));
+		return (NULL);
+	}
 	/*
 	 * Broadcast needs the socket enabled for broadcast
 	 */

