commit a8442ba4359e75c6588d6e0c4f54d621771893cd
Author: dlg <dlg@openbsd.org>
Date:   Thu Apr 20 13:02:26 2006 +0000

    get rid of the ccb list typedef. while here switch to TAILQ_HEAD instead
    of TAILQ_TAIL when pulling ccbs off the free list since it does less
    "interesting" things with pointers. changes prompted by lint bitching.

diff --git a/sys/dev/ic/ami.c b/sys/dev/ic/ami.c
index 37600218603..f60d40a1076 100644
--- a/sys/dev/ic/ami.c
+++ b/sys/dev/ic/ami.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: ami.c,v 1.148 2006/04/20 12:14:54 dlg Exp $	*/
+/*	$OpenBSD: ami.c,v 1.149 2006/04/20 13:02:26 dlg Exp $	*/
 
 /*
  * Copyright (c) 2001 Michael Shalayeff
@@ -176,7 +176,7 @@ ami_get_ccb(struct ami_softc *sc)
 {
 	struct ami_ccb *ccb;
 
-	ccb = TAILQ_LAST(&sc->sc_ccb_freeq, ami_queue_head);
+	ccb = TAILQ_FIRST(&sc->sc_ccb_freeq);
 	if (ccb) {
 		TAILQ_REMOVE(&sc->sc_ccb_freeq, ccb, ccb_link);
 		ccb->ccb_state = AMI_CCB_READY;
diff --git a/sys/dev/ic/amivar.h b/sys/dev/ic/amivar.h
index 065d92d9f2b..d48b49efb68 100644
--- a/sys/dev/ic/amivar.h
+++ b/sys/dev/ic/amivar.h
@@ -1,4 +1,4 @@
-/*	$OpenBSD: amivar.h,v 1.46 2006/04/20 04:39:11 dlg Exp $	*/
+/*	$OpenBSD: amivar.h,v 1.47 2006/04/20 13:02:26 dlg Exp $	*/
 
 /*
  * Copyright (c) 2001 Michael Shalayeff
@@ -71,7 +71,7 @@ struct ami_ccb {
 	TAILQ_ENTRY(ami_ccb)	ccb_link;
 };
 
-typedef TAILQ_HEAD(ami_queue_head, ami_ccb)	ami_queue_head;
+TAILQ_HEAD(ami_ccb_list, ami_ccb);
 
 struct ami_rawsoftc {
 	struct scsi_link	sc_link;
@@ -111,7 +111,7 @@ struct ami_softc {
 	paddr_t			sc_mbox_pa;
 
 	struct ami_ccb		sc_ccbs[AMI_MAXCMDS];
-	ami_queue_head		sc_ccb_freeq, sc_ccb_preq, sc_ccb_runq;
+	struct ami_ccb_list	sc_ccb_freeq, sc_ccb_preq, sc_ccb_runq;
 
 	struct ami_mem		*sc_ccbmem_am;
 

