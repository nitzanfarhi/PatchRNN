commit cbf09545f250a4bd12c50c3a96fe481098ab2d49
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Thu Dec 4 18:17:17 2014 +0100

    avcodec/imc: only check remaining bits in case bits will be read
    
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavcodec/imc.c b/libavcodec/imc.c
index 0d7c97b603..b367ccb172 100644
--- a/libavcodec/imc.c
+++ b/libavcodec/imc.c
@@ -803,14 +803,15 @@ static void imc_get_coeffs(AVCodecContext *avctx,
                 cw_len = chctx->CWlengthT[j];
                 cw = 0;
 
-                if (get_bits_count(&q->gb) + cw_len > 512) {
-                    av_log(avctx, AV_LOG_WARNING,
-                           "Potential problem on band %i, coefficient %i"
-                           ": cw_len=%i\n", i, j, cw_len);
-                }
+                if (cw_len && (!chctx->bandFlagsBuf[i] || !chctx->skipFlags[j])) {
+                    if (get_bits_count(&q->gb) + cw_len > 512) {
+                        av_log(avctx, AV_LOG_WARNING,
+                            "Potential problem on band %i, coefficient %i"
+                            ": cw_len=%i\n", i, j, cw_len);
+                    }
 
-                if (cw_len && (!chctx->bandFlagsBuf[i] || !chctx->skipFlags[j]))
                     cw = get_bits(&q->gb, cw_len);
+                }
 
                 chctx->codewords[j] = cw;
             }

