commit a807b34427550a774289e84e843601cb24886748
Author: Rob Richards <rrichards@php.net>
Date:   Mon Oct 27 01:12:53 2003 +0000

    cannot import nodes without document

diff --git a/ext/simplexml/simplexml.c b/ext/simplexml/simplexml.c
index bea7f810e3..7fc199d41d 100644
--- a/ext/simplexml/simplexml.c
+++ b/ext/simplexml/simplexml.c
@@ -1191,6 +1191,10 @@ PHP_FUNCTION(simplexml_import_dom)
 
 	if (object->node && object->node->node) {
 		nodep = object->node->node;
+		if (nodep->doc == NULL) {
+			php_error(E_WARNING, "Imported Node must have associated Document");
+			RETURN_NULL();
+		}
 		if (nodep->type == XML_DOCUMENT_NODE || nodep->type == XML_HTML_DOCUMENT_NODE) {
 			nodep = xmlDocGetRootElement((xmlDocPtr) nodep);
 		}

