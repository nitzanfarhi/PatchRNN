commit 42fbb5c031905630c27a65eb353bca0d448d0ac3
Author: Jeff Morriss <jeff.morriss@ulticom.com>
Date:   Thu Mar 22 08:11:16 2007 +0000

    From Abhik Sarkar: call add_new_data_source() on generated (MTP3) tvb so that users can see the bytes in a (new) byte pane.
    
    svn path=/trunk/; revision=21109

diff --git a/epan/dissectors/packet-syslog.c b/epan/dissectors/packet-syslog.c
index c62a845e16..e695d956f7 100644
--- a/epan/dissectors/packet-syslog.c
+++ b/epan/dissectors/packet-syslog.c
@@ -284,8 +284,12 @@ dissect_syslog(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)
     }
   }
 
-  /* Call MTP dissector if encapsulated MSU was found */
+  /* Call MTP dissector if encapsulated MSU was found... */
   if (mtp3_tvb) {
+    /* ...and add the encapsulated MSU as a new data source so that it gets
+     * its own tab in the packet bytes pane.
+     */
+    add_new_data_source(pinfo, mtp3_tvb, "Encapsulated MSU");
     call_dissector(mtp_handle, mtp3_tvb, pinfo, tree);
   }
 

