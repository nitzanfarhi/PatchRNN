commit 0dc719a06fc1bbe11238762f9beb0c1faa4a2b75
Author: Timo Sirainen <tss@iki.fi>
Date:   Fri Nov 21 18:17:00 2014 +0900

    lmtp: Added TLS security information to Received: header when STARTTLS was used.

diff --git a/src/lmtp/commands.c b/src/lmtp/commands.c
index ca0b2e7ff..3dcdf45ae 100644
--- a/src/lmtp/commands.c
+++ b/src/lmtp/commands.c
@@ -1004,7 +1004,12 @@ static const char *client_get_added_headers(struct client *client)
 	host = net_ip2addr(&client->remote_ip);
 	if (host[0] != '\0')
 		str_printfa(str, " ([%s])", host);
-	str_printfa(str, "\r\n\tby %s ("PACKAGE_NAME") with LMTP id %s",
+	str_append(str, "\r\n");
+	if (client->ssl_iostream != NULL) {
+		str_printfa(str, "\t(using %s)\r\n",
+			    ssl_iostream_get_security_string(client->ssl_iostream));
+	}
+	str_printfa(str, "\tby %s ("PACKAGE_NAME") with LMTP id %s",
 		    client->my_domain, client->state.session_id);
 
 	str_append(str, "\r\n\t");

