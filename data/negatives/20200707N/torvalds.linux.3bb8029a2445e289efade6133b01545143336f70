commit 3bb8029a2445e289efade6133b01545143336f70
Author: Eric Bénard <eric@eukrea.com>
Date:   Thu Jan 13 14:53:17 2011 +0100

    USB: unbreak ehci-mxc on otg port of i.MX27
    
    commit 711669e5b80b6f2d88f61ed8a9681f83d8cbd201 fixed port 0 support
    for i.MX51 but broke it for (at least) i.MX27 which doesn't have
    a usb_phy1 clock but has a pdev->id 0.
    
    Signed-off-by: Eric Bénard <eric@eukrea.com>
    Cc: Arnaud Patard <arnaud.patard@rtp-net.org>
    Cc: Sascha Hauer <s.hauer@pengutronix.de>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

diff --git a/drivers/usb/host/ehci-mxc.c b/drivers/usb/host/ehci-mxc.c
index fa59b26fc5bc..d443fbd8535b 100644
--- a/drivers/usb/host/ehci-mxc.c
+++ b/drivers/usb/host/ehci-mxc.c
@@ -177,8 +177,8 @@ static int ehci_mxc_drv_probe(struct platform_device *pdev)
 		clk_enable(priv->ahbclk);
 	}
 
-	/* "dr" device has its own clock */
-	if (pdev->id == 0) {
+	/* "dr" device has its own clock on i.MX51 */
+	if (cpu_is_mx51() && (pdev->id == 0)) {
 		priv->phy1clk = clk_get(dev, "usb_phy1");
 		if (IS_ERR(priv->phy1clk)) {
 			ret = PTR_ERR(priv->phy1clk);

