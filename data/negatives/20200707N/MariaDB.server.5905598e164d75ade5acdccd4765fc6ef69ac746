commit 5905598e164d75ade5acdccd4765fc6ef69ac746
Author: jimw@mysql.com <>
Date:   Wed May 25 14:41:50 2005 -0700

    Fix MERGE tables on Microsoft Windows. This a backport of the
    fix from the main 5.0 tree. (Bug #10687)

diff --git a/myisammrg/myrg_open.c b/myisammrg/myrg_open.c
index 0dc2f4f9768..f9cdc2bb205 100644
--- a/myisammrg/myrg_open.c
+++ b/myisammrg/myrg_open.c
@@ -67,7 +67,7 @@ MYRG_INFO *myrg_open(const char *name, int mode, int handle_locking)
   while ((length=my_b_gets(&file,buff,FN_REFLEN-1)))
   {
     if ((end=buff+length)[-1] == '\n')
-      end[-1]='\0';
+      *--end='\0';
     if (!buff[0])
       continue;		/* Skip empty lines */
     if (buff[0] == '#')
@@ -86,6 +86,8 @@ MYRG_INFO *myrg_open(const char *name, int mode, int handle_locking)
                    sizeof(name_buff)-1-dir_length));
       VOID(cleanup_dirname(buff,name_buff));
     }
+    else
+      fn_format(buff, buff, "", "", 0);
     if (!(isam=mi_open(buff,mode,(handle_locking?HA_OPEN_WAIT_IF_LOCKED:0))))
       goto err;
     if (!m_info)                                /* First file */
diff --git a/mysys/my_getwd.c b/mysys/my_getwd.c
index 89f949eca27..5663ceaa60e 100644
--- a/mysys/my_getwd.c
+++ b/mysys/my_getwd.c
@@ -208,7 +208,10 @@ int test_if_hard_path(register const char *dir_name)
 
 my_bool has_path(const char *name)
 {
-  return test(strchr(name, FN_LIBCHAR))
+  return test(strchr(name, FN_LIBCHAR)) 
+#if FN_LIBCHAR != '/'
+    || test(strchr(name,'/'))
+#endif
 #ifdef FN_DEVCHAR
     || test(strchr(name, FN_DEVCHAR))
 #endif

