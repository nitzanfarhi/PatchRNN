commit a1bb7010d494d3fcde3814d7a8ac609f1dff96ee
Author: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
Date:   Tue Jun 14 09:24:40 2011 +0000

    acornfb: Dont BUG() on invalid pan parameters
    
    The driver currently BUG()s if the pan parameters passed directly from
    userspace are invalid. Return -EINVAL instead.
    
    Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
    Signed-off-by: Paul Mundt <lethal@linux-sh.org>

diff --git a/drivers/video/acornfb.c b/drivers/video/acornfb.c
index 6183a57eb69d..3bacc1290548 100644
--- a/drivers/video/acornfb.c
+++ b/drivers/video/acornfb.c
@@ -852,7 +852,8 @@ acornfb_pan_display(struct fb_var_screeninfo *var, struct fb_info *info)
 	if (!(var->vmode & FB_VMODE_YWRAP))
 		y_bottom += var->yres;
 
-	BUG_ON(y_bottom > var->yres_virtual);
+	if (y_bottom > var->yres_virtual)
+		return -EINVAL;
 
 	acornfb_update_dma(info, var);
 

