commit 716bdf1874647196ac16dd2a1ad359d88844795a
Author: Pavel Machek <pavel@ucw.cz>
Date:   Fri Nov 6 15:58:31 2009 +0000

    backlight: Fix backlight limiting on spitz/corgi devices
    
    On spitz (& similar) machines, if battery is running low, backlight
    needs
    to be limited to lower step.  Unfortunately, current code uses &= for
    limiting, turning backlight off completely for some backlight settings.
    Fix that.
    
    Signed-off-by: Pavel Machek <pavel@ucw.cz>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Richard Purdie <rpurdie@linux.intel.com>

diff --git a/drivers/video/backlight/corgi_lcd.c b/drivers/video/backlight/corgi_lcd.c
index 2211a852af9c..96774949cd30 100644
--- a/drivers/video/backlight/corgi_lcd.c
+++ b/drivers/video/backlight/corgi_lcd.c
@@ -433,8 +433,9 @@ static int corgi_bl_update_status(struct backlight_device *bd)
 
 	if (corgibl_flags & CORGIBL_SUSPENDED)
 		intensity = 0;
-	if (corgibl_flags & CORGIBL_BATTLOW)
-		intensity &= lcd->limit_mask;
+
+	if ((corgibl_flags & CORGIBL_BATTLOW) && intensity > lcd->limit_mask)
+		intensity = lcd->limit_mask;
 
 	return corgi_bl_set_intensity(lcd, intensity);
 }

