commit b29feec9829cfab2523c8d95e35bd69e689ea4af
Author: Michael Niedermayer <michael@niedermayer.cc>
Date:   Mon May 1 18:53:52 2017 +0200

    avcodec/indeo2: Check remaining bits in ir2_decode_plane()
    
    Fixes: 1290/clusterfuzz-testcase-minimized-5815578902134784
    Fixes: timeout
    
    Found-by: continuous fuzzing process https://github.com/google/oss-fuzz/tree/master/targets/ffmpeg
    Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>

diff --git a/libavcodec/indeo2.c b/libavcodec/indeo2.c
index c89845233e..f1324e4635 100644
--- a/libavcodec/indeo2.c
+++ b/libavcodec/indeo2.c
@@ -77,6 +77,8 @@ static int ir2_decode_plane(Ir2Context *ctx, int width, int height, uint8_t *dst
 
     for (j = 1; j < height; j++) {
         out = 0;
+        if (get_bits_left(&ctx->gb) <= 0)
+            return AVERROR_INVALIDDATA;
         while (out < width) {
             int c = ir2_get_code(&ctx->gb);
             if (c >= 0x80) { /* we have a skip */
@@ -116,6 +118,8 @@ static int ir2_decode_plane_inter(Ir2Context *ctx, int width, int height, uint8_
 
     for (j = 0; j < height; j++) {
         out = 0;
+        if (get_bits_left(&ctx->gb) <= 0)
+            return AVERROR_INVALIDDATA;
         while (out < width) {
             c = ir2_get_code(&ctx->gb);
             if (c >= 0x80) { /* we have a skip */

