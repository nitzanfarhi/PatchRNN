commit 193622dada5bc9784c18fb2b81500f5378b6c8e0
Author: david <david@boite>
Date:   Sat Jan 19 15:28:07 2013 +0100

    Dump licence content when reading fails

diff --git a/libfreerdp/core/certificate.c b/libfreerdp/core/certificate.c
index c5834cb5..7a61c800 100644
--- a/libfreerdp/core/certificate.c
+++ b/libfreerdp/core/certificate.c
@@ -531,10 +531,13 @@ BOOL certificate_read_server_x509_certificate_chain(rdpCertificate* certificate,
 			DEBUG_CERTIFICATE("License Server Certificate");
 			ret = certificate_read_x509_certificate(&certificate->x509_cert_chain->array[i], &cert_info);
 			DEBUG_LICENSE("modulus length:%d", (int) cert_info.ModulusLength);
-			if(cert_info.Modulus)
+			if (cert_info.Modulus)
 				free(cert_info.Modulus);
-			if(!ret)
+			if (!ret) {
+				printf("failed to read License Server, content follows:\n");
+				winpr_HexDump(certificate->x509_cert_chain->array[i].data, certificate->x509_cert_chain->array[i].length);
 				return FALSE;
+			}
 		}
 		else if (numCertBlobs - i == 1)
 		{

