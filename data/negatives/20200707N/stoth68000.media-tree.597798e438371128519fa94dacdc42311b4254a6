commit 597798e438371128519fa94dacdc42311b4254a6
Author: Thomas Graf <tgraf@suug.ch>
Date:   Thu Jul 23 13:04:44 2015 +0200

    openvswitch: Retrieve tunnel metadata when receiving from vport-netdev
    
    Retrieve the tunnel metadata for packets received by a net_device and
    provide it to ovs_vport_receive() for flow key extraction.
    
    [This hunk was in the GRE patch in the initial series and missed the
     cut for the initial submission for merging.]
    
    Fixes: 614732eaa12d ("openvswitch: Use regular VXLAN net_device device")
    Signed-off-by: Thomas Graf <tgraf@suug.ch>
    Acked-by: Pravin B Shelar <pshelar@nicira.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/net/openvswitch/vport-netdev.c b/net/openvswitch/vport-netdev.c
index 68d0582fc001..2254b742168f 100644
--- a/net/openvswitch/vport-netdev.c
+++ b/net/openvswitch/vport-netdev.c
@@ -58,7 +58,7 @@ static void netdev_port_receive(struct vport *vport, struct sk_buff *skb)
 	skb_push(skb, ETH_HLEN);
 	ovs_skb_postpush_rcsum(skb, skb->data, ETH_HLEN);
 
-	ovs_vport_receive(vport, skb, NULL);
+	ovs_vport_receive(vport, skb, skb_tunnel_info(skb, AF_INET));
 	return;
 
 error:

