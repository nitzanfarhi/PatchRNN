commit 87124b21d1d0ecace050e7f6808e2a2777929b9e
Author: relan <relan@users.noreply.github.com>
Date:   Thu Mar 31 18:21:09 2011 +0000

    Fix root directory creation: EOD entry was missing.

diff --git a/mkfs/rootdir.c b/mkfs/rootdir.c
index bf24d99..28554f6 100644
--- a/mkfs/rootdir.c
+++ b/mkfs/rootdir.c
@@ -34,12 +34,16 @@ off_t rootdir_size(void)
 
 int rootdir_write(off_t base, int fd)
 {
+	const struct exfat_entry eod_entry = {EXFAT_ENTRY_EOD};
+
 	if (write(fd, &label_entry, sizeof(struct exfat_entry)) == -1)
 		return 1;
 	if (write(fd, &bitmap_entry, sizeof(struct exfat_entry)) == -1)
 		return 1;
 	if (write(fd, &upcase_entry, sizeof(struct exfat_entry)) == -1)
 		return 1;
+	if (write(fd, &eod_entry, sizeof(struct exfat_entry)) == -1)
+		return 1;
 
 	sb.rootdir_cluster = cpu_to_le32(OFFSET_TO_CLUSTER(base));
 	return 0;

