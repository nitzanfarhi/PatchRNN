commit 580021cfc45847d9d0fbbbfe4045c40cc56924bf
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Tue Nov 13 01:05:04 2012 +0100

    wavpack: check ch_offset
    
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavcodec/wavpack.c b/libavcodec/wavpack.c
index 2935abfa8b..b36fa0a28e 100644
--- a/libavcodec/wavpack.c
+++ b/libavcodec/wavpack.c
@@ -789,6 +789,11 @@ static int wavpack_decode_block(AVCodecContext *avctx, int block_no,
         return -1;
     }
 
+    if (wc->ch_offset >= avctx->channels) {
+        av_log(avctx, AV_LOG_ERROR, "too many channels\n");
+        return -1;
+    }
+
     memset(s->decorr, 0, MAX_TERMS * sizeof(Decorr));
     memset(s->ch, 0, sizeof(s->ch));
     s->extra_bits = 0;

