commit 74161ca102f76559e372db82d24b156d2cc732e5
Author: Timo Sirainen <tss@iki.fi>
Date:   Thu Aug 29 01:39:13 2002 +0300

    mail_modifylog_mark_synced() didn't update mmap
    
    --HG--
    branch : HEAD

diff --git a/src/lib-index/mail-modifylog.c b/src/lib-index/mail-modifylog.c
index 990471850..4f65c354c 100644
--- a/src/lib-index/mail-modifylog.c
+++ b/src/lib-index/mail-modifylog.c
@@ -485,6 +485,9 @@ int mail_modifylog_mark_synced(MailModifyLog *log)
 {
 	i_assert(log->index->lock_type != MAIL_LOCK_UNLOCK);
 
+	if (!mmap_update(log))
+		return FALSE;
+
 	if (log->header->sync_id == SYNC_ID_FULL) {
 		/* log file is full, switch to next one */
 		return mail_modifylog_switch_file(log);

