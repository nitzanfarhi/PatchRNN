commit 7b6147e438c42cf243b14f548c0739064fc720c8
Author: Bron Gondwana <brong@fastmail.fm>
Date:   Mon Jan 11 10:16:50 2016 +1100

    propfind_principal: don't stomp on p

diff --git a/imap/http_dav.c b/imap/http_dav.c
index 3faa4e974..e4d3bb713 100644
--- a/imap/http_dav.c
+++ b/imap/http_dav.c
@@ -436,9 +436,9 @@ static int principal_parse_path(const char *path, struct request_target_t *tgt,
         tgt->userid = xstrndup(p, len);
 
         if (httpd_extradomain) {
-            p = strchr(tgt->userid, '@');
-            if (p && !strcmp(p+1, httpd_extradomain))
-                *p = 0;
+            char *at = strchr(tgt->userid, '@');
+            if (at && !strcmp(at+1, httpd_extradomain))
+                *at = 0;
         }
 
         p += len;

