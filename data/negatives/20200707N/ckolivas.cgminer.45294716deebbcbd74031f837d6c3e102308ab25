commit 45294716deebbcbd74031f837d6c3e102308ab25
Author: Mikeqin <Fengling.Qin@gmail.com>
Date:   Fri May 29 16:54:06 2015 +0800

    Display MW in avalon miner status

diff --git a/driver-avalon-miner.c b/driver-avalon-miner.c
index 620f618c..92a0bf15 100644
--- a/driver-avalon-miner.c
+++ b/driver-avalon-miner.c
@@ -192,6 +192,7 @@ static void process_nonce(struct cgpu_info *avalonm, uint8_t *report)
 		info->hw_work[chip_id]++;
 	}
 
+	info->matching_work[chip_id]++;
 	free_work(work);
 	info->nonce_cnts++;
 }
@@ -421,6 +422,7 @@ static struct cgpu_info *avalonm_detect_one(struct libusb_device *dev, struct us
 	info->freq_set = 0;
 	FLAG_SET(info->freq_set, AVAM_ASIC_ALL);
 	memset(info->hw_work, 0, sizeof(int) * info->asic_cnts);
+	memset(info->matching_work, 0, sizeof(uint64_t) * info->asic_cnts);
 
 	return avalonm;
 }
@@ -1036,6 +1038,13 @@ static struct api_data *avalonm_api_stats(struct cgpu_info *cgpu)
 	}
 	statbuf[strlen(statbuf) - 1] = ']';
 
+	strcat(statbuf, " MW[");
+	for (i = 0; i < info->asic_cnts; i++) {
+		sprintf(buf, "%ld ", info->matching_work[i]);
+		strcat(statbuf, buf);
+	}
+	statbuf[strlen(statbuf) - 1] = ']';
+
 	sprintf(buf, " Led[%d]", info->led_status);
 	strcat(statbuf, buf);
 
diff --git a/driver-avalon-miner.h b/driver-avalon-miner.h
index 95f3ee60..507357d0 100644
--- a/driver-avalon-miner.h
+++ b/driver-avalon-miner.h
@@ -102,6 +102,7 @@ struct avalonm_info {
 	uint8_t freq_update;
 	uint8_t freq_set;
 	int hw_work[AVAM_DEFAULT_ASIC_COUNT];
+	uint64_t matching_work[AVAM_DEFAULT_ASIC_COUNT];
 };
 
 #define AVAM_WRITE_SIZE (sizeof(struct avalonm_pkg))

