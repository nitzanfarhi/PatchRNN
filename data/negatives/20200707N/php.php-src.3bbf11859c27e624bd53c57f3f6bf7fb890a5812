commit 3bbf11859c27e624bd53c57f3f6bf7fb890a5812
Author: Antony Dovgal <tony2001@php.net>
Date:   Mon Dec 25 22:27:12 2006 +0000

    more safe_emalloc()

diff --git a/ext/xsl/xsltprocessor.c b/ext/xsl/xsltprocessor.c
index db18723aeb..58d8c7f595 100644
--- a/ext/xsl/xsltprocessor.c
+++ b/ext/xsl/xsltprocessor.c
@@ -88,7 +88,7 @@ static char **php_xsl_xslt_make_params(HashTable *parht, int xpath_params TSRMLS
 	zstr string_key = NULL_ZSTR;
 
 	parsize = (2 * zend_hash_num_elements(parht) + 1) * sizeof(char *);
-	params = (char **)emalloc(parsize);
+	params = (char **)safe_emalloc((2 * zend_hash_num_elements(parht) + 1), sizeof(char *), 0);
 	memset((char *)params, 0, parsize);
 
 	for (zend_hash_internal_pointer_reset(parht);

