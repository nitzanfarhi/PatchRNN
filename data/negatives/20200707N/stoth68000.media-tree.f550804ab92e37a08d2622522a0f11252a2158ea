commit f550804ab92e37a08d2622522a0f11252a2158ea
Author: Amit Shah <amit.shah@redhat.com>
Date:   Mon Jan 18 19:14:59 2010 +0530

    virtio: console: We support only one device at a time
    
    We support only one virtio_console device at a time. If multiple are
    found, error out if one is already initialized.
    
    Signed-off-by: Amit Shah <amit.shah@redhat.com>
    Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>

diff --git a/drivers/char/virtio_console.c b/drivers/char/virtio_console.c
index 791be4e91d15..bfc0abf825ed 100644
--- a/drivers/char/virtio_console.c
+++ b/drivers/char/virtio_console.c
@@ -204,6 +204,11 @@ static int __devinit virtcons_probe(struct virtio_device *dev)
 	struct virtqueue *vqs[2];
 	int err;
 
+	if (vdev) {
+		dev_warn(&vdev->dev,
+			 "Multiple virtio-console devices not supported yet\n");
+		return -EEXIST;
+	}
 	vdev = dev;
 
 	/* This is the scratch page we use to receive console input */

