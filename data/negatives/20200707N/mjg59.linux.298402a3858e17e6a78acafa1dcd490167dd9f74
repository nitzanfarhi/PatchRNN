commit 298402a3858e17e6a78acafa1dcd490167dd9f74
Author: Takashi Iwai <tiwai@suse.de>
Date:   Mon Oct 28 14:21:50 2013 +0100

    ASoC: dapm: Return -ENOMEM in snd_soc_dapm_new_dai_widgets()
    
    ... instead of NULL dereferences.
    
    Spotted by coverity CID 402004.
    
    Signed-off-by: Takashi Iwai <tiwai@suse.de>
    Signed-off-by: Mark Brown <broonie@linaro.org>

diff --git a/sound/soc/soc-dapm.c b/sound/soc/soc-dapm.c
index e650e995a8e6..b2949aed1ac2 100644
--- a/sound/soc/soc-dapm.c
+++ b/sound/soc/soc-dapm.c
@@ -3495,6 +3495,7 @@ int snd_soc_dapm_new_dai_widgets(struct snd_soc_dapm_context *dapm,
 		if (!w) {
 			dev_err(dapm->dev, "ASoC: Failed to create %s widget\n",
 				dai->driver->playback.stream_name);
+			return -ENOMEM;
 		}
 
 		w->priv = dai;
@@ -3513,6 +3514,7 @@ int snd_soc_dapm_new_dai_widgets(struct snd_soc_dapm_context *dapm,
 		if (!w) {
 			dev_err(dapm->dev, "ASoC: Failed to create %s widget\n",
 				dai->driver->capture.stream_name);
+			return -ENOMEM;
 		}
 
 		w->priv = dai;

