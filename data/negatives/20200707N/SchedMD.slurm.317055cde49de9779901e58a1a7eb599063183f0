commit 317055cde49de9779901e58a1a7eb599063183f0
Author: Christopher J. Morrone <morrone2@llnl.gov>
Date:   Thu Apr 27 19:14:40 2006 +0000

    Fix ifdef

diff --git a/src/slurmd/slurmstepd/pam_ses.c b/src/slurmd/slurmstepd/pam_ses.c
index a1d2c58580..c0dd617e37 100644
--- a/src/slurmd/slurmstepd/pam_ses.c
+++ b/src/slurmd/slurmstepd/pam_ses.c
@@ -34,7 +34,7 @@
 #include "src/common/log.h"
 #include "src/slurmd/slurmd/slurmd.h"
 
-#ifdef conf->use_pam
+#ifdef HAVE_PAM
 
 #include <security/pam_appl.h>
 #include <security/pam_misc.h>
@@ -65,6 +65,8 @@ pam_setup (char *user, char *host)
 	struct pam_conv conv = {misc_conv, NULL};
         int             rc = 0;
 
+	if (!conf->use_pam)
+		return SLURM_SUCCESS;
 	/*
 	 * SLURM uses PAM to obtain resource limits established by the system
 	 * administrator. PAM's session management library is responsible for

