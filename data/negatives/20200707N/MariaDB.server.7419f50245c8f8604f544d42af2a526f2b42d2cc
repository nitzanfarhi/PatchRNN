commit 7419f50245c8f8604f544d42af2a526f2b42d2cc
Author: istruewing@chilla.local <>
Date:   Tue Sep 19 14:26:18 2006 +0200

    After merge fix.

diff --git a/sql/sql_select.cc b/sql/sql_select.cc
index 86c48ecbdd1..79ce8556e51 100644
--- a/sql/sql_select.cc
+++ b/sql/sql_select.cc
@@ -13231,14 +13231,15 @@ setup_copy_fields(THD *thd, TMP_TABLE_PARAM *param,
 	tmp= (char*) sql_alloc(field->pack_length()+2);
 	if (!tmp)
 	  goto err;
-      if (copy)
-      {
-        copy->set(tmp, item->result_field);
-        item->result_field->move_field(copy->to_ptr,copy->to_null_ptr,1);
+        if (copy)
+        {
+          copy->set(tmp, item->result_field);
+          item->result_field->move_field(copy->to_ptr,copy->to_null_ptr,1);
 #ifdef HAVE_purify
-        copy->to_ptr[copy->from_length]= 0;
+          copy->to_ptr[copy->from_length]= 0;
 #endif
-        copy++;
+          copy++;
+        }
       }
     }
     else if ((real_pos->type() == Item::FUNC_ITEM ||

