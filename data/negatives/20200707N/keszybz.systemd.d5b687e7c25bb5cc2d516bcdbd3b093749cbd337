commit d5b687e7c25bb5cc2d516bcdbd3b093749cbd337
Author: Lennart Poettering <lennart@poettering.net>
Date:   Mon Feb 22 16:28:17 2016 +0100

    virt: make sure we don't ignore some errors

diff --git a/src/basic/virt.c b/src/basic/virt.c
index 19b6318e3..79387007f 100644
--- a/src/basic/virt.c
+++ b/src/basic/virt.c
@@ -201,6 +201,8 @@ static int detect_vm_xen(void) {
         r = read_one_line_file("/proc/xen/capabilities", &domcap);
         if (r == -ENOENT)
                 return VIRTUALIZATION_NONE;
+        if (r < 0)
+                return r;
 
         i = domcap;
         while ((cap = strsep(&i, ",")))

