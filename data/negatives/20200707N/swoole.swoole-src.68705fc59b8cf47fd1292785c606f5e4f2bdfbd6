commit 68705fc59b8cf47fd1292785c606f5e4f2bdfbd6
Author: matyhtf <mikan.tenny@gmail.com>
Date:   Sat Jan 20 17:54:51 2018 +0800

    fixed #1459

diff --git a/swoole_mysql_coro.c b/swoole_mysql_coro.c
index d13da40a..888d296d 100644
--- a/swoole_mysql_coro.c
+++ b/swoole_mysql_coro.c
@@ -1026,6 +1026,11 @@ static PHP_METHOD(swoole_mysql_coro, escape)
     }
 
     const MYSQLND_CHARSET* cset = mysqlnd_find_charset_nr(client->connector.character_set);
+    if (cset == NULL)
+    {
+        swoole_php_fatal_error(E_ERROR, "unknown mysql charset[%s].", client->connector.character_set);
+        RETURN_FALSE;
+    }
     int newstr_len = mysqlnd_cset_escape_slashes(cset, newstr, str.str, str.length TSRMLS_CC);
     if (newstr_len < 0)
     {

