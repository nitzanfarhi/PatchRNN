commit 83c43e4d52dadc08c38f5f42bf6cdf1e2e72b11c
Author: Andreas Öman <andreas@olebyn.nu>
Date:   Thu Jul 19 15:56:56 2007 +0000

    bail out on unknown jpeg pixel format instead of silently decoding data incorrectly
    patch by Andreas Öman % andreas A olebyn P nu %
    Original thread:
    date: Jul 19, 2007 4:50 PM
    subject: [FFmpeg-devel] [PATCH] bail out on unknown jpeg pixel format
    
    Originally committed as revision 9764 to svn://svn.ffmpeg.org/ffmpeg/trunk

diff --git a/libavcodec/mjpegdec.c b/libavcodec/mjpegdec.c
index d65a3463c..aa8d2e4f6 100644
--- a/libavcodec/mjpegdec.c
+++ b/libavcodec/mjpegdec.c
@@ -305,10 +305,12 @@ int ff_mjpeg_decode_sof(MJpegDecodeContext *s)
     case 0x221212:
         s->avctx->pix_fmt = s->cs_itu601 ? PIX_FMT_YUV422P : PIX_FMT_YUVJ422P;
         break;
-    default:
     case 0x221111:
         s->avctx->pix_fmt = s->cs_itu601 ? PIX_FMT_YUV420P : PIX_FMT_YUVJ420P;
         break;
+    default:
+        av_log(s->avctx, AV_LOG_ERROR, "Unhandled pixel format 0x%x\n", pix_fmt_id);
+        return -1;
     }
     if(s->ls){
         if(s->nb_components > 1)

