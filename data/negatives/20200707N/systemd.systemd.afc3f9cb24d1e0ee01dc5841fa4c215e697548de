commit afc3f9cb24d1e0ee01dc5841fa4c215e697548de
Author: Kay Sievers <kay@vrfy.org>
Date:   Tue Jul 1 12:25:38 2014 +0200

    base-filesystem: avoid all searching if the link already exists

diff --git a/src/shared/base-filesystem.c b/src/shared/base-filesystem.c
index f68386b8e..daaeaca51 100644
--- a/src/shared/base-filesystem.c
+++ b/src/shared/base-filesystem.c
@@ -65,6 +65,9 @@ int base_filesystem_create(const char *root) {
                         const char *target = NULL;
                         const char *s;
 
+                        if (faccessat(fd, table[i].dir, F_OK, AT_SYMLINK_NOFOLLOW) >= 0)
+                                continue;
+
                         /* check if one of the targets exists */
                         NULSTR_FOREACH(s, table[i].target) {
                                 if (faccessat(fd, s, F_OK, AT_SYMLINK_NOFOLLOW) < 0)

