commit a9899996c8bc8eb7686f64207ef2ce1137dd125b
Author: Alexander Graf <agraf@suse.de>
Date:   Sat Jun 4 07:25:59 2011 +0200

    slirp: fix guestfwd id
    
    When using -net user,guestfwd=... Qemu immediately complains about the id
    being in invalid format. This is because we pass in an id that contains a
    colon, while the id restrictions don't allow colons.
    
    This patch changes the colon into a dot, making guestfwd work again.
    
    Signed-off-by: Alexander Graf <agraf@suse.de>
    Signed-off-by: Stefan Hajnoczi <stefanha@linux.vnet.ibm.com>

diff --git a/net/slirp.c b/net/slirp.c
index e387a116ad..e057a14ce9 100644
--- a/net/slirp.c
+++ b/net/slirp.c
@@ -614,7 +614,7 @@ static int slirp_guestfwd(SlirpState *s, const char *config_str,
     }
 
     fwd = qemu_malloc(sizeof(struct GuestFwd));
-    snprintf(buf, sizeof(buf), "guestfwd.tcp:%d", port);
+    snprintf(buf, sizeof(buf), "guestfwd.tcp.%d", port);
     fwd->hd = qemu_chr_open(buf, p, NULL);
     if (!fwd->hd) {
         error_report("could not open guest forwarding device '%s'", buf);

