commit 204c0f48f467ca9e08cd2032bacbac77af468aec
Author: Philip Gladstone <philipjsg@users.sourceforge.net>
Date:   Fri Jan 17 04:14:50 2003 +0000

    When doing -vstats and also changing the frame rate, then don't count (and
    report) frames that are dropped.
    
    Originally committed as revision 1465 to svn://svn.ffmpeg.org/ffmpeg/trunk

diff --git a/ffmpeg.c b/ffmpeg.c
index 0dabfd09c4..2cac717a5e 100644
--- a/ffmpeg.c
+++ b/ffmpeg.c
@@ -532,6 +532,8 @@ static void do_video_out(AVFormatContext *s,
     /* by default, we output a single frame */
     nb_frames = 1;
 
+    *frame_size = 0;
+
     /* NOTE: the A/V sync is always done by considering the audio is
        the master clock. It is suffisant for transcoding or playing,
        but not for the general case */
@@ -1401,7 +1403,7 @@ static int av_encode(AVFormatContext **output_files,
                                 }
 
                                 do_video_out(os, ost, ist, &picture, &frame_size, audio_sync);
-                                if (do_vstats)
+                                if (do_vstats && frame_size)
                                     do_video_stats(os, ost, frame_size);
                             }
                             break;

