commit 616570eba26a21b5dd68d1086eab76bc9d109117
Author: Kevin Lin <klin@sourcefire.com>
Date:   Wed Mar 23 14:16:00 2016 -0400

    bb#11529 - freshclam manager check return code of strdup

diff --git a/freshclam/manager.c b/freshclam/manager.c
index d7b1abfc0..b9f626842 100644
--- a/freshclam/manager.c
+++ b/freshclam/manager.c
@@ -2820,6 +2820,12 @@ downloadmanager (const struct optstruct *opts, const char *hostname,
         {
             char *cmd = strdup (opt->strarg);
 
+            if (!cmd)
+            {
+                free (newver);
+                return FCE_MEM;
+            }
+
             if ((pt = newver))
             {
                 while (*pt)
@@ -2857,6 +2863,11 @@ downloadmanager (const struct optstruct *opts, const char *hostname,
                 free (cmd);
                 cmd = strdup (buffer);
                 free (buffer);
+                if (!cmd)
+                {
+                    free (newver);
+                    return FCE_MEM;
+                }
             }
 
             if (newver)

