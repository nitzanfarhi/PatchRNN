commit f8aa15728ba960137faf77b298fa60c1e63dc50f
Author: Bernd Edlinger <bernd.edlinger@hotmail.de>
Date:   Tue Feb 21 06:58:04 2017 +0100

    Check that async_jobs is not negative and not too high.
    
    Reviewed-by: Matt Caswell <matt@openssl.org>
    Reviewed-by: Rich Salz <rsalz@openssl.org>
    (Merged from https://github.com/openssl/openssl/pull/2693)

diff --git a/apps/speed.c b/apps/speed.c
index c10a8ee197..50522ae25a 100644
--- a/apps/speed.c
+++ b/apps/speed.c
@@ -1214,7 +1214,7 @@ int speed_main(int argc, char **argv)
 #ifndef NO_FORK
     int multi = 0;
 #endif
-    int async_jobs = 0;
+    unsigned int async_jobs = 0;
 #if !defined(OPENSSL_NO_RSA) || !defined(OPENSSL_NO_DSA) \
     || !defined(OPENSSL_NO_EC)
     long rsa_count = 1;
@@ -1393,6 +1393,12 @@ int speed_main(int argc, char **argv)
                            prog);
                 goto opterr;
             }
+            if (async_jobs > 99999) {
+                BIO_printf(bio_err,
+                           "%s: too many async_jobs\n",
+                           prog);
+                goto opterr;
+            }
 #endif
             break;
         case OPT_MISALIGN:

