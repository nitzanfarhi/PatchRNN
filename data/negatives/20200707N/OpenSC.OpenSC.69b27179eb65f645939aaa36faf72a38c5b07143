commit 69b27179eb65f645939aaa36faf72a38c5b07143
Author: Frank Morgner <morgner@informatik.hu-berlin.de>
Date:   Sun Dec 7 11:32:14 2014 +0100

    use path only if it is actually present

diff --git a/src/libopensc/dir.c b/src/libopensc/dir.c
index 8281fbc6..4a3b1485 100644
--- a/src/libopensc/dir.c
+++ b/src/libopensc/dir.c
@@ -91,7 +91,7 @@ parse_dir_record(sc_card_t *card, u8 ** buf, size_t *buflen, int rec_nr)
 	else
 		app->label = NULL;
 
-	if (asn1_dirrecord[2].flags & SC_ASN1_PRESENT) {
+	if (asn1_dirrecord[2].flags & SC_ASN1_PRESENT && path_len > 0) {
 		/* application path present: ignore AID */
 		if (path_len > SC_MAX_PATH_SIZE) {
 			free(app);

