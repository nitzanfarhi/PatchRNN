commit 04d465bec864ffeba162ebd5bc189cfe39ab120a
Author: Alex Tutubalin <lexa@lexa.ru>
Date:   Sat Sep 6 17:49:52 2014 +0400

    recursive DNG-makernotes parser removed

diff --git a/dcraw/dcraw.c b/dcraw/dcraw.c
index e47452d..b6c7323 100644
--- a/dcraw/dcraw.c
+++ b/dcraw/dcraw.c
@@ -7471,36 +7471,6 @@ guess_cfa_pc:
         break;
 #endif
       case 50740:			/* DNGPrivateData */
-        {
-          char mbuf[64];
-          unsigned short makernote_found = 0;
-          unsigned curr_pos, start_pos = ftell(ifp);
-          unsigned MakN_order, m_sorder = order;
-          unsigned MakN_length;
-          unsigned pos_in_original_raw;
-          order = 0x4d4d;											// Adobe header is always in "MM" / big endian
-          if (!strncmp(software, "Adobe DNG Converter ",20)) {
-            fread (mbuf, 1, 6, ifp);
-            if (!strcmp(mbuf, "Adobe")) {
-              curr_pos = start_pos + 6;
-              while (curr_pos + 8 <= len) {
-                fread (mbuf, 1, 4, ifp);
-                curr_pos += 8;
-                if (!strncmp(mbuf, "MakN", 4)) {
-                  makernote_found = 1;
-                  MakN_length = get4();
-                  MakN_order = get2();
-                  pos_in_original_raw = get4();
-                  order = MakN_order;
-                  parse_makernote(curr_pos + 6 - pos_in_original_raw, 0);
-                  break;
-                }
-              }
-            }
-          }
-          if (!makernote_found) fseek(ifp, start_pos, SEEK_SET);
-          order = m_sorder;
-        }
 	if (dng_version) break;
 	parse_minolta (j = get4()+base);
 	fseek (ifp, j, SEEK_SET);
diff --git a/internal/dcraw_common.cpp b/internal/dcraw_common.cpp
index 183af11..7b68cbd 100644
--- a/internal/dcraw_common.cpp
+++ b/internal/dcraw_common.cpp
@@ -6290,36 +6290,6 @@ guess_cfa_pc:
         break;
 #endif
       case 50740:			/* DNGPrivateData */
-        {
-          char mbuf[64];
-          unsigned short makernote_found = 0;
-          unsigned curr_pos, start_pos = ftell(ifp);
-          unsigned MakN_order, m_sorder = order;
-          unsigned MakN_length;
-          unsigned pos_in_original_raw;
-          order = 0x4d4d;											// Adobe header is always in "MM" / big endian
-          if (!strncmp(software, "Adobe DNG Converter ",20)) {
-            fread (mbuf, 1, 6, ifp);
-            if (!strcmp(mbuf, "Adobe")) {
-              curr_pos = start_pos + 6;
-              while (curr_pos + 8 <= len) {
-                fread (mbuf, 1, 4, ifp);
-                curr_pos += 8;
-                if (!strncmp(mbuf, "MakN", 4)) {
-                  makernote_found = 1;
-                  MakN_length = get4();
-                  MakN_order = get2();
-                  pos_in_original_raw = get4();
-                  order = MakN_order;
-                  parse_makernote(curr_pos + 6 - pos_in_original_raw, 0);
-                  break;
-                }
-              }
-            }
-          }
-          if (!makernote_found) fseek(ifp, start_pos, SEEK_SET);
-          order = m_sorder;
-        }
 	if (dng_version) break;
 	parse_minolta (j = get4()+base);
 	fseek (ifp, j, SEEK_SET);
diff --git a/internal/dcraw_fileio.cpp b/internal/dcraw_fileio.cpp
index 9eea049..85b7dda 100644
--- a/internal/dcraw_fileio.cpp
+++ b/internal/dcraw_fileio.cpp
@@ -154,7 +154,7 @@ void CLASS subtract (const char *fname)
   RUN_CALLBACK(LIBRAW_PROGRESS_DARK_FRAME,1,2);
 #endif
 }
-#line 11012 "dcraw/dcraw.c"
+#line 10982 "dcraw/dcraw.c"
 #ifndef NO_LCMS
 void CLASS apply_profile (const char *input, const char *output)
 {

