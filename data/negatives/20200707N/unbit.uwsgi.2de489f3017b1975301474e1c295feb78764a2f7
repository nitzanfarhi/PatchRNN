commit 2de489f3017b1975301474e1c295feb78764a2f7
Author: roberto@maverick64 <roberto@maverick64>
Date:   Sat Jul 2 19:49:12 2011 +0200

    fixed uwsgi_log_verbose

diff --git a/utils.c b/utils.c
index 2bc20497..2c2109b3 100644
--- a/utils.c
+++ b/utils.c
@@ -972,13 +972,26 @@ void uwsgi_log_verbose(const char *fmt, ...) {
 	int rlen = 0;
 
 	struct timeval tv;
+	char sftime[64];
+        time_t now;
 
-	gettimeofday(&tv, NULL);
+		if (uwsgi.log_strftime) {
+                        now = time(NULL);
+                        rlen = strftime(sftime, 64, uwsgi.log_strftime, localtime(&now));
+                        memcpy(logpkt, sftime, rlen);
+                        memcpy(logpkt + rlen, " - ", 3);
+                        rlen += 3;
+                }
+                else {
+                        gettimeofday(&tv, NULL);
 
-	memcpy(logpkt, ctime((const time_t *) &tv.tv_sec), 24);
-	memcpy(logpkt + 24, " - ", 3);
+                        memcpy(logpkt, ctime((const time_t *) &tv.tv_sec), 24);
+                        memcpy(logpkt + 24, " - ", 3);
+
+                        rlen = 24 + 3;
+                }
+	
 
-	rlen = 24 + 3;
 
 	va_start(ap, fmt);
 	rlen += vsnprintf(logpkt + rlen, 4096 - rlen, fmt, ap);

