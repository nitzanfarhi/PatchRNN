commit c1301a486217f0027e11ae90816006f723bf4b9e
Author: Dario Lombardo <lomato@gmail.com>
Date:   Fri Jan 12 10:06:12 2018 +0100

    extcap: add more checks for extcap disabled.
    
    Change-Id: I914efbb4293518a8a3f8aaa8739c9915c63d941c
    Reviewed-on: https://code.wireshark.org/review/25278
    Petri-Dish: Roland Knall <rknall@gmail.com>
    Reviewed-by: Roland Knall <rknall@gmail.com>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Anders Broman <a.broman58@gmail.com>

diff --git a/extcap.c b/extcap.c
index 44ed5b5ad2..26a8173ca3 100644
--- a/extcap.c
+++ b/extcap.c
@@ -567,6 +567,9 @@ extcap_register_preferences_callback(gpointer key, gpointer value _U_, gpointer
 
 void extcap_register_preferences(void)
 {
+    if (prefs.capture_no_extcap)
+        return;
+
     module_t *dev_module = prefs_find_module("extcap");
 
     if (!dev_module)
@@ -1664,6 +1667,9 @@ extcap_load_interface_list(void)
     gchar *argv;
     gchar *error;
 
+    if (prefs.capture_no_extcap)
+        return;
+
     if (_toolbars)
     {
         // Remove existing interface toolbars here instead of in extcap_clear_interfaces()

