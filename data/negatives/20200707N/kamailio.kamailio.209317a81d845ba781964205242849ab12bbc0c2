commit 209317a81d845ba781964205242849ab12bbc0c2
Author: Andrew Mortensen <admorten@isc.upenn.edu>
Date:   Fri Nov 30 21:38:48 2012 -0500

    sca: fix snprintf buffer size for Expires header in replies to SUBSCRIBE.
    
    - reported by Robert Boisvert.

diff --git a/modules/sca/sca_reply.c b/modules/sca/sca_reply.c
index 57e0cfc98..dfe66e496 100644
--- a/modules/sca/sca_reply.c
+++ b/modules/sca/sca_reply.c
@@ -67,7 +67,7 @@ sca_reply( sca_mod *scam, int status_code, char *status_msg,
 	SCA_STR_COPY_CSTR( &extra_headers, "Expires: " );
 
 	len = snprintf( extra_headers.s + extra_headers.len,
-		  sizeof( hdr_buf - extra_headers.len ),
+		  sizeof( hdr_buf ) - extra_headers.len,
 		  "%d%s", expires, CRLF );
 	extra_headers.len += len;
 

