commit 158dfd40aa01fca558b6861b61dfb87c04d358fa
Author: xsa <xsa@openbsd.org>
Date:   Fri Jan 5 09:41:30 2007 +0000

    for edit: create the CVS/Base directory if it does not already exist.

diff --git a/usr.bin/cvs/edit.c b/usr.bin/cvs/edit.c
index c99e6bc5c85..64e703d9259 100644
--- a/usr.bin/cvs/edit.c
+++ b/usr.bin/cvs/edit.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: edit.c,v 1.21 2007/01/05 09:32:49 xsa Exp $	*/
+/*	$OpenBSD: edit.c,v 1.22 2007/01/05 09:41:30 xsa Exp $	*/
 /*
  * Copyright (c) 2006, 2007 Xavier Santolaria <xsa@openbsd.org>
  *
@@ -289,6 +289,10 @@ cvs_edit_local(struct cvs_file *cf)
 	    MAXPATHLEN) >= MAXPATHLEN)
 		fatal("cvs_edit_local: truncation");
 
+	if (mkdir(CVS_PATH_BASEDIR, 0755) == -1 && errno != EEXIST)
+		fatal("cvs_edit_local: `%s': %s", CVS_PATH_BASEDIR,
+		    strerror(errno));
+
 	/* XXX: copy cf->file_path to bfpath */
 
 	xfree(bfpath);

