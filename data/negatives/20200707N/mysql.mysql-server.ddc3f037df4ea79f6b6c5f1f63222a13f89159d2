commit ddc3f037df4ea79f6b6c5f1f63222a13f89159d2
Author: Nisha Gopalakrishnan <nisha.gopalakrishnan@oracle.com>
Date:   Fri Aug 4 13:30:24 2017 +0530

    Bug#26438067: CRASH ON EVENT_SCHEDULER::START WITH
                  --THREAD_STACK=123456789012345
    
    Analysis
    ========
    Server exits when it is started with an abnormal
    'thread_stack' size.
    
    The problem is observed during an attempt to free an
    already freed memory. With the P_S enabled, when the
    thread creation fails due to the abnormal thread stack
    size, the instrumented 'scheduler_param_value' is freed.
    The subsequent clean up in 'Event_scheduler::start'
    results in double free of the memory.
    
    Fix
    ===
    The clean up in 'Event_scheduler::start' now uses
    my_free() to prevent double free during clean up.

diff --git a/sql/event_scheduler.cc b/sql/event_scheduler.cc
index 1f23eeb30b2..9e6e4a26d3b 100644
--- a/sql/event_scheduler.cc
+++ b/sql/event_scheduler.cc
@@ -550,7 +550,7 @@ Event_scheduler::start(int *err_no)
     scheduler_thd= NULL;
     delete new_thd;
 
-    delete scheduler_param_value;
+    my_free(scheduler_param_value);
     ret= true;
   }
 

