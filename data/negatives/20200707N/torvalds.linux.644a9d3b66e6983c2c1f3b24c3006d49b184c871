commit 644a9d3b66e6983c2c1f3b24c3006d49b184c871
Author: Axel Lin <axel.lin@ingics.com>
Date:   Fri Nov 16 17:17:50 2012 +0800

    misc: apds9802als: Fix the logic checking timeout in als_wait_for_data_ready()
    
    In the case of timeout waiting for data ready, the retry variable is -1.
    This also fixes a bug: current code returns -ETIMEDOUT if latest retry success
    ( which means retry is 0 when exiting the while loop ).
    
    Signed-off-by: Axel Lin <axel.lin@ingics.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

diff --git a/drivers/misc/apds9802als.c b/drivers/misc/apds9802als.c
index 0314773f6db3..94923d259910 100644
--- a/drivers/misc/apds9802als.c
+++ b/drivers/misc/apds9802als.c
@@ -68,7 +68,7 @@ static int als_wait_for_data_ready(struct device *dev)
 		ret = i2c_smbus_read_byte_data(client, 0x86);
 	} while (!(ret & 0x80) && retry--);
 
-	if (!retry) {
+	if (retry < 0) {
 		dev_warn(dev, "timeout waiting for data ready\n");
 		return -ETIMEDOUT;
 	}

