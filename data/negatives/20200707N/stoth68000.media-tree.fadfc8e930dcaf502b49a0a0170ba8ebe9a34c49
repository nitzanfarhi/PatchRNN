commit fadfc8e930dcaf502b49a0a0170ba8ebe9a34c49
Author: Akinobu Mita <akinobu.mita@gmail.com>
Date:   Fri Dec 22 01:10:09 2006 -0800

    [PATCH] gss_spkm3: fix error handling in module init
    
    Return error and prevent from loading module when gss_mech_register()
    failed.
    
    Cc: Andy Adamson <andros@citi.umich.edu>
    Cc: J. Bruce Fields <bfields@citi.umich.edu>
    Acked-by: Trond Myklebust <Trond.Myklebust@netapp.com>
    Signed-off-by: Akinobu Mita <akinobu.mita@gmail.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

diff --git a/net/sunrpc/auth_gss/gss_spkm3_mech.c b/net/sunrpc/auth_gss/gss_spkm3_mech.c
index 41465072d0b5..8ef3f1c19435 100644
--- a/net/sunrpc/auth_gss/gss_spkm3_mech.c
+++ b/net/sunrpc/auth_gss/gss_spkm3_mech.c
@@ -228,7 +228,7 @@ static int __init init_spkm3_module(void)
 	status = gss_mech_register(&gss_spkm3_mech);
 	if (status)
 		printk("Failed to register spkm3 gss mechanism!\n");
-	return 0;
+	return status;
 }
 
 static void __exit cleanup_spkm3_module(void)

