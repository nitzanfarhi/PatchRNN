commit f4552c2d248e9d9f6f728ea32eb25f600d3d6cd6
Author: David Howells <dhowells@redhat.com>
Date:   Fri Jun 17 11:00:48 2016 +0100

    rxrpc: Validate the net address given to rxrpc_kernel_begin_call()
    
    Validate the net address given to rxrpc_kernel_begin_call() before using
    it.
    
    Whilst this should be mostly unnecessary for in-kernel users, it does clear
    the tail of the address struct in case we want to hash or compare the whole
    thing.
    
    Signed-off-by: David Howells <dhowells@redhat.com>

diff --git a/net/rxrpc/af_rxrpc.c b/net/rxrpc/af_rxrpc.c
index 408bd024125b..b29bb50af5de 100644
--- a/net/rxrpc/af_rxrpc.c
+++ b/net/rxrpc/af_rxrpc.c
@@ -280,9 +280,14 @@ struct rxrpc_call *rxrpc_kernel_begin_call(struct socket *sock,
 	struct rxrpc_transport *trans;
 	struct rxrpc_call *call;
 	struct rxrpc_sock *rx = rxrpc_sk(sock->sk);
+	int ret;
 
 	_enter(",,%x,%lx", key_serial(key), user_call_ID);
 
+	ret = rxrpc_validate_address(rx, srx, sizeof(*srx));
+	if (ret < 0)
+		return ERR_PTR(ret);
+
 	lock_sock(&rx->sk);
 
 	if (!key)

