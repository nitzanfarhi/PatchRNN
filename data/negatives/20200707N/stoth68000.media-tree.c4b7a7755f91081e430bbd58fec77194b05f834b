commit c4b7a7755f91081e430bbd58fec77194b05f834b
Author: Richard Guy Briggs <rgb@redhat.com>
Date:   Wed Jan 13 09:15:18 2016 -0500

    audit: don't needlessly reset valid wait time
    
    After auditd has recovered from an overflowed queue, the first process
    that doesn't use reserves to make it through the queue checks should
    reset the audit backlog wait time to the configured value.  After that,
    there is no need to keep resetting it.
    
    Signed-off-by: Richard Guy Briggs <rgb@redhat.com>
    Signed-off-by: Paul Moore <pmoore@redhat.com>

diff --git a/kernel/audit.c b/kernel/audit.c
index 5ffcbd354a52..6d00bd1ff249 100644
--- a/kernel/audit.c
+++ b/kernel/audit.c
@@ -1400,7 +1400,7 @@ struct audit_buffer *audit_log_start(struct audit_context *ctx, gfp_t gfp_mask,
 		return NULL;
 	}
 
-	if (!reserve)
+	if (!reserve && !audit_backlog_wait_time)
 		audit_backlog_wait_time = audit_backlog_wait_time_master;
 
 	ab = audit_buffer_alloc(ctx, gfp_mask, type);

