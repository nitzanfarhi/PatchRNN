commit f1ed34a9145f18b2bda0e3bfb32d38b35b862b1c
Author: mikeb <mikeb@openbsd.org>
Date:   Fri Jun 23 19:07:13 2017 +0000

    Request deferred interrupt processing

diff --git a/sys/dev/pv/hvs.c b/sys/dev/pv/hvs.c
index 5acac166ea4..02b731f44d9 100644
--- a/sys/dev/pv/hvs.c
+++ b/sys/dev/pv/hvs.c
@@ -275,6 +275,11 @@ hvs_attach(struct device *parent, struct device *self, void *aux)
 	if (strcmp("scsi", aa->aa_ident) == 0)
 		sc->sc_flags |= HVSF_SCSI;
 
+	if (hv_channel_setdeferred(sc->sc_chan, sc->sc_dev.dv_xname)) {
+		printf(": failed to create the interrupt thread\n");
+		return;
+	}
+
 	if (hv_channel_open(sc->sc_chan, HVS_RING_SIZE, &sc->sc_props,
 	    sizeof(sc->sc_props), hvs_intr, sc)) {
 		printf(": failed to open channel\n");

