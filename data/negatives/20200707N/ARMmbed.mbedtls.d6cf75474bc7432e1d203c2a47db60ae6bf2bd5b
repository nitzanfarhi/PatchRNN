commit d6cf75474bc7432e1d203c2a47db60ae6bf2bd5b
Author: Manuel Pégourié-Gonnard <manuel.pegourie-gonnard@arm.com>
Date:   Wed Jan 13 11:30:00 2016 +0000

    cmac: zeroize sensitive intermediate values

diff --git a/library/cmac.c b/library/cmac.c
index 8f6574a20..87846a617 100644
--- a/library/cmac.c
+++ b/library/cmac.c
@@ -129,6 +129,8 @@ static int generate_subkeys( mbedtls_cmac_context *ctx )
     multiply_by_u( ctx->K1, L );
     multiply_by_u( ctx->K2, ctx->K1 );
 
+    mbedtls_zeroize( L, sizeof( L ) );
+
     return( 0 );
 }
 
@@ -336,6 +338,9 @@ int mbedtls_aes_cmac_prf_128( mbedtls_cmac_context *ctx,
     {
         return( ret );
     }
+
+    mbedtls_zeroize( int_key, sizeof( int_key ) );
+
     return( mbedtls_cmac_generate( ctx, input, in_len, tag, 16 ) );
 }
 

