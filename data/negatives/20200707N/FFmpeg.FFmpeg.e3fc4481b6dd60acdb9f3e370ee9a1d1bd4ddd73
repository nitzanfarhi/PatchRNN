commit e3fc4481b6dd60acdb9f3e370ee9a1d1bd4ddd73
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Tue Nov 12 22:26:34 2013 +0100

    avformat/vqf: check a few more bits in probe
    
    Fixes probetest failure
    The threshold is choosen so that a all printale ascii string will never be
    detected as vqf
    
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavformat/vqf.c b/libavformat/vqf.c
index 4cd0a6deec..526b596146 100644
--- a/libavformat/vqf.c
+++ b/libavformat/vqf.c
@@ -43,6 +43,9 @@ static int vqf_probe(AVProbeData *probe_packet)
     if (!memcmp(probe_packet->buf + 4, "00052200", 8))
         return AVPROBE_SCORE_MAX;
 
+    if (AV_RL32(probe_packet->buf + 12) > (1<<27))
+        return AVPROBE_SCORE_EXTENSION/2;
+
     return AVPROBE_SCORE_EXTENSION;
 }
 

