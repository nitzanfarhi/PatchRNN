commit 27520a688253e1f73c6f59b32312cdf2755aed2c
Author: Jeremy Harris <jgh146exb@wizmail.org>
Date:   Mon May 26 16:26:58 2014 +0100

    Increase limit of smtp_confirmation logging from 100 to 256 chars.  Bug 1408

diff --git a/src/src/deliver.c b/src/src/deliver.c
index 70f6a7a2..3f5800de 100644
--- a/src/src/deliver.c
+++ b/src/src/deliver.c
@@ -842,17 +842,17 @@ else
 
 /* confirmation message (SMTP (host_used) and LMTP (driver_name)) */
 
-if ((log_extra_selector & LX_smtp_confirmation) != 0 &&
-    addr->message != NULL &&
-    ((addr->host_used != NULL) || (Ustrcmp(addr->transport->driver_name, "lmtp") == 0)))
+if (log_extra_selector & LX_smtp_confirmation &&
+    addr->message &&
+    (addr->host_used || Ustrcmp(addr->transport->driver_name, "lmtp") == 0))
   {
   int i;
   uschar *p = big_buffer;
   uschar *ss = addr->message;
   *p++ = '\"';
-  for (i = 0; i < 100 && ss[i] != 0; i++)
+  for (i = 0; i < 256 && ss[i] != 0; i++)	/* limit logged amount */
     {
-    if (ss[i] == '\"' || ss[i] == '\\') *p++ = '\\';
+    if (ss[i] == '\"' || ss[i] == '\\') *p++ = '\\'; /* quote \ and " */
     *p++ = ss[i];
     }
   *p++ = '\"';

