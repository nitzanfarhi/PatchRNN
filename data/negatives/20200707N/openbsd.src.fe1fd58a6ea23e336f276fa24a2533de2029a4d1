commit fe1fd58a6ea23e336f276fa24a2533de2029a4d1
Author: stsp <stsp@openbsd.org>
Date:   Mon Oct 5 22:08:14 2015 +0000

    actually use lbuf in getmailname()
    ok millert@ gilles@

diff --git a/usr.sbin/smtpd/util.c b/usr.sbin/smtpd/util.c
index f40cc40148d..a7409bc6470 100644
--- a/usr.sbin/smtpd/util.c
+++ b/usr.sbin/smtpd/util.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: util.c,v 1.115 2015/10/02 00:41:25 gilles Exp $	*/
+/*	$OpenBSD: util.c,v 1.116 2015/10/05 22:08:14 stsp Exp $	*/
 
 /*
  * Copyright (c) 2000,2001 Markus Friedl.  All rights reserved.
@@ -735,6 +735,7 @@ getmailname(char *hostname, size_t len)
 			fatal("exiting");
 		}
 		memcpy(lbuf, buf, buflen);
+		buf = lbuf;
 	}
 
 	if (strlcpy(hostname, buf, len) >= len)

