commit cdf66442fab82916fe38f928b4f91815195a294c
Author: Bryan Schumaker <bjschuma@netapp.com>
Date:   Tue Jun 5 14:59:54 2012 -0400

    NFS4: Set parsed mount data version to 4
    
    This patch only affects mounting through "-t nfs4" since it doesn't set
    up an nfs version to use in the mount data.  The nfs client was trying
    to mount using NFS v0, causing either a BUG() or a protocol not
    supported message.
    
    Signed-off-by: Bryan Schumaker <bjschuma@netapp.com>
    Signed-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>

diff --git a/fs/nfs/super.c b/fs/nfs/super.c
index ff656c022684..bdd673141e9e 100644
--- a/fs/nfs/super.c
+++ b/fs/nfs/super.c
@@ -2637,6 +2637,8 @@ static int nfs4_validate_mount_data(void *options,
 	if (data == NULL)
 		goto out_no_data;
 
+	args->version = 4;
+
 	switch (data->version) {
 	case 1:
 		if (data->host_addrlen > sizeof(args->nfs_server.address))

