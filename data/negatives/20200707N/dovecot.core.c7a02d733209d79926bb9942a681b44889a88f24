commit c7a02d733209d79926bb9942a681b44889a88f24
Author: Timo Sirainen <tss@iki.fi>
Date:   Fri Mar 14 09:44:34 2008 +0200

    Added support for SEARCH_UIDSET.
    
    --HG--
    branch : HEAD

diff --git a/src/lib-storage/index/index-search.c b/src/lib-storage/index/index-search.c
index faad0deaf..ba19414b4 100644
--- a/src/lib-storage/index/index-search.c
+++ b/src/lib-storage/index/index-search.c
@@ -75,6 +75,7 @@ static void search_init_arg(struct mail_search_arg *arg,
 	case SEARCH_SEQSET:
 		ctx->have_seqsets = TRUE;
 		break;
+	case SEARCH_UIDSET:
 	case SEARCH_FLAGS:
 	case SEARCH_KEYWORDS:
 		ctx->have_flags_or_keywords = TRUE;
@@ -144,6 +145,8 @@ static int search_arg_match_index(struct index_search_context *ctx,
 	int ret;
 
 	switch (arg->type) {
+	case SEARCH_UIDSET:
+		return seqset_contains(arg->value.seqset, rec->uid);
 	case SEARCH_FLAGS:
 		flags = rec->flags;
 		if ((arg->value.flags & MAIL_RECENT) != 0 &&
diff --git a/src/lib-storage/mail-search.h b/src/lib-storage/mail-search.h
index f4eefb866..8ef2f2bba 100644
--- a/src/lib-storage/mail-search.h
+++ b/src/lib-storage/mail-search.h
@@ -10,6 +10,7 @@ enum mail_search_arg_type {
 	/* sequence sets */
 	SEARCH_ALL,
 	SEARCH_SEQSET,
+	SEARCH_UIDSET,
 
 	/* flags */
 	SEARCH_FLAGS,

