commit 4f35b0a753dbd2e8ee63f44fde654a45c720b3ca
Author: okir <okir@c6295689-39f2-0310-b995-f0e70906c6a9>
Date:   Thu Dec 5 08:58:54 2002 +0000

    - we expect an RSA key, so better make sure it _is_ RSA
    
    
    git-svn-id: https://www.opensc-project.org/svnp/opensc/trunk@755 c6295689-39f2-0310-b995-f0e70906c6a9

diff --git a/src/scam/p15_eid.c b/src/scam/p15_eid.c
index dd4f4d93..328df991 100644
--- a/src/scam/p15_eid.c
+++ b/src/scam/p15_eid.c
@@ -276,7 +276,7 @@ int p15_eid_auth(scam_context * sctx, int argc, const char **argv,
 		goto end;
 	}
 	pubkey = X509_get_pubkey(cert);
-	if (!pubkey) {
+	if (!pubkey || pubkey->type != EVP_PKEY_RSA) {
 		scam_log_msg(sctx, "Invalid public key. (user %s)\n", user);
 		goto end;
 	}

