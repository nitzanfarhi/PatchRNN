commit f1ecfd5d3b69d98b814435758c485e6fd0e112de
Author: Ursula Braun <braunu@de.ibm.com>
Date:   Mon Oct 22 16:16:14 2007 +0200

    remove header_ops bug in qeth driver
    
    Remove qeth bug caused by commit:
    [NET]: Move hardware header operations out of netdevice.
    
    This is the second part of the qeth header_ops patch, since
    first patch sent 10/19 has been insufficient.
    Nevertheless first patch is still valid and should be kept.
    
    Signed-off-by: Ursula Braun <braunu@de.ibm.com>
    Signed-off-by: Jeff Garzik <jeff@garzik.org>

diff --git a/include/linux/netdevice.h b/include/linux/netdevice.h
index 4a3f54e358e5..c4de536cefa3 100644
--- a/include/linux/netdevice.h
+++ b/include/linux/netdevice.h
@@ -834,7 +834,7 @@ static inline int dev_hard_header(struct sk_buff *skb, struct net_device *dev,
 				  const void *daddr, const void *saddr,
 				  unsigned len)
 {
-	if (!dev->header_ops)
+	if (!dev->header_ops || !dev->header_ops->create)
 		return 0;
 
 	return dev->header_ops->create(skb, dev, type, daddr, saddr, len);

