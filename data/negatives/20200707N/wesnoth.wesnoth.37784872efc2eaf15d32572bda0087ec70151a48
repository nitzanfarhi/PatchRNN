commit 37784872efc2eaf15d32572bda0087ec70151a48
Author: Ali El Gariani <alinkmaze@gmail.com>
Date:   Sun May 6 20:07:49 2007 +0000

    get_surface_portion now quietly give NULL...
    
    ...if you ask a portion outside of the surface. This seems like a correct
    behavior.
    
    This also silence a flood of error messages "illegal surface
    portion..." when the chat/command text field go out of the
    screen after a resolution change / window resizing.

diff --git a/src/sdl_utils.cpp b/src/sdl_utils.cpp
index 16b673fa01..eee0fbada7 100644
--- a/src/sdl_utils.cpp
+++ b/src/sdl_utils.cpp
@@ -944,15 +944,15 @@ void fill_rect_alpha(SDL_Rect &rect, Uint32 colour, Uint8 alpha, surface const &
 
 surface get_surface_portion(surface const &src, SDL_Rect &area)
 {
-	if(area.x >= src->w || area.y >= src->h) {
-		std::cerr << "illegal surface portion...\n";
+	// check if there is something in the portion
+	if(area.x >= src->w || area.y >= src->h || area.x + area.w < 0 || area.y + area.h < 0) {
+		//std::cerr << "illegal surface portion...\n";
 		return NULL;
 	}
 
 	if(area.x + area.w > src->w) {
 		area.w = src->w - area.x;
 	}
-
 	if(area.y + area.h > src->h) {
 		area.h = src->h - area.y;
 	}
@@ -963,9 +963,7 @@ surface get_surface_portion(surface const &src, SDL_Rect &area)
 		return NULL;
 	}
 
-	SDL_Rect dstarea = {0,0,0,0};
-
-	SDL_BlitSurface(src,&area,dst,&dstarea);
+	SDL_BlitSurface(src,&area,dst, NULL);
 
 	return dst;
 }
diff --git a/src/sdl_utils.hpp b/src/sdl_utils.hpp
index 26e45aa7d2..df8c2b8ba9 100644
--- a/src/sdl_utils.hpp
+++ b/src/sdl_utils.hpp
@@ -113,6 +113,7 @@ surface darken_image(surface const &surf);
 surface recolor_image(surface surf, const std::map<Uint32, Uint32>& map_rgb);
 
 surface brighten_image(surface const &surf, fixed_t amount);
+// send NULL if the portion is outside of the surface 
 surface get_surface_portion(surface const &surf, SDL_Rect &rect);
 surface adjust_surface_alpha(surface const &surf, fixed_t amount, bool optimize=true);
 surface adjust_surface_alpha_add(surface const &surf, int amount);

