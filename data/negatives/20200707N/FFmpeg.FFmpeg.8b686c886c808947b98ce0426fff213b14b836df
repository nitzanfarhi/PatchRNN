commit 8b686c886c808947b98ce0426fff213b14b836df
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Fri May 30 21:04:52 2014 +0200

    avcodec/options: use av_opt_copy() in avcodec_copy_context() to copy priv_data
    
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavcodec/options.c b/libavcodec/options.c
index 0026f88b89..64b27e5768 100644
--- a/libavcodec/options.c
+++ b/libavcodec/options.c
@@ -186,6 +186,10 @@ int avcodec_copy_context(AVCodecContext *dest, const AVCodecContext *src)
     memcpy(dest, src, sizeof(*dest));
 
     dest->priv_data       = orig_priv_data;
+
+    if (orig_priv_data)
+        av_opt_copy(orig_priv_data, src->priv_data);
+
     dest->codec           = orig_codec;
 
     /* set values specific to opened codecs back to their default state */

