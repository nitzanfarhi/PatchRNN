commit 0572fbb3cf2b7faff75f3d095565af947d7ef41a
Author: Yasuyuki Tanaka <yatch@isl.rdc.toshiba.co.jp>
Date:   Sun Dec 11 15:35:30 2016 +0100

    6LoWPAN: bugfix in extracting in-line UDP checksum of IPHC
    
    Bug: 13233
    Change-Id: Ie697d5a2d8a604bf3348f690d78ada4f9f0b1b89
    Reviewed-on: https://code.wireshark.org/review/19208
    Petri-Dish: João Valverde <j@v6e.pt>
    Tested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>
    Reviewed-by: João Valverde <j@v6e.pt>

diff --git a/epan/dissectors/packet-6lowpan.c b/epan/dissectors/packet-6lowpan.c
index 7528f5d48a..9648d124ac 100644
--- a/epan/dissectors/packet-6lowpan.c
+++ b/epan/dissectors/packet-6lowpan.c
@@ -2089,7 +2089,7 @@ dissect_6lowpan_iphc_nhc(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, gi
         /* Get and display the checksum. */
         if (!(udp_flags & LOWPAN_NHC_UDP_CHECKSUM)) {
             /* Parse the checksum. */
-            udp.checksum = tvb_get_ntohs(tvb, offset);
+            tvb_memcpy(tvb, &udp.checksum, offset, sizeof(udp.checksum));
             proto_tree_add_checksum(tree, tvb, offset, hf_6lowpan_udp_checksum, -1, NULL, pinfo, 0, ENC_BIG_ENDIAN, PROTO_CHECKSUM_NO_FLAGS);
             offset += 2;
         }

