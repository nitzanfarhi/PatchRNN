commit 9614ab556ca8e4e5daec1e71d9b6032633ba21a0
Author: David Zafman <dzafman@redhat.com>
Date:   Mon Jun 12 11:28:48 2017 -0700

    osd: be_select_auth_object() sanity check oi soid
    
    Fixes: http://tracker.ceph.com/issues/18409
    
    Signed-off-by: David Zafman <dzafman@redhat.com>

diff --git a/src/osd/PGBackend.cc b/src/osd/PGBackend.cc
index 3e63f0675d..97a7f07ba3 100644
--- a/src/osd/PGBackend.cc
+++ b/src/osd/PGBackend.cc
@@ -687,6 +687,12 @@ map<pg_shard_t, ScrubMap *>::const_iterator
       goto out;
     }
 
+    if (oi.soid != obj) {
+      shard_info.set_oi_attr_corrupted();
+      error_string += " oi_attr_corrupted";
+      goto out;
+    }
+
     if (auth_version != eversion_t()) {
       if (!object_error.has_object_info_inconsistency() && !(bl == auth_bl)) {
 	object_error.set_object_info_inconsistency();

