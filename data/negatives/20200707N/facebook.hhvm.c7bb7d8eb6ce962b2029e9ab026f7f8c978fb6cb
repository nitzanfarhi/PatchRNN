commit c7bb7d8eb6ce962b2029e9ab026f7f8c978fb6cb
Author: bsimmers <bsimmers@fb.com>
Date:   Tue Mar 5 23:53:42 2013 -0800

    Fix type mistake in cgOpSub
    
    Sometimes src1 isn't an int. This was causing failed asserts
    in debug perflab runs.

diff --git a/hphp/runtime/vm/translator/hopt/codegen.cpp b/hphp/runtime/vm/translator/hopt/codegen.cpp
index 7cfc97fa8e..f61e6560b8 100644
--- a/hphp/runtime/vm/translator/hopt/codegen.cpp
+++ b/hphp/runtime/vm/translator/hopt/codegen.cpp
@@ -1010,7 +1010,8 @@ void CodeGenerator::cgOpSub(IRInstruction* inst) {
 
   if (emitDec(dst, src1, src2)) return;
 
-  if (src1->isConst() && src1->getValInt() == 0 && !src2->isA(Type::Dbl)) {
+  if (src1->isConst() && src1->isA(Type::Int) && src1->getValInt() == 0 &&
+      !src2->isA(Type::Dbl)) {
     return cgNegateWork(dst, src2);
   }
 

