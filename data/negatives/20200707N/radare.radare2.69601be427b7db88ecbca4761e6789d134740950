commit 69601be427b7db88ecbca4761e6789d134740950
Author: Riccardo Schirone <sirmy15@gmail.com>
Date:   Mon Aug 6 19:56:14 2018 +0200

    format/zimg: make sure there are enough bytes in the buffer

diff --git a/libr/bin/format/zimg/zimg.c b/libr/bin/format/zimg/zimg.c
index ef4af180b..8a1c14208 100644
--- a/libr/bin/format/zimg/zimg.c
+++ b/libr/bin/format/zimg/zimg.c
@@ -16,6 +16,9 @@ struct r_bin_zimg_obj_t* r_bin_zimg_new_buf(RBuffer *buf) {
 		goto fail;
 	}
 
+	if (r_buf_size (bin->b) < sizeof (struct zimg_header_t)) {
+		goto fail;
+	}
 	bin->header = (*(struct zimg_header_t*)bin->b->buf);
 
 	return bin;

