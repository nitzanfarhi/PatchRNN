commit abb14de7e05505d4159e6ffbb75f6135d21b3f6e
Author: Daniel Stenberg <daniel@haxx.se>
Date:   Wed Feb 7 09:31:03 2001 +0000

    GetLine() didn't properly act on -1 lengths returned from Curl_read()

diff --git a/lib/http.c b/lib/http.c
index 9fe056c5f..54623ec6b 100644
--- a/lib/http.c
+++ b/lib/http.c
@@ -226,17 +226,18 @@ int GetLine(int sockfd, char *buf, struct connectdata *conn)
       (nread<BUFSIZE) && read_rc;
       nread++, ptr++) {
     if((CURLE_OK != Curl_read(conn, sockfd, ptr, 1, &nread)) ||
+       (nread <= 0) ||
        (*ptr == '\n'))
       break;
   }
   *ptr=0; /* zero terminate */
-
+  
   if(data->bits.verbose) {
     fputs("< ", data->err);
     fwrite(buf, 1, nread, data->err);
     fputs("\n", data->err);
   }
-  return nread;
+  return nread>0?nread:0;
 }
 
 

