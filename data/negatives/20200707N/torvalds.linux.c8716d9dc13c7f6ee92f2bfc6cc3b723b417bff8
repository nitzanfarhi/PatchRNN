commit c8716d9dc13c7f6ee92f2bfc6cc3b723b417bff8
Author: Rajkumar Manoharan <rmanoharan@atheros.com>
Date:   Sat Oct 23 10:59:57 2010 +0530

    mac80211: Fix ibss station got expired immediately
    
    Station addition in ieee80211_ibss_rx_queued_mgmt is not updating
    sta->last_rx which is causing station expiry in ieee80211_ibss_work
    path. So sta addition and deletion happens repeatedly.
    
    CC: stable@kernel.org
    Signed-off-by: Rajkumar Manoharan <rmanoharan@atheros.com>
    Signed-off-by: John W. Linville <linville@tuxdriver.com>

diff --git a/net/mac80211/ibss.c b/net/mac80211/ibss.c
index ff60c022f51d..239c4836a946 100644
--- a/net/mac80211/ibss.c
+++ b/net/mac80211/ibss.c
@@ -456,6 +456,7 @@ struct sta_info *ieee80211_ibss_add_sta(struct ieee80211_sub_if_data *sdata,
 	if (!sta)
 		return NULL;
 
+	sta->last_rx = jiffies;
 	set_sta_flags(sta, WLAN_STA_AUTHORIZED);
 
 	/* make sure mandatory rates are always added */

