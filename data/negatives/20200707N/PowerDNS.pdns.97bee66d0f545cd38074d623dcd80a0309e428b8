commit 97bee66d0f545cd38074d623dcd80a0309e428b8
Author: Bert Hubert <bert.hubert@netherlabs.nl>
Date:   Sun Apr 3 15:23:15 2011 +0000

    remove some further unaligned memory accesses in powerdns recursor
    
    
    git-svn-id: svn://svn.powerdns.com/pdns/trunk/pdns@2123 d19b8d6e-7fed-0310-83ef-9ca221ded41b

diff --git a/pdns/pdns_recursor.cc b/pdns/pdns_recursor.cc
index 8adac71fe..4a5b86b80 100644
--- a/pdns/pdns_recursor.cc
+++ b/pdns/pdns_recursor.cc
@@ -815,8 +815,11 @@ string* doProcessUDPQuestion(const std::string& question, const ComboAddress& fr
       SyncRes::s_queries++;
       ageDNSPacket(response, age);
       sendto(fd, response.c_str(), response.length(), 0, (struct sockaddr*) &fromaddr, fromaddr.getSocklen());
-      if(response.length() >= sizeof(struct dnsheader))
-        updateRcodeStats(((struct dnsheader*)response.c_str())->rcode);
+      if(response.length() >= sizeof(struct dnsheader)) {
+        struct dnsheader dh;
+        memcpy(&dh, response.c_str(), sizeof(dh));
+        updateRcodeStats(dh.rcode);
+      }
       g_stats.avgLatencyUsec=(uint64_t)((1-0.0001)*g_stats.avgLatencyUsec + 0); // we assume 0 usec
       return 0;
     }

