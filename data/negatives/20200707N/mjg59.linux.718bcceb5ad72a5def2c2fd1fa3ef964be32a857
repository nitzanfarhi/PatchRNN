commit 718bcceb5ad72a5def2c2fd1fa3ef964be32a857
Author: Thomas Gleixner <tglx@linutronix.de>
Date:   Mon Jan 9 20:52:29 2006 -0800

    [PATCH] hrtimer: validate timespec of do_sys_settimeofday
    
    Check if the timespec which is provided from user space is normalized.
    
    Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
    Signed-off-by: Ingo Molnar <mingo@elte.hu>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

diff --git a/kernel/time.c b/kernel/time.c
index bbc8ca194b59..c689b53297cf 100644
--- a/kernel/time.c
+++ b/kernel/time.c
@@ -154,6 +154,9 @@ int do_sys_settimeofday(struct timespec *tv, struct timezone *tz)
 	static int firsttime = 1;
 	int error = 0;
 
+	if (!timespec_valid(tv))
+		return -EINVAL;
+
 	error = security_settime(tv, tz);
 	if (error)
 		return error;

