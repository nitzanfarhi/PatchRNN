commit 7ee1af4dddb193ae9437f4d12f7862c8ab1782c7
Author: Mickey Sola <msola@sourcefire.com>
Date:   Wed Jan 20 16:21:58 2016 -0500

    bb11446 - adding check for compressed input stream

diff --git a/libclamav/autoit.c b/libclamav/autoit.c
index 0822eb342..695b9ccd2 100644
--- a/libclamav/autoit.c
+++ b/libclamav/autoit.c
@@ -261,7 +261,7 @@ static int ea05(cli_ctx *ctx, const uint8_t *base, char *tmpd) {
       continue;
     }
 
-    if (UNP.csize < sizeof(union unaligned_32)) {
+    if (comp == 1 && UNP.csize < sizeof(union unaligned_32)) {
       cli_dbgmsg("autoit: compressed size too small, skipping\n");
       continue;
     }
@@ -586,7 +586,7 @@ static int ea06(cli_ctx *ctx, const uint8_t *base, char *tmpd) {
       continue;
     }
 
-    if (UNP.csize < sizeof(union unaligned_32)) {
+    if (comp == 1 && UNP.csize < sizeof(union unaligned_32)) {
       cli_dbgmsg("autoit: compressed size too small, skipping\n");
       continue;
     }

