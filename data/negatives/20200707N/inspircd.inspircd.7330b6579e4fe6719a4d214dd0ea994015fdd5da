commit 7330b6579e4fe6719a4d214dd0ea994015fdd5da
Author: brain <brain@e03df62e-2008-0410-955e-edbf42e46eb7>
Date:   Sat Oct 13 22:51:46 2007 +0000

    And some more tweaks to make sure it frees memory :P
    
    
    git-svn-id: http://svn.inspircd.org/repository/trunk/inspircd@8167 e03df62e-2008-0410-955e-edbf42e46eb7

diff --git a/src/modules/m_ident.cpp b/src/modules/m_ident.cpp
index 9272c5054..f522f6719 100644
--- a/src/modules/m_ident.cpp
+++ b/src/modules/m_ident.cpp
@@ -278,7 +278,11 @@ class ModuleIdent : public Module
 			{
 				int *fd;
 				if (user->GetExt("ident_socket_fd", fd) && (ServerInstance->SE->GetRef(*fd) == isock))
+				{
+					user->Shrink("ident_socket_fd");
+					delete fd;
 					isock->Close();
+				}
 			}
 		}
 	}
@@ -290,7 +294,11 @@ class ModuleIdent : public Module
 		{
 			int *fd;
 			if (user->GetExt("ident_socket_fd", fd) && (ServerInstance->SE->GetRef(*fd) == isock))
+			{
+				user->Shrink("ident_socket_fd");
+				delete fd;
 				isock->Close();
+			}
 		}
 	}
 };

