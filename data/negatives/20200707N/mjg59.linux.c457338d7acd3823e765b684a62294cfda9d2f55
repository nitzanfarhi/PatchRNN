commit c457338d7acd3823e765b684a62294cfda9d2f55
Author: Brian Haley <brian.haley@hp.com>
Date:   Tue Nov 8 04:41:42 2011 +0000

    ipv6: drop packets when source address is multicast
    
    RFC 4291 Section 2.7 says Multicast addresses must not be used as source
    addresses in IPv6 packets - drop them on input so we don't process the
    packet further.
    
    Signed-off-by: Brian Haley <brian.haley@hp.com>
    Reported-and-Tested-by: Kumar Sanghvi <divinekumar@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/net/ipv6/ip6_input.c b/net/ipv6/ip6_input.c
index 027c7ff6f1e5..a46c64eb0a66 100644
--- a/net/ipv6/ip6_input.c
+++ b/net/ipv6/ip6_input.c
@@ -111,6 +111,14 @@ int ipv6_rcv(struct sk_buff *skb, struct net_device *dev, struct packet_type *pt
 	    ipv6_addr_loopback(&hdr->daddr))
 		goto err;
 
+	/*
+	 * RFC4291 2.7
+	 * Multicast addresses must not be used as source addresses in IPv6
+	 * packets or appear in any Routing header.
+	 */
+	if (ipv6_addr_is_multicast(&hdr->saddr))
+		goto err;
+
 	skb->transport_header = skb->network_header + sizeof(*hdr);
 	IP6CB(skb)->nhoff = offsetof(struct ipv6hdr, nexthdr);
 

