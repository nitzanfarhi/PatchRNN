commit b512e566e8c899484bf42419b6153a66815ad146
Author: Timo Sirainen <tss@iki.fi>
Date:   Tue Dec 18 21:45:08 2012 +0200

    raw storage: Make sure "from envelope" isn't returned as NULL.

diff --git a/src/lib-storage/index/raw/raw-mail.c b/src/lib-storage/index/raw/raw-mail.c
index 3ad6f0c98..ea6447749 100644
--- a/src/lib-storage/index/raw/raw-mail.c
+++ b/src/lib-storage/index/raw/raw-mail.c
@@ -101,7 +101,8 @@ raw_mail_get_special(struct mail *_mail, enum mail_fetch_field field,
 
 	switch (field) {
 	case MAIL_FETCH_FROM_ENVELOPE:
-		*value_r = mbox->envelope_sender;
+		*value_r = mbox->envelope_sender != NULL ?
+			mbox->envelope_sender : "";
 		return 0;
 	case MAIL_FETCH_UIDL_FILE_NAME:
 		*value_r = mbox->have_filename ?

