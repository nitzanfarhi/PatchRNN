commit 0df551da94e2ad865ce661fb77153d15a878a059
Author: matyhtf <mikan.tenny@gmail.com>
Date:   Wed Jan 10 15:55:45 2018 +0800

    code optimization

diff --git a/src/core/base.c b/src/core/base.c
index 4c803e96..1e230476 100644
--- a/src/core/base.c
+++ b/src/core/base.c
@@ -335,8 +335,16 @@ int swoole_sync_writefile(int fd, void *data, int len)
             count -= n;
             written += n;
         }
+        else if (n == 0)
+        {
+            break;
+        }
         else
         {
+            if (errno == EINTR || errno == EAGAIN)
+            {
+                continue;
+            }
             swWarn("write() failed. Error: %s[%d]", strerror(errno), errno);
             break;
         }
@@ -675,6 +683,10 @@ int swoole_sync_readfile(int fd, void *buf, int len)
         }
         else
         {
+            if (errno == EINTR || errno == EAGAIN)
+            {
+                continue;
+            }
             swWarn("read() failed. Error: %s[%d]", strerror(errno), errno);
             break;
         }

