commit 0d09aa9d8ec4025c31304a9dbebddfaaab82962f
Author: Nicolas George <nicolas.george@normalesup.org>
Date:   Wed Mar 20 12:27:42 2013 +0100

    lavf: avformat_seek_file(): validate stream_index.

diff --git a/libavformat/utils.c b/libavformat/utils.c
index 5cf3d9cd47..a43238bd20 100644
--- a/libavformat/utils.c
+++ b/libavformat/utils.c
@@ -2137,6 +2137,8 @@ int avformat_seek_file(AVFormatContext *s, int stream_index, int64_t min_ts, int
 {
     if(min_ts > ts || max_ts < ts)
         return -1;
+    if (stream_index < -1 || stream_index >= (int)s->nb_streams)
+        return AVERROR(EINVAL);
 
     if(s->seek2any>0)
         flags |= AVSEEK_FLAG_ANY;

