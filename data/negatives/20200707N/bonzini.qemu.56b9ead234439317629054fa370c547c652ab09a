commit 56b9ead234439317629054fa370c547c652ab09a
Author: Jan Kiszka <jan.kiszka@siemens.com>
Date:   Wed Mar 21 13:36:22 2012 +0100

    kvm: Drop redundant kvm_enabled from cpu_thread_is_idle
    
    This is now implied by kvm_irqchip_in_kernel.
    
    Signed-off-by: Jan Kiszka <jan.kiszka@siemens.com>
    Signed-off-by: Avi Kivity <avi@redhat.com>

diff --git a/cpus.c b/cpus.c
index eb22bd5df1..b182b3d7d9 100644
--- a/cpus.c
+++ b/cpus.c
@@ -441,8 +441,7 @@ static bool cpu_thread_is_idle(CPUArchState *env)
     if (env->stopped || !runstate_is_running()) {
         return true;
     }
-    if (!env->halted || qemu_cpu_has_work(env) ||
-        (kvm_enabled() && kvm_irqchip_in_kernel())) {
+    if (!env->halted || qemu_cpu_has_work(env) || kvm_irqchip_in_kernel()) {
         return false;
     }
     return true;

