commit 91dd9c009e19a2d029cd01c0ca79263ac5942aef
Author: Bert Hubert <bert.hubert@netherlabs.nl>
Date:   Wed Jul 25 22:31:29 2007 +0000

    make sockets non-blocking if we use 'select', thanks DPS
    
    
    git-svn-id: svn://svn.powerdns.com/pdns/trunk/pdns@1076 d19b8d6e-7fed-0310-83ef-9ca221ded41b

diff --git a/pdns/nameserver.cc b/pdns/nameserver.cc
index 0a1e26c6b..cc7ec07c1 100644
--- a/pdns/nameserver.cc
+++ b/pdns/nameserver.cc
@@ -91,6 +91,9 @@ void UDPNameserver::bindIPv4()
     if(s<0)
       throw AhuException("Unable to acquire a UDP socket: "+string(strerror(errno)));
   
+    if(locals.size() > 1 && !Utility::setNonBlocking(s))
+      throw AhuException("Unable to set UDP socket to non-blocking: "+stringerror());
+  
     memset(&locala,0,sizeof(locala));
     locala.sin_family=AF_INET;
 

