commit 54af43c135d3360ade34885a942783e04e4b6d0f
Author: hshoexer <hshoexer@openbsd.org>
Date:   Thu Jun 24 15:58:58 2004 +0000

    Also handle keys from x509-certificates embedded in keynote credentials.
    
    with msf@
    ok ho@

diff --git a/sbin/isakmpd/policy.c b/sbin/isakmpd/policy.c
index c9ff0eab6d5..b20c9841e5c 100644
--- a/sbin/isakmpd/policy.c
+++ b/sbin/isakmpd/policy.c
@@ -1,4 +1,4 @@
-/* $OpenBSD: policy.c,v 1.75 2004/06/20 15:24:05 ho Exp $	 */
+/* $OpenBSD: policy.c,v 1.76 2004/06/24 15:58:58 hshoexer Exp $	 */
 /* $EOM: policy.c,v 1.49 2000/10/24 13:33:39 niklas Exp $ */
 
 /*
@@ -2264,7 +2264,8 @@ keynote_cert_get_key(void *scert, void *keyp)
 
 	kl = kn_get_licensees(kid, sid);
 	while (kl) {
-		if (kl->key_alg == KEYNOTE_ALGORITHM_RSA) {
+		if (kl->key_alg == KEYNOTE_ALGORITHM_RSA ||
+		    kl->key_alg == KEYNOTE_ALGORITHM_X509) {
 			*(RSA **)keyp = RSAPublicKey_dup(kl->key_key);
 			break;
 		}

