commit ddd7dac7ae0515ea6036396bb50d7bb5f702aeef
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Wed Dec 17 03:28:25 2014 +0100

    avcodec/utils: check the private context class
    
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavcodec/utils.c b/libavcodec/utils.c
index db79b67e93..74bf6d5013 100644
--- a/libavcodec/utils.c
+++ b/libavcodec/utils.c
@@ -1680,6 +1680,10 @@ int attribute_align_arg avcodec_open2(AVCodecContext *avctx, const AVCodec *code
             avctx->time_base = av_inv_q(av_mul_q(avctx->framerate, (AVRational){avctx->ticks_per_frame, 1}));
 #endif
     }
+    if (codec->priv_data_size > 0 && avctx->priv_data && codec->priv_class) {
+        av_assert0(*(const AVClass **)avctx->priv_data == codec->priv_class);
+    }
+
 end:
     ff_unlock_avcodec();
     if (options) {

