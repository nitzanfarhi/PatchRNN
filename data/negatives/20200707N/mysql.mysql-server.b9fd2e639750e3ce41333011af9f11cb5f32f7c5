commit b9fd2e639750e3ce41333011af9f11cb5f32f7c5
Author: Aditya A <aditya.a@oracle.com>
Date:   Fri Feb 9 16:17:26 2018 +0530

    Bug #27158030   INNODB ONLINE ALTER CRASHES WITH CONCURRENT DML
    
    PROBLEM
    -------
    Missing end of log check before accessing
    log to determine the length of virtual column.
    
    Fix
    ---
    Check the the end of log record before
    accessing the log.
    
    [#rb 18665 Reveiwed by Jimmy ]

diff --git a/storage/innobase/row/row0log.cc b/storage/innobase/row/row0log.cc
index 6472e80d77d..b17515604d7 100644
--- a/storage/innobase/row/row0log.cc
+++ b/storage/innobase/row/row0log.cc
@@ -2646,6 +2646,11 @@ row_log_table_apply_op(
 		if (num_v) {
 			ulint		o_v_size = 0;
 			ulint		n_v_size = 0;
+
+			if (next_mrec + 2 > mrec_end) {
+				return(NULL);
+			}
+
 			n_v_size = mach_read_from_2(next_mrec);
 			next_mrec += n_v_size;
 			if (next_mrec > mrec_end) {

