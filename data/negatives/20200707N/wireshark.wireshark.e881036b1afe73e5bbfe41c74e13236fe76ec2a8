commit e881036b1afe73e5bbfe41c74e13236fe76ec2a8
Author: Tomasz Mo≈Ñ <desowin@gmail.com>
Date:   Tue Oct 7 23:14:21 2014 +0200

    Fix extcap boolean flag handling.
    
    Change-Id: I4c6b32805d4138ef0912fbf1b129a5e97776ab9c
    Reviewed-on: https://code.wireshark.org/review/4535
    Reviewed-by: Roland Knall <rknall@gmail.com>
    Reviewed-by: Pascal Quantin <pascal.quantin@gmail.com>

diff --git a/ui/gtk/extcap_gtk.c b/ui/gtk/extcap_gtk.c
index fcde999d56..cc7bc883a0 100644
--- a/ui/gtk/extcap_gtk.c
+++ b/ui/gtk/extcap_gtk.c
@@ -294,9 +294,23 @@ GHashTable *extcap_gtk_get_state(GtkWidget *widget) {
             continue;
 
         /* Flags are set as is, and have not true/false switch */
-        if ((arg->arg_type == EXTCAP_ARG_BOOLFLAG)
-                && (extcap_complex_get_bool(parsed_complex) == TRUE)) {
-            call_string = g_strdup(" ");
+        if (arg->arg_type == EXTCAP_ARG_BOOLFLAG)
+        {
+            if (extcap_complex_get_bool(parsed_complex) == TRUE)
+            {
+                /* Include boolflag call in list.
+                 * Only arg->call should appear in commandline arguments.
+                 * Setting call_string to NULL here makes it perform as desired.
+                 */
+                call_string = NULL;
+            }
+            else
+            {
+                 /* Omit boolflag call from list. */
+                 g_free(parsed_complex);
+                 parsed_complex = NULL;
+                 continue;
+            }
         }
 
         if (parsed_complex != NULL && call_string == NULL)

