commit 7e32e90d4cc31aee3b2d97510f9cbb7117c9f285
Author: Armin Novak <armin.novak@thincast.com>
Date:   Thu Aug 17 13:16:32 2017 +0200

    Fixed RSA generation for OpenSSL >= 1.1

diff --git a/winpr/tools/makecert/makecert.c b/winpr/tools/makecert/makecert.c
index c9e38200a..f1bfcf2d7 100644
--- a/winpr/tools/makecert/makecert.c
+++ b/winpr/tools/makecert/makecert.c
@@ -1018,6 +1018,12 @@ int makecert_context_process(MAKECERT_CONTEXT* context, int argc, char** argv)
 		if (!rsa)
 			return -1;
 
+		context->rsa = RSA_new();
+		if (!context->rsa)
+		{
+			BN_clear_free(rsa);
+			return -1;
+		}
 		BN_set_word(rsa, RSA_F4);
 		rc = RSA_generate_key_ex(context->rsa, key_length, rsa, NULL);
 		BN_clear_free(rsa);

