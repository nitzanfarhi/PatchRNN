commit 414825aea0f71640824d5d103fd0cf5ca1e502d0
Author: Timo Sirainen <tss@iki.fi>
Date:   Thu Aug 29 01:33:18 2002 +0300

    reset modifylog sync mark at the end of opening index file
    
    --HG--
    branch : HEAD

diff --git a/src/lib-index/mail-index.c b/src/lib-index/mail-index.c
index c40bd3116..12147d448 100644
--- a/src/lib-index/mail-index.c
+++ b/src/lib-index/mail-index.c
@@ -462,7 +462,10 @@ static int mail_index_open_init(MailIndex *index, int update_recent,
 		index->set_flags |= MAIL_INDEX_FLAG_REBUILD;
 	}
 
-	return TRUE;
+	/* finally reset the modify log marks, fsck or syncing might have
+	   deleted some messages, and since we're only just opening the
+	   index, there's no need to remember them */
+	return mail_modifylog_mark_synced(index->modifylog);
 }
 
 static int mail_index_open_file(MailIndex *index, const char *filename,

