commit 673007c6bdf2eee5b45916949d1b2e7ed00efbe3
Author: darrenm <none@none>
Date:   Mon Mar 6 06:05:57 2006 -0800

    6387674 bzeros removed by 6264344 were not gratuitous

diff --git a/usr/src/common/crypto/md5/md5.c b/usr/src/common/crypto/md5/md5.c
index 025b73e1a4..319254f01b 100644
--- a/usr/src/common/crypto/md5/md5.c
+++ b/usr/src/common/crypto/md5/md5.c
@@ -1,5 +1,5 @@
 /*
- * Copyright 2005 Sun Microsystems, Inc.  All rights reserved.
+ * Copyright 2006 Sun Microsystems, Inc.  All rights reserved.
  * Use is subject to license terms.
  */
 
@@ -605,6 +605,9 @@ MD5Final(unsigned char *digest, MD5_CTX *ctx)
 
 	/* store state in digest */
 	Encode(digest, ctx->state, sizeof (ctx->state));
+
+	/* zeroize sensitive information */
+	bzero(ctx, sizeof (*ctx));
 }
 
 #ifndef	_KERNEL
diff --git a/usr/src/common/crypto/sha1/sha1.c b/usr/src/common/crypto/sha1/sha1.c
index 7025f25841..6406e7ea60 100644
--- a/usr/src/common/crypto/sha1/sha1.c
+++ b/usr/src/common/crypto/sha1/sha1.c
@@ -1,5 +1,5 @@
 /*
- * Copyright 2005 Sun Microsystems, Inc.  All rights reserved.
+ * Copyright 2006 Sun Microsystems, Inc.  All rights reserved.
  * Use is subject to license terms.
  */
 
@@ -672,6 +672,9 @@ SHA1Final(uint8_t *digest, SHA1_CTX *ctx)
 
 	/* store state in digest */
 	Encode(digest, ctx->state, sizeof (ctx->state));
+
+	/* zeroize sensitive information */
+	bzero(ctx, sizeof (*ctx));
 }
 
 /*
diff --git a/usr/src/common/crypto/sha2/sha2.c b/usr/src/common/crypto/sha2/sha2.c
index 9469b3d548..39e0382092 100644
--- a/usr/src/common/crypto/sha2/sha2.c
+++ b/usr/src/common/crypto/sha2/sha2.c
@@ -1,5 +1,5 @@
 /*
- * Copyright 2005 Sun Microsystems, Inc.  All rights reserved.
+ * Copyright 2006 Sun Microsystems, Inc.  All rights reserved.
  * Use is subject to license terms.
  */
 
@@ -2559,4 +2559,7 @@ SHA2Final(uint8_t *digest, SHA2_CTX *ctx)
 			Encode64(digest, ctx->state.s64,
 			    sizeof (ctx->state.s64));
 	}
+
+	/* zeroize sensitive information */
+	bzero(ctx, sizeof (*ctx));
 }

