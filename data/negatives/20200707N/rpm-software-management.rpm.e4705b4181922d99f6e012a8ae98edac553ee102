commit e4705b4181922d99f6e012a8ae98edac553ee102
Author: Panu Matilainen <pmatilai@redhat.com>
Date:   Wed Nov 16 13:13:20 2016 +0200

    Tolerate NULL info retval argument to headerVerifyInfo()
    
    Use a local temporal if info is not supplied, half the callers
    don't care anymore.

diff --git a/lib/header.c b/lib/header.c
index 885d41448..9a7c6a01c 100644
--- a/lib/header.c
+++ b/lib/header.c
@@ -210,10 +210,14 @@ int headerVerifyInfo(int il, int dl,
 		     const struct entryInfo_s * pe, const void *dataStart,
 		     struct entryInfo_s * info, char **emsg)
 {
+    struct entryInfo_s _info;
     int i, len = 0;
     int32_t end = 0;
     const char *ds = dataStart;
 
+    if (info == NULL)
+	info = &_info;
+
     for (i = 0; i < il; i++) {
 	ei2h(&pe[i], info);
 
diff --git a/lib/package.c b/lib/package.c
index bbd72c504..499fdd0e9 100644
--- a/lib/package.c
+++ b/lib/package.c
@@ -371,8 +371,7 @@ static rpmRC headerVerify(rpmKeyring keyring, rpmVSFlags vsflags,
 
     /* Sanity check the rest of the header structure. */
     if (rc != RPMRC_FAIL) {
-	struct entryInfo_s info;
-	if (headerVerifyInfo(ril-1, dl, pe+1, dataStart, &info, &buf) != -1)
+	if (headerVerifyInfo(ril-1, dl, pe+1, dataStart, NULL, &buf) != -1)
 	    rc = RPMRC_FAIL;
     }
 
diff --git a/lib/signature.c b/lib/signature.c
index 02ba4102f..5da5b88b4 100644
--- a/lib/signature.c
+++ b/lib/signature.c
@@ -196,8 +196,7 @@ rpmRC rpmReadSignature(FD_t fd, Header * sighp, char ** msg)
 
     /* Sanity check signature tags */
     for (i = 1; i < il; i++) {
-	struct entryInfo_s info;
-	if (headerVerifyInfo(1, dl, pe+i, dataStart, &info, &buf) != -1)
+	if (headerVerifyInfo(1, dl, pe+i, dataStart, NULL, &buf) != -1)
 	    goto exit;
     }
 

