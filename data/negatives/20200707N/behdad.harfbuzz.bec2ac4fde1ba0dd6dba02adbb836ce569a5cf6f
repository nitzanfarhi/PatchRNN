commit bec2ac4fde1ba0dd6dba02adbb836ce569a5cf6f
Author: Behdad Esfahbod <behdad@behdad.org>
Date:   Sat Apr 7 14:51:17 2012 -0400

    Bring normalization algorithm closer to the spec
    
    No logical difference so far.

diff --git a/src/hb-ot-shape-normalize.cc b/src/hb-ot-shape-normalize.cc
index f24fb323..02a90bf4 100644
--- a/src/hb-ot-shape-normalize.cc
+++ b/src/hb-ot-shape-normalize.cc
@@ -250,7 +250,8 @@ _hb_ot_shape_normalize (hb_font_t *font, hb_buffer_t *buffer,
     }
 
     hb_codepoint_t composed, glyph;
-    if ((buffer->out_info[buffer->out_len - 1].combining_class() < buffer->info[buffer->idx].combining_class()) &&
+    if ((starter == buffer->out_len - 1 ||
+	 buffer->out_info[buffer->out_len - 1].combining_class() < buffer->info[buffer->idx].combining_class()) &&
 	hb_unicode_compose (buffer->unicode,
 			    buffer->out_info[starter].codepoint,
 			    buffer->info[buffer->idx].codepoint,

