commit d0390d92bf548a903a48e1a2b3a12eff8a9d838b
Author: stephane duverger <stephane.duverger@gmail.com>
Date:   Mon Jul 12 18:43:47 2010 +0200

    USB: musb: forward debug mode feature to gadget
    
    This is a patch for the musb usb controller.
    
    It allows forwarding of the debug mode feature to its gadget in order
    to be able to act as an ehci debug device.
    
    This patch has been tested on an IGEPv2 board running a 2.6.35-rc1
    kernel.
    
    Signed-off-by: Stephane Duverger <stephane.duverger@gmail.com>
    Cc: Felipe Balbi <felipe.balbi@nokia.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

diff --git a/drivers/usb/musb/musb_gadget_ep0.c b/drivers/usb/musb/musb_gadget_ep0.c
index 21b9788d0243..59bef8f3a358 100644
--- a/drivers/usb/musb/musb_gadget_ep0.c
+++ b/drivers/usb/musb/musb_gadget_ep0.c
@@ -402,6 +402,9 @@ __acquires(musb->lock)
 					musb->g.a_alt_hnp_support = 1;
 					break;
 #endif
+				case USB_DEVICE_DEBUG_MODE:
+					handled = 0;
+					break;
 stall:
 				default:
 					handled = -EINVAL;

