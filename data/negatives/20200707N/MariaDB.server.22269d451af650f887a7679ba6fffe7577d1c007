commit 22269d451af650f887a7679ba6fffe7577d1c007
Author: heikki@hundin.mysql.fi <>
Date:   Tue Nov 2 13:21:11 2004 +0200

    ha_innodb.cc:
      Backport Jan's fix of the LOAD DATA INFILE REPLACE duplicate key error bug (Bug #5835) to 4.0

diff --git a/sql/ha_innodb.cc b/sql/ha_innodb.cc
index e747ff3210c..d57a9f73c91 100644
--- a/sql/ha_innodb.cc
+++ b/sql/ha_innodb.cc
@@ -2285,7 +2285,9 @@ ha_innobase::write_row(
 	        if (error == DB_DUPLICATE_KEY
 		    && (user_thd->lex.sql_command == SQLCOM_REPLACE
 			|| user_thd->lex.sql_command
-			                 == SQLCOM_REPLACE_SELECT)) {
+			                 == SQLCOM_REPLACE_SELECT
+		    	|| (user_thd->lex.sql_command == SQLCOM_LOAD
+			    && user_thd->lex.duplicates == DUP_REPLACE))) {
 
 		        skip_auto_inc_decr= TRUE;
 		}

