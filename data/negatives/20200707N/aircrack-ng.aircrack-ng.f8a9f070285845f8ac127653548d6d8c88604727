commit f8a9f070285845f8ac127653548d6d8c88604727
Author: Martin Beck <hirte@aircrack-ng.org>
Date:   Fri Feb 16 20:50:15 2007 +0000

    Fixed 384byte keystream output.
    
    git-svn-id: http://svn.aircrack-ng.org/trunk@183 28c6078b-6c39-48e3-add9-af49d547ecab

diff --git a/src/aireplay-ng.c b/src/aireplay-ng.c
index 7bed8da3..04970871 100644
--- a/src/aireplay-ng.c
+++ b/src/aireplay-ng.c
@@ -3179,9 +3179,12 @@ int do_attack_fragment()
             memset(h80211+24, '\x00', length+8);
         }
 
-        memcpy(iv, packet+24, 4);
-        memcpy(prga, packet+28, length);
-        xor_keystream(prga, h80211+24, length);
+        if(again != ABORT)
+        {
+            memcpy(iv, packet+24, 4);
+            memcpy(prga, packet+28, length);
+            xor_keystream(prga, h80211+24, length);
+        }
 
 
         lt = localtime(&tv.tv_sec);

