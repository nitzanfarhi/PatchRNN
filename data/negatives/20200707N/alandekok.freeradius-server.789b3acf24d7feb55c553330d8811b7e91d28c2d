commit 789b3acf24d7feb55c553330d8811b7e91d28c2d
Author: aland <aland>
Date:   Thu Mar 18 15:39:13 2004 +0000

            No proxy packet or proxy reply, don't do anything

diff --git a/src/modules/rlm_attr_rewrite/rlm_attr_rewrite.c b/src/modules/rlm_attr_rewrite/rlm_attr_rewrite.c
index 9a5c769ba..ad41cf157 100644
--- a/src/modules/rlm_attr_rewrite/rlm_attr_rewrite.c
+++ b/src/modules/rlm_attr_rewrite/rlm_attr_rewrite.c
@@ -205,9 +205,13 @@ static int do_attr_rewrite(void *instance, REQUEST *request)
 				tmp = request->reply->vps;
 				break;
 			case RLM_REGEX_INPROXY:
+				if (!request->proxy_reply)
+					return RLM_MODULE_NOOP;
 				tmp = request->proxy_reply->vps;
 				break;
 			case RLM_REGEX_INPROXYREPLY:
+				if (!request->proxy)
+					return RLM_MODULE_NOOP;
 				tmp = request->proxy->vps;
 				break;
 			default:

