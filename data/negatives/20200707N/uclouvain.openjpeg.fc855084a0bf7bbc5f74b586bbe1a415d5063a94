commit fc855084a0bf7bbc5f74b586bbe1a415d5063a94
Author: Mathieu Malaterre <mathieu.malaterre@gmail.com>
Date:   Fri Feb 28 14:52:58 2014 +0000

    [trunk] Really apply r2460 this time, but fix the original typo in the submitted patch
    Update issue 225

diff --git a/src/lib/openjp2/j2k.c b/src/lib/openjp2/j2k.c
index 924fdd60..bd39f759 100644
--- a/src/lib/openjp2/j2k.c
+++ b/src/lib/openjp2/j2k.c
@@ -4481,6 +4481,14 @@ static OPJ_BOOL opj_j2k_read_rgn (opj_j2k_t *p_j2k,
         };
 #endif /* USE_JPWL */
 
+        /* testcase 3635.pdf.asan.77.2930 */
+        if (l_comp_no >= l_nb_comp) {
+                opj_event_msg(p_manager, EVT_ERROR,
+                        "bad component number in RGN (%d when there are only %d)\n",
+                        l_comp_no, l_nb_comp);
+                return OPJ_FALSE;
+        }
+
         opj_read_bytes(p_header_data,(OPJ_UINT32 *) (&(l_tcp->tccps[l_comp_no].roishift)),1);   /* SPrgn */
         ++p_header_data;
 

