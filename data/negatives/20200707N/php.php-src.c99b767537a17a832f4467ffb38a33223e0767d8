commit c99b767537a17a832f4467ffb38a33223e0767d8
Author: Dmitry Stogov <dmitry@zend.com>
Date:   Wed Apr 9 10:47:03 2014 +0400

    Fixed generator destruction

diff --git a/Zend/zend_generators.c b/Zend/zend_generators.c
index 559e9f2e20..29941c12e3 100644
--- a/Zend/zend_generators.c
+++ b/Zend/zend_generators.c
@@ -597,8 +597,9 @@ ZEND_METHOD(Generator, __wakeup)
 static void zend_generator_iterator_dtor(zend_object_iterator *iterator TSRMLS_DC) /* {{{ */
 {
 	zend_generator *generator = (zend_generator*)Z_OBJ(iterator->data);
-	zval_ptr_dtor(&iterator->data);
 	generator->iterator = NULL;
+	zval_ptr_dtor(&iterator->data);
+	zend_iterator_dtor(iterator TSRMLS_CC);
 }
 /* }}} */
 

