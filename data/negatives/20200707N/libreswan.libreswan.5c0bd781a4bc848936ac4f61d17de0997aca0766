commit 5c0bd781a4bc848936ac4f61d17de0997aca0766
Author: Antony Antony <antony@phenome.org>
Date:   Wed Oct 11 11:57:13 2017 +0200

    pluto: dpdaction=restart folloup to 24f14ba85ed250b
    
    aslo check c->kind=CK_INSTANCE when deciding dangling hp

diff --git a/programs/pluto/initiate.c b/programs/pluto/initiate.c
index 763c6af95..0a33ed0a4 100644
--- a/programs/pluto/initiate.c
+++ b/programs/pluto/initiate.c
@@ -431,7 +431,8 @@ void restart_connections_by_peer(struct connection *const c)
 		host_addr = c->spd.that.host_addr;
 	}
 
-	if (hp_next == NULL)  {
+	if (c_kind == CK_INSTANCE && hp_next == NULL) {
+		/* in simple cases this is  a dangling hp */
 		DBG(DBG_CONTROL,
 			DBG_log ("no connection to restart after termination"));
 	} else {

