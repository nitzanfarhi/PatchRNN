commit 73ef19314649fbd915d39c04de5057ece3b604e4
Author: H Hartley Sweeten <hsweeten@visionengravers.com>
Date:   Mon Oct 20 11:34:27 2014 -0700

    staging: comedi: addi_apci_3120: reset the board before hooking up the interrupt
    
    Move the apci3120_reset() call in the (*auto_attach) to ensure that the board
    is reset before hooking up the interrupt.
    
    Signed-off-by: H Hartley Sweeten <hsweeten@visionengravers.com>
    Reviewed-by: Ian Abbott <abbotti@mev.co.uk>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

diff --git a/drivers/staging/comedi/drivers/addi_apci_3120.c b/drivers/staging/comedi/drivers/addi_apci_3120.c
index ec6f89b9e99c..3b4fa2ebbc85 100644
--- a/drivers/staging/comedi/drivers/addi_apci_3120.c
+++ b/drivers/staging/comedi/drivers/addi_apci_3120.c
@@ -154,6 +154,8 @@ static int apci3120_auto_attach(struct comedi_device *dev,
 	devpriv->amcc = pci_resource_start(pcidev, 0);
 	devpriv->addon = pci_resource_start(pcidev, 2);
 
+	apci3120_reset(dev);
+
 	if (pcidev->irq > 0) {
 		ret = request_irq(pcidev->irq, apci3120_interrupt, IRQF_SHARED,
 				  dev->board_name, dev);
@@ -232,7 +234,6 @@ static int apci3120_auto_attach(struct comedi_device *dev,
 	s->insn_read	= apci3120_read_insn_timer;
 	s->insn_config	= apci3120_config_insn_timer;
 
-	apci3120_reset(dev);
 	return 0;
 }
 

