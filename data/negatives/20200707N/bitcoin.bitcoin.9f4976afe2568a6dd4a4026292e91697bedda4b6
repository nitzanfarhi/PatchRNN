commit 9f4976afe2568a6dd4a4026292e91697bedda4b6
Author: Jeff Garzik <jgarzik@exmulti.com>
Date:   Wed May 1 10:41:24 2013 -0400

    RPC: strictly require HTTP URI "/"
    
    Previously, JSON-RPC clients accessed URI "/", and the JSON-RPC server
    did not care about the URI at all, and would accept any URI as valid.
    
    Change the JSON-RPC server to require URI "/" for all current accesses.
    
    This changes enables the addition of future interfaces at different
    URIs, such as pull request #1982 which demonstrates HTTP REST wallet
    download.
    
    Or, a future, breaking change in JSON-RPC interface could be introduced
    by serving JSON-RPC calls from new URI "/v2/".

diff --git a/src/bitcoinrpc.cpp b/src/bitcoinrpc.cpp
index 9c126fc3d..a9b73fd5a 100644
--- a/src/bitcoinrpc.cpp
+++ b/src/bitcoinrpc.cpp
@@ -940,6 +940,11 @@ void ServiceConnection(AcceptedConnection *conn)
         // Read HTTP message headers and body
         ReadHTTPMessage(conn->stream(), mapHeaders, strRequest, nProto);
 
+        if (strURI != "/") {
+            conn->stream() << HTTPReply(HTTP_NOT_FOUND, "", false) << std::flush;
+            break;
+        }
+
         // Check authorization
         if (mapHeaders.count("authorization") == 0)
         {

