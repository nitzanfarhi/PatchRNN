commit bfc5f2d67c97012076b67d82b17628421e3d4335
Author: Kevin Lin <klin@sourcefire.com>
Date:   Thu Feb 18 11:44:54 2016 -0500

    hwp3.x: enable password cancelling of parsing

diff --git a/libclamav/hwp.c b/libclamav/hwp.c
index 8c83691b6..996048ded 100644
--- a/libclamav/hwp.c
+++ b/libclamav/hwp.c
@@ -1847,6 +1847,12 @@ int cli_scanhwp3(cli_ctx *ctx)
 
     offset += HWP3_DOCSUMMARY_SIZE;
 
+    /* password-protected document - cannot parse */
+    if (docinfo.di_passwd) {
+        cli_dbgmsg("HWP3.x: password-protected file, skip parsing\n");
+        return CL_SUCCESS;
+    }
+
     if (docinfo.di_infoblksize) {
         /* OPTIONAL TODO: HANDLE OPTIONAL INFORMATION BLOCK #0's FOR PRECLASS */
         offset += docinfo.di_infoblksize;

