commit eb0094b224389fd7c337e3bf354b0d9120f9e961
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Fri Dec 26 18:14:59 2008 +0000

    And another sechole ...
    
    Originally committed as revision 16346 to svn://svn.ffmpeg.org/ffmpeg/trunk

diff --git a/libavcodec/faxcompr.c b/libavcodec/faxcompr.c
index 72ad8b95da..424de599b5 100644
--- a/libavcodec/faxcompr.c
+++ b/libavcodec/faxcompr.c
@@ -217,7 +217,7 @@ static int decode_group3_2d_line(AVCodecContext *avctx, GetBitContext *gb,
             else
                 run_off -= *--ref;
             offs += run;
-            if(offs > width){
+            if(offs > width || run > width){
                 av_log(avctx, AV_LOG_ERROR, "Run went out of bounds\n");
                 return -1;
             }

