commit f854824bc50c3a05d7773dce81052f9eb8670d5f
Author: Grégoire Barbier <gb@gbarbier.org>
Date:   Sun Jan 13 20:02:59 2008 +0100

    http-push: disable http-push without USE_CURL_MULTI
    
    Make http-push always fail when not compiled with USE_CURL_MULTI, since
    otherwise it corrupts the remote repository (and then fails anyway).
    
    Signed-off-by: Grégoire Barbier <gb@gbarbier.org>
    Signed-off-by: Junio C Hamano <gitster@pobox.com>

diff --git a/http-push.c b/http-push.c
index 55d0c944a..eef767453 100644
--- a/http-push.c
+++ b/http-push.c
@@ -2212,6 +2212,10 @@ int main(int argc, char **argv)
 		break;
 	}
 
+#ifndef USE_CURL_MULTI
+	die("git-push is not available for http/https repository when not compiled with USE_CURL_MULTI");
+#endif
+
 	if (!remote->url)
 		usage(http_push_usage);
 

