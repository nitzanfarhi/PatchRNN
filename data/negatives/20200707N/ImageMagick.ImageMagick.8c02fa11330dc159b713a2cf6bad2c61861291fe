commit 8c02fa11330dc159b713a2cf6bad2c61861291fe
Author: cristy <urban-warrior@git.imagemagick.org>
Date:   Wed Jan 27 01:10:17 2010 +0000

diff --git a/magick/identify.c b/magick/identify.c
index 9e0982fab..513ab9024 100644
--- a/magick/identify.c
+++ b/magick/identify.c
@@ -480,9 +480,12 @@ MagickExport MagickBooleanType IdentifyImage(Image *image,FILE *file,
     }
   channel_features=(ChannelFeatures *) NULL;
   artifact=GetImageArtifact(image,"identify:features");
-  distance=StringToUnsignedLong(artifact);
   if ((ping == MagickFalse) && (artifact != (const char *) NULL))
-    channel_features=GetImageChannelFeatures(image,distance,&image->exception);
+    {
+      distance=StringToUnsignedLong(artifact);
+      channel_features=GetImageChannelFeatures(image,distance,
+        &image->exception);
+    }
   if (channel_features != (ChannelFeatures *) NULL)
     {
       (void) fprintf(file,"  Channel features (0, 45, 90, 135):\n");

