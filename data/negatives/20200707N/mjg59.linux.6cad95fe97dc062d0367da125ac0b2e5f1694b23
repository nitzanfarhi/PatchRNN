commit 6cad95fe97dc062d0367da125ac0b2e5f1694b23
Author: Stefan Richter <stefanr@s5r6.in-berlin.de>
Date:   Sun Jan 21 20:46:45 2007 +0100

    firewire: fix failure path in ohci_enable_phys_dma
    
    "goto out" happens with the lock taken.
    
    Signed-off-by: Stefan Richter <stefanr@s5r6.in-berlin.de>
    Signed-off-by: Kristian HÃ¸gsberg <krh@redhat.com>

diff --git a/drivers/firewire/fw-ohci.c b/drivers/firewire/fw-ohci.c
index ea52e150a8e6..1b4b53d6d925 100644
--- a/drivers/firewire/fw-ohci.c
+++ b/drivers/firewire/fw-ohci.c
@@ -850,10 +850,8 @@ ohci_enable_phys_dma(struct fw_card *card, int node_id, int generation)
 			  1 << (node_id - 32));
 	}
 	flush_writes(ohci);
-
-	spin_unlock_irqrestore(&ohci->lock, flags);
-
  out:
+	spin_unlock_irqrestore(&ohci->lock, flags);
 	return retval;
 }
 

