commit 9c962f3c12e00865a2cf85ef3dfeb74f612755ed
Author: Jimmy Yang <jimmy.yang@oracle.com>
Date:   Wed Jan 30 18:33:27 2013 +0800

    fix Bug #15907954 - SETTING INNODB_MIRRORED_LOG_GROUPS = 2 LEADS TO SERVER
    CRASH
    
    rb://1888 approved by Marko

diff --git a/plugin/innodb_memcached/innodb_memcache/src/innodb_engine.c b/plugin/innodb_memcached/innodb_memcache/src/innodb_engine.c
index 99b18e2a93b..8939a494072 100644
--- a/plugin/innodb_memcached/innodb_memcache/src/innodb_engine.c
+++ b/plugin/innodb_memcached/innodb_memcache/src/innodb_engine.c
@@ -376,6 +376,12 @@ innodb_initialize(
 
 	my_eng_config = (eng_config_info_t*) config_str;
 
+	/* If no call back function registered (InnoDB engine failed to load),
+	load InnoDB Memcached engine should fail too */
+	if (!my_eng_config->cb_ptr) {
+		return(ENGINE_TMPFAIL);
+	}
+
 	/* Register the call back function */
 	register_innodb_cb((void*) my_eng_config->cb_ptr);
 

