commit 8d3c1fd8c3a4a4a1a319491cdd09bd7eca23ba3b
Author: Eliad Peller <eliad@wizery.com>
Date:   Mon Sep 9 12:24:44 2013 +0300

    wlcore: save last regdom configuration on stop
    
    In order to reconfigure the correct reg domain on
    recovery, we have to save the current configuration
    before clearing it (wl->reg_ch_conf_pending is
    considered before configuring a new regdomain).
    
    Signed-off-by: Eliad Peller <eliad@wizery.com>
    Signed-off-by: Luciano Coelho <luciano.coelho@intel.com>

diff --git a/drivers/net/wireless/ti/wlcore/main.c b/drivers/net/wireless/ti/wlcore/main.c
index a9ee23417716..0368b9cbfb89 100644
--- a/drivers/net/wireless/ti/wlcore/main.c
+++ b/drivers/net/wireless/ti/wlcore/main.c
@@ -1949,8 +1949,10 @@ static void wlcore_op_stop_locked(struct wl1271 *wl)
 
 	/*
 	 * FW channels must be re-calibrated after recovery,
-	 * clear the last Reg-Domain channel configuration.
+	 * save current Reg-Domain channel configuration and clear it.
 	 */
+	memcpy(wl->reg_ch_conf_pending, wl->reg_ch_conf_last,
+	       sizeof(wl->reg_ch_conf_pending));
 	memset(wl->reg_ch_conf_last, 0, sizeof(wl->reg_ch_conf_last));
 }
 

