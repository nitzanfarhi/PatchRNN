commit 8915f980c1b051b4ddc7d15e027a5896611e4029
Author: Rajkumar Manoharan <rmanohar@qca.qualcomm.com>
Date:   Thu Nov 10 15:14:57 2011 +0530

    ath9k_hw: Fix tx power settings for AR9003
    
    Retriving tx power for 2x2 and 3x3 chainmask is not handled
    properly. While calculating tx power for 2x2, 3 dBm was reduced
    and for 3x3, 5 dBm was reduced which should be added back when
    retriving.
    
    Cc: Paul Stewart <pstew@google.com>
    Signed-off-by: Rajkumar Manoharan <rmanohar@qca.qualcomm.com>
    Signed-off-by: John W. Linville <linville@tuxdriver.com>

diff --git a/drivers/net/wireless/ath/ath9k/ar9003_eeprom.c b/drivers/net/wireless/ath/ath9k/ar9003_eeprom.c
index ee9c09b23662..a93bd63ad23b 100644
--- a/drivers/net/wireless/ath/ath9k/ar9003_eeprom.c
+++ b/drivers/net/wireless/ath/ath9k/ar9003_eeprom.c
@@ -5059,6 +5059,8 @@ static void ath9k_hw_ar9300_set_txpower(struct ath_hw *ah,
 			regulatory->max_power_level = targetPowerValT2[i];
 	}
 
+	ath9k_hw_update_regulatory_maxpower(ah);
+
 	if (test)
 		return;
 

