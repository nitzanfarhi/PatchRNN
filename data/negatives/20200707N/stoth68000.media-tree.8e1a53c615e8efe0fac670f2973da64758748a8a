commit 8e1a53c615e8efe0fac670f2973da64758748a8a
Author: Dan Carpenter <error27@gmail.com>
Date:   Sun Mar 28 14:55:00 2010 +0300

    iwlwifi: range checking issue
    
    IWL_RATE_COUNT is 13 and IWL_RATE_COUNT_LEGACY is 12.
    
    IWL_RATE_COUNT_LEGACY is the right one here because iwl3945_rates
    doesn't support 60M and also that's how "rates" is defined in
    iwlcore_init_geos() from drivers/net/wireless/iwlwifi/iwl-core.c.
    
            rates = kzalloc((sizeof(struct ieee80211_rate) * IWL_RATE_COUNT_LEGACY),
                            GFP_KERNEL);
    
    Signed-off-by: Dan Carpenter <error27@gmail.com>
    Cc: stable@kernel.org
    Acked-by: Zhu Yi <yi.zhu@intel.com>
    Signed-off-by: John W. Linville <linville@tuxdriver.com>

diff --git a/drivers/net/wireless/iwlwifi/iwl3945-base.c b/drivers/net/wireless/iwlwifi/iwl3945-base.c
index f93013e9b17d..e276f2a4e835 100644
--- a/drivers/net/wireless/iwlwifi/iwl3945-base.c
+++ b/drivers/net/wireless/iwlwifi/iwl3945-base.c
@@ -1955,7 +1955,7 @@ static void iwl3945_init_hw_rates(struct iwl_priv *priv,
 {
 	int i;
 
-	for (i = 0; i < IWL_RATE_COUNT; i++) {
+	for (i = 0; i < IWL_RATE_COUNT_LEGACY; i++) {
 		rates[i].bitrate = iwl3945_rates[i].ieee * 5;
 		rates[i].hw_value = i; /* Rate scaling will work on indexes */
 		rates[i].hw_value_short = i;

