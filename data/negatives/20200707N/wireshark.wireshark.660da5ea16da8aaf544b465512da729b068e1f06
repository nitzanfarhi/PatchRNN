commit 660da5ea16da8aaf544b465512da729b068e1f06
Author: Alexis La Goutte <alexis.lagoutte@gmail.com>
Date:   Wed Sep 3 17:56:21 2014 +0200

    RTPS: fix Result of operation is garbage or undefined
    
    Missing get num_virtual_guids value...
    
    Change-Id: I81a3dea3c96fb946c5c26ffe4ab2bfb82d1d8222
    Reviewed-on: https://code.wireshark.org/review/3972
    Reviewed-by: Evan Huus <eapache@gmail.com>

diff --git a/epan/dissectors/packet-rtps.c b/epan/dissectors/packet-rtps.c
index a12dfb49b8..770283914c 100644
--- a/epan/dissectors/packet-rtps.c
+++ b/epan/dissectors/packet-rtps.c
@@ -6130,6 +6130,7 @@ static void dissect_HEARTBEAT_VIRTUAL(tvbuff_t *tvb, packet_info *pinfo _U_, gin
         if (!(flags & FLAG_VIRTUAL_HEARTBEAT_N)) {
           proto_tree_add_item(sil_tree_writer, hf_rtps_virtual_heartbeat_num_virtual_guids, tvb,
             offset, 4, little_endian ? ENC_LITTLE_ENDIAN : ENC_BIG_ENDIAN);
+          num_virtual_guids = NEXT_guint32(tvb, offset, little_endian);
           offset += 4;
         } else {
           num_virtual_guids = 0;

