commit 44257ef4267f01dd698c8ab8abf50fd77136a8ce
Author: Ronald S. Bultje <rsbultje@gmail.com>
Date:   Wed Mar 28 10:22:25 2012 -0700

    asf: only set index_read if the index contained entries.
    
    This allows falling back to a binary search if the file contains no
    index, thus fixing seeking in such files (e.g. luckynight.wma).

diff --git a/libavformat/asfdec.c b/libavformat/asfdec.c
index d3869b427b..f094647ba0 100644
--- a/libavformat/asfdec.c
+++ b/libavformat/asfdec.c
@@ -1235,7 +1235,7 @@ static void asf_build_simple_index(AVFormatContext *s, int stream_index)
             last_pos=pos;
             }
         }
-        asf->index_read= 1;
+        asf->index_read= ict > 0;
     }
     avio_seek(s->pb, current_pos, SEEK_SET);
 }

