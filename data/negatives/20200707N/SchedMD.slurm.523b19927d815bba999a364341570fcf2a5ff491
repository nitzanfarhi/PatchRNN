commit 523b19927d815bba999a364341570fcf2a5ff491
Author: jette <jette@schedmd.com>
Date:   Mon Jun 3 12:31:43 2013 -0700

    Fix for job step allocation with required hostlist and exclusive option
    
    Previously if the required node has no available CPUs left, then other
    nodes in the job allocation would be used

diff --git a/src/slurmctld/step_mgr.c b/src/slurmctld/step_mgr.c
index 3d344c54dd..5bcf3eb46f 100644
--- a/src/slurmctld/step_mgr.c
+++ b/src/slurmctld/step_mgr.c
@@ -943,6 +943,7 @@ _pick_step_nodes (struct job_record  *job_ptr,
 			if (!bit_super_set(selected_nodes, nodes_avail)) {
 				/* some required nodes have no available
 				 * processors, defer request */
+				i_last = -1;
 				tasks_picked_cnt = 0;
 			}
 			FREE_NULL_BITMAP(selected_nodes);

