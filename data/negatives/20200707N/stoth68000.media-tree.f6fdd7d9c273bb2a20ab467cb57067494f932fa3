commit f6fdd7d9c273bb2a20ab467cb57067494f932fa3
Author: Linus Torvalds <torvalds@g5.osdl.org>
Date:   Sat Aug 20 18:51:29 2005 -0700

    Don't allow normal users to set idle IO priority
    
    It has all the normal priority inversion problems.
    
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

diff --git a/fs/ioprio.c b/fs/ioprio.c
index 97e1f088ba00..d1c1f2b2c9da 100644
--- a/fs/ioprio.c
+++ b/fs/ioprio.c
@@ -62,6 +62,8 @@ asmlinkage long sys_ioprio_set(int which, int who, int ioprio)
 
 			break;
 		case IOPRIO_CLASS_IDLE:
+			if (!capable(CAP_SYS_ADMIN))
+				return -EPERM;
 			break;
 		default:
 			return -EINVAL;

