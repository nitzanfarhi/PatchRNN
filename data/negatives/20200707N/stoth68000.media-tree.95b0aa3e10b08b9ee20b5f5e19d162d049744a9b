commit 95b0aa3e10b08b9ee20b5f5e19d162d049744a9b
Author: Peter Griffin <peter.griffin@linaro.org>
Date:   Tue Jun 7 18:38:36 2016 +0100

    dmaengine: coh901318: Only calculate residue if txstate exists.
    
    There is no point in calculating the residue if there is no
    txstate to store the value.
    
    Signed-off-by: Peter Griffin <peter.griffin@linaro.org>
    Acked-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

diff --git a/drivers/dma/coh901318.c b/drivers/dma/coh901318.c
index c340ca9bd2b5..c1006165cea8 100644
--- a/drivers/dma/coh901318.c
+++ b/drivers/dma/coh901318.c
@@ -2422,7 +2422,7 @@ coh901318_tx_status(struct dma_chan *chan, dma_cookie_t cookie,
 	enum dma_status ret;
 
 	ret = dma_cookie_status(chan, cookie, txstate);
-	if (ret == DMA_COMPLETE)
+	if (ret == DMA_COMPLETE || !txstate)
 		return ret;
 
 	dma_set_residue(txstate, coh901318_get_bytes_left(chan));

