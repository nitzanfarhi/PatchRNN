commit 9a4c0fc4d83f2f97efbfe49b4230be48a78d8057
Author: Tim Kientzle <kientzle@gmail.com>
Date:   Wed Jan 7 00:58:23 2009 -0500

    Minor style fix:  Test for null bidder object before trying to
    allocate state.
    
    SVN-Revision: 398

diff --git a/libarchive/archive_read_support_compression_program.c b/libarchive/archive_read_support_compression_program.c
index 884b5493..6a9823a3 100644
--- a/libarchive/archive_read_support_compression_program.c
+++ b/libarchive/archive_read_support_compression_program.c
@@ -109,12 +109,12 @@ archive_read_support_compression_program(struct archive *_a, const char *cmd)
 	struct archive_read_filter_bidder *bidder = __archive_read_get_bidder(a);
 	struct program_bidder *state;
 
-	state = (struct program_bidder *)calloc(sizeof (*state), 1);
+	if (bidder == NULL)
+		return (ARCHIVE_FATAL);
 
+	state = (struct program_bidder *)calloc(sizeof (*state), 1);
 	if (state == NULL)
 		return (ARCHIVE_FATAL);
-	if (bidder == NULL)
-		return (ARCHIVE_FATAL);
 
 	state->cmd = strdup(cmd);
 	state->bid = INT_MAX;

