commit 43a33c53cc9131a537522ab9736c6e4c03ddf57a
Author: Denis Cheng <crquan@gmail.com>
Date:   Tue Feb 26 15:25:04 2008 +0800

    [GFS2] re-support special inode
    
    a previous commit removed call to
    init_special_inode from inode lookuping, this cause problems as:
    
     # mknod /mnt/gfs2/dev/null c 1 3
     # cat /mnt/gfs2/dev/null
     cat: /mnt/gfs2/dev/null: Invalid argument
    
    without special inode, GFS2 cannot support char device file,
    block device file, fifo pipe, and socket file, lose many important
    features as a common file system.
    
    this one line patch re add special inode support.
    
    Signed-off-by: Denis Cheng <crquan@gmail.com>
    Signed-off-by: Steven Whitehouse <swhiteho@redhat.com>

diff --git a/fs/gfs2/inode.c b/fs/gfs2/inode.c
index 7b9f31e5d6d3..92ea9afacb17 100644
--- a/fs/gfs2/inode.c
+++ b/fs/gfs2/inode.c
@@ -150,6 +150,7 @@ void gfs2_set_iop(struct inode *inode)
 		inode->i_op = &gfs2_symlink_iops;
 	} else {
 		inode->i_op = &gfs2_file_iops;
+		init_special_inode(inode, inode->i_mode, inode->i_rdev);
 	}
 
 	unlock_new_inode(inode);

