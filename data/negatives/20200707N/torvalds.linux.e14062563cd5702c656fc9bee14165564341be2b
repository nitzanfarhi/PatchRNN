commit e14062563cd5702c656fc9bee14165564341be2b
Author: Mike Frysinger <vapier@gentoo.org>
Date:   Wed Jun 8 15:48:57 2011 -0400

    Blackfin: debug-mmrs: disable PERIPHERAL_MAP for IMDMA channels
    
    The documentation for the IMDMA channels appears to be incorrect.
    These DMA blocks don't actually have PERIPHERAL_MAP MMRs for us
    to access.  Attempts to do so lead to system mmr hardware errors.
    
    Signed-off-by: Mike Frysinger <vapier@gentoo.org>

diff --git a/arch/blackfin/kernel/debug-mmrs.c b/arch/blackfin/kernel/debug-mmrs.c
index 40b3a64f8b60..26ebfe8f63c2 100644
--- a/arch/blackfin/kernel/debug-mmrs.c
+++ b/arch/blackfin/kernel/debug-mmrs.c
@@ -223,7 +223,8 @@ bfin_debug_mmrs_dma(struct dentry *parent, unsigned long base, int num, char mdm
 	__DMA(CURR_DESC_PTR, curr_desc_ptr);
 	__DMA(CURR_ADDR, curr_addr);
 	__DMA(IRQ_STATUS, irq_status);
-	__DMA(PERIPHERAL_MAP, peripheral_map);
+	if (strcmp(pfx, "IMDMA") != 0)
+		__DMA(PERIPHERAL_MAP, peripheral_map);
 	__DMA(CURR_X_COUNT, curr_x_count);
 	__DMA(CURR_Y_COUNT, curr_y_count);
 }

