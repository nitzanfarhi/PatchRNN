commit bf0dd0513e016abb4025748fe12e57539078c70b
Author: danieldg <danieldg@e03df62e-2008-0410-955e-edbf42e46eb7>
Date:   Mon Feb 15 23:02:24 2010 +0000

    Dump sendq before closing socket
    
    git-svn-id: http://svn.inspircd.org/repository/trunk/inspircd@12469 e03df62e-2008-0410-955e-edbf42e46eb7

diff --git a/src/inspsocket.cpp b/src/inspsocket.cpp
index f06ddf28d..65b554006 100644
--- a/src/inspsocket.cpp
+++ b/src/inspsocket.cpp
@@ -120,6 +120,8 @@ void StreamSocket::Close()
 {
 	if (this->fd > -1)
 	{
+		// final chance, dump as much of the sendq as we can
+		DoWrite();
 		if (IOHook)
 		{
 			try

