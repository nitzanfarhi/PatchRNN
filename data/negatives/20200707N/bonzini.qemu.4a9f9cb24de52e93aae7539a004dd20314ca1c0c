commit 4a9f9cb24de52e93aae7539a004dd20314ca1c0c
Author: Peter Maydell <peter.maydell@linaro.org>
Date:   Fri Mar 11 08:12:26 2011 +0000

    target-arm: Use new softfloat min/max functions for VMAX, VMIN
    
    Use the new softfloat min/max functions to implement the Neon VMAX
    and VMIN instructions. This allows us to get the right behaviour
    for NaN and negative zero.
    
    Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
    Signed-off-by: Aurelien Jarno <aurelien@aurel32.net>

diff --git a/target-arm/neon_helper.c b/target-arm/neon_helper.c
index bf324c62b6..71f1a7ead0 100644
--- a/target-arm/neon_helper.c
+++ b/target-arm/neon_helper.c
@@ -1773,16 +1773,12 @@ uint32_t HELPER(neon_qneg_s32)(CPUState *env, uint32_t x)
 /* NEON Float helpers.  */
 uint32_t HELPER(neon_min_f32)(uint32_t a, uint32_t b)
 {
-    float32 f0 = make_float32(a);
-    float32 f1 = make_float32(b);
-    return (float32_compare_quiet(f0, f1, NFS) == -1) ? a : b;
+    return float32_val(float32_min(make_float32(a), make_float32(b), NFS));
 }
 
 uint32_t HELPER(neon_max_f32)(uint32_t a, uint32_t b)
 {
-    float32 f0 = make_float32(a);
-    float32 f1 = make_float32(b);
-    return (float32_compare_quiet(f0, f1, NFS) == 1) ? a : b;
+    return float32_val(float32_max(make_float32(a), make_float32(b), NFS));
 }
 
 uint32_t HELPER(neon_abd_f32)(uint32_t a, uint32_t b)

