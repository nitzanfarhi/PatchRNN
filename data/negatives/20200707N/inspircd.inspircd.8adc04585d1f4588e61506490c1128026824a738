commit 8adc04585d1f4588e61506490c1128026824a738
Author: Attila Molnar <attilamolnar@hush.com>
Date:   Sun Oct 11 16:27:10 2015 +0200

    Revert "Fix sending the wrong numerics on join when a topic is empty."
    
    This reverts commit b0e64b8cea2d721588d92072a8d16fdd99a9c945.
    
    The original behavior isn't RFC incompliant, see #1095.

diff --git a/src/channels.cpp b/src/channels.cpp
index 6802e3d7d..9f1eafd0c 100644
--- a/src/channels.cpp
+++ b/src/channels.cpp
@@ -412,7 +412,7 @@ Channel* Channel::ForceChan(Channel* Ptr, User* user, const std::string &privs,
 
 	if (IS_LOCAL(user))
 	{
-		if (!Ptr->topic.empty())
+		if (Ptr->topicset)
 		{
 			user->WriteNumeric(RPL_TOPIC, "%s %s :%s", user->nick.c_str(), Ptr->name.c_str(), Ptr->topic.c_str());
 			user->WriteNumeric(RPL_TOPICTIME, "%s %s %s %lu", user->nick.c_str(), Ptr->name.c_str(), Ptr->setby.c_str(), (unsigned long)Ptr->topicset);

