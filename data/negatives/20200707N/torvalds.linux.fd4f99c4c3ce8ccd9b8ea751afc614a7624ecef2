commit fd4f99c4c3ce8ccd9b8ea751afc614a7624ecef2
Author: Boris Brezillon <boris.brezillon@free-electrons.com>
Date:   Tue Jun 14 11:13:17 2016 +0200

    regulator: pwm: Adjust PWM config at probe time
    
    The PWM attached to a PWM regulator device might have been previously
    configured by the bootloader.
    Make sure the bootloader and linux config are in sync, and adjust the PWM
    config if that's not the case.
    
    Signed-off-by: Boris Brezillon <boris.brezillon@free-electrons.com>
    Acked-by: Mark Brown <broonie@kernel.org>
    Acked-by: Brian Norris <briannorris@chromium.org>
    Tested-by: Brian Norris <briannorris@chromium.org>
    Tested-by: Heiko Stuebner <heiko@sntech.de>
    Signed-off-by: Thierry Reding <thierry.reding@gmail.com>

diff --git a/drivers/regulator/pwm-regulator.c b/drivers/regulator/pwm-regulator.c
index 666bc3bb52ef..cb2f22c02469 100644
--- a/drivers/regulator/pwm-regulator.c
+++ b/drivers/regulator/pwm-regulator.c
@@ -316,11 +316,9 @@ static int pwm_regulator_probe(struct platform_device *pdev)
 		return ret;
 	}
 
-	/*
-	 * FIXME: pwm_apply_args() should be removed when switching to the
-	 * atomic PWM API.
-	 */
-	pwm_apply_args(drvdata->pwm);
+	ret = pwm_adjust_config(drvdata->pwm);
+	if (ret)
+		return ret;
 
 	regulator = devm_regulator_register(&pdev->dev,
 					    &drvdata->desc, &config);

