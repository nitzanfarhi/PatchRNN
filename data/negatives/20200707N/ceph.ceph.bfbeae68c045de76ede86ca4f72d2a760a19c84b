commit bfbeae68c045de76ede86ca4f72d2a760a19c84b
Author: Henry C Chang <henry.cy.chang@gmail.com>
Date:   Thu Dec 22 18:49:04 2011 +0800

    monmap: clear addr_name map on calculating ranks
    
    We should clear addr_name before filling it. Otherwise, the removed
    mon will stay there and cause incorrect rank assignment.
    
    Signed-off-by: Henry C Chang <henry.cy.chang@gmail.com>

diff --git a/src/mon/MonMap.h b/src/mon/MonMap.h
index 651a1466ae..ffeb572cca 100644
--- a/src/mon/MonMap.h
+++ b/src/mon/MonMap.h
@@ -40,6 +40,7 @@ class MonMap {
   void calc_ranks() {
     rank_name.resize(mon_addr.size());
     rank_addr.resize(mon_addr.size());
+    addr_name.clear();
     for (map<string,entity_addr_t>::iterator p = mon_addr.begin();
 	 p != mon_addr.end();
 	 p++) {

