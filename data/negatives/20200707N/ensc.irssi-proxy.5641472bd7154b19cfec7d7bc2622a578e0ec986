commit 5641472bd7154b19cfec7d7bc2622a578e0ec986
Author: jilles <jilles@dbcabf3a-b0e7-0310-adc4-f8d773084564>
Date:   Fri Apr 3 17:49:58 2009 +0000

    Show numerics directed at channels in the channel window.
    This is about numerics where the target parameter is
    a channel, i.e.  ":<server> <numeric> <#channel> ..."
    Usually, this parameter is the user's nick or an asterisk.
    An example is the numeric ircd-ratbox and charybdis send
    to channel operators on a successful /knock.
    
    
    git-svn-id: http://svn.irssi.org/repos/irssi/trunk@5056 dbcabf3a-b0e7-0310-adc4-f8d773084564

diff --git a/src/fe-common/irc/fe-events-numeric.c b/src/fe-common/irc/fe-events-numeric.c
index dbc061d..93e1d79 100644
--- a/src/fe-common/irc/fe-events-numeric.c
+++ b/src/fe-common/irc/fe-events-numeric.c
@@ -555,13 +555,15 @@ static void print_event_received(IRC_SERVER_REC *server, const char *data,
 
 	g_return_if_fail(data != NULL);
 
-        /* skip first param, it's always our nick */
+        /* first param is our nick, "*" or a channel */
 	ptr = strchr(data, ' ');
 	if (ptr == NULL)
 		return;
 	ptr++;
 
-	if (!target_param || *ptr == ':' || (ptr2 = strchr(ptr, ' ')) == NULL)
+	if (ischannel(*data)) /* directed at channel */
+		target = g_strndup(data, (int)(ptr - data - 1));
+	else if (!target_param || *ptr == ':' || (ptr2 = strchr(ptr, ' ')) == NULL)
 		target = NULL;
 	else {
                 /* target parameter expected and present */

