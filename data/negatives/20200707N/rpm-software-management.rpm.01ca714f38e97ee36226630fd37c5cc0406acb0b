commit 01ca714f38e97ee36226630fd37c5cc0406acb0b
Author: Panu Matilainen <pmatilai@redhat.com>
Date:   Wed Jun 8 18:44:39 2011 +0300

    Add cursor method for retrieving the underlying db index handle

diff --git a/lib/backend/db3.c b/lib/backend/db3.c
index e06aa96d3..38f14deee 100644
--- a/lib/backend/db3.c
+++ b/lib/backend/db3.c
@@ -354,6 +354,11 @@ unsigned int dbiCursorCount(dbiCursor dbc)
     return count;
 }
 
+dbiIndex dbiCursorIndex(dbiCursor dbc)
+{
+    return (dbc != NULL) ? dbc->dbi : NULL;
+}
+
 int dbiByteSwapped(dbiIndex dbi)
 {
     DB * db = dbi->dbi_db;
diff --git a/lib/backend/dbi.h b/lib/backend/dbi.h
index 50b975116..848f28829 100644
--- a/lib/backend/dbi.h
+++ b/lib/backend/dbi.h
@@ -249,6 +249,13 @@ int dbiCursorDel(dbiCursor dbc, DBT * key, DBT * data, unsigned int flags);
 RPM_GNUC_INTERNAL
 unsigned int dbiCursorCount(dbiCursor dbc);
 
+/** \ingroup dbi
+ * Retrieve underlying index database handle.
+ * @param dbcursor	database cursor
+ * @return		index database handle
+ */
+RPM_GNUC_INTERNAL
+dbiIndex dbiCursorIndex(dbiCursor dbc);
 #ifdef __cplusplus
 }
 #endif

