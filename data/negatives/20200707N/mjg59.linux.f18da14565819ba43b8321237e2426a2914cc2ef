commit f18da14565819ba43b8321237e2426a2914cc2ef
Author: Stefan Gula <steweg@gmail.com>
Date:   Thu Jan 26 11:01:06 2012 +0000

    net: RTNETLINK adjusting values of min_ifinfo_dump_size
    
    Setting link parameters on a netdevice changes the value
    of if_nlmsg_size(), therefore it is necessary to recalculate
    min_ifinfo_dump_size.
    
    Signed-off-by: Stefan Gula <steweg@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/net/core/rtnetlink.c b/net/core/rtnetlink.c
index f16444bc6cbb..65aebd450027 100644
--- a/net/core/rtnetlink.c
+++ b/net/core/rtnetlink.c
@@ -1509,6 +1509,9 @@ errout:
 
 	if (send_addr_notify)
 		call_netdevice_notifiers(NETDEV_CHANGEADDR, dev);
+	min_ifinfo_dump_size = max_t(u16, if_nlmsg_size(dev),
+				     min_ifinfo_dump_size);
+
 	return err;
 }
 

