commit 4027e3b88580e011b799cd4c2d7b94b400ba6f73
Author: Sergei Golubchik <serg@mariadb.org>
Date:   Fri Nov 21 14:45:25 2014 +0100

    don't load plugin of unsupported types

diff --git a/sql/sql_plugin.cc b/sql/sql_plugin.cc
index d1de46e8551..4228c1fd9f2 100644
--- a/sql/sql_plugin.cc
+++ b/sql/sql_plugin.cc
@@ -1048,7 +1048,11 @@ static bool plugin_add(MEM_ROOT *tmp_root,
     tmp.name.length= strlen(plugin->name);
 
     if (plugin->type < 0 || plugin->type >= MYSQL_MAX_PLUGIN_TYPE_NUM)
-      continue; // invalid plugin
+      continue; // invalid plugin type
+
+    if (plugin->type == MYSQL_UDF_PLUGIN ||
+        (plugin->type == 8 && tmp.plugin_dl->mariaversion == 0))
+      continue; // unsupported plugin type
 
     if (name->str && my_strnncoll(system_charset_info,
                                   (const uchar *)name->str, name->length,

