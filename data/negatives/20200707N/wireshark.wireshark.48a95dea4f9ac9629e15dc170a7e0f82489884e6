commit 48a95dea4f9ac9629e15dc170a7e0f82489884e6
Author: Jeff Morriss <jeff.morriss.ws@gmail.com>
Date:   Thu Feb 12 17:23:46 2015 -0500

    Register the Mongo dissector by name so it can be used with TLS.
    
    Change-Id: Ic9d688603747312aa29e5af038363f70c3cbae33
    Reviewed-on: https://code.wireshark.org/review/7097
    Reviewed-by: Jeff Morriss <jeff.morriss.ws@gmail.com>

diff --git a/epan/dissectors/packet-mongo.c b/epan/dissectors/packet-mongo.c
index c46a81ccbf..1d9ecfeed9 100644
--- a/epan/dissectors/packet-mongo.c
+++ b/epan/dissectors/packet-mongo.c
@@ -400,6 +400,7 @@ dissect_bson_document(tvbuff_t *tvb, packet_info *pinfo, guint offset, proto_tre
 
   return document_length;
 }
+
 static int
 dissect_mongo_reply(tvbuff_t *tvb, packet_info *pinfo, guint offset, proto_tree *tree)
 {
@@ -431,6 +432,7 @@ dissect_mongo_reply(tvbuff_t *tvb, packet_info *pinfo, guint offset, proto_tree
   }
   return offset;
 }
+
 static int
 dissect_mongo_msg(tvbuff_t *tvb, guint offset, proto_tree *tree)
 {
@@ -572,6 +574,7 @@ dissect_mongo_kill_cursors(tvbuff_t *tvb, guint offset, proto_tree *tree)
   }
   return offset;
 }
+
 static int
 dissect_mongo_pdu(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)
 {
@@ -1028,6 +1031,9 @@ proto_register_mongo(void)
 
   proto_mongo = proto_register_protocol("Mongo Wire Protocol", "MONGO", "mongo");
 
+  /* Allow dissector to find be found by name. */
+  new_register_dissector("mongo", dissect_mongo, proto_mongo);
+
   proto_register_field_array(proto_mongo, hf, array_length(hf));
   proto_register_subtree_array(ett, array_length(ett));
   expert_mongo = expert_register_protocol(proto_mongo);

