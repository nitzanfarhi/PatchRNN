commit cb1e1f7fe9e72f98f8907b4c68f1c95854433e59
Author: Zardosht Kasheff <zardosht@tokutek.com>
Date:   Wed Apr 17 00:02:03 2013 -0400

    [t:3110], make change to get partitions in MariaDB 5.2.3 to work right.
    
    git-svn-id: file:///svn/mysql/tokudb-engine/tokudb-engine@26399 c7de825b-a66e-492c-adef-691d508d4ae1

diff --git a/storage/tokudb/ha_tokudb.cc b/storage/tokudb/ha_tokudb.cc
index 98a5a1aceb1..25064fa4b7f 100644
--- a/storage/tokudb/ha_tokudb.cc
+++ b/storage/tokudb/ha_tokudb.cc
@@ -5092,6 +5092,9 @@ int ha_tokudb::info(uint flag) {
     if (flag & HA_STATUS_VARIABLE) {
         // Just to get optimizations right
         stats.records = share->rows + share->rows_from_locked_table;
+        if (stats.records == 0) {
+            stats.records++;
+        }
         stats.deleted = 0;
         if (!(flag & HA_STATUS_NO_LOCK)) {
             u_int64_t num_rows = 0;
@@ -5105,6 +5108,9 @@ int ha_tokudb::info(uint flag) {
             if (error == 0) {
                 share->rows = num_rows;
                 stats.records = num_rows;
+                if (stats.records == 0) {
+                    stats.records++;
+                }
             }
             else {
                 goto cleanup;

