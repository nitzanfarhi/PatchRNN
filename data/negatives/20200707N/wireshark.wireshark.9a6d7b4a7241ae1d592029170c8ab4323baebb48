commit 9a6d7b4a7241ae1d592029170c8ab4323baebb48
Author: Guy Harris <guy@alum.mit.edu>
Date:   Fri Oct 12 01:41:03 2001 +0000

    Sigh.  A MacOS X 10.1 appeared to have put out a malformed NetBIOS
    session request with a length greater than 128 bytes; crank the length
    limitation up to 256.  (Perhaps I've misread the DNS spec or the
    NetBIOS-over-TCP spec, but the request sure *looked* as if it had a
    bogus second-level-encoding in the calling machine name.)
    
    svn path=/trunk/; revision=4019

diff --git a/packet-nbns.c b/packet-nbns.c
index 68f9665c03..10148eaf59 100644
--- a/packet-nbns.c
+++ b/packet-nbns.c
@@ -4,7 +4,7 @@
  * Gilbert Ramirez <gram@xiexie.org>
  * Much stuff added by Guy Harris <guy@alum.mit.edu>
  *
- * $Id: packet-nbns.c,v 1.61 2001/09/30 23:14:43 guy Exp $
+ * $Id: packet-nbns.c,v 1.62 2001/10/12 01:41:03 guy Exp $
  *
  * Ethereal - Network traffic analyzer
  * By Gerald Combs <gerald@ethereal.com>
@@ -1610,8 +1610,16 @@ dissect_nbss(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)
 			 * there should be no compression), and we
 			 * shouldn't have more than 128 bytes (actually,
 			 * we shouldn't have that many).
+			 *
+			 * XXX - actually, MacOS X 10.1 (yes, that's
+			 * redundant, but that's what Apple calls it,
+			 * not MacOS X.1) puts names longer than 16
+			 * characters into session request messages,
+			 * so we can have more than 32 bytes of
+			 * name value, so we can have more than 128
+			 * bytes of data.
 			 */
-			if (length < 2 || length > 128)
+			if (length < 2 || length > 256)
 				goto continuation;
 			break;
 

