commit 43f4798554487b29cbf218e8dac5c9d4aebe894c
Author: Greg Ames <gregames@apache.org>
Date:   Fri Apr 8 18:07:33 2005 +0000

    use a more general but slightly slower test for a body.
    
    
    git-svn-id: https://svn.apache.org/repos/asf/httpd/httpd/trunk@160573 13f79535-47bb-0310-9956-ffa450edef68

diff --git a/server/protocol.c b/server/protocol.c
index 546df2f7f2..2ef8438003 100644
--- a/server/protocol.c
+++ b/server/protocol.c
@@ -1032,7 +1032,8 @@ AP_DECLARE(void) ap_set_sub_req_protocol(request_rec *rnew,
     /* did the original request have a body?  (e.g. POST w/SSI tags)
      * if so, make sure the subrequest doesn't inherit body headers
      */
-    if (r->read_length) {
+    if (apr_table_get(r->headers_in, "Content-Length")
+        || apr_table_get(r->headers_in, "Transfer-Encoding")) {
         clone_headers_no_body(rnew, r);
     } else {
         /* no body (common case).  clone headers the cheap way */

