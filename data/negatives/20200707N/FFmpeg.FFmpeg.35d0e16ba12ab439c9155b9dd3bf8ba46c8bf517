commit 35d0e16ba12ab439c9155b9dd3bf8ba46c8bf517
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Mon Jun 16 23:16:44 2008 +0000

    Check number of bits so we do not try to use table entries which do not exist.
    
    Originally committed as revision 13785 to svn://svn.ffmpeg.org/ffmpeg/trunk

diff --git a/libavcodec/g726.c b/libavcodec/g726.c
index 15c5fa6620..13dce4f590 100644
--- a/libavcodec/g726.c
+++ b/libavcodec/g726.c
@@ -334,6 +334,10 @@ static av_cold int g726_init(AVCodecContext * avctx)
         av_log(avctx, AV_LOG_ERROR, "G726: unsupported audio format\n");
         return -1;
     }
+    if(index>3){
+        av_log(avctx, AV_LOG_ERROR, "Unsupported number of bits %d\n", index+2);
+        return -1;
+    }
     g726_reset(&c->c, index);
     c->code_size = c->c.tbls->bits;
     c->bit_buffer = 0;

