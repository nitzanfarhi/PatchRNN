commit 8012e75c8ab5f1dd7ee4dc8a2fe52c28a26124af
Author: Tomasz Kojm <tkojm@clamav.net>
Date:   Fri May 28 15:09:28 2010 +0200

    better safe than sorry

diff --git a/freshclam/manager.c b/freshclam/manager.c
index 76193a07f..795dcb8ac 100644
--- a/freshclam/manager.c
+++ b/freshclam/manager.c
@@ -241,7 +241,7 @@ static int wwwconnect(const char *server, const char *proxy, int pport, char *ip
 	return -1;
     }
 
-    for(rp = res; rp; rp = rp->ai_next) {
+    for(rp = res; rp && addrnum < 128; rp = rp->ai_next) {
 	rp->ai_flags = cli_rndnum(1024);
 	addrs[addrnum] = rp;
 	addrnum++;

