commit 606c422d5b909bfe947810357648d8a12dbd8fb9
Author: Evan Huus <eapache@gmail.com>
Date:   Thu Sep 19 17:39:43 2013 +0000

    Zero the key in ntlmssp, because we don't otherwise fill all of it. I suspect
    the tvb_memcpy on the next line should be taking more data, but I don't know
    enough about the protocol to be sure. This is the least disruptive way to fix
    the last valgrind error from
    https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=8941
    
    svn path=/trunk/; revision=52145

diff --git a/epan/dissectors/packet-ntlmssp.c b/epan/dissectors/packet-ntlmssp.c
index 5296b03a22..58eb02cfc0 100644
--- a/epan/dissectors/packet-ntlmssp.c
+++ b/epan/dissectors/packet-ntlmssp.c
@@ -1988,6 +1988,7 @@ dissect_ntlmssp_payload(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, voi
     /* Encrypted body */
     proto_tree_add_item (ntlmssp_tree, hf_ntlmssp_verf_body,
                          tvb, offset, ntlm_signature_size + ntlm_seq_size, ENC_NA);
+    memset(key, 0, sizeof(key));
     tvb_memcpy(tvb, key, offset, ntlm_signature_size + ntlm_seq_size);
     /* Try to decrypt */
     decrypt_data_payload (tvb, offset+(ntlm_signature_size + ntlm_seq_size), encrypted_block_length-(ntlm_signature_size + ntlm_seq_size), pinfo, ntlmssp_tree, key);

