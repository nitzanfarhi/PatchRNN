commit bbebb7cc34426f77bf2c82dbcbb4d903baeb0c6b
Author: Love Hörnquist Åstrand <lha@kth.se>
Date:   Wed Feb 1 12:39:26 2006 +0000

    (krb5_mk_priv): abort if ASN1_MALLOC_ENCODE failes to produce the
    matching lenghts.
    
    
    git-svn-id: svn://svn.h5l.se/heimdal/trunk/heimdal@16680 ec53bebd-3082-4978-b11e-865c3cabbd6b

diff --git a/lib/krb5/mk_priv.c b/lib/krb5/mk_priv.c
index 7525d0ea3..aef1e0929 100644
--- a/lib/krb5/mk_priv.c
+++ b/lib/krb5/mk_priv.c
@@ -129,9 +129,11 @@ krb5_mk_priv(krb5_context context,
 
 
     ASN1_MALLOC_ENCODE(KRB_PRIV, buf, buf_size, &s, &len, ret);
-
-    if(ret)
+    if (ret)
 	goto fail;
+    if (buf_size != len)
+	krb5_abortx(context, "internal error in ASN.1 encoder");
+
     krb5_data_free (&s.enc_part.cipher);
 
     ret = krb5_data_copy(outbuf, buf + buf_size - len, len);

