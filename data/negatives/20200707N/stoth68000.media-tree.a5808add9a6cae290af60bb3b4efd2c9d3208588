commit a5808add9a6cae290af60bb3b4efd2c9d3208588
Author: Alex Elder <elder@linaro.org>
Date:   Tue Sep 9 13:55:06 2014 -0500

    greybus: call put_device() on error
    
    As soon as we've called device_initialize() we're required to call
    put_device() in order to drop our reference to the device structure.
    This was missed in the error path in greybus_new_module().  Fix that.
    
    Signed-off-by: Alex Elder <elder@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <greg@kroah.com>

diff --git a/drivers/staging/greybus/core.c b/drivers/staging/greybus/core.c
index 95655e258e84..3bb8f9cb55f8 100644
--- a/drivers/staging/greybus/core.c
+++ b/drivers/staging/greybus/core.c
@@ -440,6 +440,7 @@ struct greybus_device *greybus_new_module(struct device *parent,
 
 	return gdev;
 error:
+	put_device(&gdev->dev);
 	greybus_module_release(&gdev->dev);
 	return NULL;
 }

