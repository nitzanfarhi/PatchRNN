commit 78c889cb8474caaf963c0f79abbbf184a93c2590
Author: aland <aland>
Date:   Wed Apr 18 15:08:09 2007 +0000

            Catch clients added by rlm_sql

diff --git a/src/main/client.c b/src/main/client.c
index dfcfd0db0..60fdd4c20 100644
--- a/src/main/client.c
+++ b/src/main/client.c
@@ -212,6 +212,21 @@ int client_add(RADCLIENT_LIST *clients, RADCLIENT *client)
 		tree_num = rbtree_create(client_num_cmp, NULL, 0);
 	}
 
+
+	/*
+	 *	Catch clients added by rlm_sql.
+	 */
+	if (!client->auth) {
+		client->auth = rad_malloc(sizeof(*client->auth));
+		memset(client->auth, 0, sizeof(*client->auth));
+	}
+
+	if (!client->acct) {
+		client->acct = rad_malloc(sizeof(*client->acct));
+		memset(client->acct, 0, sizeof(*client->acct));
+	}
+
+
 	client->number = tree_num_max;
 	tree_num_max++;
 	if (tree_num) rbtree_insert(tree_num, client);

