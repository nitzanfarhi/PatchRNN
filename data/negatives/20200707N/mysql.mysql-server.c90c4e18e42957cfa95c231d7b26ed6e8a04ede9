commit c90c4e18e42957cfa95c231d7b26ed6e8a04ede9
Author: Jonas Oreland <jonas@mysql.com>
Date:   Tue Nov 11 10:33:56 2008 +0100

    ndb - fix previous bug fix, dirty-read sets simple flag i.e check both

diff --git a/storage/ndb/src/kernel/blocks/dbtc/DbtcMain.cpp b/storage/ndb/src/kernel/blocks/dbtc/DbtcMain.cpp
index 080b5aa6e80..2a1399bea06 100644
--- a/storage/ndb/src/kernel/blocks/dbtc/DbtcMain.cpp
+++ b/storage/ndb/src/kernel/blocks/dbtc/DbtcMain.cpp
@@ -3092,12 +3092,13 @@ void Dbtc::tckeyreq050Lab(Signal* signal)
 
   Uint8 Toperation = regTcPtr->operation;
   Uint8 TopSimple = regTcPtr->opSimple;
+  Uint8 TopDirty = regTcPtr->dirtyOp;
   tnoOfBackup = tnodeinfo & 3;
   tnoOfStandby = (tnodeinfo >> 8) & 3;
  
   regCachePtr->fragmentDistributionKey = (tnodeinfo >> 16) & 255;
   if (Toperation == ZREAD || Toperation == ZREAD_EX) {
-    if (TopSimple == 1){
+    if (TopSimple == 1 && TopDirty == 0){
       jam();
       /*-------------------------------------------------------------*/
       /*       A SIMPLE READ CAN SELECT ANY OF THE PRIMARY AND       */

