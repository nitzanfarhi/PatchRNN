commit 56169420247854c3e61ae0fa18e3cd9f966cfd96
Author: Sage Weil <sage@redhat.com>
Date:   Mon May 1 17:27:07 2017 -0500

    crush/CrushWrapper: note about get_rule_weight_osd_map limitation
    
    This eventually needs to get fixed.  Opened
    http://tracker.ceph.com/issues/19818
    
    Signed-off-by: Sage Weil <sage@redhat.com>

diff --git a/src/crush/CrushWrapper.cc b/src/crush/CrushWrapper.cc
index 7974b9a750..88471f8745 100644
--- a/src/crush/CrushWrapper.cc
+++ b/src/crush/CrushWrapper.cc
@@ -1218,6 +1218,11 @@ int CrushWrapper::get_rule_weight_osd_map(unsigned ruleno, map<int,float> *pmap)
   crush_rule *rule = crush->rules[ruleno];
 
   // build a weight map for each TAKE in the rule, and then merge them
+
+  // FIXME: if there are multiple takes that place a different number of
+  // objects we do not take that into account.  (Also, note that doing this
+  // right is also a function of the pool, since the crush rule
+  // might choose 2 + choose 2 but pool size may only be 3.)
   for (unsigned i=0; i<rule->len; ++i) {
     map<int,float> m;
     float sum = 0;

