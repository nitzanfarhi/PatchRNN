commit 96b96d3284dd47afc4440ccb874a698ed8492b44
Author: tedu <tedu>
Date:   Wed May 7 21:06:05 2014 +0000

    in BN_clear_free, don't cleanse the data if the static data flag is set.
    much debugging work done by otto. ok miod otto.
    
    side note: BN_FLG_STATIC_DATA doesn't actually mean the data is static.
    it's also used to indicate the data may be secretly shared behind your back
    as a sort of poor man's refcounting, but without the refcounting.

diff --git a/src/crypto/bn/bn_lib.c b/src/crypto/bn/bn_lib.c
index 9787a31d..6ec92826 100644
--- a/src/crypto/bn/bn_lib.c
+++ b/src/crypto/bn/bn_lib.c
@@ -214,11 +214,10 @@ void BN_clear_free(BIGNUM *a)
 
 	if (a == NULL) return;
 	bn_check_top(a);
-	if (a->d != NULL)
+	if (a->d != NULL && !(BN_get_flags(a,BN_FLG_STATIC_DATA)))
 		{
 		OPENSSL_cleanse(a->d,a->dmax*sizeof(a->d[0]));
-		if (!(BN_get_flags(a,BN_FLG_STATIC_DATA)))
-			free(a->d);
+		free(a->d);
 		}
 	i=BN_get_flags(a,BN_FLG_MALLOCED);
 	OPENSSL_cleanse(a,sizeof(BIGNUM));

