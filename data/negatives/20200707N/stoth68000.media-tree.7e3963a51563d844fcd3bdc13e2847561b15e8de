commit 7e3963a51563d844fcd3bdc13e2847561b15e8de
Author: Marc Zyngier <marc.zyngier@arm.com>
Date:   Sun Jul 17 11:34:53 2016 +0100

    KVM: arm64: vgic-its: Fix vgic_its_check_device_id BE handling
    
    The ITS tables are stored in LE format. If the host is reading
    a L1 table entry to check its validity, it must convert it to
    the CPU endianness.
    
    Signed-off-by: Marc Zyngier <marc.zyngier@arm.com>

diff --git a/virt/kvm/arm/vgic/vgic-its.c b/virt/kvm/arm/vgic/vgic-its.c
index d6697c4d81ec..2ac5927b1d91 100644
--- a/virt/kvm/arm/vgic/vgic-its.c
+++ b/virt/kvm/arm/vgic/vgic-its.c
@@ -707,6 +707,8 @@ static bool vgic_its_check_device_id(struct kvm *kvm, struct vgic_its *its,
 			   &indirect_ptr, sizeof(indirect_ptr)))
 		return false;
 
+	indirect_ptr = le64_to_cpu(indirect_ptr);
+
 	/* check the valid bit of the first level entry */
 	if (!(indirect_ptr & BIT_ULL(63)))
 		return false;

