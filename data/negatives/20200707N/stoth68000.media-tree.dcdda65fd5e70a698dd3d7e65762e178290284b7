commit dcdda65fd5e70a698dd3d7e65762e178290284b7
Author: Andrew de Quincey <adq_dvb@lidskialf.net>
Date:   Thu Apr 6 10:37:56 2006 -0300

    V4L/DVB (3741): Budget-core doesn't check if register adapter fails
    
    If you have more than DVB_MAX_ADAPTERS in your machine, this causes an oops.
    
    Signed-off-by: Andrew de Quincey <adq_dvb@lidskialf.net>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@infradead.org>

diff --git a/drivers/media/dvb/ttpci/budget-core.c b/drivers/media/dvb/ttpci/budget-core.c
index ea2066d461fc..d8af690fa55c 100644
--- a/drivers/media/dvb/ttpci/budget-core.c
+++ b/drivers/media/dvb/ttpci/budget-core.c
@@ -400,7 +400,9 @@ int ttpci_budget_init(struct budget *budget, struct saa7146_dev *dev,
 		budget->dev->name, budget->buffer_width, budget->buffer_height);
 	printk("%s: dma buffer size %u\n", budget->dev->name, budget->buffer_size);
 
-	dvb_register_adapter(&budget->dvb_adapter, budget->card->name, owner);
+	if ((ret = dvb_register_adapter(&budget->dvb_adapter, budget->card->name, owner)) < 0) {
+		return ret;
+	}
 
 	/* set dd1 stream a & b */
 	saa7146_write(dev, DD1_STREAM_B, 0x00000000);

