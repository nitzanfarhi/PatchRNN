commit 2832b00b670391569d4abffe663c3b8180c8b14b
Author: Love Hörnquist Åstrand <lha@kth.se>
Date:   Tue Mar 28 03:46:54 2006 +0000

    Manual page claims RSA_public_decrypt will return -1 on error, lets check for that
    
    
    git-svn-id: svn://svn.h5l.se/heimdal/trunk/heimdal@16847 ec53bebd-3082-4978-b11e-865c3cabbd6b

diff --git a/lib/hx509/crypto.c b/lib/hx509/crypto.c
index d610b82b0..dace4bfa7 100644
--- a/lib/hx509/crypto.c
+++ b/lib/hx509/crypto.c
@@ -181,7 +181,7 @@ rsa_verify_signature(const struct signature_alg *sig_alg,
 
     ret = RSA_public_decrypt(sig->length, (unsigned char *)sig->data, 
 			     to, rsa, RSA_PKCS1_PADDING);
-    if (ret < 0) {
+    if (ret == -1) {
 	ret = HX509_CRYPTO_SIG_INVALID_FORMAT;
 	free(to);
 	goto out;

