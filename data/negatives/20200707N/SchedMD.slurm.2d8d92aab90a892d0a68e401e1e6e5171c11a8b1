commit 2d8d92aab90a892d0a68e401e1e6e5171c11a8b1
Author: David Bigagli <david@schedmd.com>
Date:   Fri Jun 19 11:37:12 2015 -0700

    Prevent slurmctld from dumping core ifjob_resrcs is missing in the
    job data structure.

diff --git a/src/slurmctld/job_scheduler.c b/src/slurmctld/job_scheduler.c
index c521260278..feda32e0f1 100644
--- a/src/slurmctld/job_scheduler.c
+++ b/src/slurmctld/job_scheduler.c
@@ -1905,6 +1905,12 @@ extern int make_batch_job_cred(batch_job_launch_msg_t *launch_msg_ptr,
 	xassert(job_ptr->job_resrcs);
 	job_resrcs_ptr = job_ptr->job_resrcs;
 
+	if (job_ptr->job_resrcs == NULL) {
+		error("%s: job %u is missing job_resrcs info",
+		      __func__, job_ptr->job_id);
+		return SLURM_ERROR;
+	}
+
 	memset(&cred_arg, 0, sizeof(slurm_cred_arg_t));
 
 	cred_arg.jobid     = launch_msg_ptr->job_id;

