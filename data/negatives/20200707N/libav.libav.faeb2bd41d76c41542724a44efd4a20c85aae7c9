commit faeb2bd41d76c41542724a44efd4a20c85aae7c9
Author: Justin Ruggles <justin.ruggles@gmail.com>
Date:   Mon Feb 2 01:53:40 2009 +0000

    flacdec: set default sample_fmt before parsing extradata
    
    Originally committed as revision 16926 to svn://svn.ffmpeg.org/ffmpeg/trunk

diff --git a/libavcodec/flacdec.c b/libavcodec/flacdec.c
index 49b45779e..d8ba07bc1 100644
--- a/libavcodec/flacdec.c
+++ b/libavcodec/flacdec.c
@@ -103,6 +103,8 @@ static av_cold int flac_decode_init(AVCodecContext *avctx)
     FLACContext *s = avctx->priv_data;
     s->avctx = avctx;
 
+    avctx->sample_fmt = SAMPLE_FMT_S16;
+
     if (avctx->extradata_size > 4) {
         /* initialize based on the demuxer-supplied streamdata header */
         if (avctx->extradata_size == FLAC_STREAMINFO_SIZE) {
@@ -115,7 +117,6 @@ static av_cold int flac_decode_init(AVCodecContext *avctx)
         }
     }
 
-    avctx->sample_fmt = SAMPLE_FMT_S16;
     return 0;
 }
 

