commit 253f96e53eb98dd811d380ffe108c53f48765ad2
Author: Namhyung Kim <namhyung@gmail.com>
Date:   Sun Aug 2 00:59:42 2015 +0900

    sd-bus: use mfree() in bus_reset_queues()
    
    Recently mfree() was introduced to reduce work of tedious free + reset
    pointers.  Use it in bus_reset_queues() too.

diff --git a/src/libsystemd/sd-bus/sd-bus.c b/src/libsystemd/sd-bus/sd-bus.c
index b9e93f6f4..e70016865 100644
--- a/src/libsystemd/sd-bus/sd-bus.c
+++ b/src/libsystemd/sd-bus/sd-bus.c
@@ -84,15 +84,13 @@ static void bus_reset_queues(sd_bus *b) {
         while (b->rqueue_size > 0)
                 sd_bus_message_unref(b->rqueue[--b->rqueue_size]);
 
-        free(b->rqueue);
-        b->rqueue = NULL;
+        b->rqueue = mfree(b->rqueue);
         b->rqueue_allocated = 0;
 
         while (b->wqueue_size > 0)
                 sd_bus_message_unref(b->wqueue[--b->wqueue_size]);
 
-        free(b->wqueue);
-        b->wqueue = NULL;
+        b->wqueue = mfree(b->wqueue);
         b->wqueue_allocated = 0;
 }
 

