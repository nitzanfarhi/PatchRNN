commit 9b2a9caf479ffe1572f848399484f712f9ae2619
Author: marko <>
Date:   Wed Jun 20 13:58:16 2007 +0000

    branches/zip: Restore the transaction commit that was removed in r1583.
    
    ha_innobase::add_index(): Do commit the transaction, because the error
    handler (label err1) in mysql_alter_table() won't commit it as of now.
    This was detected in a failure of type_bit_innodb.

diff --git a/handler/ha_innodb.cc b/handler/ha_innodb.cc
index 1d687785abb..88eaa8d283d 100644
--- a/handler/ha_innodb.cc
+++ b/handler/ha_innodb.cc
@@ -8361,6 +8361,7 @@ ha_innobase::add_index(
 
 func_exit:
 	mem_heap_free(heap);
+	innobase_commit_low(trx);/* work around a bug in mysql_alter_table() */
 
 	/* There might be work for utility threads.*/
 	srv_active_wake_master_thread();

