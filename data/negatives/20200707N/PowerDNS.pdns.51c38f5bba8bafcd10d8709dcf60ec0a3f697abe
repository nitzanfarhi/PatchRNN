commit 51c38f5bba8bafcd10d8709dcf60ec0a3f697abe
Author: Aki Tuomi <cmouse@cmouse.fi>
Date:   Wed Apr 26 09:55:13 2017 +0300

    geoipbackend: Use dns_random
    
    Closes coverity CID#1374548

diff --git a/modules/geoipbackend/geoipbackend.cc b/modules/geoipbackend/geoipbackend.cc
index f70e12609..b10a54b63 100644
--- a/modules/geoipbackend/geoipbackend.cc
+++ b/modules/geoipbackend/geoipbackend.cc
@@ -23,6 +23,7 @@
 #include "config.h"
 #endif
 #include "geoipbackend.hh"
+#include "pdns/dns_random.hh"
 #include <sstream>
 #include <regex.h>
 #include <glob.h>
@@ -305,7 +306,7 @@ GeoIPBackend::~GeoIPBackend() {
 bool GeoIPBackend::lookup_static(const GeoIPDomain &dom, const DNSName &search, const QType &qtype, const DNSName& qdomain, const std::string &ip, GeoIPLookup &gl, bool v6) {
   const auto i = dom.records.find(search);
   int cumul_probability = 0;
-  int probability_rnd = 1+(random() % 1000); // setting probability=0 means it never is used
+  int probability_rnd = 1+(dns_random(1000)); // setting probability=0 means it never is used
 
   if (i != dom.records.end()) { // return static value
     for(const auto& rr : i->second) {

