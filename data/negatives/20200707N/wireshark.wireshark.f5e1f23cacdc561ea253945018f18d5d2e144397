commit f5e1f23cacdc561ea253945018f18d5d2e144397
Author: Tomas Kukosa <tomas.kukosa@siemens.com>
Date:   Wed Aug 25 14:10:58 2010 +0000

    Fix wrong length of CSeq Method parameter
    
    svn path=/trunk/; revision=33920

diff --git a/epan/dissectors/packet-sip.c b/epan/dissectors/packet-sip.c
index 607e5b2f19..f13e48b940 100644
--- a/epan/dissectors/packet-sip.c
+++ b/epan/dissectors/packet-sip.c
@@ -2297,7 +2297,7 @@ dissect_sip_common(tvbuff_t *tvb, int offset, packet_info *pinfo, proto_tree *tr
 							}
 						}
 
-						if (sub_value_offset == linelen)
+						if (sub_value_offset == value_len)
 						{
 							/* Didn't find method name */
 							THROW(ReportedBoundsError);
@@ -2305,7 +2305,7 @@ dissect_sip_common(tvbuff_t *tvb, int offset, packet_info *pinfo, proto_tree *tr
 						}
 
 						/* Extract method name from value */
-						strlen_to_copy = (int)linelen-sub_value_offset;
+						strlen_to_copy = (int)value_len-sub_value_offset;
 						if (strlen_to_copy > MAX_CSEQ_METHOD_SIZE) {
 							/* Note the error in the protocol tree */
 							if (hdr_tree) {

