commit bc0abebe8e7baa3c0a725bdfe8f14a1236dd2d55
Author: wm4 <wm4@nowhere>
Date:   Thu Aug 22 19:06:51 2013 +0200

    demux: check whether stream is selected in demux_get_next_pts()
    
    Otherwise, this would just try to demux a good chunk of the file, even
    though the operation can't succeed anyway.
    
    This caused some pretty strange issues, where perfectly valid use cases
    would print a "Too many packets in the demuxer packet queue..." message.

diff --git a/demux/demux.c b/demux/demux.c
index 5ffd42a971..ff59ef4250 100644
--- a/demux/demux.c
+++ b/demux/demux.c
@@ -466,7 +466,7 @@ struct demux_packet *demux_read_packet(struct sh_stream *sh)
 // packets from the queue.
 double demux_get_next_pts(struct sh_stream *sh)
 {
-    if (sh) {
+    if (sh && sh->ds->selected) {
         ds_get_packets(sh);
         if (sh->ds->head)
             return sh->ds->head->pts;

