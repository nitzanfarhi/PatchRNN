commit 9af8c4e5a010b22b3abd18ff7383564ac46457c5
Author: Ken <knielson@adaptivecomputing.com>
Date:   Fri Jun 7 10:56:19 2013 -0600

    Added the commandline option -c to qstat to direct qstat
    to not display completed jobs. TRQ-1565

diff --git a/src/cmds/qstat.c b/src/cmds/qstat.c
index 5723380ad..8681c3cff 100644
--- a/src/cmds/qstat.c
+++ b/src/cmds/qstat.c
@@ -34,6 +34,7 @@
 #include "net_cache.h"
 #include "../lib/Libifl/lib_ifl.h"
 
+bool    do_not_display_complete = false;
 
 static void states(  
 
@@ -1232,6 +1233,7 @@ void display_statjob(
 
   for (p = status;p != NULL;p = p->next)
     {
+    bool do_not_display = false;
     jid = NULL;
     name = NULL;
     owner = NULL;
@@ -1470,6 +1472,11 @@ void display_statjob(
               }
 
             state = a->value;
+            if (*state == 'C')
+              {
+              if ( do_not_display_complete == true )
+                do_not_display = true;
+              }
             }
           else if (!strcmp(a->name, ATTR_queue))
             {
@@ -1501,20 +1508,24 @@ void display_statjob(
 
       /* display summary data */
 
-      printf(format,
-             jid,
-             name,
-             owner,
-             timeu,
-             state,
-             location);
+      if (do_not_display == false)
+        {
+        printf(format,
+               jid,
+               name,
+               owner,
+               timeu,
+               state,
+               location);
+        }
       }  /* END else (full) */
 
-    if (DisplayXML != TRUE)
+    if (DisplayXML != TRUE && do_not_display == false)
       {
       if (full)
         printf("\n");
       }
+
     }  /* END for (p = status) */
 
   if (DisplayXML == TRUE)
@@ -2210,7 +2221,7 @@ int main(
 #endif /* !FALSE */
 
 #if !defined(PBS_NO_POSIX_VIOLATION)
-#define GETOPT_ARGS "aeE:filn1qrstu:xGMQRBW:-:"
+#define GETOPT_ARGS "aceE:filn1qrstu:xGMQRBW:-:"
 #else
 #define GETOPT_ARGS "flQBW:"
 #endif /* PBS_NO_POSIX_VIOLATION */
@@ -2263,6 +2274,11 @@ int main(
 
         break;
 
+      case 'c':
+
+        do_not_display_complete = true;
+        break;
+
       case 'e':
 
         exec_only = 1;

