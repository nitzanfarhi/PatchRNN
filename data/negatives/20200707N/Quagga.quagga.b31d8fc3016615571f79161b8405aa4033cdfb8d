commit b31d8fc3016615571f79161b8405aa4033cdfb8d
Author: Dmitrij Tejblum <tejblum@yandex-team.ru>
Date:   Mon Dec 12 20:30:10 2011 +0400

    ospfd: fix packet reception for FreeBSD 10.
    
    * ospf_packet.c (ospf_recv_packet): FreeBSD, starting from version 10, will not
      subtract the IP header size from ip_len.
    
    This is the patch from FreeBSD's ports/net/quagga/files/patch-ospfd__ospf_packet.c,
    by Boris Kovalenko.

diff --git a/ospfd/ospf_packet.c b/ospfd/ospf_packet.c
index 1c1a1e69..994d3629 100644
--- a/ospfd/ospf_packet.c
+++ b/ospfd/ospf_packet.c
@@ -2067,7 +2067,7 @@ ospf_recv_packet (int fd, struct interface **ifp, struct stream *ibuf)
   
   ip_len = iph->ip_len;
   
-#if !defined(GNU_LINUX) && (OpenBSD < 200311)
+#if !defined(GNU_LINUX) && (OpenBSD < 200311) && (__FreeBSD_version < 1000000)
   /*
    * Kernel network code touches incoming IP header parameters,
    * before protocol specific processing.

