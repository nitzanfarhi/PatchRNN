commit a26452263f4e130018e712f3799f0eddcf2ebe91
Author: antirez <antirez@gmail.com>
Date:   Fri Jun 4 21:19:06 2010 +0200

    DISCSARD now unwatches all keys, as it should

diff --git a/redis.c b/redis.c
index d507adae..00a5a80c 100644
--- a/redis.c
+++ b/redis.c
@@ -7918,6 +7918,7 @@ static void discardCommand(redisClient *c) {
     freeClientMultiState(c);
     initClientMultiState(c);
     c->flags &= (~REDIS_MULTI);
+    unwatchAllKeys(c);
     addReply(c,shared.ok);
 }
 

