commit 3295a82ca114b4316da6ae2db13a9253c3f962cb
Author: Neil Brown <neilb@cse.unsw.edu.au>
Date:   Mon Apr 12 18:56:18 2004 +0000

    Fix Debian #206078, #214758; patch submitted by Artur Czechowski as
    #1845.

diff --git a/imap/auth_sasl.c b/imap/auth_sasl.c
index 574043577..c55cdcc19 100644
--- a/imap/auth_sasl.c
+++ b/imap/auth_sasl.c
@@ -116,7 +116,7 @@ imap_auth_res_t imap_auth_sasl (IMAP_DATA* idata, const char* method)
   irc = IMAP_CMD_CONTINUE;
 
   /* looping protocol */
-  while (rc == SASL_CONTINUE)
+  while (rc == SASL_CONTINUE || olen > 0)
   {
     do
       irc = imap_cmd_step (idata);
@@ -180,6 +180,8 @@ imap_auth_res_t imap_auth_sasl (IMAP_DATA* idata, const char* method)
       mutt_socket_write (idata->conn, "*\r\n");
       dprint (1, (debugfile, "imap_auth_sasl: sasl_client_step error %d\n",rc));
     }
+	  
+    olen = 0;
   }
 
   while (irc != IMAP_CMD_OK)

