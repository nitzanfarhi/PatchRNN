commit 8a0e0f9472334a5efd7de9cd919949b99cc0180f
Author: Love Hornquist Astrand <lha@h5l.org>
Date:   Sun Nov 20 21:09:38 2011 -0800

    do m-r on more then one prime

diff --git a/lib/hcrypto/libtommath/bn_mp_prime_next_prime.c b/lib/hcrypto/libtommath/bn_mp_prime_next_prime.c
index a2897f087..db2f46ddb 100644
--- a/lib/hcrypto/libtommath/bn_mp_prime_next_prime.c
+++ b/lib/hcrypto/libtommath/bn_mp_prime_next_prime.c
@@ -142,8 +142,8 @@ int mp_prime_next_prime(mp_int *a, int t, int bbs_style)
       }
 
       /* is this prime? */
-      for (x = 0; x < t; x++) {
-          mp_set(&b, ltm_prime_tab[t]);
+      for (x = 0; x < t && x < PRIME_SIZE; x++) {
+          mp_set(&b, ltm_prime_tab[x]);
           if ((err = mp_prime_miller_rabin(a, &b, &res)) != MP_OKAY) {
              goto LBL_ERR;
           }

