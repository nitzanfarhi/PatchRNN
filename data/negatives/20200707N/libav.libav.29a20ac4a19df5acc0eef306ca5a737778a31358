commit 29a20ac4a19df5acc0eef306ca5a737778a31358
Author: Alex Converse <alex.converse@gmail.com>
Date:   Fri Feb 3 10:43:21 2012 -0800

    movdec: Avoid av_malloc(0) in stss
    
    Found-by: Mateusz "j00ru" Jurczyk and Gynvael Coldwind

diff --git a/libavformat/mov.c b/libavformat/mov.c
index d0e01f8e5..9deb820eb 100644
--- a/libavformat/mov.c
+++ b/libavformat/mov.c
@@ -1529,6 +1529,8 @@ static int mov_read_stss(MOVContext *c, AVIOContext *pb, MOVAtom atom)
 
     av_dlog(c->fc, "keyframe_count = %d\n", entries);
 
+    if (!entries)
+        return 0;
     if (entries >= UINT_MAX / sizeof(int))
         return AVERROR_INVALIDDATA;
     sc->keyframes = av_malloc(entries * sizeof(int));

