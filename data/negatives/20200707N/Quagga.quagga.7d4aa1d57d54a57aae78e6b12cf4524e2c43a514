commit 7d4aa1d57d54a57aae78e6b12cf4524e2c43a514
Author: Christian Franke <chris@opensourcerouting.org>
Date:   Thu Dec 13 16:10:05 2012 +0100

    ospf6d: don't run DR election early on "ipv6 ospf6 priority"
    
    On changing the router priority, DR election should only be run when it
    was completed at least once before.
    
    Signed-off-by: Christian Franke <chris@opensourcerouting.org>

diff --git a/ospf6d/ospf6_interface.c b/ospf6d/ospf6_interface.c
index 111b929a..c692f2c7 100644
--- a/ospf6d/ospf6_interface.c
+++ b/ospf6d/ospf6_interface.c
@@ -1333,7 +1333,10 @@ DEFUN (ipv6_ospf6_priority,
 
   oi->priority = strtol (argv[0], NULL, 10);
 
-  if (oi->area)
+  if (oi->area &&
+      (oi->state == OSPF6_INTERFACE_DROTHER ||
+       oi->state == OSPF6_INTERFACE_BDR ||
+       oi->state == OSPF6_INTERFACE_DR))
     ospf6_interface_state_change (dr_election (oi), oi);
 
   return CMD_SUCCESS;

