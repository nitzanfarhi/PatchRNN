commit 1c74cd9bf515ac1f1cfef6ed58ad2aa77b76be2c
Author: heikki@hundin.mysql.fi <>
Date:   Thu Jan 1 01:51:36 2004 +0200

    row0purge.c:
      Fix bug: if purge of a table was not possible because its .ibd file was missing, trx->dict_operation_lock_mode was left to a wrong value, causing an assertion failure

diff --git a/innobase/row/row0purge.c b/innobase/row/row0purge.c
index a455722f15a..d5895f20461 100644
--- a/innobase/row/row0purge.c
+++ b/innobase/row/row0purge.c
@@ -534,6 +534,8 @@ row_purge_parse_undo_rec(
 
 		node->table = NULL;
 
+		row_mysql_unfreeze_data_dictionary(trx);
+
 		return(FALSE);
 	}
 

