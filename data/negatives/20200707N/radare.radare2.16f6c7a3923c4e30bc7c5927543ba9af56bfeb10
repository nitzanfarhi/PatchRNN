commit 16f6c7a3923c4e30bc7c5927543ba9af56bfeb10
Author: Nibble <nibble.ds@gmail.com>
Date:   Wed Aug 11 18:29:15 2010 +0200

    * r_asm
      - Handle errors in x86_nasm plugin
    * r_core
      - Minor fixup in debug message in '/c'

diff --git a/libr/asm/p/asm_x86_nasm.c b/libr/asm/p/asm_x86_nasm.c
index 0e646645a..aa4e75e1b 100644
--- a/libr/asm/p/asm_x86_nasm.c
+++ b/libr/asm/p/asm_x86_nasm.c
@@ -24,10 +24,13 @@ static int assemble(RAsm *a, RAsmAop *aop, const char *buf) {
 		"nasm /dev/stdin -o /dev/stdout <<__\n"
 		"BITS %i\nORG 0x%"PFMT64x"\n%s\n__", a->bits, a->pc, buf);
 	out = (ut8 *)r_sys_cmd_str (cmd, "", &len);
-	if (out) {
+	if (out && memcmp (out, "/dev/stdin:", len>11?11:len)) {
 		memcpy (aop->buf, out, len<=R_ASM_BUFSIZE?len:R_ASM_BUFSIZE);
-		free (out);
-	} else eprintf ("Error running 'nasm'\n");
+	} else {
+		eprintf ("Error running 'nasm'\n");
+		len = 0;
+	}
+	if (out) free (out);
 	aop->inst_len = len;
 	return len;
 }
diff --git a/libr/core/cmd.c b/libr/core/cmd.c
index 3e01bb659..c7d78a6f7 100644
--- a/libr/core/cmd.c
+++ b/libr/core/cmd.c
@@ -2221,7 +2221,7 @@ static int cmd_search(void *data, const char *input) {
 		struct r_asm_code_t *acode;
 		int asmstr = r_config_get_i (core->config, "search.asmstr");
 		if (asmstr) {
-			eprintf ("TODO");
+			eprintf ("TODO\n");
 			return R_FALSE;
 		} else {
 			if (!(acode = r_asm_massemble (core->assembler, input+2))) {

