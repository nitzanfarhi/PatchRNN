commit 1abbacafd3c8e686cd807d1ef6c2ed87ae2d5b67
Author: Bron Gondwana <brong@fastmail.fm>
Date:   Mon Feb 16 18:52:05 2015 +1100

    handle empty card

diff --git a/imap/carddav_db.c b/imap/carddav_db.c
index 60edda3d0..574031270 100644
--- a/imap/carddav_db.c
+++ b/imap/carddav_db.c
@@ -1655,20 +1655,22 @@ static void _make_fn(struct vparse_card *card)
     strarray_t *name = strarray_new();
     const char *v;
 
-    v = strarray_nth(n->v.values, 3); // prefix
-    if (v && v[0]) strarray_append(name, v);
+    if (n) {
+	v = strarray_nth(n->v.values, 3); // prefix
+	if (v && v[0]) strarray_append(name, v);
 
-    v = strarray_nth(n->v.values, 1); // first
-    if (v && v[0]) strarray_append(name, v);
+	v = strarray_nth(n->v.values, 1); // first
+	if (v && v[0]) strarray_append(name, v);
 
-    v = strarray_nth(n->v.values, 2); // middle
-    if (v && v[0]) strarray_append(name, v);
+	v = strarray_nth(n->v.values, 2); // middle
+	if (v && v[0]) strarray_append(name, v);
 
-    v = strarray_nth(n->v.values, 0); // last
-    if (v && v[0]) strarray_append(name, v);
+	v = strarray_nth(n->v.values, 0); // last
+	if (v && v[0]) strarray_append(name, v);
 
-    v = strarray_nth(n->v.values, 4); // suffix
-    if (v && v[0]) strarray_append(name, v);
+	v = strarray_nth(n->v.values, 4); // suffix
+	if (v && v[0]) strarray_append(name, v);
+    }
 
     if (!strarray_size(name)) {
 	v = vparse_stringval(card, "nickname");

