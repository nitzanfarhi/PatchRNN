commit 5ab47acd67d45bc40d29f42173a91b5132055ba8
Author: Andreas Ericsson <ae@op5.se>
Date:   Mon Sep 3 15:56:12 2012 +0000

    core: Make sure to stash next_check_event for hosts and services
    
    I stumbled on this by accident. It looked wrong and the fix is
    obviously correct, so we might as well apply it.
    
    Signed-off-by: Andreas Ericsson <ae@op5.se>
    
    git-svn-id: https://nagios.svn.sourceforge.net/svnroot/nagios/nagioscore/trunk@2138 5f96b256-904b-4d8d-8c98-d829582c6739

diff --git a/base/events.c b/base/events.c
index db548318..a6fa7dbf 100644
--- a/base/events.c
+++ b/base/events.c
@@ -397,7 +397,7 @@ void init_timing_loop(void) {
 			}
 
 		/* create a new service check event */
-		schedule_new_event(EVENT_SERVICE_CHECK, FALSE, temp_service->next_check, FALSE, 0, NULL, TRUE, (void *)temp_service, NULL, temp_service->check_options);
+		temp_service->next_check_event = schedule_new_event(EVENT_SERVICE_CHECK, FALSE, temp_service->next_check, FALSE, 0, NULL, TRUE, (void *)temp_service, NULL, temp_service->check_options);
 		}
 
 
@@ -533,7 +533,7 @@ void init_timing_loop(void) {
 			}
 
 		/* schedule a new host check event */
-		schedule_new_event(EVENT_HOST_CHECK, FALSE, temp_host->next_check, FALSE, 0, NULL, TRUE, (void *)temp_host, NULL, temp_host->check_options);
+		temp_host->next_check_event = schedule_new_event(EVENT_HOST_CHECK, FALSE, temp_host->next_check, FALSE, 0, NULL, TRUE, (void *)temp_host, NULL, temp_host->check_options);
 		}
 
 	if(test_scheduling == TRUE)

