commit d2b0261506602bd969164879206027b30358ffdf
Author: Ingo Molnar <mingo@elte.hu>
Date:   Wed Feb 25 14:36:45 2009 +0100

    alloc_percpu: fix UP build
    
    Impact: build fix
    
    the !SMP branch had a 'gfp' leftover:
    
     include/linux/percpu.h: In function '__alloc_percpu':
     include/linux/percpu.h:160: error: 'gfp' undeclared (first use in this function)
     include/linux/percpu.h:160: error: (Each undeclared identifier is reported only once
     include/linux/percpu.h:160: error: for each function it appears in.)
    
    Use GFP_KERNEL like the SMP version does.
    
    Cc: Rusty Russell <rusty@rustcorp.com.au>
    Cc: Tejun Heo <tj@kernel.org>
    Signed-off-by: Ingo Molnar <mingo@elte.hu>

diff --git a/include/linux/percpu.h b/include/linux/percpu.h
index 910beb0abea2..d8e5a9abbce0 100644
--- a/include/linux/percpu.h
+++ b/include/linux/percpu.h
@@ -157,7 +157,7 @@ static inline void *__alloc_percpu(size_t size, size_t align)
 	 * percpu sections on SMP for which this path isn't used.
 	 */
 	WARN_ON_ONCE(align > __alignof__(unsigned long long));
-	return kzalloc(size, gfp);
+	return kzalloc(size, GFP_KERNEL);
 }
 
 static inline void free_percpu(void *p)

