commit f595c535151bf9476579d575aa1413e7c3f5dca0
Author: Denys Vlasenko <dvlasenk@redhat.com>
Date:   Thu Sep 16 13:52:15 2010 +0200

    perror has to be used immediately after failed syscall
    
    Signed-off-by: Denys Vlasenko <dvlasenk@redhat.com>

diff --git a/src/daemon/Daemon.cpp b/src/daemon/Daemon.cpp
index 1237e7c4..3941b484 100644
--- a/src/daemon/Daemon.cpp
+++ b/src/daemon/Daemon.cpp
@@ -142,8 +142,8 @@ static gboolean server_socket_cb(GIOChannel *source, GIOCondition condition, gpo
     pid_t pid = fork();
     if (pid < 0)
     {
-        close(socket);
         perror_msg("fork");
+        close(socket);
         return TRUE;
     }
     if (pid == 0) /* child */

