commit 3aa69711ada650ca1450e82041d82fe2d3ebfcf5
Author: Alan T. DeKok <aland@freeradius.org>
Date:   Thu Dec 23 09:59:31 2010 +0100

    Made calculations use "int64_t"

diff --git a/src/modules/rlm_expr/rlm_expr.c b/src/modules/rlm_expr/rlm_expr.c
index 6b0456b53..445004bbf 100644
--- a/src/modules/rlm_expr/rlm_expr.c
+++ b/src/modules/rlm_expr/rlm_expr.c
@@ -65,11 +65,11 @@ static expr_map_t map[] =
 	{0,	TOKEN_LAST}
 };
 
-static int get_number(REQUEST *request, const char **string, int *answer)
+static int get_number(REQUEST *request, const char **string, int64_t *answer)
 {
 	int		i, found;
-	uint32_t	result;
-	int		x;
+	int64_t		result;
+	int64_t		x;
 	const char	*p;
 	expr_token_t	this;
 
@@ -220,7 +220,8 @@ static size_t expr_xlat(void *instance, REQUEST *request, char *fmt,
 			char *out, size_t outlen,
 		     RADIUS_ESCAPE_STRING func)
 {
-	int		rcode, result;
+	int		rcode;
+	int64_t		result;
 	rlm_expr_t	*inst = instance;
 	const		char *p;
 	char		buffer[256];
@@ -249,7 +250,7 @@ static size_t expr_xlat(void *instance, REQUEST *request, char *fmt,
 		return 0;
 	}
 
-	snprintf(out, outlen, "%d", result);
+	snprintf(out, outlen, "%ld", (long int) result);
 	return strlen(out);
 }
 

