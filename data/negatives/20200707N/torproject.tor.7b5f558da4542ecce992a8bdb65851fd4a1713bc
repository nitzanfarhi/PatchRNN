commit 7b5f558da4542ecce992a8bdb65851fd4a1713bc
Author: Yawning Angel <yawning@schwanenlied.me>
Date:   Thu Apr 2 12:36:19 2015 +0000

    Treat empty introduction points sections as missing.
    
    Found by DonnchaC.

diff --git a/src/or/rendcommon.c b/src/or/rendcommon.c
index d1b49411c..d1f8b1af9 100644
--- a/src/or/rendcommon.c
+++ b/src/or/rendcommon.c
@@ -1301,7 +1301,7 @@ rend_cache_store_v2_desc_as_client(const char *desc,
     goto err;
   }
   /* Decode/decrypt introduction points. */
-  if (intro_content) {
+  if (intro_content && intro_size > 0) {
     int n_intro_points;
     if (rend_query->auth_type != REND_NO_AUTH &&
         !tor_mem_is_zero(rend_query->descriptor_cookie,

