commit febc013dc5d6db1535a4f91cf02fa8089038937c
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Fri Jun 1 15:52:20 2012 +0200

    yopdec: check frame oddness to be within supported limits
    
    Fixes Ticket1365
    
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavcodec/yop.c b/libavcodec/yop.c
index df61426dfe..42059e1c5a 100644
--- a/libavcodec/yop.c
+++ b/libavcodec/yop.c
@@ -224,6 +224,10 @@ static int yop_decode_frame(AVCodecContext *avctx, void *data, int *data_size,
     s->low_nibble = NULL;
 
     is_odd_frame = avpkt->data[0];
+    if(is_odd_frame>1){
+        av_log(avctx, AV_LOG_ERROR, "frame is too odd %d\n", is_odd_frame);
+        return AVERROR_INVALIDDATA;
+    }
     firstcolor   = s->first_color[is_odd_frame];
     palette      = (uint32_t *)s->frame.data[1];
 

