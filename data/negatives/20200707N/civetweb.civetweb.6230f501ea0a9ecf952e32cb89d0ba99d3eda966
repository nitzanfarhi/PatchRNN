commit 6230f501ea0a9ecf952e32cb89d0ba99d3eda966
Author: bel2125 <bel2125@gmail.com>
Date:   Sat Jul 29 21:15:04 2017 +0200

    Fix yet another 32 bit warning (#496)

diff --git a/src/civetweb.c b/src/civetweb.c
index 7ae11ac8..1627a618 100644
--- a/src/civetweb.c
+++ b/src/civetweb.c
@@ -10971,15 +10971,16 @@ read_websocket(struct mg_connection *conn,
 			} else {
 				mop = buf[0]; /* current mask and opcode, overwritten by
 				               * memmove() */
+
 				/* Length of the message being read at the front of the
-				                 * queue. Cast to 31 bit is OK, since we limited
-				 * data_len
-				                 * before. */
+                                 * queue. Cast to 31 bit is OK, since we limited
+                                 * data_len before. */
 				len = (size_t)data_len + header_len;
 
 				/* Copy the data payload into the data pointer for the
-				 * callback */
-				memcpy(data, buf + header_len, data_len);
+                                 * callback. Cast to 31 bit is OK, since we
+                                 * limited data_len */
+				memcpy(data, buf + header_len, (size_t)data_len);
 
 				/* Move the queue forward len bytes */
 				memmove(buf, buf + len, body_len - len);
@@ -10990,7 +10991,7 @@ read_websocket(struct mg_connection *conn,
 
 			/* Apply mask if necessary */
 			if (mask_len > 0) {
-				for (i = 0; i < data_len; ++i) {
+				for (i = 0; i < (size_t)data_len; i++) {
 					data[i] ^= mask[i & 3];
 				}
 			}

