commit e9364d0f82f68a2f4b41b0daeee1bb0e4ae43458
Author: William Pitcock <nenolod@dereferenced.org>
Date:   Mon Nov 7 00:35:38 2011 -0600

    libathemecore: allow passing NULL to strshare functions for convenience reasons

diff --git a/libathemecore/strshare.c b/libathemecore/strshare.c
index 1f1b15500..3301e3c49 100644
--- a/libathemecore/strshare.c
+++ b/libathemecore/strshare.c
@@ -39,6 +39,9 @@ char *strshare_get(const char *str)
 {
 	strshare_t *ss;
 
+	if (str == NULL)
+		return NULL;
+
 	ss = mowgli_patricia_retrieve(strshare_dict, str);
 	if (ss != NULL)
 		ss->refcount++;
@@ -56,6 +59,9 @@ void strshare_unref(char *str)
 {
 	strshare_t *ss;
 
+	if (str == NULL)
+		return NULL;
+
 	ss = (strshare_t *)str - 1;
 	ss->refcount--;
 	if (ss->refcount == 0)

