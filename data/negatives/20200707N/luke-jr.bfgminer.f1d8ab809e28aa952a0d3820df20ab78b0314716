commit f1d8ab809e28aa952a0d3820df20ab78b0314716
Author: Luke Dashjr <luke-jr+git@utopios.org>
Date:   Fri Jun 7 19:15:54 2013 +0000

    Bugfix: bitforce_queue: Don't try to send ready-to-queue work to device, when there is no ready-to-queue work

diff --git a/driver-bitforce.c b/driver-bitforce.c
index 711a8ba8..b31a1a41 100644
--- a/driver-bitforce.c
+++ b/driver-bitforce.c
@@ -1341,6 +1341,9 @@ bool bitforce_queue_append(struct thr_info *thr, struct work *work)
 		       (unsigned)BITFORCE_MAX_QUEUED, data->ready_to_queue, data->queued);
 		bitforce_set_queue_full(thr);
 	}
+	else
+	if (!data->ready_to_queue)
+		return rv;
 	
 	ndq = !data->queued;
 	if ((ndq)              // Device is idle

