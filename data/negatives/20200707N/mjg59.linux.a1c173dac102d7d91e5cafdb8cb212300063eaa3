commit a1c173dac102d7d91e5cafdb8cb212300063eaa3
Author: Jason Gerecke <killertofu@gmail.com>
Date:   Wed Aug 5 15:45:30 2015 -0700

    HID: wacom: Do not repeatedly attempt to set device mode on error
    
    As an extension of aef3156d7, there is no sense in repeatedly calling the
    'wacom_set_report' and 'wacom_get_report' functions if they return an
    error. Getting an error from them implies that the device is out to lunch:
    either a hard error code was returned or repeated attempts at recovering
    from a "soft" error all failed. In either case, doing even more retries is
    not likely to resolve whatever is wrong.
    
    Signed-off-by: Jason Gerecke <jason.gerecke@wacom.com>
    Signed-off-by: Jiri Kosina <jkosina@suse.cz>

diff --git a/drivers/hid/wacom_sys.c b/drivers/hid/wacom_sys.c
index 936ad7770ec3..177e49b11e33 100644
--- a/drivers/hid/wacom_sys.c
+++ b/drivers/hid/wacom_sys.c
@@ -335,7 +335,7 @@ static int wacom_set_device_mode(struct hid_device *hdev, int report_id,
 		if (error >= 0)
 			error = wacom_get_report(hdev, HID_FEATURE_REPORT,
 			                         rep_data, length, 1);
-	} while ((error < 0 || rep_data[1] != mode) && limit++ < WAC_MSG_RETRIES);
+	} while (error >= 0 && rep_data[1] != mode && limit++ < WAC_MSG_RETRIES);
 
 	kfree(rep_data);
 

