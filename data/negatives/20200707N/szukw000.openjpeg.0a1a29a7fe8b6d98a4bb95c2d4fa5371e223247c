commit 0a1a29a7fe8b6d98a4bb95c2d4fa5371e223247c
Author: Antonin Descampe <antonin@gmail.com>
Date:   Thu Jul 3 16:05:56 2014 +0000

    [trunk] replaced malloc with opj_malloc. (Fixes issue 368).

diff --git a/src/lib/openjp2/j2k.c b/src/lib/openjp2/j2k.c
index d06dc05e..5fd743de 100644
--- a/src/lib/openjp2/j2k.c
+++ b/src/lib/openjp2/j2k.c
@@ -6131,10 +6131,10 @@ void opj_j2k_setup_encoder(     opj_j2k_t *p_j2k,
             const char *version = opj_version();
             /* UniPG>> */
 #ifdef USE_JPWL
-            parameters->cp_comment = (char*)malloc(clen+strlen(version)+11);
+            parameters->cp_comment = (char*)opj_malloc(clen+strlen(version)+11);
             sprintf(parameters->cp_comment,"%s%s with JPWL", comment, version);
 #else
-            parameters->cp_comment = (char*)malloc(clen+strlen(version)+1);
+            parameters->cp_comment = (char*)opj_malloc(clen+strlen(version)+1);
             sprintf(parameters->cp_comment,"%s%s", comment, version);
 #endif
             /* <<UniPG */

