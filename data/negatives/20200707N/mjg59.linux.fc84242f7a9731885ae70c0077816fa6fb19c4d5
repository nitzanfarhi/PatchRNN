commit fc84242f7a9731885ae70c0077816fa6fb19c4d5
Author: Glenn Ruben Bakke <glenn.ruben.bakke@nordicsemi.no>
Date:   Wed Jun 17 07:32:25 2015 -0700

    Bluetooth: 6lowpan: Move netdev sysfs device reference
    
    This patch moves the sysfs device used by the netdev from the device of
    the first connected peer to the hci sysfs device. Using the sysfs device
    of hci instead of the first connected device fixes this issue such that
    the sysfs group of tx-0 and bt0 kobject are still present after the last
    peer has been deleted and all sysfs entries can be removed.
    
    Signed-off-by: Lukasz Duda <lukasz.duda@nordicsemi.no>
    Signed-off-by: Glenn Ruben Bakke <glenn.ruben.bakke@nordicsemi.no>
    Signed-off-by: Marcel Holtmann <marcel@holtmann.org>

diff --git a/net/bluetooth/6lowpan.c b/net/bluetooth/6lowpan.c
index 7ee591aac2fc..bc105a91c84a 100644
--- a/net/bluetooth/6lowpan.c
+++ b/net/bluetooth/6lowpan.c
@@ -856,7 +856,7 @@ static int setup_netdev(struct l2cap_chan *chan, struct lowpan_dev **dev)
 	set_dev_addr(netdev, &chan->src, chan->src_type);
 
 	netdev->netdev_ops = &netdev_ops;
-	SET_NETDEV_DEV(netdev, &chan->conn->hcon->dev);
+	SET_NETDEV_DEV(netdev, &chan->conn->hcon->hdev->dev);
 	SET_NETDEV_DEVTYPE(netdev, &bt_type);
 
 	err = register_netdev(netdev);

