commit 44aebbf6ddecda29a52d5a0fd6e766a1653a6a38
Author: Martti Rannanj√§rvi <martti.rannanjarvi@dovecot.fi>
Date:   Wed Apr 20 14:33:57 2016 +0300

    doveadm: error to print formatted without format
    
    This changes the segfault of `doveadm -f formatted ...` to an error.

diff --git a/src/doveadm/doveadm-print-formatted.c b/src/doveadm/doveadm-print-formatted.c
index 87e03c5f1..28347eb81 100644
--- a/src/doveadm/doveadm-print-formatted.c
+++ b/src/doveadm/doveadm-print-formatted.c
@@ -53,6 +53,9 @@ static void doveadm_print_formatted_flush(void)
 
 static void doveadm_print_formatted_print(const char *value)
 {
+	if (ctx.format == NULL) {
+		i_fatal("formatted formatter cannot be used without a format.");
+	}
 	struct var_expand_table *entry = array_idx_modifiable(&ctx.headers, ctx.idx++);
 	entry->value = value;
 

