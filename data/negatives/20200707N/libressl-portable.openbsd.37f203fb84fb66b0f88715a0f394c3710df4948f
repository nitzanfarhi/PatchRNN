commit 37f203fb84fb66b0f88715a0f394c3710df4948f
Author: tedu <>
Date:   Tue Jun 17 01:41:01 2014 +0000

    ssl_session_cmp is not a sort function, can use CRYPTO_memcmp here too.

diff --git a/src/lib/libssl/src/ssl/ssl_lib.c b/src/lib/libssl/src/ssl/ssl_lib.c
index 297c80124..04c339305 100644
--- a/src/lib/libssl/src/ssl/ssl_lib.c
+++ b/src/lib/libssl/src/ssl/ssl_lib.c
@@ -1,4 +1,4 @@
-/* $OpenBSD: ssl_lib.c,v 1.67 2014/06/13 10:52:24 jsing Exp $ */
+/* $OpenBSD: ssl_lib.c,v 1.68 2014/06/17 01:41:01 tedu Exp $ */
 /* Copyright (C) 1995-1998 Eric Young (eay@cryptsoft.com)
  * All rights reserved.
  *
@@ -1678,7 +1678,9 @@ ssl_session_cmp(const SSL_SESSION *a, const SSL_SESSION *b)
 		return (1);
 	if (a->session_id_length != b->session_id_length)
 		return (1);
-	return (memcmp(a->session_id, b->session_id, a->session_id_length));
+	if (CRYPTO_memcmp(a->session_id, b->session_id, a->session_id_length) != 0)
+		return (1);
+	return (0);
 }
 
 /*
diff --git a/src/lib/libssl/ssl_lib.c b/src/lib/libssl/ssl_lib.c
index 297c80124..04c339305 100644
--- a/src/lib/libssl/ssl_lib.c
+++ b/src/lib/libssl/ssl_lib.c
@@ -1,4 +1,4 @@
-/* $OpenBSD: ssl_lib.c,v 1.67 2014/06/13 10:52:24 jsing Exp $ */
+/* $OpenBSD: ssl_lib.c,v 1.68 2014/06/17 01:41:01 tedu Exp $ */
 /* Copyright (C) 1995-1998 Eric Young (eay@cryptsoft.com)
  * All rights reserved.
  *
@@ -1678,7 +1678,9 @@ ssl_session_cmp(const SSL_SESSION *a, const SSL_SESSION *b)
 		return (1);
 	if (a->session_id_length != b->session_id_length)
 		return (1);
-	return (memcmp(a->session_id, b->session_id, a->session_id_length));
+	if (CRYPTO_memcmp(a->session_id, b->session_id, a->session_id_length) != 0)
+		return (1);
+	return (0);
 }
 
 /*

