commit 4b6ef3fac248c5e1c06195a69fae0475d2c02843
Author: Evan Huus <eapache@gmail.com>
Date:   Fri Dec 13 20:09:17 2013 +0000

    Add another check to radiotap-iter initialization to catch another out-of-bounds
    read found while fuzzing with valgrind. Hopefully doesn't break valid captures.
    
    svn path=/trunk/; revision=54056

diff --git a/epan/dissectors/packet-ieee80211-radiotap-iter.c b/epan/dissectors/packet-ieee80211-radiotap-iter.c
index a0a7711ddc..b80dbffeeb 100644
--- a/epan/dissectors/packet-ieee80211-radiotap-iter.c
+++ b/epan/dissectors/packet-ieee80211-radiotap-iter.c
@@ -159,6 +159,8 @@ int ieee80211_radiotap_iterator_init(
 
 	/* find payload start allowing for extended bitmap(s) */
 	if (iterator->_bitmap_shifter & (1<<IEEE80211_RADIOTAP_EXT)) {
+		if (!ITERATOR_VALID(iterator, sizeof(guint32)))
+			return -EINVAL;
 		while (get_unaligned_le32(iterator->_arg) &
 					(1 << IEEE80211_RADIOTAP_EXT)) {
 			iterator->_arg += sizeof(guint32);

