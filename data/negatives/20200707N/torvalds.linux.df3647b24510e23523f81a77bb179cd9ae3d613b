commit df3647b24510e23523f81a77bb179cd9ae3d613b
Author: Steven Whitehouse <swhiteho@redhat.com>
Date:   Mon Mar 23 11:38:55 2009 +0000

    GFS2: Fix freeze issue
    
    This removes some old code that was causing issues during
    filesystem freeze.
    
    Reported-by: Andrew Price <andy@andrewprice.me.uk>
    Tested-by: Andrew Price <andy@andrewprice.me.uk>
    Signed-off-by: Steven Whitehouse <swhiteho@redhat.com>

diff --git a/fs/gfs2/super.c b/fs/gfs2/super.c
index 7cf302b135ce..601913e0a482 100644
--- a/fs/gfs2/super.c
+++ b/fs/gfs2/super.c
@@ -338,7 +338,6 @@ static int gfs2_lock_fs_check_clean(struct gfs2_sbd *sdp,
 				    struct gfs2_holder *t_gh)
 {
 	struct gfs2_inode *ip;
-	struct gfs2_holder ji_gh;
 	struct gfs2_jdesc *jd;
 	struct lfcc *lfcc;
 	LIST_HEAD(list);
@@ -386,7 +385,6 @@ static int gfs2_lock_fs_check_clean(struct gfs2_sbd *sdp,
 		gfs2_glock_dq_uninit(&lfcc->gh);
 		kfree(lfcc);
 	}
-	gfs2_glock_dq_uninit(&ji_gh);
 	return error;
 }
 

