commit 32466ed51baa6da4be4f7a24db5fa9b9c49d2c92
Author: Timothy Qiu <timothyqiu32@gmail.com>
Date:   Wed Aug 9 15:16:24 2017 +0800

    Discards long ACL lines

diff --git a/src/acl.c b/src/acl.c
index 5dcc040..480c829 100644
--- a/src/acl.c
+++ b/src/acl.c
@@ -191,6 +191,23 @@ init_acl(const char *path)
     char buf[257];
     while (!feof(f))
         if (fgets(buf, 256, f)) {
+            // Discards the whole line if longer than 255 characters
+            int long_line = 0;  // 1: Long  2: Error
+            while ((strlen(buf) == 255) && (buf[254] != '\n')) {
+                long_line = 1;
+                LOGE("Discarding long ACL content: %s", buf);
+                if (fgets(buf, 256, f) == NULL) {
+                    long_line = 2;
+                    break;
+                }
+            }
+            if (long_line) {
+                if (long_line == 1) {
+                    LOGE("Discarding long ACL content: %s", buf);
+                }
+                continue;
+            }
+
             // Trim the newline
             int len = strlen(buf);
             if (len > 0 && buf[len - 1] == '\n') {

