commit 73ea41607004bd39bf56730b875549f765107e95
Author: Dr. Stephen Henson <steve@openssl.org>
Date:   Wed Jun 17 11:48:22 2009 +0000

    Update from 1.0.0-stable.

diff --git a/crypto/bn/bn_mul.c b/crypto/bn/bn_mul.c
index b848c8cc60..3a1d459dd6 100644
--- a/crypto/bn/bn_mul.c
+++ b/crypto/bn/bn_mul.c
@@ -1028,6 +1028,8 @@ int BN_mul(BIGNUM *r, const BIGNUM *a, const BIGNUM *b, BN_CTX *ctx)
 			assert(j <= al || j <= bl);
 			k = j+j;
 			t = BN_CTX_get(ctx);
+			if (t == NULL)
+				goto err;
 			if (al > j || bl > j)
 				{
 				bn_wexpand(t,k*4);

