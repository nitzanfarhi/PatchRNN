commit d89494d34bc409fdb75353613fdb1121593b2b12
Author: tholo <tholo@openbsd.org>
Date:   Sat Oct 26 07:29:40 1996 +0000

    Verify that pgid argument to setpgid() is legal

diff --git a/sys/kern/kern_prot.c b/sys/kern/kern_prot.c
index 34223860510..1f21a6d3531 100644
--- a/sys/kern/kern_prot.c
+++ b/sys/kern/kern_prot.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: kern_prot.c,v 1.5 1996/10/02 20:22:14 deraadt Exp $	*/
+/*	$OpenBSD: kern_prot.c,v 1.6 1996/10/26 07:29:40 tholo Exp $	*/
 /*	$NetBSD: kern_prot.c,v 1.33 1996/02/09 18:59:42 christos Exp $	*/
 
 /*
@@ -247,6 +247,9 @@ sys_setpgid(curp, v, retval)
 	SCARG(uap, pgid) = (short) SCARG(uap, pgid);		/* XXX */
 #endif
 
+	if (SCARG(uap, pgid) < 0)
+		return (EINVAL);
+
 	if (SCARG(uap, pid) != 0 && SCARG(uap, pid) != curp->p_pid) {
 		if ((targp = pfind(SCARG(uap, pid))) == 0 || !inferior(targp))
 			return (ESRCH);

