commit 492a9225f9431ffbe9cf4ced30455cf32a5f5af1
Author: Antony Antony <antony@phenome.org>
Date:   Fri Mar 20 02:14:27 2015 -0500

    ikev2: fix send certreq

diff --git a/programs/pluto/x509.c b/programs/pluto/x509.c
index 788c9f106..eeb385a25 100644
--- a/programs/pluto/x509.c
+++ b/programs/pluto/x509.c
@@ -1348,10 +1348,10 @@ stf_status ikev2_send_certreq(struct state *st, struct msg_digest *md,
 			DBG(DBG_CONTROL,
 			    DBG_log("connection is RW, lookup CA candidates"));
 
-			for (gn = ca; gn != NULL; gn = gn->next) {
+			for (ca = gn; ca != NULL; ca = ca->next) {
 				if (!ikev2_build_and_ship_CR(CERT_X509_SIGNATURE,
-						       gn->name, outpbs,
-						       gn->next == NULL ? np :
+						       ca->name, outpbs,
+						       ca->next == NULL ? np :
 						         ISAKMP_NEXT_v2CERTREQ))
 					return STF_INTERNAL_ERROR;
 			}

