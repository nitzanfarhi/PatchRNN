commit e3965fbc3243c0ae210586805915bfd5f5107e68
Author: Thomas Roessler <roessler@does-not-exist.org>
Date:   Thu Jul 26 17:42:48 2001 +0000

    patch-bac.imapnextword-1. From Brendan Cully.

diff --git a/imap/util.c b/imap/util.c
index b3aabc7c9..d65d7e238 100644
--- a/imap/util.c
+++ b/imap/util.c
@@ -346,8 +346,22 @@ char* imap_get_qualifier (char* buf)
 /* imap_next_word: return index into string where next IMAP word begins */
 char *imap_next_word (char *s)
 {
-  while (*s && !ISSPACE (*s))
+  int quoted = 0;
+
+  while (*s) {
+    if (*s == '\\') {
+      s++;
+      if (*s)
+	s++;
+      continue;
+    }
+    if (*s == '\"')
+      quoted = quoted ? 0 : 1;
+    if (!quoted && ISSPACE (*s))
+      break;
     s++;
+  }
+
   SKIPWS (s);
   return s;
 }

