commit 2afb41d9d30d33504c47a5dda3eeade692f388dc
Author: Jens Taprogge <jens.taprogge@taprogge.org>
Date:   Wed Sep 12 14:55:40 2012 +0200

    Staging: ipack/devices/ipoctal: Check tty_register_device return value.
    
    Signed-off-by: Jens Taprogge <jens.taprogge@taprogge.org>
    Signed-off-by: Samuel Iglesias Gonsalvez <siglesias@igalia.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

diff --git a/drivers/staging/ipack/devices/ipoctal.c b/drivers/staging/ipack/devices/ipoctal.c
index b84ab5eb4b11..737127033cff 100644
--- a/drivers/staging/ipack/devices/ipoctal.c
+++ b/drivers/staging/ipack/devices/ipoctal.c
@@ -437,6 +437,8 @@ static int ipoctal_inst_slot(struct ipoctal *ipoctal, unsigned int bus_nr,
 	ipoctal->tty_drv = tty;
 
 	for (i = 0; i < NR_CHANNELS; i++) {
+		struct device *tty_dev;
+
 		channel = &ipoctal->channel[i];
 		tty_port_init(&channel->tty_port);
 		tty_port_alloc_xmit_buf(&channel->tty_port);
@@ -450,7 +452,11 @@ static int ipoctal_inst_slot(struct ipoctal *ipoctal, unsigned int bus_nr,
 		channel->pointer_read = 0;
 		channel->pointer_write = 0;
 		channel->nb_bytes = 0;
-		tty_register_device(tty, i, NULL);
+		tty_dev = tty_register_device(tty, i, NULL);
+		if (IS_ERR(tty_dev)) {
+			dev_err(&ipoctal->dev->dev, "Failed to register tty device.\n");
+			continue;
+		}
 
 		/*
 		 * Enable again the RX. TX will be enabled when

