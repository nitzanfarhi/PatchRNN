commit 30bd897db2952a5ae0948532db3fb4438ce01e88
Author: Love Hörnquist Åstrand <lha@kth.se>
Date:   Sat Dec 11 18:55:18 2004 +0000

    (LDAP_message2entry): if the entry is missing both krb5PrincipalName
    and uid, it must be broken, ignore it and return it doesn't exists.
    
    
    git-svn-id: svn://svn.h5l.se/heimdal/trunk/heimdal@14383 ec53bebd-3082-4978-b11e-865c3cabbd6b

diff --git a/lib/hdb/hdb-ldap.c b/lib/hdb/hdb-ldap.c
index 8dd072946..5275e8417 100644
--- a/lib/hdb/hdb-ldap.c
+++ b/lib/hdb/hdb-ldap.c
@@ -927,6 +927,10 @@ LDAP_message2entry(krb5_context context, HDB * db, LDAPMessage * msg,
 	    ret = krb5_parse_name(context, unparsed_name, &ent->principal);
 	    if (ret)
 		goto out;
+	} else {
+	    krb5_set_error_string(context, "hdb-ldap: ldap entry missing"
+				  "principal name");
+	    return HDB_ERR_NOENTRY;
 	}
     }
 

