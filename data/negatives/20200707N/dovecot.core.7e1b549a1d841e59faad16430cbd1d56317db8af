commit 7e1b549a1d841e59faad16430cbd1d56317db8af
Author: Timo Sirainen <tss@iki.fi>
Date:   Sat Apr 30 15:55:08 2011 +0300

    sdbox: In-memory mailbox GUID differed from on-index GUID after mailbox_create().

diff --git a/src/lib-storage/index/dbox-single/sdbox-storage.c b/src/lib-storage/index/dbox-single/sdbox-storage.c
index 5c0bc20b6..0c8bc189d 100644
--- a/src/lib-storage/index/dbox-single/sdbox-storage.c
+++ b/src/lib-storage/index/dbox-single/sdbox-storage.c
@@ -118,6 +118,8 @@ void sdbox_update_header(struct sdbox_mailbox *mbox,
 		mail_index_update_header_ext(trans, mbox->hdr_ext_id, 0,
 					     &new_hdr, sizeof(new_hdr));
 	}
+	memcpy(mbox->mailbox_guid, new_hdr.mailbox_guid,
+	       sizeof(mbox->mailbox_guid));
 }
 
 static int sdbox_mailbox_create_indexes(struct mailbox *box,

