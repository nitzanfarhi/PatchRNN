commit 6c389ddbd32d0e08d3db8510d55fc2d3924ea495
Author: Laurent Aimar <fenrir@videolan.org>
Date:   Thu Mar 4 19:12:20 2010 +0000

    Fixed DXVA2 H264 hwaccel after luma/chroma_weight changes.
    
    Originally committed as revision 22211 to svn://svn.ffmpeg.org/ffmpeg/trunk

diff --git a/libavcodec/dxva2_h264.c b/libavcodec/dxva2_h264.c
index bf66f1e01e..9262bb8957 100644
--- a/libavcodec/dxva2_h264.c
+++ b/libavcodec/dxva2_h264.c
@@ -220,11 +220,11 @@ static void fill_slice_long(AVCodecContext *avctx, DXVA_Slice_H264_Long *slice,
                 for (plane = 0; plane < 3; plane++) {
                     int w, o;
                     if (plane == 0 && h->luma_weight_flag[list]) {
-                        w = h->luma_weight[list][i][0];
-                        o = h->luma_weight[list][i][1];
+                        w = h->luma_weight[i][list][0];
+                        o = h->luma_weight[i][list][1];
                     } else if (plane >= 1 && h->chroma_weight_flag[list]) {
-                        w = h->chroma_weight[list][i][plane-1][0];
-                        o = h->chroma_weight[list][i][plane-1][1];
+                        w = h->chroma_weight[i][list][plane-1][0];
+                        o = h->chroma_weight[i][list][plane-1][1];
                     } else {
                         w = 1 << (plane == 0 ? h->luma_log2_weight_denom :
                                                h->chroma_log2_weight_denom);

