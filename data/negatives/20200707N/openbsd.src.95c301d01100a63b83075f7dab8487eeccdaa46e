commit 95c301d01100a63b83075f7dab8487eeccdaa46e
Author: deraadt <deraadt@openbsd.org>
Date:   Thu Apr 21 00:19:54 2005 +0000

    bail out early, skip snprintf, if buflen is 0; ok cloder

diff --git a/libexec/telnetd/global.c b/libexec/telnetd/global.c
index 841fbb5ae80..395102757f8 100644
--- a/libexec/telnetd/global.c
+++ b/libexec/telnetd/global.c
@@ -93,6 +93,8 @@ output_data (const char *format, ...)
 
   va_start(args, format);
   remaining = BUFSIZ - (nfrontp - netobuf);
+  if (remaining == 0)
+    return remaining;
   if ((n = vsnprintf(nfrontp, remaining, format, args)) >= remaining || n < 0)
     n = strlen(nfrontp);
   nfrontp += n;

