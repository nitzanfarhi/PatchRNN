commit 65f05eff0a5d4319c7a3cd9cfbb982972b800cdc
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Sat Aug 16 01:31:37 2014 +0200

    avfilter/lavfutils/ff_load_image: Return error if no frame could be decoded
    
    Based-on suggestion by JULIAN GARDNER <joolzg@btinternet.com>
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavfilter/lavfutils.c b/libavfilter/lavfutils.c
index ebdf8f8f31..80310d2fea 100644
--- a/libavfilter/lavfutils.c
+++ b/libavfilter/lavfutils.c
@@ -77,6 +77,8 @@ int ff_load_image(uint8_t *data[4], int linesize[4],
     ret = avcodec_decode_video2(codec_ctx, frame, &frame_decoded, &pkt);
     if (ret < 0 || !frame_decoded) {
         av_log(log_ctx, AV_LOG_ERROR, "Failed to decode image from file\n");
+        if (ret >= 0)
+            ret = -1;
         goto end;
     }
 

