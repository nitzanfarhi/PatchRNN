commit eb4b0abc40b991f210c16bf049a0f5a76ce11e9c
Author: Timo Sirainen <tss@iki.fi>
Date:   Tue Mar 11 08:14:21 2008 +0200

    dbox rebuild: If alt directory doesn't exist, don't fail.
    
    --HG--
    branch : HEAD

diff --git a/src/lib-storage/index/dbox/dbox-sync-rebuild.c b/src/lib-storage/index/dbox/dbox-sync-rebuild.c
index dbcfe5058..8e827a3ab 100644
--- a/src/lib-storage/index/dbox/dbox-sync-rebuild.c
+++ b/src/lib-storage/index/dbox/dbox-sync-rebuild.c
@@ -287,6 +287,10 @@ static int dbox_sync_index_rebuild_dir(struct dbox_sync_rebuild_context *ctx,
 	dir = opendir(path);
 	if (dir == NULL) {
 		if (errno == ENOENT) {
+			if (!primary) {
+				/* alt directory doesn't exist, ignore */
+				return 0;
+			}
 			mailbox_set_deleted(&ctx->mbox->ibox.box);
 			return -1;
 		}

