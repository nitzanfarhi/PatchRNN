commit a4c8b3fde0c9386f9689cc8ba06b749038f7395b
Author: Török Edvin <edwin@clamav.net>
Date:   Wed Jan 11 13:07:04 2012 +0200

    fix valgrind warn

diff --git a/libclamav/crtmgr.c b/libclamav/crtmgr.c
index 63ba7d138..6c89b1868 100644
--- a/libclamav/crtmgr.c
+++ b/libclamav/crtmgr.c
@@ -50,7 +50,7 @@ cli_crt *crtmgr_lookup(crtmgr *m, cli_crt *x509) {
 	   (i->codeSign | x509->codeSign) == i->codeSign &&
 	   (i->timeSign | x509->timeSign) == i->timeSign &&
 	   !memcmp(x509->subject, i->subject, sizeof(i->subject)) &&
-	   !memcmp(x509->serial, i->serial, sizeof(i->subject)) &&
+	   !memcmp(x509->serial, i->serial, sizeof(i->serial)) &&
 	   !mp_cmp(&x509->n, &i->n) &&
 	   !mp_cmp(&x509->e, &i->e)) {
 	    return i;
@@ -411,6 +411,7 @@ int crtmgr_add_roots(crtmgr *m) {
     do {
 	memset(ca.issuer, '\xca', sizeof(ca.issuer));
 	memcpy(ca.subject, MSCA_SUBJECT, sizeof(ca.subject));
+	memset(ca.serial, 0, sizeof(ca.serial));
 	if(mp_read_unsigned_bin(&ca.n, MSCA_MOD, sizeof(MSCA_MOD)-1) || mp_read_unsigned_bin(&ca.e, MSCA_EXP, sizeof(MSCA_EXP)-1)) {
 	    cli_errmsg("crtmgr_add_roots: failed to read MSCA key\n");
 	    break;

