commit 1d2b1a76d39433ba9eb065bb31d3594cb491e617
Author: Florian Fainelli <florian@openwrt.org>
Date:   Thu Jan 8 11:02:30 2009 -0800

    r6040: warn about MAC address being unset
    
    Some bootloader/BIOSes do not set the MAC
    address, warn about that.
    
    Signed-off-by: Florian Fainelli <florian@openwrt.org>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/drivers/net/r6040.c b/drivers/net/r6040.c
index 7ac6fede6e6d..3354cceb75d2 100644
--- a/drivers/net/r6040.c
+++ b/drivers/net/r6040.c
@@ -1141,6 +1141,11 @@ static int __devinit r6040_init_one(struct pci_dev *pdev,
 	adrp[1] = ioread16(ioaddr + MID_0M);
 	adrp[2] = ioread16(ioaddr + MID_0H);
 
+	/* Some bootloader/BIOSes do not initialize
+	 * MAC address, warn about that */
+	if (!(adrp[0] || adrp[1] || adrp[2]))
+		printk(KERN_WARNING DRV_NAME ": MAC address not initialized\n");
+
 	/* Link new device into r6040_root_dev */
 	lp->pdev = pdev;
 	lp->dev = dev;

