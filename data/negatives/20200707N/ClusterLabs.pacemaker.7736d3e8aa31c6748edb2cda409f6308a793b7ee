commit 7736d3e8aa31c6748edb2cda409f6308a793b7ee
Author: Andrew Beekhof <andrew@beekhof.net>
Date:   Fri Aug 1 15:15:58 2008 +0200

    Low: ais: Warn if valgrind is requested but not available
    
    Mercurial revision: 97ba5a059cec8a6e57072ee3cc6cb0c00e7eadf4

diff --git a/crm/ais/utils.c b/crm/ais/utils.c
index 124c547d2..f5dff736e 100644
--- a/crm/ais/utils.c
+++ b/crm/ais/utils.c
@@ -113,7 +113,8 @@ gboolean spawn_child(crm_child_t *child)
     AIS_ASSERT(child->pid != -1);
 
     if(env_valgrind == NULL) {
-	
+	use_valgrind = FALSE;
+
     } else if(ais_string_to_boolean(env_valgrind)) {
 	use_valgrind = TRUE;
 
@@ -121,6 +122,11 @@ gboolean spawn_child(crm_child_t *child)
 	use_valgrind = TRUE;	
     }
 
+    if(use_valgrind && strlen(VALGRIND_BIN) == 0) {
+	ais_warn("Cannot enable valgrind for %s:"
+		 " The location of the valgrind binary is unknown", child->name);
+	use_valgrind = FALSE;
+    }
     
     if(child->pid > 0) {
 	/* parent */

