commit b09cf8afc5199d359ac985ad7cea72a6a9f20e4e
Author: Vittorio Giovara <vittorio.giovara@gmail.com>
Date:   Tue Nov 11 13:26:54 2014 +0100

    libopusenc: check return value
    
    CC: libav-stable@libav.org
    Bug-Id: CID 739870

diff --git a/libavcodec/libopusenc.c b/libavcodec/libopusenc.c
index ee9655beef..84472068ed 100644
--- a/libavcodec/libopusenc.c
+++ b/libavcodec/libopusenc.c
@@ -308,7 +308,9 @@ static int libopus_encode(AVCodecContext *avctx, AVPacket *avpkt,
     int ret;
 
     if (frame) {
-        ff_af_queue_add(&opus->afq, frame);
+        ret = ff_af_queue_add(&opus->afq, frame);
+        if (ret < 0)
+            return ret;
         if (frame->nb_samples < opus->opts.packet_size) {
             audio = opus->samples;
             memcpy(audio, frame->data[0], frame->nb_samples * sample_size);

