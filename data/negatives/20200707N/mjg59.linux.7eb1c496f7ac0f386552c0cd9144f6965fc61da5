commit 7eb1c496f7ac0f386552c0cd9144f6965fc61da5
Author: Daniel Vetter <daniel.vetter@ffwll.ch>
Date:   Thu Nov 14 11:30:43 2013 +0100

    drm/i915: Reject opening of pipe crc files for invalid pipes
    
    We don't init the lock nor set up all the other state. And it doesn't
    make sense anyway.
    
    This appeases lockdep when running the igt/drv_debugfs_reader test.
    
    Reviewed-by: Damien Lespiau <damien.lespiau@intel.com>
    Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>

diff --git a/drivers/gpu/drm/i915/i915_debugfs.c b/drivers/gpu/drm/i915/i915_debugfs.c
index 8362dc154af4..506f8efeb519 100644
--- a/drivers/gpu/drm/i915/i915_debugfs.c
+++ b/drivers/gpu/drm/i915/i915_debugfs.c
@@ -1771,6 +1771,9 @@ static int i915_pipe_crc_open(struct inode *inode, struct file *filep)
 	struct drm_i915_private *dev_priv = info->dev->dev_private;
 	struct intel_pipe_crc *pipe_crc = &dev_priv->pipe_crc[info->pipe];
 
+	if (info->pipe >= INTEL_INFO(info->dev)->num_pipes)
+		return -ENODEV;
+
 	spin_lock_irq(&pipe_crc->lock);
 
 	if (pipe_crc->opened) {

