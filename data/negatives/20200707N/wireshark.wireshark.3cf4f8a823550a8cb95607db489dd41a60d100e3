commit 3cf4f8a823550a8cb95607db489dd41a60d100e3
Author: Dario Lombardo <lomato@gmail.com>
Date:   Fri Jan 20 17:08:57 2017 +0100

    corosync-totemnet: add shutdown routine.
    
    Change-Id: Ib2e93c012ec0547d4eb5968d1bf47b0e1489f3df
    Reviewed-on: https://code.wireshark.org/review/19649
    Reviewed-by: Michael Mann <mmann78@netscape.net>

diff --git a/epan/dissectors/packet-corosync-totemnet.c b/epan/dissectors/packet-corosync-totemnet.c
index 01c1e274af..9932df087f 100644
--- a/epan/dissectors/packet-corosync-totemnet.c
+++ b/epan/dissectors/packet-corosync-totemnet.c
@@ -418,6 +418,11 @@ dissect_corosynec_totemnet(tvbuff_t *tvb,
   return call_dissector(corosync_totemsrp_handle, tvb, pinfo, parent_tree);
 }
 
+static void
+corosync_totemnet_shutdown(void)
+{
+  g_strfreev(corosync_totemnet_private_keys_list);
+}
 
 void
 proto_register_corosync_totemnet(void)
@@ -457,6 +462,8 @@ proto_register_corosync_totemnet(void)
   prefs_register_string_preference(corosync_totemnet_module, "private_keys", "Private keys",
                                    "Semicolon-separated  list of keys for decryption(e.g. key1;key2;..." ,
                                    (const gchar **)&corosync_totemnet_private_keys);
+
+  register_shutdown_routine(corosync_totemnet_shutdown);
 }
 
 void

