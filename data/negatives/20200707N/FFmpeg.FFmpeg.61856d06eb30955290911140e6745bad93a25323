commit 61856d06eb30955290911140e6745bad93a25323
Author: Alex Converse <alex.converse@gmail.com>
Date:   Tue Oct 25 18:37:24 2011 -0700

    probe: Restore identification of files with very large id3 tags and no extension.
    
    Restore behavior of identifying files with huge id3 tags as
    mp3 at AVPROBE_SCORE_MAX/4. This was broken in r25378 and subsequently
    removed in r25929.

diff --git a/libavformat/utils.c b/libavformat/utils.c
index 20be871669..81eee97a84 100644
--- a/libavformat/utils.c
+++ b/libavformat/utils.c
@@ -347,6 +347,14 @@ AVInputFormat *av_probe_input_format2(AVProbeData *pd, int is_opened, int *score
             }
     }
 
+    if (!fmt && id3 && *score_max < AVPROBE_SCORE_MAX/4-1) {
+        while ((fmt = av_iformat_next(fmt)))
+            if (fmt->extensions && av_match_ext("mp3", fmt->extensions)) {
+                *score_max = AVPROBE_SCORE_MAX/4-1;
+                break;
+            }
+    }
+
     return fmt;
 }
 

