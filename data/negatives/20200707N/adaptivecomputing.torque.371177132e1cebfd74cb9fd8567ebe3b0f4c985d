commit 371177132e1cebfd74cb9fd8567ebe3b0f4c985d
Author: B Daw <bdaw@adaptivecomputing.com>
Date:   Wed Oct 22 10:23:16 2014 -0600

    TRQ-2924: Core dump fix

diff --git a/src/resmom/mom_comm.c b/src/resmom/mom_comm.c
index 60845aa11..f30a641de 100644
--- a/src/resmom/mom_comm.c
+++ b/src/resmom/mom_comm.c
@@ -5423,7 +5423,7 @@ int handle_im_kill_job_radix_response(
   else 
     np = &pjob->ji_sisters[nodeid+1]; /* yes this is klugey but the sisters are off by one on the index */
     
-  if (pjob->ji_resources != NULL)
+  if ((pjob->ji_resources != NULL)&&(nodeid > 0))
     {
     pjob->ji_resources[nodeid - 1].nr_cput = cput;
     pjob->ji_resources[nodeid - 1].nr_mem = mem;
diff --git a/src/resmom/start_exec.c b/src/resmom/start_exec.c
index fa9347049..379fe385a 100644
--- a/src/resmom/start_exec.c
+++ b/src/resmom/start_exec.c
@@ -6400,14 +6400,16 @@ int start_exec(
       ((mom_radix + 1) <= nodenum) &&
       (is_login_node == FALSE))
     {
-    pjob->ji_resources = (noderes *)calloc(nodenum, sizeof(noderes));
+    noderes *pNodeRes = (noderes *)calloc(nodenum, sizeof(noderes));
     
-    assert(pjob->ji_resources != NULL);
+    assert(pNodeRes);
     
-    pjob->ji_resources[0].nr_cput = 0;
-    pjob->ji_resources[0].nr_mem = 0;
-    pjob->ji_resources[0].nr_vmem = 0;
+    pNodeRes[0].nr_cput = 0;
+    pNodeRes[0].nr_mem = 0;
+    pNodeRes[0].nr_vmem = 0;
     
+    pjob->ji_resources = pNodeRes;
+
     pjob->ji_joins_sent = time(NULL);
     
     if ((ret = allocate_demux_sockets(pjob, MOTHER_SUPERIOR)) != PBSE_NONE)

