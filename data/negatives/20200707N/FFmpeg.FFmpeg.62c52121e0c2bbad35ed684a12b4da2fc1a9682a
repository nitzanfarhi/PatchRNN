commit 62c52121e0c2bbad35ed684a12b4da2fc1a9682a
Author: Måns Rullgård <mans@mansr.com>
Date:   Thu Jun 29 19:42:34 2006 +0000

    extradata may be used as bitstream reader input so allocate with padding
    
    Originally committed as revision 5547 to svn://svn.ffmpeg.org/ffmpeg/trunk

diff --git a/libavformat/utils.c b/libavformat/utils.c
index 74ec667d91..3826df3f0a 100644
--- a/libavformat/utils.c
+++ b/libavformat/utils.c
@@ -1995,8 +1995,9 @@ int av_find_stream_info(AVFormatContext *ic)
             int i= st->parser->parser->split(st->codec, pkt->data, pkt->size);
             if(i){
                 st->codec->extradata_size= i;
-                st->codec->extradata= av_malloc(st->codec->extradata_size);
+                st->codec->extradata= av_malloc(st->codec->extradata_size + FF_INPUT_BUFFER_PADDING_SIZE);
                 memcpy(st->codec->extradata, pkt->data, st->codec->extradata_size);
+                memset(st->codec->extradata + i, 0, FF_INPUT_BUFFER_PADDING_SIZE);
             }
         }
 

