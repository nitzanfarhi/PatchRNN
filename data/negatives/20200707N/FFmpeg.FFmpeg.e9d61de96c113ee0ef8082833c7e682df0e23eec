commit e9d61de96c113ee0ef8082833c7e682df0e23eec
Author: Martin Storsjö <martin@martin.st>
Date:   Thu Sep 19 15:32:02 2013 +0300

    mpegaudiodec: Validate that the number of channels fits at the given offset
    
    This is similar to the fix in 35cbc98b.
    
    Reported-by: Mateusz "j00ru" Jurczyk and Gynvael Coldwind
    CC: libav-stable@libav.org
    Signed-off-by: Martin Storsjö <martin@martin.st>

diff --git a/libavcodec/mpegaudiodec.c b/libavcodec/mpegaudiodec.c
index c18f433b4b..423b4b06a1 100644
--- a/libavcodec/mpegaudiodec.c
+++ b/libavcodec/mpegaudiodec.c
@@ -1939,7 +1939,8 @@ static int decode_frame_mp3on4(AVCodecContext *avctx, void *data,
 
         avpriv_mpegaudio_decode_header((MPADecodeHeader *)m, header);
 
-        if (ch + m->nb_channels > avctx->channels) {
+        if (ch + m->nb_channels > avctx->channels ||
+            s->coff[fr] + m->nb_channels > avctx->channels) {
             av_log(avctx, AV_LOG_ERROR, "frame channel count exceeds codec "
                                         "channel count\n");
             return AVERROR_INVALIDDATA;

