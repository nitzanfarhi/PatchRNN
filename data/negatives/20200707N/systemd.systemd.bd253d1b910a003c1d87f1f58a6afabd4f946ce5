commit bd253d1b910a003c1d87f1f58a6afabd4f946ce5
Author: Lennart Poettering <lennart@poettering.net>
Date:   Thu May 26 02:16:49 2011 +0200

    dbus: add api for append gid/uid properties

diff --git a/src/dbus-common.c b/src/dbus-common.c
index c2650fdf3..cb43bbdd4 100644
--- a/src/dbus-common.c
+++ b/src/dbus-common.c
@@ -503,7 +503,7 @@ int bus_property_append_uint64(DBusMessageIter *i, const char *property, void *d
         assert(property);
         assert(data);
 
-        /* Let's ensure that pid_t is actually 64bit, and hence this
+        /* Let's ensure that usec_t is actually 64bit, and hence this
          * function can be used for usec_t */
         assert_cc(sizeof(uint64_t) == sizeof(usec_t));
 
@@ -518,11 +518,14 @@ int bus_property_append_uint32(DBusMessageIter *i, const char *property, void *d
         assert(property);
         assert(data);
 
-        /* Let's ensure that pid_t and mode_t is actually 32bit, and
-         * hence this function can be used for pid_t/mode_t */
+        /* Let's ensure that pid_t, mode_t, uid_t, gid_t are actually
+         * 32bit, and hence this function can be used for
+         * pid_t/mode_t/uid_t/gid_t */
         assert_cc(sizeof(uint32_t) == sizeof(pid_t));
         assert_cc(sizeof(uint32_t) == sizeof(mode_t));
         assert_cc(sizeof(uint32_t) == sizeof(unsigned));
+        assert_cc(sizeof(uint32_t) == sizeof(uid_t));
+        assert_cc(sizeof(uint32_t) == sizeof(gid_t));
 
         if (!dbus_message_iter_append_basic(i, DBUS_TYPE_UINT32, data))
                 return -ENOMEM;
diff --git a/src/dbus-common.h b/src/dbus-common.h
index 1e5545f38..e321a2c82 100644
--- a/src/dbus-common.h
+++ b/src/dbus-common.h
@@ -129,6 +129,8 @@ int bus_property_append_long(DBusMessageIter *i, const char *property, void *dat
 
 #define bus_property_append_int bus_property_append_int32
 #define bus_property_append_pid bus_property_append_uint32
+#define bus_property_append_uid bus_property_append_uint32
+#define bus_property_append_gid bus_property_append_uint32
 #define bus_property_append_mode bus_property_append_uint32
 #define bus_property_append_unsigned bus_property_append_uint32
 #define bus_property_append_usec bus_property_append_uint64

