commit 9769ad6753eebab3fa0644d8b185e25446ce755d
Author: Dave White <davewx7@gmail.com>
Date:   Wed May 26 19:19:21 2004 +0000

    fixed bug where entering a chat message while the message is selected...
    
    ...would keep the area selected, and cause a crash upon next keypress
    (bug #9114)

diff --git a/src/widgets/textbox.cpp b/src/widgets/textbox.cpp
index e55df5f1cb..ff75bba761 100644
--- a/src/widgets/textbox.cpp
+++ b/src/widgets/textbox.cpp
@@ -51,6 +51,8 @@ void textbox::set_text(std::string text)
 {
 	text_ = string_to_wstring(text);
 	cursor_ = text_.size();
+	selstart_ = -1;
+	selend_ = -1;
 	set_dirty(true);
 	update_text_cache(true);
 }
@@ -61,6 +63,8 @@ void textbox::clear()
 	cursor_ = 0;
 	cursor_pos_ = 0;
 	text_pos_ = 0;
+	selstart_ = -1;
+	selend_ = -1;
 	set_dirty(true);
 	update_text_cache(true);
 }

