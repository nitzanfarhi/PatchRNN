commit cf5f439b48f82c230dcd81d0061e00664cbb6d39
Author: Richard Röjfors <richard.rojfors.ext@mocean-labs.com>
Date:   Tue Aug 4 22:34:10 2009 -0700

    Input: tsc2007 - check if I2C communication works during probe
    
    Check the result when sending the power down command to the controller.
    
    Signed-off-by: Richard Röjfors <richard.rojfors.ext@mocean-labs.com>
    Signed-off-by: Dmitry Torokhov <dtor@mail.ru>

diff --git a/drivers/input/touchscreen/tsc2007.c b/drivers/input/touchscreen/tsc2007.c
index 3714d19f1027..7ef0d1420d3c 100644
--- a/drivers/input/touchscreen/tsc2007.c
+++ b/drivers/input/touchscreen/tsc2007.c
@@ -319,15 +319,17 @@ static int __devinit tsc2007_probe(struct i2c_client *client,
 		goto err_free_mem;
 	}
 
+	/* Prepare for touch readings - power down ADC and enable PENIRQ */
+	err = tsc2007_xfer(ts, PWRDOWN);
+	if (err < 0)
+		goto err_free_irq;
+
 	err = input_register_device(input_dev);
 	if (err)
 		goto err_free_irq;
 
 	i2c_set_clientdata(client, ts);
 
-	/* Prepare for touch readings - power down ADC and enable PENIRQ */
-	tsc2007_xfer(ts, PWRDOWN);
-
 	return 0;
 
  err_free_irq:

