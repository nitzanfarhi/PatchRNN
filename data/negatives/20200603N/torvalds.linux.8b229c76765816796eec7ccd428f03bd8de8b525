commit 8b229c76765816796eec7ccd428f03bd8de8b525
Author: Artem Bityutskiy <Artem.Bityutskiy@nokia.com>
Date:   Fri Mar 25 18:33:57 2011 +0200

    UBIFS: do not read flash unnecessarily
    
    This fix makes the 'dbg_check_old_index()' function return
    immediately if debugging is disabled, instead of executing
    incorrect 'goto out' which causes UBIFS to:
    
    1. Allocate memory
    2. Read the flash
    
    On every commit. OK, we do not commit that often, but it is
    still silly to do unneeded I/O anyway.
    
    Credits to coverity for spotting this silly issue.
    
    Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com>
    Cc: stable@kernel.org

diff --git a/fs/ubifs/commit.c b/fs/ubifs/commit.c
index b148fbc80f8d..1bd01ded7123 100644
--- a/fs/ubifs/commit.c
+++ b/fs/ubifs/commit.c
@@ -577,7 +577,7 @@ int dbg_check_old_index(struct ubifs_info *c, struct ubifs_zbranch *zroot)
 	size_t sz;
 
 	if (!(ubifs_chk_flags & UBIFS_CHK_OLD_IDX))
-		goto out;
+		return 0;
 
 	INIT_LIST_HEAD(&list);
 

