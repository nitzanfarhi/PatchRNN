commit 598116944026e5237b12a15697a3caf4aa47b515
Author: Roger Dingledine <arma@torproject.org>
Date:   Sun Dec 11 11:55:41 2005 +0000

    mark the helper node as down if we time-out on the circuit handshake
    with him.
    
    
    svn:r5567

diff --git a/src/or/circuituse.c b/src/or/circuituse.c
index 02fa55d72..44d4559c9 100644
--- a/src/or/circuituse.c
+++ b/src/or/circuituse.c
@@ -665,6 +665,7 @@ circuit_build_failed(circuit_t *circ)
       info(LD_OR, "Our circuit failed to get a response from the first hop (%s:%d). I'm going to try to rotate to a better connection.",
            circ->n_conn->address, circ->n_conn->port);
       circ->n_conn->is_obsolete = 1;
+      helper_node_set_status(circ->n_conn->identity_digest, 0);
     }
   }
 

