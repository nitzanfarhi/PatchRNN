commit 54f8d95f72eabbfbc2dee9c325a9abac10ab1efa
Author: Love Hörnquist Åstrand <lha@kth.se>
Date:   Tue Jun 14 00:14:43 2005 +0000

    (main): catch KRB5_CONFIG_BADFORMAT from krb5_init_context
    
    
    git-svn-id: svn://svn.h5l.se/heimdal/trunk/heimdal@15369 ec53bebd-3082-4978-b11e-865c3cabbd6b

diff --git a/kdc/main.c b/kdc/main.c
index ccc6eeab5..68b28f60a 100644
--- a/kdc/main.c
+++ b/kdc/main.c
@@ -56,7 +56,9 @@ main(int argc, char **argv)
     setprogname(argv[0]);
     
     ret = krb5_init_context(&context);
-    if (ret)
+    if (ret == KRB5_CONFIG_BADFORMAT)
+	errx (1, "krb5_init_context failed to parse configuration file");
+    else if (ret)
 	errx (1, "krb5_init_context failed: %d", ret);
 
     configure(argc, argv);
diff --git a/kuser/kinit.c b/kuser/kinit.c
index 6cb1175db..2de03ee22 100644
--- a/kuser/kinit.c
+++ b/kuser/kinit.c
@@ -718,7 +718,9 @@ main (int argc, char **argv)
     setprogname (argv[0]);
     
     ret = krb5_init_context (&context);
-    if (ret)
+    if (ret == KRB5_CONFIG_BADFORMAT)
+	errx (1, "krb5_init_context failed to parse configuration file");
+    else if (ret)
 	errx(1, "krb5_init_context failed: %d", ret);
   
     if(getarg(args, sizeof(args) / sizeof(args[0]), argc, argv, &optind))

