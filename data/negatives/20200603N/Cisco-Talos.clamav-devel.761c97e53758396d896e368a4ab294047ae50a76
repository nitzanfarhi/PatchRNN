commit 761c97e53758396d896e368a4ab294047ae50a76
Author: Török Edvin <edwin@clamav.net>
Date:   Mon Jan 4 17:17:22 2010 +0200

    The hashset's bitmap needs only capacity/32 memory, not capacity/8.

diff --git a/libclamav/hashtab.c b/libclamav/hashtab.c
index e4c629e24..62861fb6c 100644
--- a/libclamav/hashtab.c
+++ b/libclamav/hashtab.c
@@ -434,7 +434,7 @@ int cli_hashset_init(struct cli_hashset* hs, size_t initial_capacity, uint8_t lo
 	if(!hs->keys) {
 		return CL_EMEM;
 	}
-	hs->bitmap = cli_calloc(initial_capacity / 8, sizeof(*hs->bitmap));
+	hs->bitmap = cli_calloc(initial_capacity >> 5, sizeof(*hs->bitmap));
 	if(!hs->bitmap) {
 		free(hs->keys);
 		return CL_EMEM;

