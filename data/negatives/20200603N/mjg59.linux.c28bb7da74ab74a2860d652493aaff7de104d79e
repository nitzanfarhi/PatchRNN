commit c28bb7da74ab74a2860d652493aaff7de104d79e
Author: Zhenwen Xu <helight.xu@gmail.com>
Date:   Thu Mar 12 22:16:12 2009 +0800

    make the e->rule.xxx shorter in kernel auditfilter.c
    
    make the e->rule.xxx shorter in kernel/auditfilter.c
    --
    ---------------------------------
    Zhenwen Xu - Open and Free
    Home Page:      http://zhwen.org
    My Studio:      http://dim4.cn
    
    >From 99692dc640b278f1cb1a15646ce42f22e89c0f77 Mon Sep 17 00:00:00 2001
    From: Zhenwen Xu <Helight.Xu@gmail.com>
    Date: Thu, 12 Mar 2009 22:04:59 +0800
    Subject: [PATCH] make the e->rule.xxx shorter in kernel/auditfilter.c
    
    Signed-off-by: Zhenwen Xu <Helight.Xu@gmail.com>
    Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>

diff --git a/kernel/auditfilter.c b/kernel/auditfilter.c
index fbf24d121d97..a6fe71fd5d1b 100644
--- a/kernel/auditfilter.c
+++ b/kernel/auditfilter.c
@@ -135,18 +135,18 @@ static void audit_remove_watch(struct audit_watch *watch)
 static inline void audit_free_rule(struct audit_entry *e)
 {
 	int i;
-
+	struct audit_krule *erule = &e->rule;
 	/* some rules don't have associated watches */
-	if (e->rule.watch)
-		audit_put_watch(e->rule.watch);
-	if (e->rule.fields)
-		for (i = 0; i < e->rule.field_count; i++) {
-			struct audit_field *f = &e->rule.fields[i];
+	if (erule->watch)
+		audit_put_watch(erule->watch);
+	if (erule->fields)
+		for (i = 0; i < erule->field_count; i++) {
+			struct audit_field *f = &erule->fields[i];
 			kfree(f->lsm_str);
 			security_audit_rule_free(f->lsm_rule);
 		}
-	kfree(e->rule.fields);
-	kfree(e->rule.filterkey);
+	kfree(erule->fields);
+	kfree(erule->filterkey);
 	kfree(e);
 }
 

