commit 70a06fc1a8b098e9934f837896159bfc6caf0228
Author: Rob Percival <robpercival@google.com>
Date:   Wed Oct 19 15:11:04 2016 +0100

    Subtract padding from outlen in ct_base64_decode
    
    Reviewed-by: Tim Hudson <tjh@openssl.org>
    Reviewed-by: Rich Salz <rsalz@openssl.org>
    (Merged from https://github.com/openssl/openssl/pull/1548)

diff --git a/crypto/ct/ct_b64.c b/crypto/ct/ct_b64.c
index d13d8f2af2..636ac4f5d2 100644
--- a/crypto/ct/ct_b64.c
+++ b/crypto/ct/ct_b64.c
@@ -45,6 +45,11 @@ static int ct_base64_decode(const char *in, unsigned char **out)
         goto err;
     }
 
+    /* Subtract padding bytes from |outlen| */
+    while (in[--inlen] == '=') {
+        --outlen;
+    }
+
     *out = outbuf;
     return outlen;
 err:

