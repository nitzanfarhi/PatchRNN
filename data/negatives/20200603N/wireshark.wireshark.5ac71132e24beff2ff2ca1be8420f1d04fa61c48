commit 5ac71132e24beff2ff2ca1be8420f1d04fa61c48
Author: sswsdev <sswsdev@gmail.com>
Date:   Sun Apr 23 19:20:26 2017 +0300

    UMTS FP: Fix bug in heuristic dissectors
    
    The code was not allowing UDP port types, should ONLY allowed UDP ports.
    
    Change-Id: Ida5467313cbc24fcbac7cd432fb4a018cc00bdef
    Reviewed-on: https://code.wireshark.org/review/21301
    Reviewed-by: Pascal Quantin <pascal.quantin@gmail.com>

diff --git a/epan/dissectors/packet-umts_fp.c b/epan/dissectors/packet-umts_fp.c
index bac91ad879..4c1d3d71aa 100644
--- a/epan/dissectors/packet-umts_fp.c
+++ b/epan/dissectors/packet-umts_fp.c
@@ -3899,7 +3899,7 @@ check_payload_crc_for_heur(tvbuff_t *tvb, guint16 header_length)
 static guint32
 generate_ue_id_for_heur(packet_info *pinfo)
 {
-    if (pinfo->ptype != PT_UDP &&  pinfo->src.type == AT_IPv4 &&  pinfo->dst.type == AT_IPv4) {
+    if (pinfo->ptype == PT_UDP &&  pinfo->src.type == AT_IPv4 &&  pinfo->dst.type == AT_IPv4) {
         /* This logic assumes FP is delivered over IP/UDP*/
         /* Will return the same ID even if the address and ports are reversed */
 

