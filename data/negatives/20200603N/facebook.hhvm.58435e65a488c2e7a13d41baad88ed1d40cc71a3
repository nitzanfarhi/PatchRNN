commit 58435e65a488c2e7a13d41baad88ed1d40cc71a3
Author: Jordan DeLong <jdelong@fb.com>
Date:   Wed Jun 3 12:43:24 2015 -0700

    Fix bug when we run check type hoisting
    
    Summary: Check type hoisting can create unreachable blocks, which means it must
    run minimal DCE to restore IR invariants.
    
    Reviewed By: @swtaarrs
    
    Differential Revision: D2123944

diff --git a/hphp/runtime/vm/jit/opt.cpp b/hphp/runtime/vm/jit/opt.cpp
index 1fc9e57f92..df002579ac 100644
--- a/hphp/runtime/vm/jit/opt.cpp
+++ b/hphp/runtime/vm/jit/opt.cpp
@@ -97,7 +97,7 @@ void optimize(IRUnit& unit, IRBuilder& irBuilder, TransKind kind) {
   assertx(checkEverything(unit));
 
   if (RuntimeOption::EvalHHIRTypeCheckHoisting) {
-    doPass(unit, hoistTypeChecks, DCE::None);
+    doPass(unit, hoistTypeChecks, DCE::Minimal);
   }
   doPass(unit, removeExitPlaceholders, DCE::Minimal);
 

