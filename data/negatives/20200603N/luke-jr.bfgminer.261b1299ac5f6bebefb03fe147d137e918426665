commit 261b1299ac5f6bebefb03fe147d137e918426665
Author: Con Kolivas <kernel@kolivas.org>
Date:   Thu Jun 13 13:01:27 2013 +1000

    Add the cgpu_info structure before avalon reset.

diff --git a/driver-avalon.c b/driver-avalon.c
index df17d00b..9deb1901 100644
--- a/driver-avalon.c
+++ b/driver-avalon.c
@@ -622,11 +622,11 @@ static bool avalon_detect_one(libusb_device *dev, struct usb_find_devices *found
 	info->temp_sum = 0;
 	info->temp_old = 0;
 
-	ret = avalon_reset(avalon, true);
-	if (ret && !configured)
+	if (!add_cgpu(avalon))
 		goto unshin;
 
-	if (!add_cgpu(avalon))
+	ret = avalon_reset(avalon, true);
+	if (ret && !configured)
 		goto unshin;
 
 	update_usb_stats(avalon);

