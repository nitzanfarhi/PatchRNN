commit 00d41bb549732d0a66a0fa683264a063705821d9
Author: Jon Siwek <jsiwek@ncsa.illinois.edu>
Date:   Mon Jul 30 11:07:43 2012 -0500

    Add missing breaks to switch cases in ElasticSearch::HTTPReceive().
    
    Observed as reason for segfault in
    testing/btest/scripts/check-test-all-policy.bro unit test when compiled
    with optimizations.

diff --git a/src/logging/writers/ElasticSearch.cc b/src/logging/writers/ElasticSearch.cc
index 7a80866bf..9e5e3fb20 100644
--- a/src/logging/writers/ElasticSearch.cc
+++ b/src/logging/writers/ElasticSearch.cc
@@ -385,12 +385,14 @@ bool ElasticSearch::HTTPSend(CURL *handle)
 			if ( ! failing )
 				Error(Fmt("ElasticSearch server may not be accessible."));
 			}
+			break;
 
 		case CURLE_OPERATION_TIMEDOUT:
 			{
 			if ( ! failing )
 				Warning(Fmt("HTTP operation with elasticsearch server timed out at %" PRIu64 " msecs.", transfer_timeout));
 			}
+			break;
 
 		case CURLE_OK:
 			{
@@ -402,10 +404,12 @@ bool ElasticSearch::HTTPSend(CURL *handle)
 			else if ( ! failing )
 				Error(Fmt("Received a non-successful status code back from ElasticSearch server, check the elasticsearch server log."));
 			}
+			break;
 
 		default:
 			{
 			}
+			break;
 		}
 		// The "successful" return happens above
 		return false;

