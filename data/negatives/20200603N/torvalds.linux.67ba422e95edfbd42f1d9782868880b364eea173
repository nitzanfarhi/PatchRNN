commit 67ba422e95edfbd42f1d9782868880b364eea173
Author: Amir Vadai <amir@vadai.me>
Date:   Tue Mar 8 12:42:34 2016 +0200

    net/mlx5e: Relax ndo_setup_tc handle restriction
    
    Restricting handle to TC_H_ROOT breaks the old instantiation of mqprio
    to setup a hardware qdisc. This patch relaxes the test, to only check the
    type.
    
    Fixes: 08fb1da ("net/mlx5e: Support DCBNL IEEE ETS")
    Signed-off-by: Amir Vadai <amir@vadai.me>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/drivers/net/ethernet/mellanox/mlx5/core/en_main.c b/drivers/net/ethernet/mellanox/mlx5/core/en_main.c
index 19e5daeaa61d..f1ebe065de0d 100644
--- a/drivers/net/ethernet/mellanox/mlx5/core/en_main.c
+++ b/drivers/net/ethernet/mellanox/mlx5/core/en_main.c
@@ -1883,7 +1883,7 @@ static int mlx5e_setup_tc(struct net_device *netdev, u8 tc)
 static int mlx5e_ndo_setup_tc(struct net_device *dev, u32 handle,
 			      __be16 proto, struct tc_to_netdev *tc)
 {
-	if (handle != TC_H_ROOT || tc->type != TC_SETUP_MQPRIO)
+	if (tc->type != TC_SETUP_MQPRIO)
 		return -EINVAL;
 
 	return mlx5e_setup_tc(dev, tc->tc);

