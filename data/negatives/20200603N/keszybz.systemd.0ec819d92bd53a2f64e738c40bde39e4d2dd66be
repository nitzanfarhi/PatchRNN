commit 0ec819d92bd53a2f64e738c40bde39e4d2dd66be
Author: Kay Sievers <kay.sievers@suse.de>
Date:   Fri Jan 20 02:54:31 2006 +0100

    ignore all messages with missing devpath or action
    
    Signed-off-by: Kay Sievers <kay.sievers@suse.de>

diff --git a/udevd.c b/udevd.c
index f64a4252b..c45d3a4cd 100644
--- a/udevd.c
+++ b/udevd.c
@@ -516,8 +516,8 @@ static struct uevent_msg *get_msg_from_envbuf(const char *buf, int buf_size)
 	msg->envp[i++] = "UDEVD_EVENT=1";
 	msg->envp[i] = NULL;
 
-	if (!msg->devpath) {
-		info("DEVPATH missing, ignore message");
+	if (msg->devpath == NULL || msg->action == NULL) {
+		info("DEVPATH or ACTION missing, ignore message");
 		free(msg);
 		return NULL;
 	}

