commit 819d9153d4c87329910a4cb01198610cd24ec62d
Author: Jaegeuk Kim <jaegeuk@kernel.org>
Date:   Mon Dec 28 13:48:11 2015 -0800

    f2fs: use i_size_read to get i_size
    
    We need to use i_size_read() to get inode->i_size.
    
    Signed-off-by: Jaegeuk Kim <jaegeuk@kernel.org>

diff --git a/fs/f2fs/data.c b/fs/f2fs/data.c
index 6fbfc70ac8a0..14b40a9db5b3 100644
--- a/fs/f2fs/data.c
+++ b/fs/f2fs/data.c
@@ -1386,10 +1386,11 @@ static int f2fs_write_data_pages(struct address_space *mapping,
 static void f2fs_write_failed(struct address_space *mapping, loff_t to)
 {
 	struct inode *inode = mapping->host;
+	loff_t i_size = i_size_read(inode);
 
-	if (to > inode->i_size) {
-		truncate_pagecache(inode, inode->i_size);
-		truncate_blocks(inode, inode->i_size, true);
+	if (to > i_size) {
+		truncate_pagecache(inode, i_size);
+		truncate_blocks(inode, i_size, true);
 	}
 }
 

