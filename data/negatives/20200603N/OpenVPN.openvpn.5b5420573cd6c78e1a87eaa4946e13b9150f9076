commit 5b5420573cd6c78e1a87eaa4946e13b9150f9076
Author: Adriaan de Jong <dejong@fox-it.com>
Date:   Sat Feb 4 14:16:13 2012 +0100

    Minor code cleanup: cleaned up error handling in verify_cert.
    
    Removed done label and cleaned up return values.
    
    Signed-off-by: Adriaan de Jong <dejong@fox-it.com>
    Acked-by: David Sommerseth <davids@redhat.com>
    Signed-off-by: David Sommerseth <davids@redhat.com>

diff --git a/ssl_verify.c b/ssl_verify.c
index 0b2a1fb9..e45f149c 100644
--- a/ssl_verify.c
+++ b/ssl_verify.c
@@ -669,14 +669,14 @@ verify_cert(struct tls_session *session, x509_cert_t *cert, int cert_depth)
   msg (D_HANDSHAKE, "VERIFY OK: depth=%d, %s", cert_depth, subject);
   session->verified = true;
 
- done:
   x509_free_subject (subject);
-  return (session->verified == true) ? SUCCESS : FAILURE;
+  return SUCCESS;
 
  err:
   tls_clear_error();
   session->verified = false;
-  goto done;
+  x509_free_subject (subject);
+  return FAILURE;
 }
 
 /* ***************************************************************************

