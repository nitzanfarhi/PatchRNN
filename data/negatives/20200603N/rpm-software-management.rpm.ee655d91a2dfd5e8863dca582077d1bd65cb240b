commit ee655d91a2dfd5e8863dca582077d1bd65cb240b
Author: Panu Matilainen <pmatilai@redhat.com>
Date:   Fri Jan 25 12:01:16 2008 +0200

    Permit conflicting ghost files
    Patch from Pascal Rigaux

diff --git a/lib/rpmfi.c b/lib/rpmfi.c
index bb0ccbf08..657d334ba 100644
--- a/lib/rpmfi.c
+++ b/lib/rpmfi.c
@@ -449,6 +449,9 @@ int rpmfiCompare(const rpmfi afi, const rpmfi bfi)
     rpmFileTypes awhat = rpmfiWhatis(rpmfiFMode(afi));
     rpmFileTypes bwhat = rpmfiWhatis(rpmfiFMode(bfi));
 
+    if ((rpmfiFFlags(afi) & RPMFILE_GHOST) ||
+	(rpmfiFFlags(bfi) & RPMFILE_GHOST)) return 0;
+
     if (awhat != bwhat) return 1;
 
     if (awhat == LINK) {

