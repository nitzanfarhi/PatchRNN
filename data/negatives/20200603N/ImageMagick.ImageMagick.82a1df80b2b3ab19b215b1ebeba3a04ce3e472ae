commit 82a1df80b2b3ab19b215b1ebeba3a04ce3e472ae
Author: Cristy <urban-warrior@imagemagick.org>
Date:   Sat Jul 9 09:54:12 2016 -0400

    https://www.imagemagick.org/discourse-server/viewtopic.php?f=2&t=30043

diff --git a/MagickCore/constitute.c b/MagickCore/constitute.c
index e9b45c6d1..79a5a8030 100644
--- a/MagickCore/constitute.c
+++ b/MagickCore/constitute.c
@@ -227,7 +227,6 @@ MagickExport Image *PingImage(const ImageInfo *image_info,
   if (image != (Image *) NULL)
     {
       ResetTimer(&image->timer);
-      InitializePixelChannelMap(image);
       if (ping_info->verbose != MagickFalse)
         (void) IdentifyImage(image,stdout,MagickFalse,exception);
     }
diff --git a/MagickCore/stream.c b/MagickCore/stream.c
index a0e1d5d8e..88d439cd6 100644
--- a/MagickCore/stream.c
+++ b/MagickCore/stream.c
@@ -1010,6 +1010,8 @@ MagickExport Image *ReadStream(const ImageInfo *image_info,StreamHandler stream,
   SetPixelCacheMethods(read_info->cache,&cache_methods);
   read_info->stream=stream;
   image=ReadImage(read_info,exception);
+  if (image != (Image *) NULL)
+    InitializePixelChannelMap(image);
   read_info=DestroyImageInfo(read_info);
   return(image);
 }

