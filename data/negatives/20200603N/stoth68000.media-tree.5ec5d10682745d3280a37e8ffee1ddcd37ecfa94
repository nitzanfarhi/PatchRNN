commit 5ec5d10682745d3280a37e8ffee1ddcd37ecfa94
Author: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
Date:   Wed Feb 24 13:53:46 2016 +0100

    Revert "ACPI / PCI: Simplify acpi_penalize_isa_irq()"
    
    Revert commit 0971686954f9 "ACPI / PCI: Simplify acpi_penalize_isa_irq()"
    that depends on commit b5bd02695471 (ACPI, PCI, irq: remove interrupt
    count restriction) which introduced a regression and needs to be
    reverted for this reason.
    
    Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>

diff --git a/drivers/acpi/pci_link.c b/drivers/acpi/pci_link.c
index fa2863567eed..5114d8007aa0 100644
--- a/drivers/acpi/pci_link.c
+++ b/drivers/acpi/pci_link.c
@@ -877,9 +877,17 @@ static int __init acpi_irq_penalty_update(char *str, int used)
  */
 void acpi_penalize_isa_irq(int irq, int active)
 {
-	if (irq >= 0)
-		acpi_irq_add_penalty(irq, active ?
-			PIRQ_PENALTY_ISA_USED : PIRQ_PENALTY_PCI_USING);
+	int penalty;
+
+	if (irq < 0)
+		return;
+
+	if (active)
+		penalty = PIRQ_PENALTY_ISA_USED;
+	else
+		penalty = PIRQ_PENALTY_PCI_USING;
+
+	acpi_irq_add_penalty(irq, penalty);
 }
 
 bool acpi_isa_irq_available(int irq)

