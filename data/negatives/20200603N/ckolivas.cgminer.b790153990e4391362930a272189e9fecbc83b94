commit b790153990e4391362930a272189e9fecbc83b94
Author: Con Kolivas <kernel@kolivas.org>
Date:   Mon May 27 01:33:54 2013 +1000

    Wait till buffer is cleared after sending idle tasks to avalon before returning from avalon_idle.

diff --git a/driver-avalon.c b/driver-avalon.c
index 0ca3206f..1fd4b5a2 100644
--- a/driver-avalon.c
+++ b/driver-avalon.c
@@ -494,6 +494,7 @@ static void avalon_idle(struct cgpu_info *avalon, struct avalon_info *info,
 				 info->frequency);
 		avalon_send_task(fd, &at, avalon);
 	}
+	wait_avalon_ready(fd);
 }
 
 static bool avalon_detect_one(const char *devpath)

