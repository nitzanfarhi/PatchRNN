commit 5c9f2eddc0d608afb33ad25c3821ab9d1d517532
Author: Cristy <urban-warrior@imagemagick.org>
Date:   Wed May 30 18:08:30 2018 -0400

    ...

diff --git a/coders/png.c b/coders/png.c
index a753a977a..db4cdd704 100644
--- a/coders/png.c
+++ b/coders/png.c
@@ -4251,7 +4251,7 @@ static Image *ReadPNGImage(const ImageInfo *image_info,
   */
   count=ReadBlob(image,8,(unsigned char *) magic_number);
 
-  if (count < 8 || memcmp(magic_number,"\211PNG\r\n\032\n",8) != 0)
+  if ((count < 8) || (memcmp(magic_number,"\211PNG\r\n\032\n",8) != 0))
     ThrowReaderException(CorruptImageError,"ImproperImageHeader");
 
   /*
@@ -5219,7 +5219,7 @@ static Image *ReadJNGImage(const ImageInfo *image_info,
 
   count=(size_t) ReadBlob(image,8,(unsigned char *) magic_number);
 
-  if (count < 8 || memcmp(magic_number,"\213JNG\r\n\032\n",8) != 0)
+  if ((count < 8) || (memcmp(magic_number,"\213JNG\r\n\032\n",8) != 0))
     ThrowReaderException(CorruptImageError,"ImproperImageHeader");
 
   /*
@@ -5378,7 +5378,7 @@ static Image *ReadOneMNGImage(MngInfo* mng_info, const ImageInfo *image_info,
 
       /* Verify MNG signature.  */
       count=(size_t) ReadBlob(image,8,(unsigned char *) magic_number);
-      if (memcmp(magic_number,"\212MNG\r\n\032\n",8) != 0)
+      if ((count < 8) || (memcmp(magic_number,"\212MNG\r\n\032\n",8) != 0))
         ThrowReaderException(CorruptImageError,"ImproperImageHeader");
 
       /* Initialize some nonzero members of the MngInfo structure.  */

