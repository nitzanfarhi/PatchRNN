commit ce2f3c8b0cdbc1a325a484b0bb4fc0af7ec41c18
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Tue Oct 10 23:49:45 2006 +0000

    set duration and timebase (based on a patch by Simon Morlat simon.morlat linphone org)
    
    Originally committed as revision 6634 to svn://svn.ffmpeg.org/ffmpeg/trunk

diff --git a/libavformat/amr.c b/libavformat/amr.c
index 5ccef995b5..efdfb1e36e 100644
--- a/libavformat/amr.c
+++ b/libavformat/amr.c
@@ -124,6 +124,7 @@ static int amr_read_header(AVFormatContext *s,
         st->codec->channels = 1;
         st->codec->sample_rate = 8000;
     }
+    av_set_pts_info(st, 64, 1, st->codec->sample_rate);
 
     return 0;
 }
@@ -169,6 +170,7 @@ static int amr_read_packet(AVFormatContext *s,
     pkt->stream_index = 0;
     pkt->pos= url_ftell(&s->pb);
     pkt->data[0]=toc;
+    pkt->duration= enc->codec_id == CODEC_ID_AMR_NB ? 160 : 320;
     read = get_buffer(&s->pb, pkt->data+1, size-1);
 
     if (read != size-1)

