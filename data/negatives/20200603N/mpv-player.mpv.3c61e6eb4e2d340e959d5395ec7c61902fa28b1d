commit 3c61e6eb4e2d340e959d5395ec7c61902fa28b1d
Author: wm4 <wm4@nowhere>
Date:   Thu Jun 25 20:17:14 2015 +0200

    ao_coreaudio_utils: compare full AudioStreamBasicDescription
    
    Originally, this was written for comparing the sample format only, but
    ca_change_physical_format_sync() actually expects that the full format
    is compared. (For all other uses it doesn't matter.)

diff --git a/audio/out/ao_coreaudio_utils.c b/audio/out/ao_coreaudio_utils.c
index 52b0e32194..aa1c9934d6 100644
--- a/audio/out/ao_coreaudio_utils.c
+++ b/audio/out/ao_coreaudio_utils.c
@@ -222,7 +222,9 @@ bool ca_asbd_equals(const AudioStreamBasicDescription *a,
            a->mBitsPerChannel == b->mBitsPerChannel &&
            ca_normalize_formatid(a->mFormatID) ==
                 ca_normalize_formatid(b->mFormatID) &&
-           a->mBytesPerPacket == b->mBytesPerPacket;
+           a->mBytesPerPacket == b->mBytesPerPacket &&
+           a->mChannelsPerFrame == b->mChannelsPerFrame &&
+           a->mSampleRate == b->mSampleRate;
 }
 
 // Return the AF_FORMAT_* (AF_FORMAT_S16 etc.) corresponding to the asbd.

