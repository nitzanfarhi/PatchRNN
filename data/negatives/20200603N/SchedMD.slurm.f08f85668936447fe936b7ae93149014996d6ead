commit f08f85668936447fe936b7ae93149014996d6ead
Author: Moe Jette <jette1@llnl.gov>
Date:   Thu May 29 17:51:52 2008 +0000

    clear job's reason state from dependency as soon as the dependency
    has been satisfied.

diff --git a/src/slurmctld/job_mgr.c b/src/slurmctld/job_mgr.c
index 6e3b19b11c..2d8905a862 100644
--- a/src/slurmctld/job_mgr.c
+++ b/src/slurmctld/job_mgr.c
@@ -4792,6 +4792,8 @@ extern bool job_independent(struct job_record *job_ptr)
 	rc = test_job_dependency(job_ptr);
 	if (rc == 0) {
 		bool send_acct_rec = false;
+		if (job_ptr->state_reason == WAIT_DEPENDENCY)
+			job_ptr->state_reason = WAIT_NO_REASON;
 		if (detail_ptr && (detail_ptr->begin_time == 0)) {
 			detail_ptr->begin_time = now;
 			send_acct_rec = true;
diff --git a/src/slurmctld/job_scheduler.c b/src/slurmctld/job_scheduler.c
index 0f7d6dc324..9e2f367788 100644
--- a/src/slurmctld/job_scheduler.c
+++ b/src/slurmctld/job_scheduler.c
@@ -285,6 +285,7 @@ extern int schedule(void)
 			continue;
 		if (_failed_partition(job_ptr->part_ptr, failed_parts, 
 				      failed_part_cnt)) {
+			job_ptr->state_reason = WAIT_PRIORITY;
 			continue;
 		}
 
@@ -339,8 +340,7 @@ extern int schedule(void)
 					     &ionodes);
 			if(ionodes) {
 				sprintf(tmp_char,"%s[%s]",
-						job_ptr->nodes,
-						ionodes);
+					job_ptr->nodes, ionodes);
 			} else {
 				sprintf(tmp_char,"%s",job_ptr->nodes);
 			}

