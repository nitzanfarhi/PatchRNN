commit 92ba873f7bcb51ff76b8d27e2d3e4daecc7d0954
Author: Zardosht Kasheff <zardosht@tokutek.com>
Date:   Tue Mar 31 20:29:43 2009 +0000

    closes #1634
    fix ticket
    
    git-svn-id: file:///svn/mysql/tokudb-engine/src@10894 c7de825b-a66e-492c-adef-691d508d4ae1

diff --git a/storage/tokudb/ha_tokudb.cc b/storage/tokudb/ha_tokudb.cc
index 8397023f6dd..b27d805beaa 100644
--- a/storage/tokudb/ha_tokudb.cc
+++ b/storage/tokudb/ha_tokudb.cc
@@ -898,11 +898,12 @@ bool ha_tokudb::has_auto_increment_flag(uint* index) {
     // check to see if we have auto increment field
     //
     bool ai_found = false;
-    uint i = 0;
-    for (Field ** field = table->field; *field; field++,i++) {
-        if ((*field)->flags & AUTO_INCREMENT_FLAG) {
+    uint ai_index = 0;
+    for (uint i = 0; i < table_share->fields; i++, ai_index++) {
+        Field* field = table->field[i];
+        if (field->flags & AUTO_INCREMENT_FLAG) {
             ai_found = true;
-            *index = i;
+            *index = ai_index;
             break;
         }
     }

