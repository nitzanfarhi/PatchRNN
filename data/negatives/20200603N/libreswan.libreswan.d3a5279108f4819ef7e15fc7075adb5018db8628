commit d3a5279108f4819ef7e15fc7075adb5018db8628
Author: Paul Wouters <paul@xelerance.com>
Date:   Mon Nov 22 17:10:03 2010 -0500

    Warn if bytes from cert blob read is not what we expected.

diff --git a/lib/libopenswan/certload.c b/lib/libopenswan/certload.c
index 18e27fd84..8a7fb8bf7 100644
--- a/lib/libopenswan/certload.c
+++ b/lib/libopenswan/certload.c
@@ -269,6 +269,9 @@ load_cert(bool forcedtype, const char *filename,
 	rewind(fd);
 	cert->u.blob.ptr = alloc_bytes(cert->u.blob.len, " cert blob");
 	bytes = fread(cert->u.blob.ptr, 1, cert->u.blob.len, fd);
+	if(bytes != cert->u.blob.len)	{
+		openswan_log("  WARNING: could not fully read certificate-blob filename '%s'\n", filename);
+	}
 	fclose(fd);
     }
     return FALSE;

