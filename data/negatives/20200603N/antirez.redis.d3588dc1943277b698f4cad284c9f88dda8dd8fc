commit d3588dc1943277b698f4cad284c9f88dda8dd8fc
Author: antirez <antirez@gmail.com>
Date:   Thu Nov 7 23:53:18 2013 +0100

    Fix broken rdbWriteRaw() return value check in rdb.c.
    
    Thanks to @PhoneLi for reporting.

diff --git a/src/rdb.c b/src/rdb.c
index d1804d74..f04f6def 100644
--- a/src/rdb.c
+++ b/src/rdb.c
@@ -99,7 +99,7 @@ int rdbSaveLen(rio *rdb, uint32_t len) {
         buf[0] = (REDIS_RDB_32BITLEN<<6);
         if (rdbWriteRaw(rdb,buf,1) == -1) return -1;
         len = htonl(len);
-        if (rdbWriteRaw(rdb,&len,4) == -4) return -1;
+        if (rdbWriteRaw(rdb,&len,4) == -1) return -1;
         nwritten = 1+4;
     }
     return nwritten;

