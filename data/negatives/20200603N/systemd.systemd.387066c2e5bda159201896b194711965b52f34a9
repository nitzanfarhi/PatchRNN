commit 387066c2e5bda159201896b194711965b52f34a9
Author: Michal Sekletar <msekleta@redhat.com>
Date:   Fri May 30 18:20:16 2014 +0200

    localed: consider an unset model as a wildcard

diff --git a/src/locale/localed.c b/src/locale/localed.c
index e3061c8d5..358f6c200 100644
--- a/src/locale/localed.c
+++ b/src/locale/localed.c
@@ -712,15 +712,16 @@ static int find_legacy_keymap(Context *c, char **new_keymap) {
                         }
                 }
 
-                if (matching > 0 &&
-                    streq_ptr(c->x11_model, a[2])) {
-                        matching++;
-
-                        if (streq_ptr(c->x11_variant, a[3])) {
+                if (matching > 0) {
+                        if (isempty(c->x11_model) || streq_ptr(c->x11_model, a[2])) {
                                 matching++;
 
-                                if (streq_ptr(c->x11_options, a[4]))
+                                if (streq_ptr(c->x11_variant, a[3])) {
                                         matching++;
+
+                                        if (streq_ptr(c->x11_options, a[4]))
+                                                matching++;
+                                }
                         }
                 }
 

