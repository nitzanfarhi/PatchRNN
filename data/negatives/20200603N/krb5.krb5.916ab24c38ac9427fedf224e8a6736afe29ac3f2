commit 916ab24c38ac9427fedf224e8a6736afe29ac3f2
Author: Theodore Tso <tytso@mit.edu>
Date:   Fri Feb 26 20:56:22 1993 +0000

    The authdata field of the credential wasn't being copied.  Fixed
    
    git-svn-id: svn://anonsvn.mit.edu/krb5/trunk@2509 dc483132-0cff-0310-8789-dd5450dbe970

diff --git a/src/lib/krb5/krb/copy_creds.c b/src/lib/krb5/krb/copy_creds.c
index 12591cdb6..c109ec9a8 100644
--- a/src/lib/krb5/krb/copy_creds.c
+++ b/src/lib/krb5/krb/copy_creds.c
@@ -76,9 +76,15 @@ krb5_creds **outcred;
     tempcred->second_ticket = *scratch;
     xfree(scratch);
 
+    retval = krb5_copy_authdata(incred->authdata,&tempcred->authdata);
+    if (retval)
+        goto clearticket;
+
     *outcred = tempcred;
     return 0;
 
+ clearticket:    
+    memset(tempcred->ticket.data,0,tempcred->ticket.length);
  cleanticket:
     free(tempcred->ticket.data);
  cleanaddrs:

