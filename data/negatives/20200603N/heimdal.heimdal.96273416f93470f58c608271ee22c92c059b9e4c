commit 96273416f93470f58c608271ee22c92c059b9e4c
Author: Love Hörnquist Åstrand <lha@kth.se>
Date:   Mon Sep 8 15:25:02 2003 +0000

    (krb5_get_init_creds_opt_alloc): add context argument
    
    
    git-svn-id: svn://svn.h5l.se/heimdal/trunk/heimdal@12782 ec53bebd-3082-4978-b11e-865c3cabbd6b

diff --git a/lib/krb5/init_creds.c b/lib/krb5/init_creds.c
index 87cbace25..ff06e19b1 100644
--- a/lib/krb5/init_creds.c
+++ b/lib/krb5/init_creds.c
@@ -44,17 +44,21 @@ krb5_get_init_creds_opt_init(krb5_get_init_creds_opt *opt)
 }
 
 krb5_error_code
-krb5_get_init_creds_opt_alloc(krb5_get_init_creds_opt **opt)
+krb5_get_init_creds_opt_alloc(krb5_context context, 
+			      krb5_get_init_creds_opt **opt)
 {
     krb5_get_init_creds_opt *o;
     
     *opt = NULL;
     o = calloc(1, sizeof(*o));
-    if (o == NULL)
+    if (o == NULL) {
+	krb5_set_error_string(context, "out of memory");
 	return ENOMEM;
+    }
     krb5_get_init_creds_opt_init(o);
     o->private = calloc(1, sizeof(*o->private));
     if (o->private == NULL) {
+	krb5_set_error_string(context, "out of memory");
 	free(o);
 	return ENOMEM;
     }

