commit 61cef23486d84da0b53107d35d641f15265bef3f
Author: Gerald Combs <gerald@wireshark.org>
Date:   Thu May 28 14:10:49 2015 -0700

    Use an "Open" instead of a "Save" dialog for UAT prefs.
    
    When selecting a file for a PT_TXTMOD_FILENAME UAT preference, use
    QFileDialog::getOpenFileName instead of QFileDialog::getSaveFileName.
    This matches current GTK+ behavior and the two preferences that use
    PT_TXTMOD_FILENAME.
    
    Add a comment noting that the PT_TXTMOD_FILENAME is Open-only.
    
    Bug: 11027
    Change-Id: I29eb056422949eda700d448621e508cf094fd7b7
    Reviewed-on: https://code.wireshark.org/review/8678
    Reviewed-by: Gerald Combs <gerald@wireshark.org>

diff --git a/epan/uat.h b/epan/uat.h
index 24ab2ef2a6..14204a5e53 100644
--- a/epan/uat.h
+++ b/epan/uat.h
@@ -402,9 +402,16 @@ static void basename ## _ ## field_name ## _tostr_cb(void* rec, const char** out
  */
 #define UAT_FILENAME_CB_DEF(basename,field_name,rec_t) UAT_CSTRING_CB_DEF(basename,field_name,rec_t)
 
+/* XXX UAT_FLD_FILENAME is currently unused. */
 #define UAT_FLD_FILENAME(basename,field_name,title,desc) \
 	{#field_name, title, PT_TXTMOD_FILENAME,{uat_fld_chk_str,basename ## _ ## field_name ## _set_cb,basename ## _ ## field_name ## _tostr_cb},{0,0,0},0,desc,FLDFILL}
 
+/*
+ * Both the Qt and GTK+ UIs assume that we're opening a preexisting
+ * file. We might want to split the ..._FILENAME defines into
+ * ..._FILE_OPEN and ..._FILE_SAVE if we ever need to specify a
+ * file that we're creating.
+ */
 #define UAT_FLD_FILENAME_OTHER(basename,field_name,title,chk,desc) \
 	{#field_name, title, PT_TXTMOD_FILENAME,{chk,basename ## _ ## field_name ## _set_cb,basename ## _ ## field_name ## _tostr_cb},{0,0,0},0,desc,FLDFILL}
 
diff --git a/ui/qt/uat_dialog.cpp b/ui/qt/uat_dialog.cpp
index a2aa8d481b..29f3dcf8b1 100644
--- a/ui/qt/uat_dialog.cpp
+++ b/ui/qt/uat_dialog.cpp
@@ -277,7 +277,7 @@ void UatDialog::on_uatTreeWidget_itemActivated(QTreeWidgetItem *item, int column
     case PT_TXTMOD_FILENAME:
     {
         QString cur_path = fieldString(row, column);
-        const QByteArray& new_path = QFileDialog::getSaveFileName(this,
+        const QByteArray& new_path = QFileDialog::getOpenFileName(this,
                 field->title, cur_path, QString(), NULL, fd_opt).toUtf8();
         field->cb.set(rec, new_path.constData(), (unsigned) new_path.size(), field->cbdata.set, field->fld_data);
         updateItem(*item);

