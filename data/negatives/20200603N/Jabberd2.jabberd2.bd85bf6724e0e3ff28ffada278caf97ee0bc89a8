commit bd85bf6724e0e3ff28ffada278caf97ee0bc89a8
Author: Tomasz Sterna <tomek@xiaoka.com>
Date:   Tue Feb 24 22:16:21 2009 +0000

    Handle missing authreg configuration correctly

diff --git a/c2s/authreg.c b/c2s/authreg.c
index 3d66179..0b2c669 100644
--- a/c2s/authreg.c
+++ b/c2s/authreg.c
@@ -113,8 +113,10 @@ authreg_t authreg_init(c2s_t c2s, char *name) {
 
 /** shutdown the authreg system */
 void authreg_free(authreg_t ar) {
-    if(ar->free != NULL) (ar->free)(ar);
-    free(ar);
+    if (ar) {
+        if(ar->free != NULL) (ar->free)(ar);
+        free(ar);
+    }
 }
 
 /** auth get handler */

