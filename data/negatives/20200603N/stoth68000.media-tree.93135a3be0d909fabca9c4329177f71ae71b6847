commit 93135a3be0d909fabca9c4329177f71ae71b6847
Author: Mike McCormack <mikem@ring3k.org>
Date:   Thu May 13 06:12:50 2010 +0000

    sky2: Shut off interrupts before NAPI
    
    Interrupts should be masked, then synchronized, and
    finally NAPI should be disabled.
    
    Signed-off-by: Mike McCormack <mikem@ring3k.org>
    Acked-by: Stephen Hemminger <shemminger@vyatta.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/drivers/net/sky2.c b/drivers/net/sky2.c
index efc31e93eb78..f13a45f1db68 100644
--- a/drivers/net/sky2.c
+++ b/drivers/net/sky2.c
@@ -3320,10 +3320,10 @@ static void sky2_restart(struct work_struct *work)
 
 	rtnl_lock();
 
-	napi_disable(&hw->napi);
-	synchronize_irq(hw->pdev->irq);
 	imask = sky2_read32(hw, B0_IMSK);
 	sky2_write32(hw, B0_IMSK, 0);
+	synchronize_irq(hw->pdev->irq);
+	napi_disable(&hw->napi);
 
 	for (i = 0; i < hw->ports; i++) {
 		struct net_device *dev = hw->dev[i];

