commit 4250dfd3f5585262e8ac61c915417585c78a23f9
Author: Peter Wu <peter@lekensteyn.nl>
Date:   Sat Apr 26 00:20:07 2014 +0200

    ssl: return early if no private keys are found
    
    There is no need to check for private keys if there are none. In
    addition, print the number of keys for debugging purposes.
    
    Change-Id: Idc9d650e0bf087c0f647dba4e5bd4920b4f6e228
    Reviewed-on: https://code.wireshark.org/review/1367
    Reviewed-by: Evan Huus <eapache@gmail.com>

diff --git a/epan/dissectors/packet-ssl-utils.c b/epan/dissectors/packet-ssl-utils.c
index 70699fa830..4470964ac9 100644
--- a/epan/dissectors/packet-ssl-utils.c
+++ b/epan/dissectors/packet-ssl-utils.c
@@ -3681,6 +3681,14 @@ ssl_find_private_key(SslDecryptSession *ssl_session, GHashTable *key_hash, GTree
     ssl_debug_printf("ssl_find_private_key server %s:%u\n",
                      ep_address_to_str(&dummy.addr),dummy.port);
 
+    if (g_hash_table_size(key_hash) == 0) {
+        ssl_debug_printf("ssl_find_private_key: no keys found\n");
+        return;
+    } else {
+        ssl_debug_printf("ssl_find_private_key: testing %i keys\n",
+            g_hash_table_size(key_hash));
+    }
+
     /* try to retrieve private key for this service. Do it now 'cause pinfo
      * is not always available
      * Note that with HAVE_LIBGNUTLS undefined private_key is allways 0

