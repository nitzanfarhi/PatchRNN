commit c771968ab6e842ecda4043a6e8d553457543816e
Author: Daniel Stenberg <daniel@haxx.se>
Date:   Tue Aug 7 23:30:05 2012 +0200

    Curl_socket_check: fix timeout return value for select users
    
    This is the same fix applied for the conditional code that uses select()
    that was already done for the poll specific code in commit
    b61e8b81f5038.

diff --git a/lib/select.c b/lib/select.c
index 4196211c0..32b6fa55f 100644
--- a/lib/select.c
+++ b/lib/select.c
@@ -5,7 +5,7 @@
  *                            | (__| |_| |  _ <| |___
  *                             \___|\___/|_| \_\_____|
  *
- * Copyright (C) 1998 - 2011, Daniel Stenberg, <daniel@haxx.se>, et al.
+ * Copyright (C) 1998 - 2012, Daniel Stenberg, <daniel@haxx.se>, et al.
  *
  * This software is licensed as described in the file COPYING, which
  * you should have received as part of this distribution. The terms
@@ -306,8 +306,10 @@ int Curl_socket_check(curl_socket_t readfd0, /* two sockets to read from */
       break;
     if(timeout_ms > 0) {
       pending_ms = timeout_ms - elapsed_ms;
-      if(pending_ms <= 0)
+      if(pending_ms <= 0) {
+        r = 0;  /* Simulate a "call timed out" case */
         break;
+      }
     }
   } while(r == -1);
 

