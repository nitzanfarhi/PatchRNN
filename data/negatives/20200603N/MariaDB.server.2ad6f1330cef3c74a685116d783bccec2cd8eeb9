commit 2ad6f1330cef3c74a685116d783bccec2cd8eeb9
Author: Yoni Fogel <yoni@tokutek.com>
Date:   Tue Apr 16 23:57:45 2013 -0400

    Addresses #1576 Remove 'return a-b' comparison trick from default key compare function
    
    git-svn-id: file:///svn/toku/tokudb@10394 c7de825b-a66e-492c-adef-691d508d4ae1

diff --git a/newbrt/key.c b/newbrt/key.c
index 1374b9fc740..045d179b097 100644
--- a/newbrt/key.c
+++ b/newbrt/key.c
@@ -60,7 +60,9 @@ int toku_keycompare (bytevec key1, ITEMLEN key1len, bytevec key2, ITEMLEN key2le
 	    return (int)*k1-(int)*k2;
 	}
     }
-    return key1len-key2len;
+    if (key1len<key2len) return -1;
+    if (key1len>key2len) return 1;
+    return 0;
 }
 #else
 /* unroll that one four times */
@@ -84,8 +86,9 @@ int toku_keycompare (bytevec key1, ITEMLEN key1len, bytevec key2, ITEMLEN key2le
 	    return (int)*k1-(int)*k2;
 	}
     }
-    //See #1576.  For very large keylengths this is a problem.  Our maximum keysize is << INT_MAX so this is not an issue.
-    return key1len-key2len;
+    if (key1len<key2len) return -1;
+    if (key1len>key2len) return 1;
+    return 0;
 }
 
 #endif

