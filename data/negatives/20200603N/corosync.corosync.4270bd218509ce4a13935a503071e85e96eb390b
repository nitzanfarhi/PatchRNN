commit 4270bd218509ce4a13935a503071e85e96eb390b
Author: Steven Dake <sdake@redhat.com>
Date:   Fri Jul 15 16:57:23 2005 +0000

    defecct 747
    in saCkptSectionIterationInitialize if sectionsChosen invalid,
    return INVALID_PARAM
    
    
    git-svn-id: http://svn.fedorahosted.org/svn/corosync/trunk@765 fd59a12c-fef9-0310-b244-a6a79926bd2f

diff --git a/lib/ckpt.c b/lib/ckpt.c
index cf76040d..8bb02797 100644
--- a/lib/ckpt.c
+++ b/lib/ckpt.c
@@ -1171,6 +1171,15 @@ saCkptSectionIterationInitialize (
 	if (sectionIterationHandle == NULL) {
 		return (SA_AIS_ERR_INVALID_PARAM);
 	}
+
+	if (sectionsChosen != SA_CKPT_SECTIONS_FOREVER &&
+		sectionsChosen != SA_CKPT_SECTIONS_LEQ_EXPIRATION_TIME &&
+		sectionsChosen != SA_CKPT_SECTIONS_GEQ_EXPIRATION_TIME &&
+		sectionsChosen != SA_CKPT_SECTIONS_CORRUPTED &&
+		sectionsChosen != SA_CKPT_SECTIONS_ANY) {
+
+		return (SA_AIS_ERR_INVALID_PARAM);
+	}
 	error = saHandleInstanceGet (&checkpointHandleDatabase, checkpointHandle,
 		(void *)&ckptCheckpointInstance);
 	if (error != SA_AIS_OK) {

