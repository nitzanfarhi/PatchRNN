commit b6896e79a5570016f2f927fa5b8967ebd78cff0c
Author: bcook <bcook>
Date:   Thu Sep 10 07:58:28 2015 +0000

    Fix an incorrect error check in DSA verify.
    
    From Matt Caswell's OpenSSL commit "RT3192: spurious error in DSA verify".
    
    https://github.com/openssl/openssl/commit/eb63bce040d1cc6147d256f516b59552c018e29b

diff --git a/src/crypto/dsa/dsa_ossl.c b/src/crypto/dsa/dsa_ossl.c
index 03124c87..b3eefcc8 100644
--- a/src/crypto/dsa/dsa_ossl.c
+++ b/src/crypto/dsa/dsa_ossl.c
@@ -396,9 +396,7 @@ dsa_do_verify(const unsigned char *dgst, int dgst_len, DSA_SIG *sig, DSA *dsa)
 	ret = BN_ucmp(&u1, sig->r) == 0;
 
 err:
-	/* XXX: surely this is wrong - if ret is 0, it just didn't verify;
-	   there is no error in BN. Test should be ret == -1 (Ben) */
-	if (ret != 1)
+	if (ret < 0)
 		DSAerr(DSA_F_DSA_DO_VERIFY, ERR_R_BN_LIB);
 	BN_CTX_free(ctx);
 	BN_free(&u1);

