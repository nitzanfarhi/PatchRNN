commit 60909641577d39a9bdb4888c44e6b856ea2a927c
Author: Wez Furlong <wez@php.net>
Date:   Tue Mar 15 15:57:49 2005 +0000

    I'm a PECL citizen; even though I am HEAD of pecl/sqlite, don't assume that I
    am being built against HEAD of php-src.

diff --git a/ext/sqlite/sqlite.c b/ext/sqlite/sqlite.c
index ed8b25ac9a..33760b6c76 100644
--- a/ext/sqlite/sqlite.c
+++ b/ext/sqlite/sqlite.c
@@ -44,7 +44,7 @@
 #include "zend_exceptions.h"
 #include "zend_interfaces.h"
 
-#ifdef HAVE_SPL
+#if defined(HAVE_SPL) && ((PHP_MAJOR_VERSION > 5) || (PHP_MAJOR_VERSION == 5 && PHP_MINOR_VERSION >= 1))
 extern PHPAPI zend_class_entry *spl_ce_RuntimeException;
 extern PHPAPI zend_class_entry *spl_ce_Countable;
 #endif
@@ -1008,7 +1008,7 @@ PHP_MINIT_FUNCTION(sqlite)
 	REGISTER_SQLITE_CLASS(Database,   db,        NULL);
 	REGISTER_SQLITE_CLASS(Result,     query,     NULL);
 	REGISTER_SQLITE_CLASS(Unbuffered, ub_query,  NULL);
-#ifdef HAVE_SPL
+#if defined(HAVE_SPL) && ((PHP_MAJOR_VERSION > 5) || (PHP_MAJOR_VERSION == 5 && PHP_MINOR_VERSION >= 1))
 	REGISTER_SQLITE_CLASS(Exception,  exception, spl_ce_RuntimeException);
 #else
 	REGISTER_SQLITE_CLASS(Exception,  exception, zend_exception_get_default());
@@ -1020,7 +1020,7 @@ PHP_MINIT_FUNCTION(sqlite)
 	sqlite_ce_ub_query->get_iterator = sqlite_get_iterator;
 	sqlite_ce_ub_query->iterator_funcs.funcs = &sqlite_ub_query_iterator_funcs;
 
-#ifdef HAVE_SPL
+#if defined(HAVE_SPL) && ((PHP_MAJOR_VERSION > 5) || (PHP_MAJOR_VERSION == 5 && PHP_MINOR_VERSION >= 1))
 	zend_class_implements(sqlite_ce_query TSRMLS_CC, 2, zend_ce_iterator, spl_ce_Countable);
 #else
 	zend_class_implements(sqlite_ce_query TSRMLS_CC, 1, zend_ce_iterator);	

