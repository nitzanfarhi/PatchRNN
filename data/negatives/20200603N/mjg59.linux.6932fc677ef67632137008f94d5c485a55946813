commit 6932fc677ef67632137008f94d5c485a55946813
Author: Hannes Reinecke <hare@suse.de>
Date:   Thu Oct 2 09:21:41 2014 +0200

    vmw_pvscsi: fixup tagging
    
    The request (and SCSI command) tag is the tag number assigned
    by the generic block-tagging code, not the SCSI-II tag messages.
    Those are represented by the device flags 'tagged_supported',
    'simple_tags', and 'ordered_tags'.
    (The SCSI midlayer doesn't use HEAD_OF_QUEUE tags).
    So fixup vmw_pvscsi to assign the correct tag type.
    
    [hch: fixed up to never set MSG_ORDERED_TAG]
    Signed-off-by: Hannes Reinecke <hare@suse.de>
    Acked-by: Arvind Kumar <arvindkumar@vmware.com>
    Signed-off-by: Christoph Hellwig <hch@lst.de>

diff --git a/drivers/scsi/vmw_pvscsi.c b/drivers/scsi/vmw_pvscsi.c
index c3b4f8b3a3a5..4a01c0598a2f 100644
--- a/drivers/scsi/vmw_pvscsi.c
+++ b/drivers/scsi/vmw_pvscsi.c
@@ -723,10 +723,6 @@ static int pvscsi_queue_ring(struct pvscsi_adapter *adapter,
 	memcpy(e->cdb, cmd->cmnd, e->cdbLen);
 
 	e->tag = SIMPLE_QUEUE_TAG;
-	if (sdev->tagged_supported &&
-	    (cmd->tag == HEAD_OF_QUEUE_TAG ||
-	     cmd->tag == ORDERED_QUEUE_TAG))
-		e->tag = cmd->tag;
 
 	if (cmd->sc_data_direction == DMA_FROM_DEVICE)
 		e->flags = PVSCSI_FLAG_CMD_DIR_TOHOST;

