commit 78bb3949a965e8a28e20988e28868429606b3639
Author: Mauro Carvalho Chehab <mchehab@infradead.org>
Date:   Sun Apr 13 14:56:25 2008 -0300

    V4L/DVB (7549): em28xx: some small cleanups
    
    - Remove dead code;
    - Fix a few CodingStyle issues;
    - Prints frame number, if debug is enabled.
    
    Signed-off-by: Mauro Carvalho Chehab <mchehab@infradead.org>

diff --git a/drivers/media/video/em28xx/em28xx-video.c b/drivers/media/video/em28xx/em28xx-video.c
index e2d04cf4ba9d..0a2ff4afe416 100644
--- a/drivers/media/video/em28xx/em28xx-video.c
+++ b/drivers/media/video/em28xx/em28xx-video.c
@@ -133,7 +133,7 @@ static inline void buffer_filled(struct em28xx *dev,
 				  struct em28xx_dmaqueue *dma_q,
 				  struct em28xx_buffer *buf)
 {
-	mod_timer(&dma_q->timeout, jiffies+BUFFER_TIMEOUT);
+	mod_timer(&dma_q->timeout, jiffies + BUFFER_TIMEOUT);
 
 	/* Advice that buffer was filled */
 	em28xx_isocdbg("[%p/%d] wakeup\n", buf, buf->vb.i);
@@ -159,7 +159,7 @@ static void em28xx_copy_video(struct em28xx *dev,
 
 	if (dev->frame_size != buf->vb.size) {
 		em28xx_errdev("size %i and buf.length %lu are different!\n",
-			   dev->frame_size, buf->vb.size);
+			      dev->frame_size, buf->vb.size);
 		return;
 	}
 
@@ -208,8 +208,6 @@ static void em28xx_copy_video(struct em28xx *dev,
 		else
 			lencopy = dev->bytesperline;
 
-		BUG_ON(lencopy <= 0);
-
 		if ((char *)startwrite + lencopy > (char *)outp + buf->vb.size) {
 			em28xx_isocdbg("Overflow of %zi bytes past buffer end (2)\n",
 				       ((char *)startwrite + lencopy) -
@@ -319,7 +317,6 @@ static inline int em28xx_isoc_copy(struct urb *urb)
 
 	outp = videobuf_to_vmalloc(&buf->vb);
 
-
 	for (i = 0; i < urb->number_of_packets; i++) {
 		int status = urb->iso_frame_desc[i].status;
 
@@ -347,11 +344,8 @@ static inline int em28xx_isoc_copy(struct urb *urb)
 		   logic simpler. Impacts of those changes should be evaluated
 		 */
 		if (p[0] == 0x22 && p[1] == 0x5a) {
-			/* FIXME - are the fields the right way around? */
-			em28xx_isocdbg("Video frame, length=%i, %s\n", len,
-					(p[2] & 1)? "odd" : "even");
-			em28xx_isocdbg("Current buffer is: outp = 0x%p,"
-				       " len = %i\n", outp, (int)buf->vb.size);
+			em28xx_isocdbg("Video frame %d, length=%i, %s\n", p[2],
+				       len, (p[2] & 1)? "odd" : "even");
 
 			if (p[2] & 1)
 				buf->top_field = 0;
@@ -455,7 +449,6 @@ static void em28xx_uninit_isoc(struct em28xx *dev)
 	em28xx_capture_start(dev, 0);
 }
 
-
 /*
  * Allocate URBs and start IRQ
  */

