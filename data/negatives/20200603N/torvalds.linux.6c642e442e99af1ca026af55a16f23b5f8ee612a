commit 6c642e442e99af1ca026af55a16f23b5f8ee612a
Author: zhangdianfang <zhangdianfang@huawei.com>
Date:   Fri May 30 08:37:28 2014 +0800

    tools/liblockdep: Fix comparison of a boolean value with a value of 2
    
    Comparison of a boolean value (!__init_state) with a value of 2 (done)
    as currently happens in the code is unlikely to succeed and causes
    repeated initialization of the pthread function pointers.
    
    Instead, remove boolean comparison so that we would initialize said
    function pointers only once.
    
    Ref: https://bugzilla.kernel.org/show_bug.cgi?id=76741
    Cc: Jean Delvare <jdelvare@suse.de>
    Reported-by: David Binderman <dcb314@hotmail.com>
    Signed-off-by: Dianfang Zhang <zhangdianfang@huawei.com>
    Signed-off-by: Sasha Levin <sasha.levin@oracle.com>

diff --git a/tools/lib/lockdep/preload.c b/tools/lib/lockdep/preload.c
index 23bd69cb5ade..b5e52af6ddf3 100644
--- a/tools/lib/lockdep/preload.c
+++ b/tools/lib/lockdep/preload.c
@@ -92,7 +92,7 @@ enum { none, prepare, done, } __init_state;
 static void init_preload(void);
 static void try_init_preload(void)
 {
-	if (!__init_state != done)
+	if (__init_state != done)
 		init_preload();
 }
 

