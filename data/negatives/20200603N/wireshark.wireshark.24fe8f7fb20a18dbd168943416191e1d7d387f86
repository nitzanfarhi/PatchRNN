commit 24fe8f7fb20a18dbd168943416191e1d7d387f86
Author: Martin Kaiser <wireshark@kaiser.cx>
Date:   Thu Mar 7 22:06:18 2013 +0000

    correctly mark the payload for unknown extension tags
    (fixes a bug introduced by my previous commit)
    
    svn path=/trunk/; revision=48181

diff --git a/epan/dissectors/packet-mpeg-descriptor.c b/epan/dissectors/packet-mpeg-descriptor.c
index fcd4396a8c..9bbee6a27e 100644
--- a/epan/dissectors/packet-mpeg-descriptor.c
+++ b/epan/dissectors/packet-mpeg-descriptor.c
@@ -2306,7 +2306,9 @@ proto_mpeg_descriptor_dissect_extension(tvbuff_t *tvb, guint offset, guint8 len,
 				proto_tree_add_text(tree, tvb, offset, len-already_dissected, "Private data");
 			break;
 		default:
-			proto_tree_add_item(tree, hf_mpeg_descr_extension_data, tvb, offset, len, ENC_NA);
+			already_dissected = offset-offset_start;
+			if (already_dissected<len)
+				proto_tree_add_item(tree, hf_mpeg_descr_extension_data, tvb, offset, len-already_dissected, ENC_NA);
 			break;
 	}
 

