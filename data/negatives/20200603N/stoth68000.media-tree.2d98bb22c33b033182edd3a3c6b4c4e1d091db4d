commit 2d98bb22c33b033182edd3a3c6b4c4e1d091db4d
Author: Dan Carpenter <error27@gmail.com>
Date:   Fri Jun 4 12:39:51 2010 +0200

    Staging: rc2860: return -EFAULT on copy_to_user errors
    
    copy_to_user() returns the number of bytes remaining but we want to
    return a negative error code.  This is in the ioctl handler and the
    error code gets passed to userspace.
    
    Signed-off-by: Dan Carpenter <error27@gmail.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

diff --git a/drivers/staging/rt2860/sta_ioctl.c b/drivers/staging/rt2860/sta_ioctl.c
index 112da7a6c417..6b8268d3dc75 100644
--- a/drivers/staging/rt2860/sta_ioctl.c
+++ b/drivers/staging/rt2860/sta_ioctl.c
@@ -2522,6 +2522,8 @@ int rt28xx_sta_ioctl(IN struct net_device *net_dev,
 			Status =
 			    copy_to_user(erq->pointer, pAd->nickname,
 					 erq->length);
+			if (Status)
+				Status = -EFAULT;
 			break;
 		}
 	case SIOCGIWRATE:	/*get default bit rate (bps) */

