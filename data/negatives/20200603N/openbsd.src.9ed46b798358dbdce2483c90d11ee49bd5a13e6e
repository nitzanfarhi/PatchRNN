commit 9ed46b798358dbdce2483c90d11ee49bd5a13e6e
Author: damien <damien@openbsd.org>
Date:   Wed Aug 1 12:37:46 2007 +0000

    add a TSC field to the key structure. it will be used to store the
    TKIP sequence counter (TKIP) or the PN (packet number, CCMP).

diff --git a/sys/net80211/ieee80211_crypto.h b/sys/net80211/ieee80211_crypto.h
index 8a54c0415ca..2a15425c0f7 100644
--- a/sys/net80211/ieee80211_crypto.h
+++ b/sys/net80211/ieee80211_crypto.h
@@ -1,4 +1,4 @@
-/*	$OpenBSD: ieee80211_crypto.h,v 1.4 2007/07/28 11:01:19 damien Exp $	*/
+/*	$OpenBSD: ieee80211_crypto.h,v 1.5 2007/08/01 12:37:46 damien Exp $	*/
 /*	$NetBSD: ieee80211_crypto.h,v 1.2 2003/09/14 01:14:55 dyoung Exp $	*/
 
 /*-
@@ -67,7 +67,8 @@ struct ieee80211_key {
 #define IEEE80211_KEY_GROUP	0x00000001	/* group key */
 #define IEEE80211_KEY_TX	0x00000002	/* Tx+Rx */
 
-	u_int64_t		k_rsc;		/* receive sequence counter */
+	u_int64_t		k_rsc;
+	u_int64_t		k_tsc;
 	int			k_len;
 	u_int8_t		k_key[IEEE80211_KEYBUF_SIZE];
 };

