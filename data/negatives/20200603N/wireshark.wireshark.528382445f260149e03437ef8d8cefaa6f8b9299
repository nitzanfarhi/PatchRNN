commit 528382445f260149e03437ef8d8cefaa6f8b9299
Author: Anders Broman <anders.broman@ericsson.com>
Date:   Sun Sep 13 16:11:11 2009 +0000

    From Didier Gautheron:
    optimizations patch http://wiki.wireshark.org/Development/Optimization
    'patch.29854.diff.gz"
    
    Speed up sorting.
    
    svn path=/trunk/; revision=29879

diff --git a/gtk/gui_utils.c b/gtk/gui_utils.c
index 2a34a504d7..49740f025d 100644
--- a/gtk/gui_utils.c
+++ b/gtk/gui_utils.c
@@ -1209,7 +1209,7 @@ str_ptr_data_func (GtkTreeViewColumn *column _U_,
                            GtkTreeModel      *model,
                            GtkTreeIter       *iter,
                            gpointer           user_data)
-   {
+ {	
 	 const gchar *str = NULL;
 
 	 /* The col to get data from is in userdata */
@@ -1237,11 +1237,15 @@ str_ptr_sort_func(GtkTreeModel *model,
      gtk_tree_model_get(model, a, data_column, &str_a, -1);
      gtk_tree_model_get(model, b, data_column, &str_b, -1);
 
-	if (str_a == NULL || str_b == NULL){
-		if (str_a == NULL && str_b == NULL)
-			return 0;
+	if (str_a == str_b) {
+		/* it's worth testing because a lot of row point to 
+		   the same data */
+		return 0;
+	} 
+	else if (str_a == NULL || str_b == NULL) {
 		ret = (str_a == NULL) ? -1 : 1;
-	}else{
+	} 
+	else {
 		ret = g_ascii_strcasecmp(str_a,str_b);
 	}
 	return ret;

