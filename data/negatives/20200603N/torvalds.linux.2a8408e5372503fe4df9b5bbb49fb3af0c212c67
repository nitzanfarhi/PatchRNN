commit 2a8408e5372503fe4df9b5bbb49fb3af0c212c67
Author: Imre Deak <imre.deak@intel.com>
Date:   Tue Oct 3 12:51:58 2017 +0300

    drm/i915/cnl: Reprogram DMC firmware after S3/S4 resume
    
    The DMC firmware program memory is lost after S3/S4 system suspend, so
    we need to reprogram it during resume.
    
    Bugzilla: https://bugs.freedesktop.org/show_bug.cgi?id=103070
    Fixes: cebfcead63de ("drm/i915/DMC/CNL: Load DMC on CNL")
    Cc: Anusha Srivatsa <anusha.srivatsa@intel.com>
    Cc: Animesh Manna <animesh.manna@intel.com>
    Cc: Rodrigo Vivi <rodrigo.vivi@intel.com>
    Signed-off-by: Imre Deak <imre.deak@intel.com>
    Reviewed-by: Rodrigo Vivi <rodrigo.vivi@intel.com>
    Link: https://patchwork.freedesktop.org/patch/msgid/20171003095159.711-1-imre.deak@intel.com
    (cherry picked from commit 57522c4c87de20d8f7ad4e142a3a4334066d55ff)
    Signed-off-by: Rodrigo Vivi <rodrigo.vivi@intel.com>

diff --git a/drivers/gpu/drm/i915/intel_runtime_pm.c b/drivers/gpu/drm/i915/intel_runtime_pm.c
index b66d8e136aa3..b3a087cb0860 100644
--- a/drivers/gpu/drm/i915/intel_runtime_pm.c
+++ b/drivers/gpu/drm/i915/intel_runtime_pm.c
@@ -2782,6 +2782,9 @@ static void cnl_display_core_init(struct drm_i915_private *dev_priv, bool resume
 
 	/* 6. Enable DBUF */
 	gen9_dbuf_enable(dev_priv);
+
+	if (resume && dev_priv->csr.dmc_payload)
+		intel_csr_load_program(dev_priv);
 }
 
 #undef CNL_PROCMON_IDX

