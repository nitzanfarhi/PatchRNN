commit 9c6bf8d1eed8517e4f8b030b075c1490b3a9b60c
Author: Michael Richardson <mcr@xelerance.com>
Date:   Mon Sep 4 20:53:02 2006 -0400

    make sure to unpack the nonce that was calculated.
    
    Signed-off-by: Michael Richardson <mcr@xelerance.com>

diff --git a/programs/pluto/ikev1_aggr.c b/programs/pluto/ikev1_aggr.c
index d5a4669d7..19a020b5e 100644
--- a/programs/pluto/ikev1_aggr.c
+++ b/programs/pluto/ikev1_aggr.c
@@ -172,6 +172,9 @@ aggr_inI1_outR1_continue1(struct pluto_crypto_req_cont *pcrc
   /* unpack first calculation */
   unpack_KE(st, r, &st->st_gr);
 
+  /* unpack nonce too */
+  unpack_nonce(&st->st_nr, r);
+
   /* NOTE: the "r" reply will get freed by our caller */
   
   /* set up second calculation */

