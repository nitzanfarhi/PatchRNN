commit ec07efa70012845e8642df67a4a773f510a17088
Author: Derek Buitenhuis <derek.buitenhuis@gmail.com>
Date:   Thu Apr 20 16:17:44 2017 +0100

    avformat/webmdashenc: Validate the 'streams' adaptation sets parameter
    
    It should not be a value larger than the number of streams we have,
    or it will cause invalid reads and/or SIGSEGV.
    
    Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>

diff --git a/libavformat/webmdashenc.c b/libavformat/webmdashenc.c
index 71f01fd770..550ad72e4d 100644
--- a/libavformat/webmdashenc.c
+++ b/libavformat/webmdashenc.c
@@ -467,7 +467,11 @@ static int parse_adaptation_sets(AVFormatContext *s)
             if (as->streams == NULL)
                 return AVERROR(ENOMEM);
             as->streams[as->nb_streams - 1] = to_integer(p, q - p + 1);
-            if (as->streams[as->nb_streams - 1] < 0) return -1;
+            if (as->streams[as->nb_streams - 1] < 0 ||
+                as->streams[as->nb_streams - 1] >= s->nb_streams) {
+                av_log(s, AV_LOG_ERROR, "Invalid value for 'streams' in adapation_sets.\n");
+                return AVERROR(EINVAL);
+            }
             if (*q == '\0') break;
             if (*q == ' ') state = new_set;
             p = ++q;

