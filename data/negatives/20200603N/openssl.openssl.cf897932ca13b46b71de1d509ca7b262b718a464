commit cf897932ca13b46b71de1d509ca7b262b718a464
Author: Bodo MÃ¶ller <bodo@openssl.org>
Date:   Fri Apr 2 23:35:43 1999 +0000

    Avoid EADDRINUSE for s_server.
    
    Submitted by:
    Reviewed by:
    PR:

diff --git a/apps/s_socket.c b/apps/s_socket.c
index 6274acf53b..0030b57936 100644
--- a/apps/s_socket.c
+++ b/apps/s_socket.c
@@ -342,6 +342,12 @@ char *ip;
 	s=socket(AF_INET,SOCK_STREAM,SOCKET_PROTOCOL);
 
 	if (s == INVALID_SOCKET) goto err;
+#if defined SOL_SOCKET && defined SO_REUSEADDR
+		{
+		int i = 1;
+		setsockopt(s, SOL_SOCKET, SO_REUSEADDR, &i, sizeof i);
+		}
+#endif
 	if (bind(s,(struct sockaddr *)&server,sizeof(server)) == -1)
 		{
 #ifndef WINDOWS

