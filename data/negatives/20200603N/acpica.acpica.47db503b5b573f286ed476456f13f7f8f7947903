commit 47db503b5b573f286ed476456f13f7f8f7947903
Author: rmoore1 <rmoore1>
Date:   Fri Mar 10 18:58:00 2006 +0000

    Don't store return object unless returning AE_OK

diff --git a/source/components/executer/exoparg1.c b/source/components/executer/exoparg1.c
index ef083dbcc..d47226238 100644
--- a/source/components/executer/exoparg1.c
+++ b/source/components/executer/exoparg1.c
@@ -2,7 +2,7 @@
 /******************************************************************************
  *
  * Module Name: exoparg1 - AML execution - opcodes with 1 argument
- *              $Revision: 1.176 $
+ *              $Revision: 1.177 $
  *
  *****************************************************************************/
 
@@ -682,11 +682,6 @@ AcpiExOpcode_1A_1T_1R (
 
 Cleanup:
 
-    if (!WalkState->ResultObj)
-    {
-        WalkState->ResultObj = ReturnDesc;
-    }
-
     /* Delete return object on error */
 
     if (ACPI_FAILURE (Status))
@@ -694,6 +689,13 @@ Cleanup:
         AcpiUtRemoveReference (ReturnDesc);
     }
 
+    /* Save return object on success */
+
+    else if (!WalkState->ResultObj)
+    {
+        WalkState->ResultObj = ReturnDesc;
+    }
+
     return_ACPI_STATUS (Status);
 }
 
@@ -1166,7 +1168,13 @@ Cleanup:
         AcpiUtRemoveReference (ReturnDesc);
     }
 
-    WalkState->ResultObj = ReturnDesc;
+    /* Save return object on success */
+
+    else
+    {
+        WalkState->ResultObj = ReturnDesc;
+    }
+
     return_ACPI_STATUS (Status);
 }
 
diff --git a/source/components/executer/exoparg2.c b/source/components/executer/exoparg2.c
index 455221a04..41eb68a89 100644
--- a/source/components/executer/exoparg2.c
+++ b/source/components/executer/exoparg2.c
@@ -1,7 +1,7 @@
 /******************************************************************************
  *
  * Module Name: exoparg2 - AML execution - opcodes with 2 arguments
- *              $Revision: 1.139 $
+ *              $Revision: 1.140 $
  *
  *****************************************************************************/
 
@@ -504,7 +504,6 @@ AcpiExOpcode_2A_1T_1R (
         Index = Operand[1]->Integer.Value;
         ReturnDesc->Reference.Offset = (UINT32) Index;
         ReturnDesc->Reference.Opcode = AML_INDEX_OP;
-        ReturnDesc->Reference.Object = Operand[0];
 
         /*
          * At this point, the Source operand is a String, Buffer, or Package.
@@ -560,9 +559,10 @@ AcpiExOpcode_2A_1T_1R (
         }
 
         /*
-         * Add a reference to the target package/buffer/string for the life
+         * Save the target object and add a reference to it for the life
          * of the index
          */
+        ReturnDesc->Reference.Object = Operand[0];
         AcpiUtAddReference (Operand[0]);
 
         /* Store the reference to the Target */

