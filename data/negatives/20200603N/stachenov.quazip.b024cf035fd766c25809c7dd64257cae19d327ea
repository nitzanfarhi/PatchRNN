commit b024cf035fd766c25809c7dd64257cae19d327ea
Author: Sergei Tachenov <sergei@tachenov.name>
Date:   Thu Sep 13 15:57:54 2012 +0000

    No more empty entry in the QuaZipDir list (bug #3567268)

diff --git a/quazip/quazip/quazipdir.cpp b/quazip/quazip/quazipdir.cpp
index 0220889..b138c89 100644
--- a/quazip/quazip/quazipdir.cpp
+++ b/quazip/quazip/quazipdir.cpp
@@ -306,6 +306,8 @@ bool QuaZipDirPrivate::entryInfoList(QStringList nameFilters,
         if (!name.startsWith(basePath))
             continue;
         QString relativeName = name.mid(baseLength);
+        if (relativeName.isEmpty())
+            continue;
         bool isDir = false;
         bool isReal = true;
         if (relativeName.contains('/')) {
diff --git a/quazip/test/testquazipdir.cpp b/quazip/test/testquazipdir.cpp
index 63b58d0..83780ae 100644
--- a/quazip/test/testquazipdir.cpp
+++ b/quazip/test/testquazipdir.cpp
@@ -24,6 +24,11 @@ void TestQuaZipDir::entryList_data()
             << "" << static_cast<int>(QDir::NoFilter)
             << static_cast<int>(QDir::Unsorted)
             << (QStringList() << "laj/");
+    QTest::newRow("separate dir (subdir listing)") << "sepdirsub.zip" << (
+            QStringList() << "laj/" << "laj/lajfile.txt")
+            << "laj" << static_cast<int>(QDir::NoFilter)
+            << static_cast<int>(QDir::Unsorted)
+            << (QStringList() << "lajfile.txt");
     QTest::newRow("dirs only") << "dirsonly.zip" << (
             QStringList() << "file" << "dir/")
             << "" << static_cast<int>(QDir::Dirs)

