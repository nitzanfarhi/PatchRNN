commit 313067f47f27f949bfc74c1367144adbdd8f376d
Author: Gerardo Iglesias Galvan <iglesiasg@gmail.com>
Date:   Tue May 31 20:23:36 2011 -0500

    Check return code of DetectEngineCtxInit at startup

diff --git a/src/suricata.c b/src/suricata.c
index 24e45463..1e419637 100644
--- a/src/suricata.c
+++ b/src/suricata.c
@@ -1325,6 +1325,11 @@ int main(int argc, char **argv)
     FlowInitConfig(FLOW_VERBOSE);
 
     DetectEngineCtx *de_ctx = DetectEngineCtxInit();
+    if (de_ctx == NULL) {
+        SCLogError(SC_ERR_INITIALIZATION, "initializing detection engine "
+            "context failed.");
+        exit(EXIT_FAILURE);
+    }
 
     SCClassConfLoadClassficationConfigFile(de_ctx);
     SCRConfLoadReferenceConfigFile(de_ctx);

