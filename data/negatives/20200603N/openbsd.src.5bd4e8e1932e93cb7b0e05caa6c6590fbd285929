commit 5bd4e8e1932e93cb7b0e05caa6c6590fbd285929
Author: claudio <claudio@openbsd.org>
Date:   Mon Jul 4 22:48:31 2011 +0000

    Force the sa_len to sizeof(struct sockaddr_dl) before calling
    link_addr() since the function looks at sa_len internally.
    This should solve issues with using -ifp modifier because
    the aflen was often to small.

diff --git a/sbin/route/route.c b/sbin/route/route.c
index 701e31306b0..d543cc43866 100644
--- a/sbin/route/route.c
+++ b/sbin/route/route.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: route.c,v 1.154 2011/07/02 22:00:54 claudio Exp $	*/
+/*	$OpenBSD: route.c,v 1.155 2011/07/04 22:48:31 claudio Exp $	*/
 /*	$NetBSD: route.c,v 1.16 1996/04/15 18:27:05 cgd Exp $	*/
 
 /*
@@ -865,6 +865,7 @@ getaddr(int which, char *s, struct hostent **hpp)
 	    }
 
 	case AF_LINK:
+		su->sa.sa_len = sizeof(struct sockaddr_dl);
 		link_addr(s, &su->sdl);
 		return (1);
 	case AF_MPLS:

