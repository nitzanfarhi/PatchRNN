commit 417642ddac19708bea6dd2c2bbeaf6a9578d521b
Author: Timo Sirainen <tss@iki.fi>
Date:   Tue Sep 6 17:03:55 2011 +0300

    lib-storage: When mail_debug=yes logs userdb fields, hide values of all whose key contains "pass".

diff --git a/src/lib-storage/mail-storage-service.c b/src/lib-storage/mail-storage-service.c
index ad4add7ee..f44565576 100644
--- a/src/lib-storage/mail-storage-service.c
+++ b/src/lib-storage/mail-storage-service.c
@@ -164,6 +164,11 @@ static int set_line(struct mail_storage_service_ctx *ctx,
 
 	ret = settings_parse_line(set_parser, line);
 	if (mail_debug && ret >= 0) {
+		if (strstr(key, "pass") != NULL) {
+			/* possibly a password field (e.g. imapc_password).
+			   hide the value. */
+			line = t_strconcat(key, "=<hidden>", NULL);
+		}
 		i_debug(ret == 0 ?
 			"Unknown userdb setting: %s" :
 			"Added userdb setting: %s", line);

