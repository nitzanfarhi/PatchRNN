commit ca714ef70e549aad486a62f4d6ef849572e3a7f1
Author: Matthias Schwarzott <zzam@gentoo.org>
Date:   Tue Jan 23 20:01:30 2007 +0100

    fix retry-loop in netif-rename code

diff --git a/udev_device.c b/udev_device.c
index bc0b33077..1eebd61cc 100644
--- a/udev_device.c
+++ b/udev_device.c
@@ -122,16 +122,17 @@ static int rename_netif(struct udevice *udev)
 		strlcpy(ifr.ifr_newname, udev->name, IFNAMSIZ);
 		loop = 30 * 20;
 		while (loop--) {
-			retval = ioctl(sk, SIOCSIFNAME, &ifr);	
-			if (retval != 0) {
-				if (errno != EEXIST) {
-					err("error changing net interface name %s to %s: %s",
-					    ifr.ifr_name, ifr.ifr_newname, strerror(errno));
-					break;
-				}
-				dbg("wait for netif '%s' to become free, loop=%i", udev->name, (30 * 20) - loop);
-				usleep(1000 * 1000 / 20);
+			retval = ioctl(sk, SIOCSIFNAME, &ifr);
+			if (retval == 0)
+				break;
+
+			if (errno != EEXIST) {
+				err("error changing net interface name %s to %s: %s",
+				    ifr.ifr_name, ifr.ifr_newname, strerror(errno));
+				break;
 			}
+			dbg("wait for netif '%s' to become free, loop=%i", udev->name, (30 * 20) - loop);
+			usleep(1000 * 1000 / 20);
 		}
 	}
 

