commit 9c4e6f29ad07fbd27cb9ac510fa69f8c60709f1f
Author: Timo Sirainen <tss@iki.fi>
Date:   Mon Oct 11 16:24:03 2004 +0300

    Don't send extra ")" line with bad FETCH parameters.
    
    --HG--
    branch : HEAD

diff --git a/src/imap/imap-fetch.c b/src/imap/imap-fetch.c
index c08c94f46..47e2e06b8 100644
--- a/src/imap/imap-fetch.c
+++ b/src/imap/imap-fetch.c
@@ -93,6 +93,7 @@ struct imap_fetch_context *imap_fetch_init(struct client *client)
 	ctx->seen_flag.flags = MAIL_SEEN;
 	ctx->all_headers_buf = buffer_create_dynamic(client->cmd_pool, 128);
 	ctx->handlers = buffer_create_dynamic(client->cmd_pool, 128);
+	ctx->line_finished = TRUE;
 	return ctx;
 }
 
@@ -152,7 +153,6 @@ void imap_fetch_begin(struct imap_fetch_context *ctx,
 	ctx->search_ctx =
 		mailbox_search_init(ctx->trans, NULL, search_arg, NULL,
 				    ctx->fetch_data, ctx->all_headers_ctx);
-	ctx->line_finished = TRUE;
 }
 
 int imap_fetch(struct imap_fetch_context *ctx)

