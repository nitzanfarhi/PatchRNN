commit bc2a3f86f46569fb091792867ce67c9ab24dfd0f
Author: J. Bruce Fields <bfields@citi.umich.edu>
Date:   Mon Oct 29 14:37:18 2007 -0700

    sunrpc: fix rpc debugging
    
    Commit baa3a2a0d24ebcf1c451bec8e5bee3d3467f4cbb ("sysctl: remove broken
    sunrpc debug binary sysctls"), by removing initialization of the
    ctl_name field, broke this conditional, preventing the display of
    rpc_tasks that you previously got when turning on rpc debugging.
    
    [akpm@linux-foundation.org: coding-style fixes]
    Signed-off-by: J. Bruce Fields <bfields@citi.umich.edu>
    Acked-by: "Eric W. Biederman" <ebiederm@xmission.com>
    Cc: "David S. Miller" <davem@davemloft.net>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

diff --git a/net/sunrpc/sysctl.c b/net/sunrpc/sysctl.c
index 864b541bbf51..2be714e9b382 100644
--- a/net/sunrpc/sysctl.c
+++ b/net/sunrpc/sysctl.c
@@ -87,9 +87,8 @@ proc_dodebug(ctl_table *table, int write, struct file *file,
 			left--, s++;
 		*(unsigned int *) table->data = value;
 		/* Display the RPC tasks on writing to rpc_debug */
-		if (table->ctl_name == CTL_RPCDEBUG) {
+		if (strcmp(table->procname, "rpc_debug") == 0)
 			rpc_show_tasks();
-		}
 	} else {
 		if (!access_ok(VERIFY_WRITE, buffer, left))
 			return -EFAULT;

