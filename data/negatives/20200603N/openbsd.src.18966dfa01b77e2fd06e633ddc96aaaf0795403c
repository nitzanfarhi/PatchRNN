commit 18966dfa01b77e2fd06e633ddc96aaaf0795403c
Author: markus <markus@openbsd.org>
Date:   Tue Dec 25 18:53:00 2001 +0000

    be more carefull on allocation

diff --git a/usr.bin/ssh/auth1.c b/usr.bin/ssh/auth1.c
index 6163b26fa1e..1a0ccdc7706 100644
--- a/usr.bin/ssh/auth1.c
+++ b/usr.bin/ssh/auth1.c
@@ -10,7 +10,7 @@
  */
 
 #include "includes.h"
-RCSID("$OpenBSD: auth1.c,v 1.27 2001/12/19 07:18:56 deraadt Exp $");
+RCSID("$OpenBSD: auth1.c,v 1.28 2001/12/25 18:53:00 markus Exp $");
 
 #include "xmalloc.h"
 #include "rsa.h"
@@ -227,6 +227,8 @@ do_authloop(Authctxt *authctxt)
 			}
 			/* RSA authentication requested. */
 			n = BN_new();
+			if (n == NULL)
+				fatal("BN_new failed");
 			packet_get_bignum(n, &nlen);
 			packet_integrity_check(plen, nlen, type);
 			authenticated = auth_rsa(pw, n);

