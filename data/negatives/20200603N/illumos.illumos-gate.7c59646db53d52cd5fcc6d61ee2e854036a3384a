commit 7c59646db53d52cd5fcc6d61ee2e854036a3384a
Author: georges <none@none>
Date:   Mon Nov 13 14:23:29 2006 -0800

    6477746 sctp_data_frag()should check alignment of mblks passed in, before writing to headers.

diff --git a/usr/src/uts/common/inet/sctp/sctp_input.c b/usr/src/uts/common/inet/sctp/sctp_input.c
index cd334c880d..e945a61616 100644
--- a/usr/src/uts/common/inet/sctp/sctp_input.c
+++ b/usr/src/uts/common/inet/sctp/sctp_input.c
@@ -804,7 +804,8 @@ sctp_data_frag(sctp_t *sctp, mblk_t *dmp, sctp_data_hdr_t **dc, int *error,
 	 */
 #define	SCTP_NEW_REASS(nmp, dmp, srp, seterror)				\
 	if ((DB_REF(dmp) == 2) && (MBLKHEAD(dmp) >= 			\
-	    (sizeof (*(srp)) + sizeof (sctp_hdr_t)))) {			\
+	    (sizeof (*(srp)) + sizeof (sctp_hdr_t))) &&			\
+	    (IS_P2ALIGNED(DB_BASE(dmp), sizeof (uintptr_t)))) {		\
 		(nmp) = (dmp);						\
 	} else {							\
 		(nmp) = allocb(sizeof (*(srp)), BPRI_MED); 		\

