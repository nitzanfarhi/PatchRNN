commit 76c55eae2f9b0b378332762f6dce544d05eb24d7
Author: Christos Zoulas <christos@zoulas.com>
Date:   Sun Jul 8 23:37:33 2018 +0000

    Print the Go Build-ID like we do for other elf binaries

diff --git a/src/readelf.c b/src/readelf.c
index 1f41b461..db0b35a5 100644
--- a/src/readelf.c
+++ b/src/readelf.c
@@ -27,7 +27,7 @@
 #include "file.h"
 
 #ifndef lint
-FILE_RCSID("@(#)$File: readelf.c,v 1.143 2018/06/09 16:00:06 christos Exp $")
+FILE_RCSID("@(#)$File: readelf.c,v 1.144 2018/07/08 23:37:33 christos Exp $")
 #endif
 
 #ifdef BUILTIN_ELF
@@ -556,6 +556,13 @@ do_bid_note(struct magic_set *ms, unsigned char *nbuf, uint32_t type,
 			return 1;
 		return 1;
 	}
+	if (namesz == 4 && strcmp((char *)&nbuf[noff], "Go") == 0 &&
+	    type == NT_GO_BUILD_ID && descsz < 128) {
+		if (file_printf(ms, ", Go BuildID=%s",
+		    (char *)&nbuf[doff]) == -1)
+			return 1;
+		return 1;
+	}
 	return 0;
 }
 
diff --git a/src/readelf.h b/src/readelf.h
index f2f3dc33..6ae63f2d 100644
--- a/src/readelf.h
+++ b/src/readelf.h
@@ -355,6 +355,15 @@ typedef struct {
  */
 #define NT_NETBSD_CMODEL	6
 
+/*
+ * Golang-specific note type
+ * name: Go\0\0
+ * namesz: 4
+ * desc: base-64 build id.
+ * descsz: < 128
+ */
+#define NT_GO_BUILD_ID	4
+
 /*
  * FreeBSD specific notes
  */

