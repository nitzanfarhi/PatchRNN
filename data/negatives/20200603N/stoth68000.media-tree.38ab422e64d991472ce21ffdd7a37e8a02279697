commit 38ab422e64d991472ce21ffdd7a37e8a02279697
Author: Gabor Juhos <juhosg@openwrt.org>
Date:   Wed Jun 17 20:53:21 2009 +0200

    ath9k: restore PS mode, before we put the chip into FULL SLEEP state.
    
    We want to put the chip into FULL SLEEP state, when we are disabling the
    radio, but the the current code always change it to AWAKE/NETWORK SLEEP.
    
    Changes-licensed-under: ISC
    Signed-off-by: Gabor Juhos <juhosg@openwrt.org>
    Signed-off-by: John W. Linville <linville@tuxdriver.com>

diff --git a/drivers/net/wireless/ath/ath9k/main.c b/drivers/net/wireless/ath/ath9k/main.c
index 9f49a3251d4d..66a6c1f5022a 100644
--- a/drivers/net/wireless/ath/ath9k/main.c
+++ b/drivers/net/wireless/ath/ath9k/main.c
@@ -1196,8 +1196,8 @@ void ath_radio_disable(struct ath_softc *sc)
 
 	ath9k_hw_phy_disable(ah);
 	ath9k_hw_configpcipowersave(ah, 1);
-	ath9k_hw_setpower(ah, ATH9K_PM_FULL_SLEEP);
 	ath9k_ps_restore(sc);
+	ath9k_hw_setpower(ah, ATH9K_PM_FULL_SLEEP);
 }
 
 /*******************/

