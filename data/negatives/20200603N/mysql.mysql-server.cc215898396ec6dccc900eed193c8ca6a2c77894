commit cc215898396ec6dccc900eed193c8ca6a2c77894
Author: bar@bar.intranet.mysql.r18.ru <>
Date:   Wed Jan 14 17:26:30 2004 +0400

    item_strfunc.cc:
      We don't need to copy if start is 0, we can return the original value.

diff --git a/sql/item_strfunc.cc b/sql/item_strfunc.cc
index 45b2b7455f9..f810afa3cfa 100644
--- a/sql/item_strfunc.cc
+++ b/sql/item_strfunc.cc
@@ -982,6 +982,8 @@ String *Item_func_right::val_str(String *str)
     never return a value more than "length".
   */
   uint start=res->numchars()-(uint) length;
+  if (!start)
+    return res;
   start=res->charpos(start);
   tmp_value.set(*res,start,res->length()-start);
   return &tmp_value;

