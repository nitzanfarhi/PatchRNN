commit 660cd0dd94eba5201c69cd10f2d2fefb52807fa8
Author: Javier Martin <javier.martin@vista-silicon.com>
Date:   Thu Mar 22 14:54:15 2012 +0100

    dmaengine: i.MX: Fix merge of cookie branch.
    
    When merging DMA cookie changes a small chunk
    of code was dropped. This broke imx-dma driver.
    
    This patch adds this chunk again and fixes the problem.
    
    Signed-off-by: Javier Martin <javier.martin@vista-silicon.com>
    Signed-off-by: Vinod Koul <vinod.koul@linux.intel.com>

diff --git a/drivers/dma/imx-dma.c b/drivers/dma/imx-dma.c
index 0f698f883cca..569b0a29fa8c 100644
--- a/drivers/dma/imx-dma.c
+++ b/drivers/dma/imx-dma.c
@@ -679,6 +679,7 @@ static dma_cookie_t imxdma_tx_submit(struct dma_async_tx_descriptor *tx)
 	unsigned long flags;
 
 	spin_lock_irqsave(&imxdma->lock, flags);
+	list_move_tail(imxdmac->ld_free.next, &imxdmac->ld_queue);
 	cookie = dma_cookie_assign(tx);
 	spin_unlock_irqrestore(&imxdma->lock, flags);
 

