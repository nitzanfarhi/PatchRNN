commit b9f9901bd1a229b45e957261665cf1f0d5db67bc
Author: tholo <tholo@openbsd.org>
Date:   Sat Jun 14 06:10:36 1997 +0000

    Don't look beyond the end of bdevsw[], from NetBSD PR 3748 by Michael L Hitch

diff --git a/sys/kern/vfs_bio.c b/sys/kern/vfs_bio.c
index ffa423f0c88..d1d4592820c 100644
--- a/sys/kern/vfs_bio.c
+++ b/sys/kern/vfs_bio.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: vfs_bio.c,v 1.14 1997/04/14 04:23:23 tholo Exp $	*/
+/*	$OpenBSD: vfs_bio.c,v 1.15 1997/06/14 06:10:36 tholo Exp $	*/
 /*	$NetBSD: vfs_bio.c,v 1.44 1996/06/11 11:15:36 pk Exp $	*/
 
 /*-
@@ -402,7 +402,8 @@ bdwrite(bp)
 	}
 
 	/* If this is a tape block, write the block now. */
-	if (bdevsw[major(bp->b_dev)].d_type == D_TAPE) {
+	if (major(bp->b_dev) < nblkdev &&
+	    bdevsw[major(bp->b_dev)].d_type == D_TAPE) {
 		bawrite(bp);
 		return;
 	}

