commit 40e8c42704dfbf504ebdb66cfab09a2e9517550d
Author: jsing <jsing>
Date:   Sat Dec 6 13:28:56 2014 +0000

    Ensure that the client specified EC curve list length is a multiple of two.
    The EC curve handling code assumes this to be the case and will read one
    byte off the end of the curve list during processing, in the case where it
    is not.
    
    ok miod@

diff --git a/src/ssl/t1_lib.c b/src/ssl/t1_lib.c
index 378885a2..1fe851b4 100644
--- a/src/ssl/t1_lib.c
+++ b/src/ssl/t1_lib.c
@@ -1,4 +1,4 @@
-/* $OpenBSD: t1_lib.c,v 1.68 2014/12/02 20:46:19 miod Exp $ */
+/* $OpenBSD: t1_lib.c,v 1.69 2014/12/06 13:21:14 jsing Exp $ */
 /* Copyright (C) 1995-1998 Eric Young (eay@cryptsoft.com)
  * All rights reserved.
  *
@@ -1370,7 +1370,8 @@ ssl_parse_clienthello_tlsext(SSL *s, unsigned char **p, unsigned char *d,
 			ellipticcurvelist_length += (*(sdata++));
 
 			if (ellipticcurvelist_length != size - 2 ||
-			    ellipticcurvelist_length < 1) {
+			    ellipticcurvelist_length < 1 ||
+			    ellipticcurvelist_length % 2 != 0) {
 				*al = TLS1_AD_DECODE_ERROR;
 				return 0;
 			}

