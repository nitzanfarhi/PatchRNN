commit 012200abc78909d6c5b511a39895659897eab09d
Author: Poul-Henning Kamp <phk@FreeBSD.org>
Date:   Sat Sep 17 11:43:39 2011 +0000

    Eliminate the global vca_pipes.

diff --git a/bin/varnishd/cache_acceptor.c b/bin/varnishd/cache_acceptor.c
index 2afc97553..f7147cc3e 100644
--- a/bin/varnishd/cache_acceptor.c
+++ b/bin/varnishd/cache_acceptor.c
@@ -95,8 +95,6 @@ static const struct linger linger = {
 
 static unsigned char	need_sndtimeo, need_rcvtimeo, need_linger, need_test;
 
-int vca_pipes[2] = { -1, -1 };
-
 static void
 sock_test(int fd)
 {
@@ -407,7 +405,6 @@ ccf_start(struct cli *cli, const char * const *av, void *priv)
 	AN(vca_act->init);
 	AN(vca_act->pass);
 
-	AZ(pipe(vca_pipes)); 	/* XXX */
 	waiter_priv = vca_act->init();
 	AZ(pthread_create(&VCA_thread, NULL, vca_acct, NULL));
 	VSL(SLT_Debug, 0, "Acceptor is %s", vca_act->name);
diff --git a/bin/varnishd/cache_waiter.h b/bin/varnishd/cache_waiter.h
index 9bf139c29..ab54fe72a 100644
--- a/bin/varnishd/cache_waiter.h
+++ b/bin/varnishd/cache_waiter.h
@@ -33,8 +33,6 @@ struct sess;
 typedef void* waiter_init_f(void);
 typedef void waiter_pass_f(void *priv, const struct sess *);
 
-extern int vca_pipes[2];
-
 struct waiter {
 	const char		*name;
 	waiter_init_f		*init;

