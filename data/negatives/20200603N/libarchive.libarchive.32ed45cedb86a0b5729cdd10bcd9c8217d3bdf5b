commit 32ed45cedb86a0b5729cdd10bcd9c8217d3bdf5b
Author: Tim Kientzle <kientzle@gmail.com>
Date:   Sun Apr 19 17:35:35 2009 -0400

    If the archive is truncated, exit with ARCHIVE_FATAL.
    
    SVN-Revision: 1028

diff --git a/libarchive/archive_read_support_format_iso9660.c b/libarchive/archive_read_support_format_iso9660.c
index c45872a8..1921c580 100644
--- a/libarchive/archive_read_support_format_iso9660.c
+++ b/libarchive/archive_read_support_format_iso9660.c
@@ -683,7 +683,7 @@ archive_read_format_iso9660_read_data(struct archive_read *a,
 	if (bytes_read == 0)
 		archive_set_error(&a->archive, ARCHIVE_ERRNO_MISC,
 		    "Truncated input file");
-	if (buff == NULL)
+	if (*buff == NULL)
 		return (ARCHIVE_FATAL);
 	if (bytes_read > iso9660->entry_bytes_remaining)
 		bytes_read = iso9660->entry_bytes_remaining;

