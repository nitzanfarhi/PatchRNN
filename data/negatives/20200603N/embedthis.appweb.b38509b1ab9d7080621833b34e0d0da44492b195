commit b38509b1ab9d7080621833b34e0d0da44492b195
Author: Embedthis Software <dev@embedthis.com>
Date:   Mon Nov 18 13:49:40 2013 -0800

    Harden httpStealConn.

diff --git a/src/deps/http/httpLib.c b/src/deps/http/httpLib.c
index 019c5dff0..d0995772b 100644
--- a/src/deps/http/httpLib.c
+++ b/src/deps/http/httpLib.c
@@ -2792,8 +2792,9 @@ PUBLIC MprSocket *httpStealConn(HttpConn *conn)
 {
     MprSocket   *sock;
 
-    sock = conn->sock;
-    mprRemoveSocketHandler(sock);
+    if ((sock = conn->sock) != 0) {
+        mprRemoveSocketHandler(sock);
+    }
     conn->sock = 0;
 
     if (conn->http) {

