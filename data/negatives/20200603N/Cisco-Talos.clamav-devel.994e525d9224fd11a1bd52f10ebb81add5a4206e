commit 994e525d9224fd11a1bd52f10ebb81add5a4206e
Author: Kevin Lin <klin@sourcefire.com>
Date:   Thu Jun 2 11:09:55 2016 -0400

    bb#11129 - applied unencoded '@' patch

diff --git a/libclamav/phishcheck.c b/libclamav/phishcheck.c
index ba367c875..85a48edb3 100644
--- a/libclamav/phishcheck.c
+++ b/libclamav/phishcheck.c
@@ -1265,7 +1265,9 @@ int cli_url_canon(const char *inurl, size_t len, char *urlbuff, size_t dest_len,
 	++host_begin;
 
 	/* ignore username in URL */
-	p = strchr(host_begin, '@');
+	while((host_begin < urlend) && *host_begin == '/') ++host_begin;
+	host_len = strcspn(host_begin, ":/?");
+	p = memchr(host_begin, '@', host_len);
 	if (p)
 	    host_begin = p+1;
 	url = host_begin;

