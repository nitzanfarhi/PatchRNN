commit fb889b032d5a5f7e7178a038918bcdcd5d19d6ec
Author: Hoa V. DINH <dinh.viet.hoa@gmail.com>
Date:   Mon Jun 24 21:58:58 2013 -0700

    Fixed crash in loggers.

diff --git a/src/low-level/imap/mailimap.c b/src/low-level/imap/mailimap.c
index 77c46c2..017d95c 100644
--- a/src/low-level/imap/mailimap.c
+++ b/src/low-level/imap/mailimap.c
@@ -2712,10 +2712,11 @@ static inline void imap_logger(mailstream * s, int log_type,
     const char * str, size_t size, void * context)
 {
   mailimap * session;
+
+  session = context;
   if (session->imap_logger == NULL)
     return;
 
-  session = context;
   session->imap_logger(session, log_type, str, size, session->imap_logger_context);
 }
 
diff --git a/src/low-level/nntp/newsnntp.c b/src/low-level/nntp/newsnntp.c
index b4182ff..995fe33 100644
--- a/src/low-level/nntp/newsnntp.c
+++ b/src/low-level/nntp/newsnntp.c
@@ -2544,10 +2544,11 @@ static inline void nntp_logger(mailstream * s, int log_type,
     const char * str, size_t size, void * context)
 {
   newsnntp * session;
+
+  session = context;
   if (session->nntp_logger == NULL)
     return;
 
-  session = context;
   session->nntp_logger(session, log_type, str, size, session->nntp_logger_context);
 }
 
diff --git a/src/low-level/pop3/mailpop3.c b/src/low-level/pop3/mailpop3.c
index 27d98e7..6a4dc8e 100644
--- a/src/low-level/pop3/mailpop3.c
+++ b/src/low-level/pop3/mailpop3.c
@@ -1598,10 +1598,11 @@ static inline void pop3_logger(mailstream * s, int log_type,
     const char * str, size_t size, void * context)
 {
   mailpop3 * session;
+
+  session = context;
   if (session->pop3_logger == NULL)
     return;
 
-  session = context;
   session->pop3_logger(session, log_type, str, size, session->pop3_logger_context);
 }
 
diff --git a/src/low-level/smtp/mailsmtp.c b/src/low-level/smtp/mailsmtp.c
index 1d90615..150962b 100644
--- a/src/low-level/smtp/mailsmtp.c
+++ b/src/low-level/smtp/mailsmtp.c
@@ -1461,10 +1461,11 @@ static inline void smtp_logger(mailstream * s, int log_type,
     const char * str, size_t size, void * context)
 {
   mailsmtp * session;
+
+  session = context;
   if (session->smtp_logger == NULL)
     return;
 
-  session = context;
   session->smtp_logger(session, log_type, str, size, session->smtp_logger_context);
 }
 

