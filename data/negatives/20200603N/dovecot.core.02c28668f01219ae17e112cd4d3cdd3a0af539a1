commit 02c28668f01219ae17e112cd4d3cdd3a0af539a1
Author: Timo Sirainen <timo.sirainen@dovecot.fi>
Date:   Tue Dec 13 14:51:20 2016 +0200

    acl: Don't set acl_defaults_from_inbox=yes as default after all.
    
    Reverts b56d462fff46511b7efa0ccf254ba93d72322920 and removes the FIXME.
    Some people might actually want to give someone else access to their INBOX
    but not to all the other mailboxes. We should make it possible to use the
    "" mailbox name as the default ACL instead.

diff --git a/src/plugins/acl/acl-backend.c b/src/plugins/acl/acl-backend.c
index 86b999809..f351a56da 100644
--- a/src/plugins/acl/acl-backend.c
+++ b/src/plugins/acl/acl-backend.c
@@ -163,16 +163,18 @@ unsigned int acl_backend_lookup_right(struct acl_backend *backend,
 
 struct acl_object *acl_backend_get_default_object(struct acl_backend *backend)
 {
+	struct mail_user *user = mailbox_list_get_user(backend->list);
 	struct mail_namespace *ns = mailbox_list_get_namespace(backend->list);
 	const char *default_name = "";
 
 	if (backend->default_aclobj != NULL)
 		return backend->default_aclobj;
 
-	if (ns->type == MAIL_NAMESPACE_TYPE_PRIVATE ||
-	    ns->type == MAIL_NAMESPACE_TYPE_SHARED)
-		default_name = "INBOX";
-
+	if (mail_user_plugin_getenv(user, "acl_defaults_from_inbox") != NULL) {
+		if (ns->type == MAIL_NAMESPACE_TYPE_PRIVATE ||
+		    ns->type == MAIL_NAMESPACE_TYPE_SHARED)
+			default_name = "INBOX";
+	}
 	backend->default_aclobj =
 		acl_object_init_from_name(backend, default_name);
 	return backend->default_aclobj;

