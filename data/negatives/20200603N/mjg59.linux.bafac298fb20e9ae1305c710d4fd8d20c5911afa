commit bafac298fb20e9ae1305c710d4fd8d20c5911afa
Author: Jiang Liu <jiang.liu@linux.intel.com>
Date:   Sat Jun 20 11:50:50 2015 +0200

    x86/hpet: Check for irq==0 when allocating hpet MSI interrupts
    
    irq == 0 is not a valid irq for a irqdomain MSI allocation, but hpet
    code checks only for negative return values.
    
    Reported-by: Sergey Senozhatsky <sergey.senozhatsky@gmail.com>
    Cc: Borislav Petkov <bp@alien8.de>
    Link: http://lkml.kernel.org/r/558447AF.30703@linux.intel.com
    Signed-off-by: Thomas Gleixner <tglx@linutronix.de>

diff --git a/arch/x86/kernel/hpet.c b/arch/x86/kernel/hpet.c
index e2449cf38b06..c47aab35a17e 100644
--- a/arch/x86/kernel/hpet.c
+++ b/arch/x86/kernel/hpet.c
@@ -578,7 +578,7 @@ static void hpet_msi_capability_lookup(unsigned int start_timer)
 			continue;
 
 		irq = hpet_assign_irq(hpet_domain, hdev, hdev->num);
-		if (irq < 0)
+		if (irq <= 0)
 			continue;
 
 		sprintf(hdev->name, "hpet%d", i);

