commit 8f0361245807daf7c217b555490f6d7c6e15415f
Author: ratchov <ratchov@openbsd.org>
Date:   Wed Aug 26 05:33:01 2009 +0000

    handle incoming AMSG_SETVOL messages, allows the client to be notified
    of volume changes

diff --git a/lib/libsndio/aucat.c b/lib/libsndio/aucat.c
index 4e4d7489ba0..e7be5694107 100644
--- a/lib/libsndio/aucat.c
+++ b/lib/libsndio/aucat.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: aucat.c,v 1.24 2009/07/26 12:38:20 ratchov Exp $	*/
+/*	$OpenBSD: aucat.c,v 1.25 2009/08/26 05:33:01 ratchov Exp $	*/
 /*
  * Copyright (c) 2008 Alexandre Ratchov <alex@caoua.org>
  *
@@ -155,6 +155,12 @@ aucat_runmsg(struct aucat_hdl *hdl)
 		hdl->rstate = STATE_MSG;
 		hdl->rtodo = sizeof(struct amsg);
 		break;
+	case AMSG_SETVOL:
+		hdl->curvol = hdl->reqvol = hdl->rmsg.u.vol.ctl;
+		sio_onvol_cb(&hdl->sio, hdl->curvol);
+		hdl->rstate = STATE_MSG;
+		hdl->rtodo = sizeof(struct amsg);
+		break;
 	case AMSG_GETPAR:
 	case AMSG_ACK:
 		hdl->rstate = STATE_IDLE;

