commit fd0fee34b5ae7699dc558c12ddc3663bdb580060
Author: Max Reitz <mreitz@redhat.com>
Date:   Fri Dec 20 19:28:20 2013 +0100

    qemu-io: Make filename optional
    
    Giving a filename is actually not essential, since it can be specified
    through the options as well - on the contrary: Sometimes a filename must
    not be given.
    
    Signed-off-by: Max Reitz <mreitz@redhat.com>
    Reviewed-by: Kevin Wolf <kwolf@redhat.com>
    Signed-off-by: Kevin Wolf <kwolf@redhat.com>

diff --git a/qemu-io.c b/qemu-io.c
index bfb773e70f..d6690289b8 100644
--- a/qemu-io.c
+++ b/qemu-io.c
@@ -163,11 +163,13 @@ static int open_f(BlockDriverState *bs, int argc, char **argv)
         flags |= BDRV_O_RDWR;
     }
 
-    if (optind != argc - 1) {
+    if (optind == argc - 1) {
+        return openfile(argv[optind], flags, growable, opts);
+    } else if (optind == argc) {
+        return openfile(NULL, flags, growable, opts);
+    } else {
         return qemuio_command_usage(&open_cmd);
     }
-
-    return openfile(argv[optind], flags, growable, opts);
 }
 
 static int quit_f(BlockDriverState *bs, int argc, char **argv)

