commit 61ceaef57e19f7b19669bca4f7972123d2e6b119
Author: TingPing <tingping@tingping.se>
Date:   Fri Dec 27 09:20:39 2013 -0500

    Properly request server-time when it's the only cap
    
    Closes #862

diff --git a/src/common/inbound.c b/src/common/inbound.c
index 8d51df94..1ea0a412 100644
--- a/src/common/inbound.c
+++ b/src/common/inbound.c
@@ -1707,15 +1707,18 @@ inbound_cap_ls (server *serv, char *nick, char *extensions_str,
 		if (!strcmp (extension, "znc.in/server-time-iso"))
 		{
 			strcat (buffer, "znc.in/server-time-iso ");
+			want_cap = 1;
 		}
 		if (!strcmp (extension, "znc.in/server-time"))
 		{
 			strcat (buffer, "znc.in/server-time ");
+			want_cap = 1;
 		}
 		if (prefs.hex_irc_cap_server_time
 			 && !strcmp (extension, "server-time"))
 		{
 			strcat (buffer, "server-time ");
+			want_cap = 1;
 		}
 		
 		/* if the SASL password is set AND auth mode is set to SASL, request SASL auth */

