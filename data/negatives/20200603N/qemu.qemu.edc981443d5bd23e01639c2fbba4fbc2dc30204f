commit edc981443d5bd23e01639c2fbba4fbc2dc30204f
Author: Yang Hongyang <yanghy@cn.fujitsu.com>
Date:   Tue Oct 20 09:51:25 2015 +0800

    net: make iov_to_buf take right size argument in nc_sendv_compat()
    
    We want "buf, sizeof(buf)" here.  sizeof(buffer) is the size of a
    pointer, which is wrong.
    Thanks to Paolo for pointing it out.
    
    Signed-off-by: Yang Hongyang <yanghy@cn.fujitsu.com>
    Cc: Jason Wang <jasowang@redhat.com>
    Cc: Paolo Bonzini <pbonzini@redhat.com>
    Signed-off-by: Jason Wang <jasowang@redhat.com>

diff --git a/net/net.c b/net/net.c
index 70a3576db9..2f2b39e09b 100644
--- a/net/net.c
+++ b/net/net.c
@@ -708,7 +708,7 @@ static ssize_t nc_sendv_compat(NetClientState *nc, const struct iovec *iov,
         offset = iov[0].iov_len;
     } else {
         buffer = buf;
-        offset = iov_to_buf(iov, iovcnt, 0, buffer, sizeof(buffer));
+        offset = iov_to_buf(iov, iovcnt, 0, buf, sizeof(buf));
     }
 
     if (flags & QEMU_NET_PACKET_FLAG_RAW && nc->info->receive_raw) {

