commit c4ed442f1479f05f08a421767232c5559768ff92
Author: Timo Sirainen <tss@iki.fi>
Date:   Mon Jul 9 05:47:48 2007 +0300

    Added asserts
    
    --HG--
    branch : HEAD

diff --git a/src/lib-index/mail-transaction-log.c b/src/lib-index/mail-transaction-log.c
index 82a485dc7..ac8f55aa6 100644
--- a/src/lib-index/mail-transaction-log.c
+++ b/src/lib-index/mail-transaction-log.c
@@ -29,6 +29,9 @@ mail_transaction_log_set_head(struct mail_transaction_log *log,
 
 	file->refcount++;
 	log->head = file;
+
+	i_assert(log->files != NULL);
+	i_assert(log->files->next != NULL || log->files == file);
 }
 
 struct mail_transaction_log *
@@ -193,6 +196,7 @@ void mail_transaction_logs_clean(struct mail_transaction_log *log)
 		if (file->refcount == 0)
 			mail_transaction_log_file_free(&file);
 	}
+	i_assert(log->head == NULL || log->files != NULL);
 }
 
 #define LOG_WANT_ROTATE(file) \

