commit 1aaf61921b5dcbbf6f41bdc199789d52f77f8fed
Author: Bron Gondwana <brong@opera.com>
Date:   Thu Feb 14 15:16:51 2013 +1100

    snippets needs a mailbox at the moment too

diff --git a/imap/index.c b/imap/index.c
index 29b6ffbca..c27273946 100644
--- a/imap/index.c
+++ b/imap/index.c
@@ -2406,6 +2406,10 @@ EXPORTED int index_snippets(struct index_state *state,
     int nmatches = 0;
     struct snippet_rock srock;
 
+    /* reload index */
+    r = index_refresh(state);
+    if (r) return r;
+
     bx = search_begin_search(state->mailbox, SEARCH_MULTIPLE);
     if (!bx) {
 	r = IMAP_INTERNAL;

