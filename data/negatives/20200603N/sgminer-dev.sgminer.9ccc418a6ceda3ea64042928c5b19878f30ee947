commit 9ccc418a6ceda3ea64042928c5b19878f30ee947
Author: Con Kolivas <kernel@kolivas.org>
Date:   Mon Oct 22 23:12:06 2012 +1100

    Switch queued count when choosing a different pool from a failed stratum pool in getwork thread.

diff --git a/cgminer.c b/cgminer.c
index b5f5e81a..dfe449c5 100644
--- a/cgminer.c
+++ b/cgminer.c
@@ -2684,6 +2684,8 @@ retry:
 			sleep(5);
 			if (altpool != pool) {
 				wc->pool = altpool;
+				inc_queued(altpool);
+				dec_queued(pool);
 				goto retry;
 			}
 		}

