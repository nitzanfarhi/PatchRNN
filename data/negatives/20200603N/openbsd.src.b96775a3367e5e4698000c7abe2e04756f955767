commit b96775a3367e5e4698000c7abe2e04756f955767
Author: dim <dim@openbsd.org>
Date:   Mon May 15 08:27:19 2006 +0000

    Add AGP support for Intel 945G/GM chipsets.  The 945GM (mobile) variant
    also needs a X.org update, which will go in later.
    
    Tested by a bunch of people; ok deraadt@

diff --git a/sys/arch/i386/pci/agp_machdep.c b/sys/arch/i386/pci/agp_machdep.c
index 702eb1e9fe9..f42eb00619f 100644
--- a/sys/arch/i386/pci/agp_machdep.c
+++ b/sys/arch/i386/pci/agp_machdep.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: agp_machdep.c,v 1.6 2006/02/11 21:15:21 matthieu Exp $	*/
+/*	$OpenBSD: agp_machdep.c,v 1.7 2006/05/15 08:27:19 dim Exp $	*/
 
 /*
  * Copyright (c) 2002 Michael Shalayeff
@@ -49,6 +49,8 @@ const struct agp_product agp_products[] = {
 	{ PCI_VENDOR_INTEL, PCI_PRODUCT_INTEL_82865_IGD, agp_i810_attach },
 	{ PCI_VENDOR_INTEL, PCI_PRODUCT_INTEL_82915G_IV, agp_i810_attach },
 	{ PCI_VENDOR_INTEL, PCI_PRODUCT_INTEL_82915GM_IGD, agp_i810_attach },
+	{ PCI_VENDOR_INTEL, PCI_PRODUCT_INTEL_82945G_IGD_1, agp_i810_attach },
+	{ PCI_VENDOR_INTEL, PCI_PRODUCT_INTEL_82945GM_IGD, agp_i810_attach },
 	{ PCI_VENDOR_INTEL, -1, agp_intel_attach },
 	{ PCI_VENDOR_SIS, -1, agp_sis_attach },
 	{ PCI_VENDOR_VIATECH, -1, agp_via_attach },
diff --git a/sys/dev/pci/agp_i810.c b/sys/dev/pci/agp_i810.c
index 956a999dfab..d818099a0fb 100644
--- a/sys/dev/pci/agp_i810.c
+++ b/sys/dev/pci/agp_i810.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: agp_i810.c,v 1.12 2006/02/16 19:40:43 matthieu Exp $	*/
+/*	$OpenBSD: agp_i810.c,v 1.13 2006/05/15 08:27:19 dim Exp $	*/
 /*	$NetBSD: agp_i810.c,v 1.15 2003/01/31 00:07:39 thorpej Exp $	*/
 
 /*-
@@ -150,6 +150,8 @@ agp_i810_attach(struct vga_pci_softc *sc, struct pci_attach_args *pa,
 		break;
 	case PCI_PRODUCT_INTEL_82915G_IV:
 	case PCI_PRODUCT_INTEL_82915GM_IGD:
+	case PCI_PRODUCT_INTEL_82945G_IGD_1:
+	case PCI_PRODUCT_INTEL_82945GM_IGD:
 		isc->chiptype = CHIP_I915;
 		break;
 	}

