commit 0e7ceb2442f07edefc2357e3ed14d208652a99f3
Author: Reimar DÃ¶ffinger <Reimar.Doeffinger@gmx.de>
Date:   Fri Jan 16 15:35:51 2009 +0000

    Return AVERROR(ENOMEM) instead of -1 when malloc fails in url_open_dyn_buf_internal
    
    Originally committed as revision 16636 to svn://svn.ffmpeg.org/ffmpeg/trunk

diff --git a/libavformat/aviobuf.c b/libavformat/aviobuf.c
index defd20789b..b1e1b49a7e 100644
--- a/libavformat/aviobuf.c
+++ b/libavformat/aviobuf.c
@@ -794,7 +794,7 @@ static int url_open_dyn_buf_internal(ByteIOContext **s, int max_packet_size)
         return -1;
     d = av_mallocz(sizeof(DynBuffer) + io_buffer_size);
     if (!d)
-        return -1;
+        return AVERROR(ENOMEM);
     *s = av_mallocz(sizeof(ByteIOContext));
     if(!*s) {
         av_free(d);

