commit 44ce818bb6485101baba3d69cefccb5a711476e9
Author: jparcel <none@none>
Date:   Tue May 27 19:35:38 2008 -0700

    6691801 defrouter property breaks zones if patch is removed: must not appear in xml file if unset

diff --git a/usr/src/lib/libzonecfg/common/libzonecfg.c b/usr/src/lib/libzonecfg/common/libzonecfg.c
index 025ef86b36..d68533aa79 100644
--- a/usr/src/lib/libzonecfg/common/libzonecfg.c
+++ b/usr/src/lib/libzonecfg/common/libzonecfg.c
@@ -2231,8 +2231,13 @@ zonecfg_add_nwif_core(zone_dochandle_t handle, struct zone_nwiftab *tabptr)
 	if ((err = newprop(newnode, DTD_ATTR_PHYSICAL,
 	    tabptr->zone_nwif_physical)) != Z_OK)
 		return (err);
-	if ((err = newprop(newnode, DTD_ATTR_DEFROUTER,
-	    tabptr->zone_nwif_defrouter)) != Z_OK)
+	/*
+	 * Do not add this property when it is not set, for backwards
+	 * compatibility and because it is optional.
+	 */
+	if ((strlen(tabptr->zone_nwif_defrouter) > 0) &&
+	    ((err = newprop(newnode, DTD_ATTR_DEFROUTER,
+	    tabptr->zone_nwif_defrouter)) != Z_OK))
 		return (err);
 	return (Z_OK);
 }

