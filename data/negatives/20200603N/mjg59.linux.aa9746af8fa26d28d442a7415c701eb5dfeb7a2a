commit aa9746af8fa26d28d442a7415c701eb5dfeb7a2a
Author: Johannes Berg <johannes.berg@intel.com>
Date:   Wed Jun 9 01:46:32 2010 -0700

    iwlwifi: print warning about disconnected antennas
    
    When we detect that not all antennas are
    properly connected, we simply disable the
    associated chains, but never notify the
    user at all. Print out a warning so it is
    obvious that happened and we know where
    to start looking for related issues.
    
    Signed-off-by: Johannes Berg <johannes.berg@intel.com>
    Signed-off-by: Reinette Chatre <reinette.chatre@intel.com>

diff --git a/drivers/net/wireless/iwlwifi/iwl-calib.c b/drivers/net/wireless/iwlwifi/iwl-calib.c
index 7e8227773213..22fa947e8756 100644
--- a/drivers/net/wireless/iwlwifi/iwl-calib.c
+++ b/drivers/net/wireless/iwlwifi/iwl-calib.c
@@ -846,6 +846,13 @@ void iwl_chain_noise_calibration(struct iwl_priv *priv,
 		}
 	}
 
+	if (active_chains != priv->hw_params.valid_rx_ant &&
+	    active_chains != priv->chain_noise_data.active_chains)
+		IWL_WARN(priv,
+			 "Detected that not all antennas are connected! "
+			 "Connected: %#x, valid: %#x.\n",
+			 active_chains, priv->hw_params.valid_rx_ant);
+
 	/* Save for use within RXON, TX, SCAN commands, etc. */
 	priv->chain_noise_data.active_chains = active_chains;
 	IWL_DEBUG_CALIB(priv, "active_chains (bitwise) = 0x%x\n",

