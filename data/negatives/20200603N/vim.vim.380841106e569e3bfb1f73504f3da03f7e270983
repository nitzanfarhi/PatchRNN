commit 380841106e569e3bfb1f73504f3da03f7e270983
Author: Bram Moolenaar <Bram@vim.org>
Date:   Sat Jul 26 14:05:07 2008 +0000

    updated for version 7.2b-022

diff --git a/src/ex_docmd.c b/src/ex_docmd.c
index 7247d8cbc..07dcb774a 100644
--- a/src/ex_docmd.c
+++ b/src/ex_docmd.c
@@ -8913,6 +8913,7 @@ ex_normal(eap)
     tasave_T	tabuf;
     int		save_insertmode = p_im;
     int		save_finish_op = finish_op;
+    int		save_opcount = opcount;
 #ifdef FEAT_MBYTE
     char_u	*arg = NULL;
     int		l;
@@ -9040,6 +9041,7 @@ ex_normal(eap)
     restart_edit = save_restart_edit;
     p_im = save_insertmode;
     finish_op = save_finish_op;
+    opcount = save_opcount;
     msg_didout |= save_msg_didout;	/* don't reset msg_didout now */
 
     /* Restore the state (needed when called from a function executed for
diff --git a/src/globals.h b/src/globals.h
index b31e05436..dc3038d82 100644
--- a/src/globals.h
+++ b/src/globals.h
@@ -868,6 +868,7 @@ EXTERN int	State INIT(= NORMAL);	/* This is the current state of the
 					 * command interpreter. */
 
 EXTERN int	finish_op INIT(= FALSE);/* TRUE while an operator is pending */
+EXTERN int	opcount INIT(= 0);	/* count for pending operator */
 
 /*
  * ex mode (Q) state
diff --git a/src/normal.c b/src/normal.c
index 3c1c6f064..a1b3a945f 100644
--- a/src/normal.c
+++ b/src/normal.c
@@ -565,7 +565,6 @@ normal_cmd(oap, toplevel)
     oparg_T	*oap;
     int		toplevel;		/* TRUE when called from main() */
 {
-    static long	opcount = 0;		/* ca.opcount saved here */
     cmdarg_T	ca;			/* command arguments */
     int		c;
     int		ctrl_w = FALSE;		/* got CTRL-W command */
diff --git a/src/version.c b/src/version.c
index f6843cb0f..0535785e3 100644
--- a/src/version.c
+++ b/src/version.c
@@ -676,6 +676,8 @@ static char *(features[]) =
 
 static int included_patches[] =
 {   /* Add new patch number below this line */
+/**/
+    22,
 /**/
     21,
 /**/

