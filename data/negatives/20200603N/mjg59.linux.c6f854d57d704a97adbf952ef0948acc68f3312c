commit c6f854d57d704a97adbf952ef0948acc68f3312c
Author: Veaceslav Falico <vfalico@gmail.com>
Date:   Thu Jul 17 19:46:09 2014 +0200

    net: use dev->name in netdev_pr* when it's available
    
    netdev_name() returns dev->name only when the net_device is in
    NETREG_REGISTERED state.
    
    However, dev->name is always populated on creation, so we can easily use
    it.
    
    There are two cases when there's no real name - when it's an empty string
    or when the name is in form of "eth%d", then netdev_name() returns "unnamed
    net_device".
    
    CC: "David S. Miller" <davem@davemloft.net>
    CC: Tom Gundersen <teg@jklm.no>
    Signed-off-by: Veaceslav Falico <vfalico@gmail.com>
    Acked-by: Tom Gundersen <teg@jklm.no>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/include/linux/netdevice.h b/include/linux/netdevice.h
index 15ed750458ad..70256aa2ae81 100644
--- a/include/linux/netdevice.h
+++ b/include/linux/netdevice.h
@@ -3383,8 +3383,8 @@ extern struct pernet_operations __net_initdata loopback_net_ops;
 
 static inline const char *netdev_name(const struct net_device *dev)
 {
-	if (dev->reg_state != NETREG_REGISTERED)
-		return "(unregistered net_device)";
+	if (!dev->name[0] || strchr(dev->name, '%'))
+		return "(unnamed net_device)";
 	return dev->name;
 }
 

