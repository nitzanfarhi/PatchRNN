commit 742bf95284a093d51f1e84e887a474de2ba47292
Author: Thomas Roessler <roessler@does-not-exist.org>
Date:   Tue Dec 21 09:46:24 2004 +0000

    Fix Debian #275188.

diff --git a/pgp.c b/pgp.c
index 6ecf3e991..e13b4a9d6 100644
--- a/pgp.c
+++ b/pgp.c
@@ -830,6 +830,10 @@ int pgp_decrypt_mime (FILE *fpin, FILE **fpout, BODY *b, BODY **cur)
   *cur = pgp_decrypt_part (b, &s, *fpout, p);
 
   rewind (*fpout);
+  
+  if (!*cur) 
+    return -1;
+  
   return (0);
 }
 

