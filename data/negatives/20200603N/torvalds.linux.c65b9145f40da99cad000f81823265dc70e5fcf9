commit c65b9145f40da99cad000f81823265dc70e5fcf9
Author: Tejun Heo <tj@kernel.org>
Date:   Thu Nov 13 13:20:00 2008 +0900

    uevent: don't pass envp_ext[] as format string in kobject_uevent_env()
    
    kobject_uevent_env() uses envp_ext[] as verbatim format string which
    can cause problems ranging from unexpectedly mangled string to oops if
    a string in envp_ext[] contains substring which can be interpreted as
    format.  Fix it.
    
    Signed-off-by: Tejun Heo <tj@kernel.org>
    Cc: Kay Sievers <kay.sievers@vrfy.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

diff --git a/lib/kobject_uevent.c b/lib/kobject_uevent.c
index 3f914725bda8..ca215bc2329a 100644
--- a/lib/kobject_uevent.c
+++ b/lib/kobject_uevent.c
@@ -165,7 +165,7 @@ int kobject_uevent_env(struct kobject *kobj, enum kobject_action action,
 	/* keys passed in from the caller */
 	if (envp_ext) {
 		for (i = 0; envp_ext[i]; i++) {
-			retval = add_uevent_var(env, envp_ext[i]);
+			retval = add_uevent_var(env, "%s", envp_ext[i]);
 			if (retval)
 				goto exit;
 		}

