commit 4c34897aed0721ed6ea88168aa45579787534e25
Author: Igor Mammedov <imammedo@redhat.com>
Date:   Wed Oct 19 14:05:36 2016 +0200

    pc: apic_common: Restore APIC ID to initial ID on reset
    
    APIC ID should be restored to initial APIC ID
    state after Reset and Power-On.
    
    Signed-off-by: Igor Mammedov <imammedo@redhat.com>
    Reviewed-by: Eduardo Habkost <ehabkost@redhat.com>
    Signed-off-by: Eduardo Habkost <ehabkost@redhat.com>

diff --git a/hw/intc/apic_common.c b/hw/intc/apic_common.c
index 30f2af01e6..ea3c8caef5 100644
--- a/hw/intc/apic_common.c
+++ b/hw/intc/apic_common.c
@@ -243,6 +243,7 @@ static void apic_reset_common(DeviceState *dev)
 
     bsp = s->apicbase & MSR_IA32_APICBASE_BSP;
     s->apicbase = APIC_DEFAULT_ADDRESS | bsp | MSR_IA32_APICBASE_ENABLE;
+    s->id = s->initial_apic_id;
 
     s->vapic_paddr = 0;
     info->vapic_base_update(s);

