commit 02ec656af72030eea4f3d63e30b25625cce6a3df
Author: Luca Barbato <lu_zero@gentoo.org>
Date:   Sat Jun 29 02:16:50 2013 +0200

    wmapro: error out on impossible scale factor offsets
    
    Reported-by: Mateusz "j00ru" Jurczyk and Gynvael Coldwind
    CC: libav-stable@libav.org

diff --git a/libavcodec/wmaprodec.c b/libavcodec/wmaprodec.c
index 302f58a483..d3bd3816fa 100644
--- a/libavcodec/wmaprodec.c
+++ b/libavcodec/wmaprodec.c
@@ -436,7 +436,8 @@ static av_cold int decode_init(AVCodecContext *avctx)
             for (x = 0; x < num_possible_block_sizes; x++) {
                 int v = 0;
                 while (s->sfb_offsets[x][v + 1] << x < offset)
-                    ++v;
+                    if (++v >= MAX_BANDS)
+                        return AVERROR_INVALIDDATA;
                 s->sf_offsets[i][x][b] = v;
             }
         }

