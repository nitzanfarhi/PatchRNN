commit c8d1029d86a8ce8ba683ffbfbe17961e9cea29cf
Author: Sage Weil <sage@newdream.net>
Date:   Mon Jan 17 20:07:35 2011 -0800

    osd: avoid polluting peer_info with acting[0]
    
    This can confuse code that iterates over peer_info and finds the primary
    (with bad info).
    
    Signed-off-by: Sage Weil <sage@newdream.net>

diff --git a/src/osd/PG.cc b/src/osd/PG.cc
index 26acd3416a..ef178d30f0 100644
--- a/src/osd/PG.cc
+++ b/src/osd/PG.cc
@@ -1577,7 +1577,7 @@ void PG::do_peer(ObjectStore::Transaction& t, list<Context*>& tfin,
       osd->queue_generate_backlog(this);
       return;
     }
-    for (unsigned i=0; i<acting.size(); i++) {
+    for (unsigned i=1; i<acting.size(); i++) {
       int o = acting[i];
       Info& pi = peer_info[o];
       if (pi.last_complete < pi.log_tail && !pi.log_backlog &&

