commit 50d02c49b91c21b5520d7f48e0586f80c2c7d5f2
Author: Love Hörnquist Åstrand <lha@kth.se>
Date:   Sat Sep 13 09:43:32 2008 +0000

    Only claime configuration exists if the plugin returned some useful data.
    
    git-svn-id: svn://svn.h5l.se/heimdal/trunk/heimdal@23816 ec53bebd-3082-4978-b11e-865c3cabbd6b

diff --git a/lib/krb5/krbhst.c b/lib/krb5/krbhst.c
index 63e55bf0e..7348ac3f0 100644
--- a/lib/krb5/krbhst.c
+++ b/lib/krb5/krbhst.c
@@ -531,8 +531,6 @@ plugin_get_hosts(krb5_context context,
     if(ret != 0 || list == NULL)
 	return;
 
-    kd->flags |= KD_CONFIG_EXISTS;
-
     for (e = list; e != NULL; e = _krb5_plugin_get_next(e)) {
 	krb5plugin_service_locate_ftable *service;
 	void *ctx;
@@ -549,7 +547,9 @@ plugin_get_hosts(krb5_context context,
 				   N_("Locate plugin failed to lookup realm %s: %d", ""),
 				   kd->realm, ret);
 	    break;
-	}
+	} else if (ret == 0)
+	    kd->flags |= KD_CONFIG_EXISTS;
+
     }
     _krb5_plugin_free(list);
 }

