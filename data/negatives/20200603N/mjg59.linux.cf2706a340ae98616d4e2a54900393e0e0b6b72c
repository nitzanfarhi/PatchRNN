commit cf2706a340ae98616d4e2a54900393e0e0b6b72c
Author: Al Viro <viro@zeniv.linux.org.uk>
Date:   Tue Apr 7 09:03:30 2009 -0400

    Fix AUTOFS_DEV_IOCTL_REQUESTER_CMD
    
    Missing conversion from kernel to userland dev_t; this sucker
    breaks as soon as we get sufficiently many autofs mounts for
    new_encode_dev(s_dev) != s_dev.
    
    Note: this is the minimal fix.
    
    Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>

diff --git a/fs/autofs4/dev-ioctl.c b/fs/autofs4/dev-ioctl.c
index 9e5ae8a4f5c8..463f798f71b3 100644
--- a/fs/autofs4/dev-ioctl.c
+++ b/fs/autofs4/dev-ioctl.c
@@ -488,7 +488,7 @@ static int autofs_dev_ioctl_requester(struct file *fp,
 	}
 
 	path = param->path;
-	devid = sbi->sb->s_dev;
+	devid = new_encode_dev(sbi->sb->s_dev);
 
 	param->requester.uid = param->requester.gid = -1;
 

