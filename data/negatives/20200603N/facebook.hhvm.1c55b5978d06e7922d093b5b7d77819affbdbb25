commit 1c55b5978d06e7922d093b5b7d77819affbdbb25
Author: Mark Williams <mwilliams@fb.com>
Date:   Fri Mar 24 16:02:37 2017 -0700

    Set the srcLoc when generating switches
    
    Summary:
    Otherwise, if the first thing in the pseudomain is a switch, we
    trigger an assert on the emitting next bytecode.
    
    Reviewed By: swtaarrs
    
    Differential Revision: D4770279
    
    fbshipit-source-id: 8c09bfda0fab7c7c52ffc98a5a90519bbda02085

diff --git a/hphp/hhbbc/cfg-opts.cpp b/hphp/hhbbc/cfg-opts.cpp
index 04de859ed2..bc9a28f435 100644
--- a/hphp/hhbbc/cfg-opts.cpp
+++ b/hphp/hhbbc/cfg-opts.cpp
@@ -310,9 +310,11 @@ bool buildSwitches(php::Func& func,
         } else {
           it -= 2;
         }
+        bc.srcLoc = it->srcLoc;
         blkInfos[switchInfo.defaultBlock].multiplePreds = true;
         blk->hhbcs.erase(it, blk->hhbcs.end());
         blk->hhbcs.emplace_back(bc::CGetL { switchInfo.switchLoc });
+        blk->hhbcs.back().srcLoc = bc.srcLoc;
         blk->hhbcs.push_back(std::move(bc));
         blk->fallthrough = NoBlockId;
         for (auto id : blocks) {

