commit 0ab82b04ac83a05bda3ef8499f415fc6fd6ee206
Author: Eliad Peller <eliad@wizery.com>
Date:   Fri Dec 3 02:16:23 2010 +0200

    mac80211: fix dynamic-ps/pm_qos magic numbers
    
    mac80211 uses pm_qos (/dev/network_latency) in order to determine the
    dynamic ps timeout (or disable the dynamic-ps at all in some cases).
    
    commit ff616381 added a comparison for the current network_latency
    against one high value (1900ms), and against the default value
    (2000sec, rather than the commented 2sec).
    
    however, the representation of 1900ms was incorrect:
    1900ms = 1900000us ( != 1900000000 )
    
    fix it by using USEC_TO_MSEC/SEC consts.
    
    Signed-off-by: Eliad Peller <eliad@wizery.com>
    Signed-off-by: John W. Linville <linville@tuxdriver.com>

diff --git a/net/mac80211/mlme.c b/net/mac80211/mlme.c
index 3a1dde3c7956..59e2e06aa4e9 100644
--- a/net/mac80211/mlme.c
+++ b/net/mac80211/mlme.c
@@ -625,11 +625,12 @@ void ieee80211_recalc_ps(struct ieee80211_local *local, s32 latency)
 			/*
 			 * Go to full PSM if the user configures a very low
 			 * latency requirement.
-			 * The 2 second value is there for compatibility until
-			 * the PM_QOS_NETWORK_LATENCY is configured with real
-			 * values.
+			 * The 2000 second value is there for compatibility
+			 * until the PM_QOS_NETWORK_LATENCY is configured
+			 * with real values.
 			 */
-			if (latency > 1900000000 && latency != 2000000000)
+			if (latency > (1900 * USEC_PER_MSEC) &&
+			    latency != (2000 * USEC_PER_SEC))
 				timeout = 0;
 			else
 				timeout = 100;

