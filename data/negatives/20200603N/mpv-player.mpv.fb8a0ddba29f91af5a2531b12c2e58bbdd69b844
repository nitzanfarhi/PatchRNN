commit fb8a0ddba29f91af5a2531b12c2e58bbdd69b844
Author: nicodvb <nicodvb@b3059339-0415-0410-9bf9-f77b7e298cf2>
Date:   Sun Jan 30 09:13:28 2005 +0000

    discard lavf packets with wrong ids
    
    
    git-svn-id: svn://svn.mplayerhq.hu/mplayer/trunk@14612 b3059339-0415-0410-9bf9-f77b7e298cf2

diff --git a/libmpdemux/demux_lavf.c b/libmpdemux/demux_lavf.c
index e0474dd1e9..d96aebb893 100644
--- a/libmpdemux/demux_lavf.c
+++ b/libmpdemux/demux_lavf.c
@@ -292,8 +292,10 @@ int demux_lavf_fill_buffer(demuxer_t *demux){
             ds->sh=demux->v_streams[id];
             mp_msg(MSGT_DEMUX,MSGL_V,"Auto-selected LAVF video ID = %d\n",ds->id);
         }
-    } else
-        ds= NULL;
+    } else {
+        av_free_packet(&pkt);
+        return 1;
+    }
         
     if(0/*pkt.destruct == av_destruct_packet*/){
         //ok kids, dont try this at home :)

