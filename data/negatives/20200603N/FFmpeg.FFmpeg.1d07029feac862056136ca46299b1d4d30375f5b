commit 1d07029feac862056136ca46299b1d4d30375f5b
Author: Justin Ruggles <justin.ruggles@gmail.com>
Date:   Fri Sep 4 21:38:45 2009 +0000

    Add frame_size as a codec parameter requirement for Speex in
    av_find_stream_info().  It forces decoding of a packet when there is no
    Speex header in order to determine the correct frame size.
    
    Originally committed as revision 19760 to svn://svn.ffmpeg.org/ffmpeg/trunk

diff --git a/libavformat/utils.c b/libavformat/utils.c
index 4cec2863f3..59fefd2913 100644
--- a/libavformat/utils.c
+++ b/libavformat/utils.c
@@ -1862,7 +1862,8 @@ static int has_codec_parameters(AVCodecContext *enc)
         val = enc->sample_rate && enc->channels && enc->sample_fmt != SAMPLE_FMT_NONE;
         if(!enc->frame_size &&
            (enc->codec_id == CODEC_ID_VORBIS ||
-            enc->codec_id == CODEC_ID_AAC))
+            enc->codec_id == CODEC_ID_AAC ||
+            enc->codec_id == CODEC_ID_SPEEX))
             return 0;
         break;
     case CODEC_TYPE_VIDEO:

