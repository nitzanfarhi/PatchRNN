commit a646bd81945b337b1cf37dea4734847947a0d9ad
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Sat Oct 5 13:57:53 2013 -0700

    Bluetooth: Check for non BR/EDR controller in AMP discover response
    
    Within the AMP discover response, all controllers that are not the
    primary BR/EDR controller are valid.
    
    Signed-off-by: Marcel Holtmann <marcel@holtmann.org>
    Signed-off-by: Johan Hedberg <johan.hedberg@intel.com>

diff --git a/net/bluetooth/a2mp.c b/net/bluetooth/a2mp.c
index 529789d81159..ad8bda3a6fd1 100644
--- a/net/bluetooth/a2mp.c
+++ b/net/bluetooth/a2mp.c
@@ -210,7 +210,7 @@ static int a2mp_discover_rsp(struct amp_mgr *mgr, struct sk_buff *skb,
 		BT_DBG("Remote AMP id %d type %d status %d", cl->id, cl->type,
 		       cl->status);
 
-		if (cl->id != AMP_ID_BREDR && cl->type == HCI_AMP) {
+		if (cl->id != AMP_ID_BREDR && cl->type != AMP_TYPE_BREDR) {
 			struct a2mp_info_req req;
 
 			found = true;

