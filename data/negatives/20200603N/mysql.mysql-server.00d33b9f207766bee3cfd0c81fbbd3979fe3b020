commit 00d33b9f207766bee3cfd0c81fbbd3979fe3b020
Author: Jimmy Yang <jimmy.yang@oracle.com>
Date:   Wed Jul 5 11:17:34 2017 +0800

    A follow up fix for flush log for trx->ddl_operation marked trx

diff --git a/storage/innobase/trx/trx0trx.cc b/storage/innobase/trx/trx0trx.cc
index 9af85c55726..ae7542a7a6b 100644
--- a/storage/innobase/trx/trx0trx.cc
+++ b/storage/innobase/trx/trx0trx.cc
@@ -2049,9 +2049,10 @@ trx_commit_in_memory(
 			/* if we need to flush log later, we must
 			remember the DDL operation */
 			trx->ddl_must_flush = trx->ddl_operation;
-		} else if (srv_flush_log_at_trx_commit == 0
-			   || thd_requested_durability(trx->mysql_thd)
-			   == HA_IGNORE_DURABILITY) {
+		} else if ((srv_flush_log_at_trx_commit == 0
+			    || thd_requested_durability(trx->mysql_thd)
+			    == HA_IGNORE_DURABILITY)
+			   && (!trx->ddl_operation)) {
 			/* Do nothing */
 		} else {
 			trx_flush_log_if_needed(lsn, trx);

