commit f293d98f8ffbb768026f0afaa67eae96c4f4d8dc
Author: anwleung <anwleung@29311d96-e01e-0410-9327-a35deaab8ce9>
Date:   Thu Mar 1 20:55:54 2007 +0000

    Cleaned up the mon key gen
    
    
    git-svn-id: https://ceph.svn.sf.net/svnroot/ceph@1152 29311d96-e01e-0410-9327-a35deaab8ce9

diff --git a/branches/aleung/security1/ceph/mon/MonMap.h b/branches/aleung/security1/ceph/mon/MonMap.h
index 6f4d9117bf..06c3a7c289 100644
--- a/branches/aleung/security1/ceph/mon/MonMap.h
+++ b/branches/aleung/security1/ceph/mon/MonMap.h
@@ -37,11 +37,12 @@ class MonMap {
   
   void generate_key_pair(string& private_key) {
     esignPriv tempKey = esignPrivKey("crypto/esig1536.dat");
+    private_key = privToString(tempKey);
     pub_key = esignPubKey(tempKey);
     pub_str_key = pubToString(pub_key);
     // now throw away the private key
     keyConvert = false;
-    assert(0); // FIXME
+    //assert(0); // FIXME
   }
 
 
diff --git a/branches/aleung/security1/ceph/mon/Monitor.cc b/branches/aleung/security1/ceph/mon/Monitor.cc
index a9dd22f2e6..548246cbf6 100644
--- a/branches/aleung/security1/ceph/mon/Monitor.cc
+++ b/branches/aleung/security1/ceph/mon/Monitor.cc
@@ -44,9 +44,11 @@
 void Monitor::set_new_private_key(string& pk)
 {
   dout(10) << "set_new_private_key" << endl;
-
+  myPrivKey = _fromStr_esignPrivKey(pk);
+  myPubKey = esignPubKey(myPrivKey);
+  
   // FIXME.
-  assert(0);
+  //assert(0);
 }
 
 void Monitor::init()

