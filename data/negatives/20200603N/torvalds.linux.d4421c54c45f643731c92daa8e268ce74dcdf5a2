commit d4421c54c45f643731c92daa8e268ce74dcdf5a2
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Thu Aug 20 17:02:40 2015 +0800

    crypto: hash - Add AHASH_REQUEST_ON_STACK
    
    This patch adds the helper AHASH_REQUEST_ON_STACK for those users
    of ahash that are synchronous only.
    
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

diff --git a/include/crypto/hash.h b/include/crypto/hash.h
index 57c8a6ee33c2..8e920b44c0ac 100644
--- a/include/crypto/hash.h
+++ b/include/crypto/hash.h
@@ -63,6 +63,11 @@ struct ahash_request {
 	void *__ctx[] CRYPTO_MINALIGN_ATTR;
 };
 
+#define AHASH_REQUEST_ON_STACK(name, ahash) \
+	char __##name##_desc[sizeof(struct ahash_request) + \
+		crypto_ahash_reqsize(ahash)] CRYPTO_MINALIGN_ATTR; \
+	struct ahash_request *name = (void *)__##name##_desc
+
 /**
  * struct ahash_alg - asynchronous message digest definition
  * @init: Initialize the transformation context. Intended only to initialize the

