commit 1ce86743044a2795b0b659bfab24bafbc7375224
Author: Gerardo Ganis <gerardo.ganis@cern.ch>
Date:   Wed Jul 6 11:25:16 2005 +0000

    Do not allow special chars in passwords

diff --git a/src/XrdSut/XrdSutAux.cc b/src/XrdSut/XrdSutAux.cc
index 0c216304..2519ea8c 100644
--- a/src/XrdSut/XrdSutAux.cc
+++ b/src/XrdSut/XrdSutAux.cc
@@ -144,10 +144,13 @@ int XrdSutGetPass(const char *prompt, XrdOucString &passwd)
 
    char *pw = getpass(prompt);
    if (pw) {
-      if (pw[strlen(pw)-1] == '\n')
-         pw[strlen(pw) - 1] = 0;   // get rid of \n
+      // Get rid of special chars, if any
+      int k = 0, i = 0, len = strlen(pw);
+      for (; i<len ; i++)
+         if (pw[i] > 0x20) pw[k++] = pw[i];
+      pw[k] = 0;
       passwd = pw;
-      XrdSutMemSet((volatile void *)pw,0,strlen(pw));
+      XrdSutMemSet((volatile void *)pw,0,len);
    } else {
       DEBUG("error from getpass");
       return -1;

