commit 1cd4fa7546c21d92acdda72d33e029e8a01ab0ba
Author: tomas@whalegate.ndb.mysql.com <>
Date:   Wed Jul 11 14:58:06 2007 +0200

    correct merge

diff --git a/storage/ndb/src/common/debugger/EventLogger.cpp b/storage/ndb/src/common/debugger/EventLogger.cpp
index eb927929104..9487c1ee89c 100644
--- a/storage/ndb/src/common/debugger/EventLogger.cpp
+++ b/storage/ndb/src/common/debugger/EventLogger.cpp
@@ -52,8 +52,8 @@ void getTextConnectedApiVersion(QQQQ) {
   BaseString::snprintf(m_text, m_text_len, 
 		       "Node %u: API %s",
 		       theData[1],
-		       getVersionString(theData[2], mysql_version, 0,
-					tmp, sizeof(tmp)));
+		       ndbGetVersionString(theData[2], mysql_version, 0,
+                                           tmp, sizeof(tmp)));
 }
 
 void getTextDisconnected(QQQQ) {
@@ -88,8 +88,8 @@ void getTextNDBStartStarted(QQQQ) {
     mysql_version = 0;
   BaseString::snprintf(m_text, m_text_len, 
 		       "Start initiated (%s)", 
-		       getVersionString(theData[1], mysql_version, 0,
-					tmp, sizeof(tmp)));
+		       ndbGetVersionString(theData[1], mysql_version, 0,
+                                           tmp, sizeof(tmp)));
 }
 void getTextNDBStopStarted(QQQQ) {
   BaseString::snprintf(m_text, m_text_len,
@@ -163,8 +163,8 @@ void getTextNDBStartCompleted(QQQQ) {
     mysql_version = 0;
   BaseString::snprintf(m_text, m_text_len, 
 		       "Started (%s)", 
-		       getVersionString(theData[1], mysql_version, 0,
-					tmp, sizeof(tmp)));
+		       ndbGetVersionString(theData[1], mysql_version, 0,
+                                           tmp, sizeof(tmp)));
 }
 
 void getTextSTTORRYRecieved(QQQQ) {
diff --git a/storage/ndb/src/common/util/version.c b/storage/ndb/src/common/util/version.c
index f216954b5b9..6e67b124325 100644
--- a/storage/ndb/src/common/util/version.c
+++ b/storage/ndb/src/common/util/version.c
@@ -48,6 +48,7 @@ const char * ndbGetOwnVersionString()
 const char * ndbGetVersionString(Uint32 version, Uint32 mysql_version, const char * status,
                                  char *buf, unsigned sz)
 {
+  char tmp[NDB_VERSION_STRING_BUF_SZ];
   if (status && status[0] != 0)
     basestring_snprintf(tmp, sizeof(tmp), "%s", status);
   else
diff --git a/storage/ndb/src/mgmclient/CommandInterpreter.cpp b/storage/ndb/src/mgmclient/CommandInterpreter.cpp
index 0e6814b70ad..02ab728a73d 100644
--- a/storage/ndb/src/mgmclient/CommandInterpreter.cpp
+++ b/storage/ndb/src/mgmclient/CommandInterpreter.cpp
@@ -1598,10 +1598,10 @@ print_nodes(ndb_mgm_cluster_state *state, ndb_mgm_configuration_iterator *it,
 	  ndbout << "\t@" << hostname;
 
 	char tmp[100];
-	ndbout << "  (" << getVersionString(node_state->version,
-					    node_state->mysql_version,
-					    0,
-					    tmp, sizeof(tmp));
+	ndbout << "  (" << ndbGetVersionString(node_state->version,
+                                               node_state->mysql_version,
+                                               0,
+                                               tmp, sizeof(tmp));
 	if (type == NDB_MGM_NODE_TYPE_NDB) {
 	  if (node_state->node_status != NDB_MGM_NODE_STATUS_STARTED) {
 	    ndbout << ", " << status_string(node_state->node_status);
@@ -2345,7 +2345,7 @@ CommandInterpreter::executeStatus(int processId,
   
   char tmp[100];
   if(status != NDB_MGM_NODE_STATUS_NO_CONTACT)
-    ndbout_c(" (%s)", getVersionString(version, mysql_version, 0, tmp, sizeof(tmp))); 
+    ndbout_c(" (%s)", ndbGetVersionString(version, mysql_version, 0, tmp, sizeof(tmp))); 
   else
     ndbout << endl;
   

