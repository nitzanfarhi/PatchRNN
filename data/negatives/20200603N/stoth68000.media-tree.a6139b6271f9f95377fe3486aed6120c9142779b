commit a6139b6271f9f95377fe3486aed6120c9142779b
Author: Amitkumar Karwar <akarwar@marvell.com>
Date:   Tue Feb 23 05:16:17 2016 -0800

    mwifiex: fix corner case association failure
    
    This patch corrects the error case in association path by returning
    -1. Earlier "media_connected" used to remain on in this error case
    causing failure for further association attempts.
    
    Signed-off-by: Amitkumar Karwar <akarwar@marvell.com>
    Fixes: b887664d882ee4 ('mwifiex: channel switch handling for station')
    Signed-off-by: Cathy Luo <cluo@marvell.com>
    Signed-off-by: Kalle Valo <kvalo@codeaurora.org>

diff --git a/drivers/net/wireless/marvell/mwifiex/sta_ioctl.c b/drivers/net/wireless/marvell/mwifiex/sta_ioctl.c
index 5cbee58f8781..d5c56eb9e985 100644
--- a/drivers/net/wireless/marvell/mwifiex/sta_ioctl.c
+++ b/drivers/net/wireless/marvell/mwifiex/sta_ioctl.c
@@ -314,6 +314,7 @@ int mwifiex_bss_start(struct mwifiex_private *priv, struct cfg80211_bss *bss,
 			mwifiex_dbg(adapter, ERROR,
 				    "Attempt to reconnect on csa closed chan(%d)\n",
 				    bss_desc->channel);
+			ret = -1;
 			goto done;
 		}
 

