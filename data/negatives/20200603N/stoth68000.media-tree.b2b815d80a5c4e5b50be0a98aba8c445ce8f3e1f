commit b2b815d80a5c4e5b50be0a98aba8c445ce8f3e1f
Author: Mike Travis <travis@sgi.com>
Date:   Fri Jan 16 15:22:16 2009 -0800

    x86: put trigger in to detect mismatched apic versions
    
    Impact: add debug warning
    
    Fire off one message if two apic's discovered with different
    apic versions. (this code is only called during CPU init)
    
    The goal of this is to pave the way of the removal of the apic_version[]
    array. We dont expect any apic version incompatibilities in the x86
    landscape of systems [if so we dont handle them very well and probably
    never will handle deep apic version assymetries well], but it's prudent
    to have a debug check for one kernel cycle nevertheless.
    
    Signed-off-by: Mike Travis <travis@sgi.com>
    Signed-off-by: Ingo Molnar <mingo@elte.hu>

diff --git a/arch/x86/kernel/apic.c b/arch/x86/kernel/apic.c
index d19aa3aab62b..4b6df2469fe3 100644
--- a/arch/x86/kernel/apic.c
+++ b/arch/x86/kernel/apic.c
@@ -1837,6 +1837,11 @@ void __cpuinit generic_processor_info(int apicid, int version)
 	num_processors++;
 	cpu = cpumask_next_zero(-1, cpu_present_mask);
 
+	if (version != apic_version[boot_cpu_physical_apicid])
+		WARN_ONCE(1,
+			"ACPI: apic version mismatch, bootcpu: %x cpu %d: %x\n",
+			apic_version[boot_cpu_physical_apicid], cpu, version);
+
 	physid_set(apicid, phys_cpu_present_map);
 	if (apicid == boot_cpu_physical_apicid) {
 		/*

