commit 49de302c8468bef63e38d6683e836abc6ea9ab5f
Author: Guy Harris <guy@alum.mit.edu>
Date:   Tue Apr 2 01:32:11 2002 +0000

    Use "tvb_memcpy()", not "tvb_get_ptr()" followed by "memcpy()".
    
    svn path=/trunk/; revision=5081

diff --git a/packet-zebra.c b/packet-zebra.c
index fbfa4965f5..b47cfbe3ca 100644
--- a/packet-zebra.c
+++ b/packet-zebra.c
@@ -3,7 +3,7 @@
  *
  * Jochen Friedrich <jochen@scram.de>
  *
- * $Id: packet-zebra.c,v 1.20 2002/01/24 09:20:54 guy Exp $
+ * $Id: packet-zebra.c,v 1.21 2002/04/02 01:32:11 guy Exp $
  *
  * Ethereal - Network traffic analyzer
  * By Gerald Combs <gerald@ethereal.com>
@@ -195,7 +195,6 @@ dissect_zebra_request(proto_tree *tree, gboolean request, tvbuff_t *tvb,
 	guint32	prefix4;
 	guint16 i;
 	guint8  buffer6[16], prefixlen, message;
-	const guint8 *prefix;
 	proto_item *ti;
 	proto_tree *msg_tree;
 
@@ -312,9 +311,8 @@ dissect_zebra_request(proto_tree *tree, gboolean request, tvbuff_t *tvb,
 				 offset, 1, prefixlen);
 			offset += 1;
 
-			prefix = tvb_get_ptr(tvb, offset, PSIZE(prefixlen));
 			prefix4 = 0;
-			memcpy(&prefix4, prefix,
+			tvb_memcpy(tvb, (guint8 *)&prefix4, offset,
 			    MIN((unsigned) PSIZE(prefixlen), sizeof prefix4));
 			proto_tree_add_ipv4(tree, hf_zebra_prefix4,
 				tvb, offset, PSIZE(prefixlen), prefix4);
@@ -390,9 +388,8 @@ dissect_zebra_request(proto_tree *tree, gboolean request, tvbuff_t *tvb,
 				 offset, 1, prefixlen);
 			offset += 1;
 
-			prefix = tvb_get_ptr(tvb, offset, PSIZE(prefixlen));
 			memset(buffer6, '\0', sizeof buffer6);
-			memcpy(buffer6, prefix,
+			tvb_memcpy(tvb, buffer6, offset,
 			    MIN((unsigned) PSIZE(prefixlen), sizeof buffer6));
 			proto_tree_add_ipv6(tree, hf_zebra_prefix6,
 				tvb, offset, PSIZE(prefixlen), buffer6);

