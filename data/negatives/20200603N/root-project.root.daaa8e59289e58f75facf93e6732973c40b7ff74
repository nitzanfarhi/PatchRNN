commit daaa8e59289e58f75facf93e6732973c40b7ff74
Author: Fons Rademakers <Fons.Rademakers@cern.ch>
Date:   Thu Apr 27 15:49:34 2006 +0000

    From Bertrand:
    fix for handling ESC key.
    
    
    git-svn-id: http://root.cern.ch/svn/root/trunk@14866 27541ba8-7e3a-0410-8455-c3a389f83636

diff --git a/win32gdk/gdk/src/gdk/win32/gdkevents-win32.c b/win32gdk/gdk/src/gdk/win32/gdkevents-win32.c
index 0d7b6e1b70..e6d68c62eb 100644
--- a/win32gdk/gdk/src/gdk/win32/gdkevents-win32.c
+++ b/win32gdk/gdk/src/gdk/win32/gdkevents-win32.c
@@ -5307,13 +5307,23 @@ gdk_event_translate(GdkEvent * event,
       }
 
       is_AltGr_key = FALSE;
-      event->key.type = ((xevent->message == WM_KEYDOWN
-                          || xevent->message == WM_SYSKEYDOWN) ?
-                         GDK_KEY_PRESS : GDK_KEY_RELEASE);
+      event->key.window = window;
+      event->key.type = ((xevent->message == WM_KEYDOWN || 
+                          xevent->message == WM_SYSKEYDOWN) ?
+                          GDK_KEY_PRESS : GDK_KEY_RELEASE);
       event->type = event->key.type;
       event->key.time = xevent->time;
       event->key.string = NULL;
       event->key.length = 0;
+      if (event->key.keyval == GDK_Escape) {
+         event->key.length = 1;
+         event->key.string = g_strdup ("\033");
+      }
+      else if (event->key.keyval == GDK_Return ||
+	            event->key.keyval == GDK_KP_Enter) {
+         event->key.length = 1;
+         event->key.string = g_strdup ("\r");
+      }
       return_val = !GDK_DRAWABLE_DESTROYED(window);
       break;
 

