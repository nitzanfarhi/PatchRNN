commit 923c2b375b4c8cefb3f05e8a5167879135b7d8c4
Author: Erik de Castro Lopo <erikd@mega-nerd.com>
Date:   Sun Sep 4 13:47:16 2011 +1000

    Make sure 23 bit PCM SD2 files are readable/writeable.

diff --git a/src/sd2.c b/src/sd2.c
index 9ef10a91..35ce36b3 100644
--- a/src/sd2.c
+++ b/src/sd2.c
@@ -149,6 +149,7 @@ sd2_open (SF_PRIVATE *psf)
 	{	case SF_FORMAT_PCM_S8 :	/* 8-bit linear PCM. */
 		case SF_FORMAT_PCM_16 :	/* 16-bit linear PCM. */
 		case SF_FORMAT_PCM_24 :	/* 24-bit linear PCM */
+		case SF_FORMAT_PCM_32 :	/* 32-bit linear PCM */
 				error = pcm_init (psf) ;
 				break ;
 
@@ -620,6 +621,10 @@ parse_str_rsrc (SF_PRIVATE *psf, SD2_RSRC * rsrc)
 			psf->sf.format = SF_FORMAT_SD2 | SF_FORMAT_PCM_24 ;
 			break ;
 
+		case 4 :
+			psf->sf.format = SF_FORMAT_SD2 | SF_FORMAT_PCM_32 ;
+			break ;
+
 		default :
 			psf_log_printf (psf, "Bad sample size (%d)\n", rsrc->sample_size) ;
 			return SFE_SD2_BAD_SAMPLE_SIZE ;
diff --git a/src/sndfile.c b/src/sndfile.c
index d88a16cb..1e2af298 100644
--- a/src/sndfile.c
+++ b/src/sndfile.c
@@ -782,7 +782,7 @@ sf_format_check	(const SF_INFO *info)
 				/* SD2 is strictly big endian. */
 				if (endian == SF_ENDIAN_LITTLE || endian == SF_ENDIAN_CPU)
 					return 0 ;
-				if (subformat == SF_FORMAT_PCM_S8 || subformat == SF_FORMAT_PCM_16 || subformat == SF_FORMAT_PCM_24)
+				if (subformat == SF_FORMAT_PCM_S8 || subformat == SF_FORMAT_PCM_16 || subformat == SF_FORMAT_PCM_24 || subformat == SF_FORMAT_PCM_32)
 					return 1 ;
 				break ;
 

