commit 461a0ffbec1bcea896bd5daf1a98a18232a1e9c7
Author: Steven Rostedt <rostedt@goodmis.org>
Date:   Wed Oct 19 08:22:13 2005 -0400

    [PATCH] scsi_error thread exits in TASK_INTERRUPTIBLE state.
    
    Found in the -rt patch set.  The scsi_error thread likely will be in the
    TASK_INTERRUPTIBLE state upon exit.  This patch fixes this bug.
    
    Signed-off-by: Steven Rostedt <rostedt@goodmis.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

diff --git a/drivers/scsi/scsi_error.c b/drivers/scsi/scsi_error.c
index ad5342165079..52b348c36d56 100644
--- a/drivers/scsi/scsi_error.c
+++ b/drivers/scsi/scsi_error.c
@@ -1645,6 +1645,8 @@ int scsi_error_handler(void *data)
 		set_current_state(TASK_INTERRUPTIBLE);
 	}
 
+	__set_current_state(TASK_RUNNING);
+
 	SCSI_LOG_ERROR_RECOVERY(1, printk("Error handler scsi_eh_%d"
 					  " exiting\n",shost->host_no));
 

