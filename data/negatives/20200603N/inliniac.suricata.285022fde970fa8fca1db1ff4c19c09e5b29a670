commit 285022fde970fa8fca1db1ff4c19c09e5b29a670
Author: Mats Klepsland <mats.klepsland@gmail.com>
Date:   Tue Oct 13 14:44:06 2015 +0200

    output-json-tls: added SNI field to extended output
    
    Added SNI field to extended JSON output.

diff --git a/src/output-json-tls.c b/src/output-json-tls.c
index 4cbd21ae..d8b8078f 100644
--- a/src/output-json-tls.c
+++ b/src/output-json-tls.c
@@ -92,6 +92,12 @@ void JsonTlsLogJSONExtended(json_t *tjs, SSLState * state)
     json_object_set_new(tjs, "fingerprint",
                         json_string(state->server_connp.cert0_fingerprint));
 
+    /* tls.sni */
+    if (state->client_connp.sni) {
+        json_object_set_new(tjs, "sni",
+                            json_string(state->client_connp.sni));
+    }
+
     /* tls.version */
     switch (state->server_connp.version) {
         case TLS_VERSION_UNKNOWN:

