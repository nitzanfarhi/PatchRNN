commit 21a36f4840b1f816364ca91e693619ae03266f08
Author: Con Kolivas <kernel@kolivas.org>
Date:   Sat Mar 16 00:04:30 2013 +1100

    Connect backup stratum pools if the primary pool cannot deliver work.

diff --git a/cgminer.c b/cgminer.c
index 6e47b43c..43fd63b0 100644
--- a/cgminer.c
+++ b/cgminer.c
@@ -4899,6 +4899,8 @@ static bool cnx_needed(struct pool *pool)
 	 * it. */
 	if (pool_strategy == POOL_FAILOVER && pool->prio < cp_prio())
 		return true;
+	if (pool_unworkable(cp))
+		return true;
 	return false;
 }
 

