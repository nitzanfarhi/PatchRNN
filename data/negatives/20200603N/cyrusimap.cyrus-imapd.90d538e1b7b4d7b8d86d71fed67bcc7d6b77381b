commit 90d538e1b7b4d7b8d86d71fed67bcc7d6b77381b
Author: Bron Gondwana <brong@fastmail.fm>
Date:   Tue May 24 22:38:37 2016 +1000

    mboxevent: check that item numbers are correct!

diff --git a/imap/mboxevent.c b/imap/mboxevent.c
index 9489c52be..dcf40b510 100644
--- a/imap/mboxevent.c
+++ b/imap/mboxevent.c
@@ -296,6 +296,11 @@ EXPORTED struct mboxevent *mboxevent_new(enum event_type type)
     mboxevent = xmalloc(sizeof(struct mboxevent));
     memcpy(mboxevent, &event_template, sizeof(struct mboxevent));
 
+    unsigned i;
+    for (i = 0; mboxevent->params[i].id; i++) {
+        assert(i == mboxevent->params[i].id);
+    }
+
     mboxevent->type = type;
 
     /* From RFC 5423:

