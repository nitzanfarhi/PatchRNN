commit bfaf618b08c188939cc174d4b73d5b83a5cf169a
Author: Derick Rethans <derick@php.net>
Date:   Fri Apr 18 17:55:45 2003 +0000

    - Revert my symbol fix patch, and merge in Stas' fixes to Zend Engine 1.

diff --git a/Zend/zend.h b/Zend/zend.h
index 156c9109f8..a2212446ff 100644
--- a/Zend/zend.h
+++ b/Zend/zend.h
@@ -114,7 +114,7 @@ const char *zend_mh_bundle_error(void);
 #elif defined(HAVE_MACH_O_DYLD_H)
 # define DL_LOAD(libname)			zend_mh_bundle_load(libname)
 # define DL_UNLOAD(handle)			zend_mh_bundle_unload(handle)
-# define DL_FETCH_SYMBOL(h,s)		zend_mh_bundle_symbol(h,"_" s)
+# define DL_FETCH_SYMBOL(h,s)		zend_mh_bundle_symbol(h,s)
 # define DL_ERROR					zend_mh_bundle_error
 # define DL_HANDLE					void *
 # define ZEND_EXTENSIONS_SUPPORT	1
diff --git a/Zend/zend_extensions.c b/Zend/zend_extensions.c
index 9e5020d2e8..a1372dff2c 100644
--- a/Zend/zend_extensions.c
+++ b/Zend/zend_extensions.c
@@ -42,7 +42,13 @@ int zend_load_extension(char *path)
 	}
 
 	extension_version_info = (zend_extension_version_info *) DL_FETCH_SYMBOL(handle, "extension_version_info");
+	if (!extension_version_info) {
+		extension_version_info = (zend_extension_version_info *) DL_FETCH_SYMBOL(handle, "_extension_version_info");
+	}
 	new_extension = (zend_extension *) DL_FETCH_SYMBOL(handle, "zend_extension_entry");
+	if (!new_extension) {
+		new_extension = (zend_extension *) DL_FETCH_SYMBOL(handle, "_zend_extension_entry");
+	}
 	if (!extension_version_info || !new_extension) {
 		fprintf(stderr, "%s doesn't appear to be a valid Zend extension\n", path);
 		DL_UNLOAD(handle);

