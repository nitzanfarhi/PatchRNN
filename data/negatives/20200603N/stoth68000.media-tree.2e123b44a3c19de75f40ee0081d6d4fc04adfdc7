commit 2e123b44a3c19de75f40ee0081d6d4fc04adfdc7
Author: Michael S. Tsirkin <mst@redhat.com>
Date:   Wed Mar 8 02:14:25 2017 +0200

    virtio_net: enable big packets for large MTU values
    
    If one enables e.g. jumbo frames without mergeable
    buffers, packets won't fit in 1500 byte buffers
    we use. Switch to big packet mode instead.
    TODO: make sizing more exact, possibly extend small
    packet mode to use larger pages.
    
    Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

diff --git a/drivers/net/virtio_net.c b/drivers/net/virtio_net.c
index ea9890d61967..006f1a603102 100644
--- a/drivers/net/virtio_net.c
+++ b/drivers/net/virtio_net.c
@@ -2367,6 +2367,10 @@ static int virtnet_probe(struct virtio_device *vdev)
 			dev->mtu = mtu;
 			dev->max_mtu = mtu;
 		}
+
+		/* TODO: size buffers correctly in this case. */
+		if (dev->mtu > ETH_DATA_LEN)
+			vi->big_packets = true;
 	}
 
 	if (vi->any_header_sg)

