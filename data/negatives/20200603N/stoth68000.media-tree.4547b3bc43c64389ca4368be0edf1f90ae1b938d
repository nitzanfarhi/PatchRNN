commit 4547b3bc43c64389ca4368be0edf1f90ae1b938d
Author: Gao feng <gaofeng@cn.fujitsu.com>
Date:   Fri Nov 1 19:34:44 2013 +0800

    audit: use old_lock in audit_set_feature
    
    we already have old_lock, no need to calculate it again.
    
    Acked-by: Eric Paris <eparis@redhat.com>
    Signed-off-by: Gao feng <gaofeng@cn.fujitsu.com>
    Signed-off-by: Richard Guy Briggs <rgb@redhat.com>
    Signed-off-by: Eric Paris <eparis@redhat.com>

diff --git a/kernel/audit.c b/kernel/audit.c
index 2360da991721..0d4865a50171 100644
--- a/kernel/audit.c
+++ b/kernel/audit.c
@@ -714,7 +714,7 @@ static int audit_set_feature(struct sk_buff *skb)
 		old_lock = af.lock & feature;
 
 		/* are we changing a locked feature? */
-		if ((af.lock & feature) && (new_feature != old_feature)) {
+		if (old_lock && (new_feature != old_feature)) {
 			audit_log_feature_change(i, old_feature, new_feature,
 						 old_lock, new_lock, 0);
 			return -EPERM;

