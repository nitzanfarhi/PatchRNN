commit 95b1bc20532c18e3f19cd460c8350350c84ffbb2
Author: David Brownell <dbrownell@users.sourceforge.net>
Date:   Tue Jul 29 22:28:12 2008 -0700

    [MTD] MTD_DEBUG always does compile-time typechecks
    
    The current style for debug messages is to ensure they're always
    parsed by the compiler and then subjected to dead code removal.
    That way builds won't break only when debug options get enabled,
    which is common when they are stripped out early by CPP.
    
    This patch makes CONFIG_MTD_DEBUG adopt that convention.
    
    Signed-off-by: David Brownell <dbrownell@users.sourceforge.net>
    Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>

diff --git a/include/linux/mtd/mtd.h b/include/linux/mtd/mtd.h
index 4ed40caff4e5..922636548558 100644
--- a/include/linux/mtd/mtd.h
+++ b/include/linux/mtd/mtd.h
@@ -272,7 +272,11 @@ static inline void mtd_erase_callback(struct erase_info *instr)
 			printk(KERN_INFO args);		\
 	} while(0)
 #else /* CONFIG_MTD_DEBUG */
-#define DEBUG(n, args...) do { } while(0)
+#define DEBUG(n, args...)				\
+	do {						\
+		if (0)					\
+			printk(KERN_INFO args);		\
+	} while(0)
 
 #endif /* CONFIG_MTD_DEBUG */
 

