commit 836132ec43441fc8560c267851e9aa1c0192300a
Author: Anssi Hannula <anssi.hannula@iki.fi>
Date:   Wed Dec 29 16:48:40 2010 +0000

    Fix wrong bitstream mode for AC-3.
    Noticed by CrystalP from XBMC.
    
    Patch by Anssi Hannula, anssi d hannula a iki d fi
    
    Originally committed as revision 26130 to svn://svn.ffmpeg.org/ffmpeg/trunk

diff --git a/libavformat/spdifenc.c b/libavformat/spdifenc.c
index 0fcfc09496..dd9ff85784 100644
--- a/libavformat/spdifenc.c
+++ b/libavformat/spdifenc.c
@@ -76,7 +76,7 @@ typedef struct IEC958Context {
 static int spdif_header_ac3(AVFormatContext *s, AVPacket *pkt)
 {
     IEC958Context *ctx = s->priv_data;
-    int bitstream_mode = pkt->data[6] & 0x7;
+    int bitstream_mode = pkt->data[5] & 0x7;
 
     ctx->data_type  = IEC958_AC3 | (bitstream_mode << 8);
     ctx->pkt_offset = AC3_FRAME_SIZE << 2;

