commit 4fb7d4c499e1458e7f7be73579c3f4e382fac7ce
Author: Xycaleth <alex@acslo.com>
Date:   Sat May 17 14:31:13 2014 +0100

    [SP] Win32: Fix game incorrectly reporting low mem
    
    GlobalMemoryStatusEx requires the dwLength field of the MEMORYSTATUSEX
    struct to be filled in by the caller.
    
    This fixes strange actions being performed by the game such as s_khz being
    set to 11 on start up. This should also improve performance in some cases
    where the game doesn't try to free memory when it didn't need to.

diff --git a/code/win32/win_main.cpp b/code/win32/win_main.cpp
index dfc0dbb1..c177fd19 100644
--- a/code/win32/win_main.cpp
+++ b/code/win32/win_main.cpp
@@ -160,6 +160,8 @@ qboolean Sys_LowPhysicalMemory()
 	if (!bAsked)	// just in case it takes a little time for GlobalMemoryStatus() to gather stats on
 	{				//	stuff we don't care about such as virtual mem etc.
 		bAsked = qtrue;
+
+		stat.dwLength = sizeof (stat);
 		GlobalMemoryStatusEx (&stat);
 	}
 	if (sys_lowmem->integer)

