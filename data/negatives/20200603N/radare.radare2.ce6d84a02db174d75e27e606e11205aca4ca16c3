commit ce6d84a02db174d75e27e606e11205aca4ca16c3
Author: pancake <pancake@nopcode.org>
Date:   Thu Oct 20 01:52:47 2016 +0200

    Fix #5997 - Do not permit xrefs on invalid addresses

diff --git a/libr/anal/xrefs.c b/libr/anal/xrefs.c
index 6b101decd..82f598278 100644
--- a/libr/anal/xrefs.c
+++ b/libr/anal/xrefs.c
@@ -38,6 +38,9 @@ R_API int r_anal_xrefs_set (RAnal *anal, const RAnalRefType type, ut64 from, ut6
 	if (!anal || !DB) {
 		return false;
 	}
+	if (!anal->iob.is_valid_offset (anal->iob.io, to, 0)) {
+		return false;
+	}
 	// unknown refs should not be stored. seems wrong
 	if (type == R_ANAL_REF_TYPE_NULL) {
 		return false;

