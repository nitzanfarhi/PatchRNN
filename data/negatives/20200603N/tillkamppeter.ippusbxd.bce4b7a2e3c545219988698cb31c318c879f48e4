commit bce4b7a2e3c545219988698cb31c318c879f48e4
Author: Daniel Dressler <danieru.dressler@gmail.com>
Date:   Wed Jun 4 14:41:15 2014 -0600

    Add basic sending of printer responce to client
    
    The send-receive loop is too broken for firefox
    but netcat works.

diff --git a/src/ippusbd.c b/src/ippusbd.c
index 67d1aea..b1e9108 100644
--- a/src/ippusbd.c
+++ b/src/ippusbd.c
@@ -62,6 +62,8 @@ void start_daemon(uint32_t requested_port)
 
 			struct http_packet_t *usb_pkt = get_packet_usb(usb);
 			printf("%.*s", (int)usb_pkt->filled_size, usb_pkt->buffer);
+
+			tcp_packet_send(conn, usb_pkt);
 		}
 
 
diff --git a/src/tcp.c b/src/tcp.c
index a9d7363..c479b7f 100644
--- a/src/tcp.c
+++ b/src/tcp.c
@@ -136,6 +136,11 @@ error:
 	return NULL;
 }
 
+void tcp_packet_send(struct tcp_conn_t *conn, struct http_packet_t *pkt)
+{
+	send(conn->sd, pkt->buffer, pkt->filled_size, 0);
+}
+
 
 struct tcp_conn_t *tcp_conn_accept(struct tcp_sock_t *sock)
 {
diff --git a/src/tcp.h b/src/tcp.h
index 0c10077..2a6e51e 100644
--- a/src/tcp.h
+++ b/src/tcp.h
@@ -32,3 +32,4 @@ struct tcp_conn_t *tcp_conn_accept(struct tcp_sock_t *);
 void tcp_conn_close(struct tcp_conn_t *);
 
 struct http_packet_t *tcp_packet_get(struct tcp_conn_t *, struct http_message_t *);
+void tcp_packet_send(struct tcp_conn_t *, struct http_packet_t *);

