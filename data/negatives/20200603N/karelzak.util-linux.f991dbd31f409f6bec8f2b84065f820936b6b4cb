commit f991dbd31f409f6bec8f2b84065f820936b6b4cb
Author: Ruediger Meier <ruediger.meier@ga-group.nl>
Date:   Mon May 19 00:43:53 2014 +0200

    fsck.cramfs: allow smaller superblock sizes
    
    We are already fine with checking for different endianess. Now we
    also succeed if systems's page size does not match.
    
    Note that page_size is only really used if INCLUDE_FS_TESTS is
    defined, see followups.
    
    Signed-off-by: Ruediger Meier <ruediger.meier@ga-group.nl>

diff --git a/disk-utils/fsck.cramfs.c b/disk-utils/fsck.cramfs.c
index 66523f4de..00ea2ab56 100644
--- a/disk-utils/fsck.cramfs.c
+++ b/disk-utils/fsck.cramfs.c
@@ -189,7 +189,8 @@ static void test_super(int *start, size_t * length)
 	if (super.flags & ~CRAMFS_SUPPORTED_FLAGS)
 		errx(FSCK_EX_ERROR, _("unsupported filesystem features"));
 
-	if (super.size < page_size)
+	/* What are valid superblock sizes? */
+	if (super.size < sizeof(struct cramfs_super))
 		errx(FSCK_EX_UNCORRECTED, _("superblock size (%d) too small"),
 		     super.size);
 

