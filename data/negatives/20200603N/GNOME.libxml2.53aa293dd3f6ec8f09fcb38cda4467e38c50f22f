commit 53aa293dd3f6ec8f09fcb38cda4467e38c50f22f
Author: Daniel Veillard <veillard@redhat.com>
Date:   Mon Jul 16 14:37:00 2012 +0800

    Convert C14N to the new Input buffer
    
    one case of direct access cleaned up

diff --git a/c14n.c b/c14n.c
index 9c3cad2a..5d891c9e 100644
--- a/c14n.c
+++ b/c14n.c
@@ -27,6 +27,8 @@
 #include <libxml/xpathInternals.h>
 #include <libxml/c14n.h>
 
+#include "buf.h"
+
 /************************************************************************
  *									*
  *		Some declaration better left private ATM		*
@@ -2033,9 +2035,9 @@ xmlC14NDocDumpMemory(xmlDocPtr doc, xmlNodeSetPtr nodes,
         return (-1);
     }
 
-    ret = buf->buffer->use;
+    ret = xmlBufUse(buf->buffer);
     if (ret > 0) {
-        *doc_txt_ptr = xmlStrndup(buf->buffer->content, ret);
+        *doc_txt_ptr = xmlStrndup(xmlBufContent(buf->buffer), ret);
     }
     (void) xmlOutputBufferClose(buf);
 

