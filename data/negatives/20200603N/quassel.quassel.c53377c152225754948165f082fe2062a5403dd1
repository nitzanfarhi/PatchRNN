commit c53377c152225754948165f082fe2062a5403dd1
Author: Marcus Eggenberger <egs@quassel-irc.org>
Date:   Thu Mar 12 13:00:57 2009 +0100

    Treating invalid IdentityIds as NULL values

diff --git a/src/core/postgresqlstorage.cpp b/src/core/postgresqlstorage.cpp
index 143adbb9..d65b4ee0 100644
--- a/src/core/postgresqlstorage.cpp
+++ b/src/core/postgresqlstorage.cpp
@@ -546,7 +546,7 @@ NetworkId PostgreSqlStorage::createNetwork(UserId user, const NetworkInfo &info)
 
 void PostgreSqlStorage::bindNetworkInfo(QSqlQuery &query, const NetworkInfo &info) {
   query.bindValue(":networkname", info.networkName);
-  query.bindValue(":identityid", info.identity.toInt());
+  query.bindValue(":identityid", info.identity.isValid() ? info.identity.toInt() : QVariant());
   query.bindValue(":encodingcodec", QString(info.codecForEncoding));
   query.bindValue(":decodingcodec", QString(info.codecForDecoding));
   query.bindValue(":servercodec", QString(info.codecForServer));

