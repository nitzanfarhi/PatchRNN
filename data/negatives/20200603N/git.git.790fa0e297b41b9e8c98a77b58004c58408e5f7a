commit 790fa0e297b41b9e8c98a77b58004c58408e5f7a
Author: Junio C Hamano <junkio@cox.net>
Date:   Sat Dec 16 16:23:02 2006 -0800

    update-index: make D/F conflict error a bit more verbose.
    
    When you remove a directory D that has a tracked file D/F out of the
    way to create a file D and try to "git update-index --add D", it used
    to say "cannot add" which was not very helpful.  This issues an extra
    error message to explain the situation before the final "fatal" message.
    
    Since D/F conflicts are relatively rare event, extra verbosity would
    not make things too noisy.
    
    Signed-off-by: Junio C Hamano <junkio@cox.net>

diff --git a/read-cache.c b/read-cache.c
index eae4745d2..a602010a6 100644
--- a/read-cache.c
+++ b/read-cache.c
@@ -609,7 +609,7 @@ int add_cache_entry(struct cache_entry *ce, int option)
 	if (!skip_df_check &&
 	    check_file_directory_conflict(ce, pos, ok_to_replace)) {
 		if (!ok_to_replace)
-			return -1;
+			return error("'%s' appears as both a file and as a directory", ce->name);
 		pos = cache_name_pos(ce->name, ntohs(ce->ce_flags));
 		pos = -pos-1;
 	}

