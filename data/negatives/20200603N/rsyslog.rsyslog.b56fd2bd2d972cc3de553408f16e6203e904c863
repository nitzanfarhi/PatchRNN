commit b56fd2bd2d972cc3de553408f16e6203e904c863
Author: Allan Park <allan.park@guardtime.com>
Date:   Mon Apr 9 15:04:15 2018 +0300

    lmsig_ksils12: fixing issues 2517 and 2621

diff --git a/runtime/lib_ksils12.c b/runtime/lib_ksils12.c
old mode 100644
new mode 100755
index c2cfe8575..873fe621a
--- a/runtime/lib_ksils12.c
+++ b/runtime/lib_ksils12.c
@@ -62,7 +62,6 @@
 #include "lib_ksils12.h"
 #include "lib_ksi_queue.h"
 
-typedef unsigned char uchar;
 #ifndef VERSION
 #define VERSION "no-version"
 #endif
@@ -553,8 +552,13 @@ ksiCreateFile(rsksictx ctx, const char *path, uid_t uid, gid_t gid, int mode, bo
 		goto done;
 	}
 
-	if (stat_st.st_size == 0 && header != NULL)
-		fwrite(header, strlen(header), 1, f);
+	if (stat_st.st_size == 0 && header != NULL) {
+		if(fwrite(header, strlen(header), 1, f) != 1) {
+        	        report(ctx, "ksiOpenSigFile: fwrite for file %s failed: %s",
+				path, strerror(errno));
+	                goto done;
+		}
+	}
 
 done:
 	return f;

