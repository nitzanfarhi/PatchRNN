commit edd159566de1cdae6f39302961a10e1800b0ff2c
Author: attilamolnar <attilamolnar@hush.com>
Date:   Wed Jul 4 19:12:00 2012 +0200

    m_delaymsg Stop sending +d mode change to users when a remote user joins a channel with +d on it

diff --git a/src/modules/m_delaymsg.cpp b/src/modules/m_delaymsg.cpp
index c0ff09ccf..cc09629e3 100644
--- a/src/modules/m_delaymsg.cpp
+++ b/src/modules/m_delaymsg.cpp
@@ -61,6 +61,9 @@ ModeAction DelayMsgMode::OnModeChange(User* source, User* dest, Channel* channel
 {
 	if (adding)
 	{
+		if ((channel->IsModeSet('d')) && (channel->GetModeParameter('d') == parameter))
+			return MODEACTION_DENY;
+
 		/* Setting a new limit, sanity check */
 		long limit = atoi(parameter.c_str());
 

