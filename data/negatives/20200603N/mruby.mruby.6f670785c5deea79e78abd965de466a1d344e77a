commit 6f670785c5deea79e78abd965de466a1d344e77a
Author: Yukihiro Matsumoto <matz@ruby-lang.org>
Date:   Thu Jun 14 00:03:36 2012 +0900

    mrb_get_args(i) should check range of float values

diff --git a/src/class.c b/src/class.c
index fe0a2b53..ee6cf78f 100644
--- a/src/class.c
+++ b/src/class.c
@@ -542,7 +542,14 @@ mrb_get_args(mrb_state *mrb, const char *format, ...)
 	    *p = mrb_fixnum(*sp);
 	    break;
 	  case MRB_TT_FLOAT:
-	    *p = (mrb_int)mrb_float(*sp);
+	    {
+	      mrb_float f = mrb_float(*sp);
+
+	      if (!FIXABLE(f)) {
+		mrb_raise(mrb, E_RANGE_ERROR, "float too big for int");
+	      }
+	      *p = (mrb_int)f;
+	    }
 	    break;
 	  case MRB_TT_FALSE:
 	    *p = 0;

