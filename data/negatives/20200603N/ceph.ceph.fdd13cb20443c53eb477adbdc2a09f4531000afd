commit fdd13cb20443c53eb477adbdc2a09f4531000afd
Author: Sage Weil <sage@newdream.net>
Date:   Fri Jul 23 11:08:48 2010 -0700

    filestore: make stat print correct errno

diff --git a/src/os/FileStore.cc b/src/os/FileStore.cc
index 657f93e665..cb88b36ae9 100644
--- a/src/os/FileStore.cc
+++ b/src/os/FileStore.cc
@@ -1298,8 +1298,10 @@ int FileStore::stat(coll_t cid, const sobject_t& oid, struct stat *st)
   char fn[PATH_MAX];
   get_coname(cid, oid, fn, sizeof(fn));
   int r = ::stat(fn, st);
+  if (r < 0)
+    r = -errno;
   dout(10) << "stat " << fn << " = " << r << dendl;
-  return r < 0 ? -errno:r;
+  return r;
 }
 
 int FileStore::read(coll_t cid, const sobject_t& oid, 

