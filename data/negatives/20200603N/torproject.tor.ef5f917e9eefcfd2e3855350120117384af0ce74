commit ef5f917e9eefcfd2e3855350120117384af0ce74
Author: Roger Dingledine <arma@torproject.org>
Date:   Sun Feb 29 03:52:38 2004 +0000

    print a statement when the first circ is finished,
    so the user knows it's working
    
    
    svn:r1179

diff --git a/src/or/circuit.c b/src/or/circuit.c
index ae2e77b8c..59e046988 100644
--- a/src/or/circuit.c
+++ b/src/or/circuit.c
@@ -1077,6 +1077,8 @@ int circuit_extend(cell_t *cell, circuit_t *circ) {
   return 0;
 }
 
+extern int has_completed_circuit;
+
 int circuit_finish_handshake(circuit_t *circ, char *reply) {
   unsigned char iv[16];
   unsigned char keys[40+32];
@@ -1128,6 +1130,10 @@ int circuit_finish_handshake(circuit_t *circ, char *reply) {
 
   hop->state = CPATH_STATE_OPEN;
   log_fn(LOG_INFO,"finished");
+  if(!has_completed_circuit) {
+    has_completed_circuit=1;
+    log_fn(LOG_WARN,"Tor has successfully opened a circuit. Looks like it's working.");
+  }
   circuit_log_path(LOG_INFO,circ);
   return 0;
 }
diff --git a/src/or/main.c b/src/or/main.c
index 07a0d3015..b80ac9cd7 100644
--- a/src/or/main.c
+++ b/src/or/main.c
@@ -472,6 +472,7 @@ static int do_hup(void) {
   char keydir[512];
 
   log_fn(LOG_WARN,"Received sighup. Reloading config.");
+  has_completed_circuit=0;
   /* first, reload config variables, in case they've changed */
   /* no need to provide argc/v, they've been cached inside init_from_config */
   if (init_from_config(0, NULL) < 0) {

