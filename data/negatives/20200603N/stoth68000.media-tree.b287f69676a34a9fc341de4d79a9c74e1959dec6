commit b287f69676a34a9fc341de4d79a9c74e1959dec6
Author: Chris Metcalf <cmetcalf@tilera.com>
Date:   Thu Mar 29 14:02:52 2012 -0400

    arch/tile: avoid false corrupt frame warning in early boot
    
    With lockstat we can end up trying to get a backtrace before
    "high_memory" is initialized, so don't worry about range testing
    if it is zero.
    
    Signed-off-by: Chris Metcalf <cmetcalf@tilera.com>

diff --git a/arch/tile/kernel/process.c b/arch/tile/kernel/process.c
index ee01b1c683e4..2d5ef617bb39 100644
--- a/arch/tile/kernel/process.c
+++ b/arch/tile/kernel/process.c
@@ -286,7 +286,7 @@ struct task_struct *validate_current(void)
 	static struct task_struct corrupt = { .comm = "<corrupt>" };
 	struct task_struct *tsk = current;
 	if (unlikely((unsigned long)tsk < PAGE_OFFSET ||
-		     (void *)tsk > high_memory ||
+		     (high_memory && (void *)tsk > high_memory) ||
 		     ((unsigned long)tsk & (__alignof__(*tsk) - 1)) != 0)) {
 		pr_err("Corrupt 'current' %p (sp %#lx)\n", tsk, stack_pointer);
 		tsk = &corrupt;

