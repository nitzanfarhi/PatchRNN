commit fc9c2d53c39fac446b7b05db639ee4ccb39e37d4
Author: Ramiro Polla <ramiro.polla@gmail.com>
Date:   Fri Jun 6 16:53:01 2008 +0000

    Merge declaration and initialization.
    
    Originally committed as revision 13672 to svn://svn.ffmpeg.org/ffmpeg/trunk

diff --git a/libavformat/utils.c b/libavformat/utils.c
index e7e3128a35..bab4a3cd11 100644
--- a/libavformat/utils.c
+++ b/libavformat/utils.c
@@ -2496,9 +2496,8 @@ static void truncate_ts(AVStream *st, AVPacket *pkt){
 
 int av_write_frame(AVFormatContext *s, AVPacket *pkt)
 {
-    int ret;
+    int ret = compute_pkt_fields2(s->streams[pkt->stream_index], pkt);
 
-    ret=compute_pkt_fields2(s->streams[pkt->stream_index], pkt);
     if(ret<0 && !(s->oformat->flags & AVFMT_NOTIMESTAMPS))
         return ret;
 

