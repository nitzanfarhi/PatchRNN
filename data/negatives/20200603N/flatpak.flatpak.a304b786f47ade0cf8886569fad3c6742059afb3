commit a304b786f47ade0cf8886569fad3c6742059afb3
Author: Alexander Larsson <alexl@redhat.com>
Date:   Wed Apr 27 09:29:48 2016 +0200

    installation_fetch_remote_size_sync: Always fail with deprecation error
    
    This is not supported anymore since it was replaced with the summary cache.
    Remove the code so nothing accidentally uses it.

diff --git a/common/xdg-app-dir.c b/common/xdg-app-dir.c
index 77ad21c4..c21a9ace 100644
--- a/common/xdg-app-dir.c
+++ b/common/xdg-app-dir.c
@@ -4033,53 +4033,6 @@ xdg_app_dir_get_installed_size (XdgAppDir *self,
                      error);
 }
 
-/** xdg_app_dir_fetch_sizes
- * @self: a #XdgAppDir
- * @new_archived: total size of new (to be downloaded) objects in compressed form
- * @new_unpacked: total size of new (to be downloaded) objects in uncompressed form
- * @total_archived: total size of all objects in compressed form
- * @total_unpacked: total size of all objects in uncompressed form
- */
-gboolean
-xdg_app_dir_fetch_sizes (XdgAppDir *self,
-                         const char *remote_name,
-                         const char *commit,
-                         guint64 *new_archived,
-                         guint64 *new_unpacked,
-                         guint64 *total_archived,
-                         guint64 *total_unpacked,
-                         GCancellable *cancellable,
-                         GError **error)
-{
-  g_autoptr(GBytes) commit_bytes = NULL;
-  g_autoptr(GVariant) commit_variant = NULL;
-
-  if (!xdg_app_dir_ensure_repo (self, cancellable, error))
-    return FALSE;
-
-  commit_bytes = xdg_app_dir_fetch_remote_object (self, remote_name,
-                                                  commit, "commit",
-                                                  cancellable, error);
-  if (commit_bytes == NULL)
-    return FALSE;
-
-  commit_variant = g_variant_new_from_bytes (OSTREE_COMMIT_GVARIANT_FORMAT,
-                                             commit_bytes, FALSE);
-
-
-  if (!ostree_validate_structureof_commit (commit_variant, error))
-    return FALSE;
-
-  return calc_sizes (self,
-                     commit_variant,
-                     new_archived,
-                     new_unpacked,
-                     total_archived,
-                     total_unpacked,
-                     cancellable,
-                     error);
-}
-
 gboolean
 xdg_app_dir_fetch_ref_cache (XdgAppDir    *self,
                              const char   *remote_name,
diff --git a/common/xdg-app-dir.h b/common/xdg-app-dir.h
index 2ca8f314..c1945cdf 100644
--- a/common/xdg-app-dir.h
+++ b/common/xdg-app-dir.h
@@ -338,15 +338,6 @@ gboolean xdg_app_dir_get_installed_size (XdgAppDir *self,
                                          guint64 *installed_size,
                                          GCancellable *cancellable,
                                          GError **error);
-gboolean xdg_app_dir_fetch_sizes         (XdgAppDir *self,
-                                          const char *remote_name,
-                                          const char *commit,
-                                          guint64    *new_archived,
-                                          guint64    *new_unpacked,
-                                          guint64    *total_archived,
-                                          guint64    *total_unpacked,
-                                          GCancellable *cancellable,
-                                          GError **error);
 gboolean xdg_app_dir_fetch_ref_cache (XdgAppDir    *self,
                                       const char   *remote_name,
                                       const char   *ref,
diff --git a/lib/xdg-app-installation.c b/lib/xdg-app-installation.c
index 788b333e..140be966 100644
--- a/lib/xdg-app-installation.c
+++ b/lib/xdg-app-installation.c
@@ -1202,15 +1202,7 @@ xdg_app_installation_fetch_remote_size_sync (XdgAppInstallation  *self,
                                              GCancellable        *cancellable,
                                              GError             **error)
 {
-  XdgAppInstallationPrivate *priv = xdg_app_installation_get_instance_private (self);
-
-  return xdg_app_dir_fetch_sizes (priv->dir, remote_name, commit,
-                                  download_size,
-                                  NULL,
-                                  NULL,
-                                  installed_size,
-                                  cancellable,
-                                  error);
+  return xdg_app_fail (error, "Deprecated function call xdg_app_installation_fetch_remote_size_sync");
 }
 
 /**

