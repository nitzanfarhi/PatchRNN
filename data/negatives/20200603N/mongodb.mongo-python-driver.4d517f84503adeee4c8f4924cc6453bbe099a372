commit 4d517f84503adeee4c8f4924cc6453bbe099a372
Author: Joakim Sernbrant <joakim.sernbrant@trioptima.com>
Date:   Sun Aug 30 21:18:05 2009 +0800

    cbson: PySequence_GetItem returns a new ref
    
    Signed-off-by: Mike Dirolf <mike@dirolf.com>

diff --git a/pymongo/_cbsonmodule.c b/pymongo/_cbsonmodule.c
index cb42c09b..b0fc099a 100644
--- a/pymongo/_cbsonmodule.c
+++ b/pymongo/_cbsonmodule.c
@@ -244,8 +244,10 @@ static int write_element_to_buffer(bson_buffer* buffer, int type_byte, PyObject*
 
             item_value = PySequence_GetItem(value, i);
             if (!write_element_to_buffer(buffer, list_type_byte, item_value, check_keys)) {
+                Py_DECREF(item_value);
                 return 0;
             }
+            Py_DECREF(item_value);
         }
 
         /* write null byte and fill in length */

