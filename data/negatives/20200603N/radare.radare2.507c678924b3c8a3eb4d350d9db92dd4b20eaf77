commit 507c678924b3c8a3eb4d350d9db92dd4b20eaf77
Author: pancake <pancake@nopcode.org>
Date:   Mon Sep 3 01:48:47 2018 +1000

    Fix #11352 - slow esil emulation visual panel

diff --git a/libr/core/cmd_debug.c b/libr/core/cmd_debug.c
index 53db3bfc0..3989c2480 100644
--- a/libr/core/cmd_debug.c
+++ b/libr/core/cmd_debug.c
@@ -4795,7 +4795,7 @@ static int cmd_debug(void *data, const char *input) {
 					r_cons_printf ("%s at 0x%08"PFMT64x"\n", r, core->dbg->stopaddr);
 				}
 				break;
-			case '?': // "dij"
+			case '?': // "di?"
 			default:
 				r_core_cmd_help (core, help_msg_di);
 			}
diff --git a/libr/debug/debug.c b/libr/debug/debug.c
index 2b8623185..c711d74c9 100644
--- a/libr/debug/debug.c
+++ b/libr/debug/debug.c
@@ -17,6 +17,9 @@ R_API RDebugInfo *r_debug_info(RDebug *dbg, const char *arg) {
 	if (!dbg || !dbg->h || !dbg->h->info) {
 		return NULL;
 	}
+	if (dbg->pid < 0) {
+		return NULL;
+	}
 	return dbg->h->info (dbg, arg);
 }
 
@@ -1618,10 +1621,13 @@ R_API ut64 r_debug_get_baddr(RDebug *dbg, const char *file) {
 	}
 	if (!strcmp (dbg->iob.io->desc->plugin->name, "gdb")) {		//this is very bad
 		// Tell gdb that we want baddr, not full mem map
-		dbg->iob.system(dbg->iob.io, "baddr");
+		dbg->iob.system (dbg->iob.io, "baddr");
 	}
 	int pid = r_io_desc_get_pid (dbg->iob.io->desc);
 	int tid = r_io_desc_get_tid (dbg->iob.io->desc);
+	if (pid < 0 || tid < 0) {
+		return 0LL;
+	}
 	if (r_debug_attach (dbg, pid) == -1) {
 		return 0LL;
 	}

