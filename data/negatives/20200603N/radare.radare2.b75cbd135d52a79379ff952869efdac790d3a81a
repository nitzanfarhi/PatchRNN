commit b75cbd135d52a79379ff952869efdac790d3a81a
Author: dequis <dx@dxzone.com.ar>
Date:   Sun May 10 19:19:21 2015 -0300

    debug_gdb: handle null return value from gdbr_read_registers
    
    This would crash when doing r2 -d cat -c 'dh gdb'
    
    Now that just prints "r_debug_reg: error reading registers"

diff --git a/libr/debug/p/debug_gdb.c b/libr/debug/p/debug_gdb.c
index 0923fc341..b9bc79f56 100644
--- a/libr/debug/p/debug_gdb.c
+++ b/libr/debug/p/debug_gdb.c
@@ -24,10 +24,13 @@ static int r_debug_gdb_step(RDebug *dbg) {
 }
 
 static int r_debug_gdb_reg_read(RDebug *dbg, int type, ut8 *buf, int size) {
-	gdbr_read_registers (desc);
 	int copy_size;
-	// read the len of the current area
 	int buflen = 0;
+	gdbr_read_registers (desc);
+	if (!desc) {
+		return -1;
+	}
+	// read the len of the current area
 	free (r_reg_get_bytes (dbg->reg, type, &buflen));
 	if (size<desc->data_len) {
 		eprintf ("r_debug_gdb_reg_read: small buffer %d vs %d\n",

