commit b9c43856f21d97ffdfdd642acf2eb0b52d3b1555
Author: Pantelis Antoniou <pantelis.antoniou@konsulko.com>
Date:   Mon May 9 16:20:42 2016 +0300

    of: dynamic: changeset prop-update revert fix
    
    When reverting an update property changeset entry that created a
    property the reverse operation is a remove property and not an update.
    
    Signed-off-by: Pantelis Antoniou <pantelis.antoniou@konsulko.com>
    Signed-off-by: Rob Herring <robh@kernel.org>

diff --git a/drivers/of/dynamic.c b/drivers/of/dynamic.c
index 75ce30dfdd5f..3033fa3250dc 100644
--- a/drivers/of/dynamic.c
+++ b/drivers/of/dynamic.c
@@ -498,6 +498,11 @@ static void __of_changeset_entry_invert(struct of_changeset_entry *ce,
 	case OF_RECONFIG_UPDATE_PROPERTY:
 		rce->old_prop = ce->prop;
 		rce->prop = ce->old_prop;
+		/* update was used but original property did not exist */
+		if (!rce->prop) {
+			rce->action = OF_RECONFIG_REMOVE_PROPERTY;
+			rce->prop = ce->prop;
+		}
 		break;
 	}
 }

