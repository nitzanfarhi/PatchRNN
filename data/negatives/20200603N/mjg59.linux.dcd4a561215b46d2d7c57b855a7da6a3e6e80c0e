commit dcd4a561215b46d2d7c57b855a7da6a3e6e80c0e
Author: Michal Kazior <michal.kazior@tieto.com>
Date:   Wed Jul 31 10:55:12 2013 +0200

    ath10k: make sure to use passive scan when n_ssids is 0
    
    Normally user specifies broadcast ssid for
    scanning. If the user wants to do a passive scan
    it does not pass any ssids.
    
    The patch makes sure we ath10k tells firmware to
    not send anything at all in case it decides no
    ssids equals broadcast ssid.
    
    Signed-off-by: Michal Kazior <michal.kazior@tieto.com>
    Signed-off-by: Kalle Valo <kvalo@qca.qualcomm.com>

diff --git a/drivers/net/wireless/ath/ath10k/mac.c b/drivers/net/wireless/ath/ath10k/mac.c
index 9ea31f89b748..6b9f85009288 100644
--- a/drivers/net/wireless/ath/ath10k/mac.c
+++ b/drivers/net/wireless/ath/ath10k/mac.c
@@ -2338,6 +2338,8 @@ static int ath10k_hw_scan(struct ieee80211_hw *hw,
 			arg.ssids[i].len  = req->ssids[i].ssid_len;
 			arg.ssids[i].ssid = req->ssids[i].ssid;
 		}
+	} else {
+		arg.scan_ctrl_flags |= WMI_SCAN_FLAG_PASSIVE;
 	}
 
 	if (req->n_channels) {

