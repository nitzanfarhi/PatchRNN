commit f3707d07055b59afd33adfefe8456328e0b45710
Author: Tom Lane <tgl@sss.pgh.pa.us>
Date:   Thu May 29 00:54:42 2003 +0000

    Fix stupid oversight :-(

diff --git a/src/backend/catalog/index.c b/src/backend/catalog/index.c
index 1399f960f7..1bc66a5959 100644
--- a/src/backend/catalog/index.c
+++ b/src/backend/catalog/index.c
@@ -8,7 +8,7 @@
  *
  *
  * IDENTIFICATION
- *	  $Header: /cvsroot/pgsql/src/backend/catalog/index.c,v 1.210 2003/05/28 16:03:56 tgl Exp $
+ *	  $Header: /cvsroot/pgsql/src/backend/catalog/index.c,v 1.211 2003/05/29 00:54:42 tgl Exp $
  *
  *
  * INTERFACE ROUTINES
@@ -1602,6 +1602,10 @@ IndexBuildHeapScan(Relation heapRelation,
 
 		MemoryContextReset(econtext->ecxt_per_tuple_memory);
 
+		/* Set up for predicate or expression evaluation */
+		if (slot)
+			ExecStoreTuple(heapTuple, slot, InvalidBuffer, false);
+
 		/*
 		 * In a partial index, discard tuples that don't satisfy the
 		 * predicate.  We can also discard recently-dead tuples, since
@@ -1612,7 +1616,6 @@ IndexBuildHeapScan(Relation heapRelation,
 		{
 			if (!tupleIsAlive)
 				continue;
-			ExecStoreTuple(heapTuple, slot, InvalidBuffer, false);
 			if (!ExecQual(predicate, econtext, false))
 				continue;
 		}

