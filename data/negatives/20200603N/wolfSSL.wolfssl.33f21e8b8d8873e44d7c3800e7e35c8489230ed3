commit 33f21e8b8d8873e44d7c3800e7e35c8489230ed3
Author: Chris Conlon <chris@wolfssl.com>
Date:   Wed Dec 14 11:34:10 2016 -0700

    set correct cert type in CertificateRequest when using ChaCha suite with ECDSA

diff --git a/src/internal.c b/src/internal.c
index a62c1e63..ae9c8417 100644
--- a/src/internal.c
+++ b/src/internal.c
@@ -10611,7 +10611,8 @@ int SendCertificateRequest(WOLFSSL* ssl)
     /* write to output */
     output[i++] = (byte)typeTotal;  /* # of types */
 #ifdef HAVE_ECC
-    if (ssl->options.cipherSuite0 == ECC_BYTE &&
+    if ((ssl->options.cipherSuite0 == ECC_BYTE ||
+         ssl->options.cipherSuite0 == CHACHA_BYTE) &&
                      ssl->specs.sig_algo == ecc_dsa_sa_algo) {
         output[i++] = ecdsa_sign;
     } else

