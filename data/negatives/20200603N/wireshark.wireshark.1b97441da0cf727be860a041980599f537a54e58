commit 1b97441da0cf727be860a041980599f537a54e58
Author: Darien Spencer <cusneud@mail.com>
Date:   Sat Aug 18 13:37:21 2018 +0300

    AT: Add CGSN/GSN Commands
    
    Change-Id: Ie383c0de07e4114f00e6c8833b6c18fcbaa4a07f
    Reviewed-on: https://code.wireshark.org/review/29185
    Reviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>
    Petri-Dish: Alexis La Goutte <alexis.lagoutte@gmail.com>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Anders Broman <a.broman58@gmail.com>

diff --git a/epan/dissectors/packet-at.c b/epan/dissectors/packet-at.c
index be6cc874f0..4f4c627036 100644
--- a/epan/dissectors/packet-at.c
+++ b/epan/dissectors/packet-at.c
@@ -433,6 +433,12 @@ static gboolean check_cgmm(gint role, guint16 type) {
     return FALSE;
 }
 
+static gboolean check_cgsn(gint role, guint16 type) {
+    if (role == ROLE_DTE && (type == TYPE_ACTION_SIMPLY || type == TYPE_TEST)) return TRUE;
+
+    return FALSE;
+}
+
 static gboolean check_chld(gint role, guint16 type) {
     if (role == ROLE_DTE && (type == TYPE_ACTION || type == TYPE_TEST)) return TRUE;
     if (role == ROLE_DCE && type == TYPE_RESPONSE) return TRUE;
@@ -529,6 +535,12 @@ static gboolean check_csim(gint role, guint16 type) {
     return FALSE;
 }
 
+static gboolean check_gsn(gint role, guint16 type) {
+    if (role == ROLE_DTE && (type == TYPE_ACTION_SIMPLY || type == TYPE_TEST)) return TRUE;
+
+    return FALSE;
+}
+
 static gboolean check_vts(gint role, guint16 type) {
     if (role == ROLE_DTE && (type == TYPE_ACTION || type == TYPE_TEST)) return TRUE;
     if (role == ROLE_DCE && type == TYPE_RESPONSE) return TRUE;
@@ -1228,6 +1240,7 @@ static const at_cmd_t at_cmds[] = {
     { "+CCWA",      "Call Waiting Notification",                               check_ccwa, dissect_ccwa_parameter },
     { "+CFUN",      "Set Phone Functionality",                                 check_cfun, dissect_cfun_parameter },
     { "+CGMM",      "Request model identification",                            check_cgmm, dissect_cgmm_parameter },
+    { "+CGSN",      "Request Product Serial Number Identification (ESN/IMEI)", check_cgsn, dissect_no_parameter },
     { "+CHLD",      "Call Hold and Multiparty Handling",                       check_chld, dissect_chld_parameter },
     { "+CHUP",      "Call Hang-up",                                            check_chup, dissect_no_parameter   },
     { "+CIEV",      "Indicator Events Reporting",                              check_ciev, dissect_ciev_parameter },
@@ -1243,6 +1256,7 @@ static const at_cmd_t at_cmds[] = {
     { "+COPS",      "Reading Network Operator",                                check_cops, dissect_cops_parameter },
     { "+CPMS",      "Preferred Message Storage",                               check_cpms, dissect_cpms_parameter },
     { "+CSIM",      "Generic SIM access",                                      check_csim, dissect_csim_parameter },
+    { "+GSN",       "Request Product Serial Number Identification (ESN/IMEI)", check_gsn,  dissect_no_parameter },
     { "+VTS",       "DTMF and tone generation",                                check_vts,  dissect_vts_parameter  },
     { "ERROR",      "ERROR",                                                   check_only_dce_role, dissect_no_parameter },
     { "RING",       "Incoming Call Indication",                                check_only_dce_role, dissect_no_parameter },

