commit 2642f0393aa8c04df3cd5ceb118d417b4200dd02
Author: paulsan <none@none>
Date:   Tue May 20 07:37:47 2008 -0700

    6701890 panic: hat_unlock_region: addr not found panic

diff --git a/usr/src/uts/sfmmu/vm/hat_sfmmu.c b/usr/src/uts/sfmmu/vm/hat_sfmmu.c
index 79dfe1b7d5..9c7e706005 100644
--- a/usr/src/uts/sfmmu/vm/hat_sfmmu.c
+++ b/usr/src/uts/sfmmu/vm/hat_sfmmu.c
@@ -3972,7 +3972,7 @@ hat_unlock_region(struct hat *sfmmup, caddr_t addr, size_t len,
 			hblktag.htag_rehash = ttesz;
 			hblktag.htag_rid = rid;
 			hblktag.htag_id = srdp;
-			hmebp = HME_HASH_FUNCTION(srdp, addr, hmeshift);
+			hmebp = HME_HASH_FUNCTION(srdp, va, hmeshift);
 			SFMMU_HASH_LOCK(hmebp);
 			HME_HASH_SEARCH_PREV(hmebp, hblktag, hmeblkp, hblkpa,
 			    pr_hblk, prevpa, &list);

