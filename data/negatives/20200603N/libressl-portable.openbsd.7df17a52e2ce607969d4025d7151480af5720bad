commit 7df17a52e2ce607969d4025d7151480af5720bad
Author: deraadt <>
Date:   Sat Oct 3 03:39:19 2015 +0000

    BIO_get_fd() could return fd 0; fix error condition.  Found at
    http://marc.info/?l=openssl-dev&m=144374015404899&w=2
    ok doug

diff --git a/src/usr.bin/openssl/ocsp.c b/src/usr.bin/openssl/ocsp.c
index 39000328b..3a6ac36b1 100644
--- a/src/usr.bin/openssl/ocsp.c
+++ b/src/usr.bin/openssl/ocsp.c
@@ -1,4 +1,4 @@
-/* $OpenBSD: ocsp.c,v 1.4 2015/09/11 14:30:23 bcook Exp $ */
+/* $OpenBSD: ocsp.c,v 1.5 2015/10/03 03:39:19 deraadt Exp $ */
 /* Written by Dr Stephen N Henson (steve@openssl.org) for the OpenSSL
  * project 2000.
  */
@@ -1110,7 +1110,7 @@ query_responder(BIO * err, BIO * cbio, char *path,
 		BIO_puts(err, "Error connecting BIO\n");
 		return NULL;
 	}
-	if (BIO_get_fd(cbio, &fd) <= 0) {
+	if (BIO_get_fd(cbio, &fd) < 0) {
 		BIO_puts(err, "Can't get connection fd\n");
 		goto err;
 	}

