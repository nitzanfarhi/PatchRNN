commit d358f771e3a0e78ea8ebed7edf48a12a7620c813
Author: Junio C Hamano <gitster@pobox.com>
Date:   Tue May 5 11:03:24 2015 -0700

    daemon: unbreak NO_IPV6 build regression
    
    When 01cec54e (daemon: deglobalize hostname information, 2015-03-07)
    wrapped the global variables such as hostname inside a struct, it
    forgot to convert one location that spelled "hostname" that needs to
    be updated to "hi->hostname".
    
    This was inside NO_IPV6 block, and was not caught by anybody.
    
    Signed-off-by: Junio C Hamano <gitster@pobox.com>

diff --git a/daemon.c b/daemon.c
index 9ee21877c..4be10914e 100644
--- a/daemon.c
+++ b/daemon.c
@@ -633,7 +633,7 @@ static void lookup_hostname(struct hostinfo *hi)
 		char **ap;
 		static char addrbuf[HOST_NAME_MAX + 1];
 
-		hent = gethostbyname(hostname.buf);
+		hent = gethostbyname(hi->hostname.buf);
 		if (hent) {
 			ap = hent->h_addr_list;
 			memset(&sa, 0, sizeof sa);

