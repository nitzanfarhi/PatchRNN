commit 36dba95afa3e61037186f74ae37ef7ab0c50d168
Author: Andrew Hanushevsky <abh@slac.stanford.edu>
Date:   Tue May 17 18:36:24 2005 +0000

    Minor fixes to end session code.

diff --git a/src/Xrd/XrdLink.cc b/src/Xrd/XrdLink.cc
index 1a58c4fb..01a6dfe3 100644
--- a/src/Xrd/XrdLink.cc
+++ b/src/Xrd/XrdLink.cc
@@ -758,6 +758,14 @@ int XrdLink::Terminate(const XrdLink *owner, int fdnum, unsigned int inst)
    lp->Serialize();
    lp->opMutex.Lock();
 
+// If this link is now dead, simply ignore the request. Typically, this
+// indicates a race condition that the server won.
+//
+   if (lp->FD != fdnum || lp->Instance != inst || !(lp->Poller))
+      {lp->opMutex.UnLock();
+       return EPIPE;
+      }
+
 // Verify that the owner of this link is making the request
 //
    if (owner 

