commit 2166ab77d8f81d9c44b2a4213f581f3e6dc784a7
Author: Morris Jette <jette@schedmd.com>
Date:   Fri Mar 9 13:21:34 2018 -0700

    Correct step's reported pack_offset
    
    Non-pack jobs were getting their pack_offset set to -1, which resulting
    in a bad pack_group value being reported for non-pack steps which were
    killed.

diff --git a/src/srun/libsrun/srun_job.c b/src/srun/libsrun/srun_job.c
index f713a1d570..d4efeab57c 100644
--- a/src/srun/libsrun/srun_job.c
+++ b/src/srun/libsrun/srun_job.c
@@ -1176,7 +1176,8 @@ extern void create_srun_job(void **p_job, bool *got_alloc,
 								 opt_local);
 				if (!job)
 					exit(error_exit);
-				job->pack_offset = pack_offset;
+				if (max_pack_offset > 0)
+					job->pack_offset = pack_offset;
 				list_append(srun_job_list, job);
 			}	/* While more option structures */
 			pack_offset++;

