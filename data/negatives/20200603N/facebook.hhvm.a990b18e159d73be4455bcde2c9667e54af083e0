commit a990b18e159d73be4455bcde2c9667e54af083e0
Author: iproctor <iproctor@facebook.com>
Date:   Thu Jun 10 11:08:25 2010 -0700

    [Fix] Don't set 303 on POST
    
    Summary:
    A location: set on a POST request was setting the code to 303.
    Ape doesn't do this.
    
    Test Plan:
    POSTed to a page redirecting, got 302.
    
    DiffCamp Revision: 122326
    Reviewed By: hzhao
    CC: hphp-diffs@lists, hzhao
    Revert Plan:
    OK

diff --git a/src/runtime/base/server/transport.cpp b/src/runtime/base/server/transport.cpp
index 6014ee3cab..3d12c99a92 100644
--- a/src/runtime/base/server/transport.cpp
+++ b/src/runtime/base/server/transport.cpp
@@ -301,12 +301,16 @@ void Transport::addHeader(const char *name, const char *value) {
 
   if (strcasecmp(name, "Location") == 0 && m_responseCode != 201 &&
       !(m_responseCode >= 300 && m_responseCode <=307)) {
+    /* Zend seems to set 303 on a post with HTTP version > 1.0 in the code but
+     * in our testing we can only get it to give 302.
     Method m = getMethod();
     if (m != GET && m != HEAD) {
       setResponse(303);
     } else {
       setResponse(302);
     }
+    */
+    setResponse(302);
   }
 }
 

