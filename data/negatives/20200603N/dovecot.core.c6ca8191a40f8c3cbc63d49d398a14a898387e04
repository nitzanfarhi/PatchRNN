commit c6ca8191a40f8c3cbc63d49d398a14a898387e04
Author: Timo Sirainen <tss@iki.fi>
Date:   Thu Feb 26 18:27:17 2009 -0500

    IMAP: Don't return APPENDUI/COPYUID if backend didn't provide them.
    
    --HG--
    branch : HEAD

diff --git a/src/imap/cmd-append.c b/src/imap/cmd-append.c
index 8eb245a99..8042e55d7 100644
--- a/src/imap/cmd-append.c
+++ b/src/imap/cmd-append.c
@@ -259,7 +259,9 @@ static bool cmd_append_continue_parsing(struct client_command_context *cmd)
 		}
 		i_assert(ctx->count == uid2 - uid1 + 1);
 
-		if (uid1 == uid2) {
+		if (uid1 == 0)
+			msg = "OK Append completed.";
+		else if (uid1 == uid2) {
 			msg = t_strdup_printf("OK [APPENDUID %u %u] "
 					      "Append completed.",
 					      uid_validity, uid1);
diff --git a/src/imap/cmd-copy.c b/src/imap/cmd-copy.c
index 1180e132a..97882cbcc 100644
--- a/src/imap/cmd-copy.c
+++ b/src/imap/cmd-copy.c
@@ -155,6 +155,8 @@ bool cmd_copy(struct client_command_context *cmd)
 	else {
 		i_assert(copy_count == uid2 - uid1 + 1);
 
+		if (uid1 == 0)
+			msg = "OK Copy completed.";
 		if (uid1 == uid2) {
 			msg = t_strdup_printf("OK [COPYUID %u %s %u] "
 					      "Copy completed.",

