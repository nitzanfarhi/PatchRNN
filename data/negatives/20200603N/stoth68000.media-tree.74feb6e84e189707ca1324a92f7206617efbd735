commit 74feb6e84e189707ca1324a92f7206617efbd735
Author: Eric Dumazet <dada1@cosmosbay.com>
Date:   Thu Jan 24 00:15:42 2008 -0800

    [ICMP]: Avoid sparse warnings in net/ipv4/icmp.c
    
       CHECK   net/ipv4/icmp.c
    net/ipv4/icmp.c:249:13: warning: context imbalance in 'icmp_xmit_unlock' -
    unexpected unlock
    net/ipv4/icmp.c:376:13: warning: context imbalance in 'icmp_reply' - different
    lock contexts for basic block
    net/ipv4/icmp.c:430:6: warning: context imbalance in 'icmp_send' - different
    lock contexts for basic block
    
    Solution is to declare both icmp_xmit_lock() and icmp_xmit_unlock() as inline
    
    Signed-off-by: Eric Dumazet <dada1@cosmosbay.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/net/ipv4/icmp.c b/net/ipv4/icmp.c
index ce5b4be559aa..1a6024978e28 100644
--- a/net/ipv4/icmp.c
+++ b/net/ipv4/icmp.c
@@ -232,7 +232,7 @@ static const struct icmp_control icmp_pointers[NR_ICMP_TYPES+1];
 static DEFINE_PER_CPU(struct socket *, __icmp_socket) = NULL;
 #define icmp_socket	__get_cpu_var(__icmp_socket)
 
-static __inline__ int icmp_xmit_lock(void)
+static inline int icmp_xmit_lock(void)
 {
 	local_bh_disable();
 
@@ -246,7 +246,7 @@ static __inline__ int icmp_xmit_lock(void)
 	return 0;
 }
 
-static void icmp_xmit_unlock(void)
+static inline void icmp_xmit_unlock(void)
 {
 	spin_unlock_bh(&icmp_socket->sk->sk_lock.slock);
 }

