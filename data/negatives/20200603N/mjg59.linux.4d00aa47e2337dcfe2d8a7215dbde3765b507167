commit 4d00aa47e2337dcfe2d8a7215dbde3765b507167
Author: Jeff Moyer <jmoyer@redhat.com>
Date:   Tue Apr 21 07:25:04 2009 +0200

    cfq-iosched: make seek_mean converge more quickly
    
    Right now, depending on the first sector to which a process issues I/O,
    the seek time may start out way out of whack. So make sure we start
    with 0 sectors in seek, instead of the offset of the first request
    issued.
    
    Signed-off-by: Jeff Moyer <jmoyer@redhat.com>
    Signed-off-by: Jens Axboe <jens.axboe@oracle.com>

diff --git a/block/cfq-iosched.c b/block/cfq-iosched.c
index 0d3b70de3d80..0eb4aff9df68 100644
--- a/block/cfq-iosched.c
+++ b/block/cfq-iosched.c
@@ -1908,7 +1908,9 @@ cfq_update_io_seektime(struct cfq_data *cfqd, struct cfq_io_context *cic,
 	sector_t sdist;
 	u64 total;
 
-	if (cic->last_request_pos < rq->sector)
+	if (!cic->last_request_pos)
+		sdist = 0;
+	else if (cic->last_request_pos < rq->sector)
 		sdist = rq->sector - cic->last_request_pos;
 	else
 		sdist = cic->last_request_pos - rq->sector;

