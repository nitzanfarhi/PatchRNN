commit 73ab341130352e9e32ce01dbc2b86d3970461a3c
Author: Dr. Stephen Henson <steve@openssl.org>
Date:   Mon May 23 12:27:43 2011 +0000

    PR: 2522
    Submitted by: Henrik Grindal Bakken <henribak@cisco.com>
    
    Don't compare past end of buffer.

diff --git a/fips/rand/fips_drbg_lib.c b/fips/rand/fips_drbg_lib.c
index 7892a02b60..46f059d058 100644
--- a/fips/rand/fips_drbg_lib.c
+++ b/fips/rand/fips_drbg_lib.c
@@ -145,7 +145,7 @@ static size_t fips_get_entropy(DRBG_CTX *dctx, unsigned char **pout,
 	if (rv < (min_len + bl) || (rv % bl))
 		return 0;
 	/* Compare consecutive blocks for continuous PRNG test */
-	for (p = tout; p < tout + rv; p += bl)
+	for (p = tout; p < tout + rv - bl; p += bl)
 		{
 		if (!memcmp(p, p + bl, bl))
 			{

