commit a3d218280c273f298b0a17902bc2b4aa3f1dae06
Author: Richard Weinberger <richard@nod.at>
Date:   Mon Jul 2 23:47:13 2018 +0200

    ubifs: Use kmalloc_array()
    
    Since commit 6da2ec56059c ("treewide: kmalloc() -> kmalloc_array()")
    we use kmalloc_array() for kmalloc() that computes the length with
    a multiplication.
    
    Cc: Kees Cook <keescook@chromium.org>
    Suggested-by: Kees Cook <keescook@chromium.org>
    Signed-off-by: Richard Weinberger <richard@nod.at>
    Reviewed-by: Kees Cook <keescook@chromium.org>
    Signed-off-by: Richard Weinberger <richard@nod.at>

diff --git a/fs/ubifs/journal.c b/fs/ubifs/journal.c
index cef0d76d490a..42ba4ceb81ee 100644
--- a/fs/ubifs/journal.c
+++ b/fs/ubifs/journal.c
@@ -1291,7 +1291,7 @@ static int truncate_data_node(const struct ubifs_info *c, const struct inode *in
 	int err, dlen, compr_type, out_len, old_dlen;
 
 	out_len = le32_to_cpu(dn->size);
-	buf = kmalloc(out_len * WORST_COMPR_FACTOR, GFP_NOFS);
+	buf = kmalloc_array(out_len, WORST_COMPR_FACTOR, GFP_NOFS);
 	if (!buf)
 		return -ENOMEM;
 

