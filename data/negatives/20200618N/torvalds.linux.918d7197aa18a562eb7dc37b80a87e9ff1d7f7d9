commit 918d7197aa18a562eb7dc37b80a87e9ff1d7f7d9
Author: Bruce Allan <bruce.w.allan@intel.com>
Date:   Tue Jun 2 11:28:20 2009 +0000

    e1000e: do not attempt to disable smart powerdown if not supported
    
    During reset, the driver was attempting to disable the Smart Powerdown
    feature even if the part does not support Smart Powerdown.  Check for
    support before attempting to disable the feature.
    
    Signed-off-by: Bruce Allan <bruce.w.allan@intel.com>
    Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/drivers/net/e1000e/netdev.c b/drivers/net/e1000e/netdev.c
index f012cc62eff3..7e412d1168ed 100644
--- a/drivers/net/e1000e/netdev.c
+++ b/drivers/net/e1000e/netdev.c
@@ -2799,7 +2799,8 @@ void e1000e_reset(struct e1000_adapter *adapter)
 	e1000e_reset_adaptive(hw);
 	e1000_get_phy_info(hw);
 
-	if (!(adapter->flags & FLAG_SMART_POWER_DOWN)) {
+	if ((adapter->flags & FLAG_HAS_SMART_POWER_DOWN) &&
+	    !(adapter->flags & FLAG_SMART_POWER_DOWN)) {
 		u16 phy_data = 0;
 		/*
 		 * speed up time to link by disabling smart power down, ignore

