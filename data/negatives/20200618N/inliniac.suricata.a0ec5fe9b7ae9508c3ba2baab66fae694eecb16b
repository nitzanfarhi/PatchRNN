commit a0ec5fe9b7ae9508c3ba2baab66fae694eecb16b
Author: Andreas Herz <andi@geekosphere.org>
Date:   Fri Aug 11 23:25:44 2017 +0200

    rule-parser: detect duplicate rev keyword

diff --git a/src/detect-rev.c b/src/detect-rev.c
index d558e754..faa06639 100644
--- a/src/detect-rev.c
+++ b/src/detect-rev.c
@@ -56,6 +56,14 @@ static int DetectRevSetup (DetectEngineCtx *de_ctx, Signature *s, const char *ra
         SCLogError(SC_ERR_INVALID_NUMERIC_VALUE, "rev value to high, max %u", UINT_MAX);
         goto error;
     }
+    if (rev == 0) {
+        SCLogError(SC_ERR_INVALID_NUMERIC_VALUE, "rev value 0 is invalid");
+        goto error;
+    }
+    if (s->rev > 0) {
+        SCLogError(SC_ERR_INVALID_RULE_ARGUMENT, "duplicated 'rev' keyword detected");
+        goto error;
+    }
 
     s->rev = (uint32_t)rev;
 

