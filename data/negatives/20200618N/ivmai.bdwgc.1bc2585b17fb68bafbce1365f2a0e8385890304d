commit 1bc2585b17fb68bafbce1365f2a0e8385890304d
Author: Zoltan Varga <vargaz@gmail.com>
Date:   Tue May 23 15:23:37 2006 +0000

    Add assertion on result alignment to GC_unix_mmap_get_mem
    (Apply commit 3e56070 from 'mono_libgc' branch)
    
    * os_dep.c (GC_unix_mmap_get_mem): Add an assert to bail out early if
    run on a machine with smaller page size than HBLKSIZE.

diff --git a/os_dep.c b/os_dep.c
index e6651f45..3b9fa397 100644
--- a/os_dep.c
+++ b/os_dep.c
@@ -2075,6 +2075,9 @@ STATIC ptr_t GC_unix_mmap_get_mem(word bytes)
 #   else
       GC_ASSERT(last_addr != 0);
 #   endif
+    if (((word)result % HBLKSIZE) != 0)
+      ABORT(
+       "GC_unix_get_mem: Memory returned by mmap is not aligned to HBLKSIZE.");
     return((ptr_t)result);
 }
 

