commit d7a047c4c9637ef7e672a0ccd0c869d3d5f1f76e
Author: Jia Zhouyang <jiazhouyang@nudt.edu.cn>
Date:   Thu Mar 1 16:25:36 2018 +0800

    MDEV-15550 Add error handling for fopen
    
    Print error message and return when fopen fails.
    
    Closes #634

diff --git a/client/mysql_plugin.c b/client/mysql_plugin.c
index 81677ad551f..d297f3cd03e 100644
--- a/client/mysql_plugin.c
+++ b/client/mysql_plugin.c
@@ -365,6 +365,12 @@ static int get_default_values()
     }
     /* Now open the file and read the defaults we want. */
     file= fopen(defaults_file, "r");
+    if (file == NULL)
+    {
+      fprintf(stderr, "ERROR: failed to open file %s: %s.\n", defaults_file,
+              strerror(errno));
+      goto exit;
+    }
     while (fgets(line, FN_REFLEN, file) != NULL)
     {
       char *value= 0;

