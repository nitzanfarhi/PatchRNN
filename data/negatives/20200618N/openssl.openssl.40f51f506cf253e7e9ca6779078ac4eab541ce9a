commit 40f51f506cf253e7e9ca6779078ac4eab541ce9a
Author: Nils Larsch <nils@openssl.org>
Date:   Wed Mar 15 08:37:35 2006 +0000

    create BN_CTX object

diff --git a/crypto/asn1/t_pkey.c b/crypto/asn1/t_pkey.c
index afb95d6712..e53c1294e9 100644
--- a/crypto/asn1/t_pkey.c
+++ b/crypto/asn1/t_pkey.c
@@ -312,6 +312,13 @@ int ECPKParameters_print(BIO *bp, const EC_GROUP *x, int off)
 		goto err;
 		}
 
+	ctx = BN_CTX_new();
+	if (ctx == NULL)
+		{
+		reason = ERR_R_MALLOC_FAILURE;
+		goto err;
+		}
+
 	if (EC_GROUP_get_asn1_flag(x))
 		{
 		/* the curve parameter are given by an asn1 OID */
@@ -508,6 +515,13 @@ int EC_KEY_print(BIO *bp, const EC_KEY *x, int off)
 		goto err;
 		}
 
+	ctx = BN_CTX_new();
+	if (ctx == NULL)
+		{
+		reason = ERR_R_MALLOC_FAILURE;
+		goto err;
+		}
+
 	public_key = EC_KEY_get0_public_key(x);
 	if ((pub_key = EC_POINT_point2bn(group, public_key,
 		EC_KEY_get_conv_form(x), NULL, ctx)) == NULL)

