commit 65ebf72e66d493f2d1b3508f8665fd1e9fb5ba9d
Author: Khairul Azhar Kasmiran <kazarmy@gmail.com>
Date:   Wed Aug 29 10:19:33 2018 +0800

    Fix #11227 - Fix another clusterfuzz crash (#11291)

diff --git a/libr/bin/format/mdmp/mdmp.c b/libr/bin/format/mdmp/mdmp.c
index d23cabf85..7a352fa37 100644
--- a/libr/bin/format/mdmp/mdmp.c
+++ b/libr/bin/format/mdmp/mdmp.c
@@ -427,6 +427,13 @@ static bool r_bin_mdmp_init_directory_entry(struct r_bin_mdmp_obj *obj, struct m
 
 		for (i = 0; i < memory_list->number_of_memory_ranges; i++) {
 			memories = (struct minidump_memory_descriptor *)(&(memory_list->memory_ranges));
+			ut64 start_offset = entry->location.rva
+			                + r_offsetof (struct minidump_memory_list, memory_ranges);
+			ut64 needed_space = (i + 1) * sizeof (memories[0]);
+			if (start_offset + needed_space > obj->b->length
+			    || start_offset + needed_space < start_offset) {
+				break;
+			}
 			r_list_append (obj->streams.memories, &(memories[i]));
 		}
 		break;

