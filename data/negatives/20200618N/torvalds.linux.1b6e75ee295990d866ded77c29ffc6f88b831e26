commit 1b6e75ee295990d866ded77c29ffc6f88b831e26
Author: Oleg Drokin <green@linuxhacker.ru>
Date:   Sat Feb 6 02:08:08 2016 -0500

    ACPI / EC: Deny write access unless requested by module param
    
    In debugfs it's not enough to just set file mode to read-only to
    deny write access to a file, instead just don't provide
    the write method unless write access is really requested.
    
    Signed-off-by: Oleg Drokin <green@linuxhacker.ru>
    Acked-by: Thomas Renninger <trenn@suse.com>
    Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>

diff --git a/drivers/acpi/ec_sys.c b/drivers/acpi/ec_sys.c
index bea8e425a8de..6c7dd7af789e 100644
--- a/drivers/acpi/ec_sys.c
+++ b/drivers/acpi/ec_sys.c
@@ -73,6 +73,9 @@ static ssize_t acpi_ec_write_io(struct file *f, const char __user *buf,
 	loff_t init_off = *off;
 	int err = 0;
 
+	if (!write_support)
+		return -EINVAL;
+
 	if (*off >= EC_SPACE_SIZE)
 		return 0;
 	if (*off + count >= EC_SPACE_SIZE) {

