commit a3b5b60bdf451faefeeec07c4e684a251968bf2d
Author: Michael Niedermayer <michael@niedermayer.cc>
Date:   Thu Jun 8 13:58:47 2017 +0200

    avcodec/indeo4: Check remaining data in Pic hdr extension parsing code
    
    Fixes: Timeout
    Fixes: 2115/clusterfuzz-testcase-minimized-6594111748440064
    
    Found-by: continuous fuzzing process https://github.com/google/oss-fuzz/tree/master/projects/ffmpeg
    Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>

diff --git a/libavcodec/indeo4.c b/libavcodec/indeo4.c
index 594c56d163..85d5fa3e7a 100644
--- a/libavcodec/indeo4.c
+++ b/libavcodec/indeo4.c
@@ -237,6 +237,8 @@ static int decode_pic_hdr(IVI45DecContext *ctx, AVCodecContext *avctx)
     /* skip picture header extension if any */
     while (get_bits1(&ctx->gb)) {
         ff_dlog(avctx, "Pic hdr extension encountered!\n");
+        if (get_bits_left(&ctx->gb) < 10)
+            return AVERROR_INVALIDDATA;
         skip_bits(&ctx->gb, 8);
     }
 

