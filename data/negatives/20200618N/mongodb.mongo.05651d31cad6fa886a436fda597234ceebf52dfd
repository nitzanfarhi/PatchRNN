commit 05651d31cad6fa886a436fda597234ceebf52dfd
Author: Max Hirschhorn <max.hirschhorn@mongodb.com>
Date:   Thu May 17 20:59:17 2018 -0400

    SERVER-35017 Disable speculative behavior when using atClusterTime.

diff --git a/src/mongo/db/read_concern.cpp b/src/mongo/db/read_concern.cpp
index 84e31e5255..4d7bbf0b4d 100644
--- a/src/mongo/db/read_concern.cpp
+++ b/src/mongo/db/read_concern.cpp
@@ -209,8 +209,12 @@ Status waitForReadConcern(OperationContext* opCtx,
     invariant(replCoord);
 
     auto session = OperationContextSession::get(opCtx);
-    // Currently speculative read concern is used only for transactions and snapshot reads.
-    const bool speculative = session && session->inSnapshotReadOrMultiDocumentTransaction();
+    // Currently speculative read concern is used only for transactions and snapshot reads. However,
+    // speculative read concern is not yet supported with atClusterTime.
+    //
+    // TODO SERVER-34620: Re-enable speculative behavior when "atClusterTime" is specified.
+    const bool speculative = session && session->inSnapshotReadOrMultiDocumentTransaction() &&
+        !readConcernArgs.getArgsAtClusterTime();
 
     if (readConcernArgs.getLevel() == repl::ReadConcernLevel::kLinearizableReadConcern) {
         if (replCoord->getReplicationMode() != repl::ReplicationCoordinator::modeReplSet) {

