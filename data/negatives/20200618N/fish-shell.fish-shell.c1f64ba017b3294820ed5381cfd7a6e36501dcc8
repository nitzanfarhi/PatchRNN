commit c1f64ba017b3294820ed5381cfd7a6e36501dcc8
Author: ridiculousfish <corydoras@ridiculousfish.com>
Date:   Thu Mar 27 13:46:33 2014 -0700

    Make set_color fail silently if there is no argument (reintroducing
    469743c). Fixes #1335

diff --git a/builtin_set_color.cpp b/builtin_set_color.cpp
index 0fdc1ac0..79a81bbb 100644
--- a/builtin_set_color.cpp
+++ b/builtin_set_color.cpp
@@ -81,6 +81,12 @@ static int builtin_set_color(parser_t &parser, wchar_t **argv)
 
     int argc = builtin_count_args(argv);
 
+    /* Some code passes variables to set_color that don't exist, like $fish_user_whatever. As a hack, quietly return failure. */
+    if (argc <= 1)
+    {
+        return EXIT_FAILURE;
+    }
+
     const wchar_t *bgcolor = NULL;
     bool bold = false, underline=false;
     int errret;

