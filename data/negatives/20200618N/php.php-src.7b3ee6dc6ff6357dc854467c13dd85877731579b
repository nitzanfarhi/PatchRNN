commit 7b3ee6dc6ff6357dc854467c13dd85877731579b
Author: Arnaud Le Blanc <lbarnaud@php.net>
Date:   Tue May 19 10:04:35 2009 +0000

    Fix build

diff --git a/main/streams/streams.c b/main/streams/streams.c
index 5bb85acef1..b3c834b286 100755
--- a/main/streams/streams.c
+++ b/main/streams/streams.c
@@ -1857,7 +1857,11 @@ static size_t _php_stream_copy_to_stream_common(php_stream *src, php_stream *des
 				}
 
 				towrite -= didwrite;
-				writeptr.v += ZBYTES(utype, didwrite);
+				if (utype == IS_UNICODE) {
+					writeptr.u += didwrite;
+				} else {
+					writeptr.s += didwrite;
+				}
 			}
 		} else {
 			break;

