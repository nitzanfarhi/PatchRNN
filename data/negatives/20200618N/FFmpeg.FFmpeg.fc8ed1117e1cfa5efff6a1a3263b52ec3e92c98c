commit fc8ed1117e1cfa5efff6a1a3263b52ec3e92c98c
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Mon Mar 19 22:20:04 2012 +0100

    avcodec_encode_audio2: Increase the audio buffer size.
    
    Fixes Ticket1104
    
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavcodec/utils.c b/libavcodec/utils.c
index 23ab832022..6b65542f60 100644
--- a/libavcodec/utils.c
+++ b/libavcodec/utils.c
@@ -1024,7 +1024,7 @@ int attribute_align_arg avcodec_encode_audio2(AVCodecContext *avctx,
                    implement encode2() */
                 buf_size = 2 * avctx->frame_size * avctx->channels *
                            av_get_bytes_per_sample(avctx->sample_fmt);
-                buf_size += FF_MIN_BUFFER_SIZE;
+                buf_size += 2*FF_MIN_BUFFER_SIZE;
             }
         }
         if ((ret = ff_alloc_packet(avpkt, buf_size)))

