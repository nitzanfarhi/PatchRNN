commit 3044fa8b88d87c74c20ba0a61547b17b8a978edb
Author: Yehuda Sadeh <yehuda@inktank.com>
Date:   Fri May 24 19:12:23 2013 -0700

    rgw: determine owner after effetctive user
    
    Signed-off-by: Yehuda Sadeh <yehuda@inktank.com>

diff --git a/src/rgw/rgw_rest_s3.cc b/src/rgw/rgw_rest_s3.cc
index 28129f6b8a..6448b65fff 100644
--- a/src/rgw/rgw_rest_s3.cc
+++ b/src/rgw/rgw_rest_s3.cc
@@ -1952,10 +1952,6 @@ int RGW_Auth_S3::authorize(RGWRados *store, struct req_state *s)
     return -EPERM;
   }
 
-  // populate the owner info
-  s->owner.set_id(s->user.user_id);
-  s->owner.set_name(s->user.display_name);
-
   /* now verify signature */
    
   string auth_hdr;
@@ -2019,6 +2015,11 @@ int RGW_Auth_S3::authorize(RGWRados *store, struct req_state *s)
     }
   }
 
+  // populate the owner info
+  s->owner.set_id(s->user.user_id);
+  s->owner.set_name(s->user.display_name);
+
+
   return  0;
 }
 

