commit 4af8bcef595d229c1509300f21d973d4cdfd9f38
Author: William Pitcock <nenolod@atheme.org>
Date:   Tue Jun 2 02:06:18 2009 -0500

    presence: Replace stagnant free_away() call with delete_metadata(..., "away").

diff --git a/modules/m_away.c b/modules/m_away.c
index 540fd3e6..d8eb8764 100644
--- a/modules/m_away.c
+++ b/modules/m_away.c
@@ -83,7 +83,7 @@ m_away(struct Client *client_p, struct Client *source_p, int parc, const char *p
 			/* we now send this only if they were away before --is */
 			sendto_server(client_p, NULL, CAP_TS6, NOCAPS,
 				      ":%s AWAY", use_id(source_p));
-			free_away(source_p);
+			delete_metadata(source_p, "away");
 		}
 		if(MyConnect(source_p))
 			sendto_one_numeric(source_p, RPL_UNAWAY, form_str(RPL_UNAWAY));

