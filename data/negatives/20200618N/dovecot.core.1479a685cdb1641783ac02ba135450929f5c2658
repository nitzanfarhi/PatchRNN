commit 1479a685cdb1641783ac02ba135450929f5c2658
Author: Timo Sirainen <tss@iki.fi>
Date:   Thu Sep 19 22:43:45 2013 +0300

    auth: Fixed non-auth passdb lookup when password had ".<encoding>" suffix.

diff --git a/src/auth/passdb.c b/src/auth/passdb.c
index 2b994cc8d..105d312c2 100644
--- a/src/auth/passdb.c
+++ b/src/auth/passdb.c
@@ -92,7 +92,7 @@ bool passdb_get_credentials(struct auth_request *auth_request,
 		/* anything goes. change the credentials_scheme to what we
 		   actually got, so blocking passdbs work. */
 		auth_request->credentials_scheme =
-			p_strdup(auth_request->pool, input_scheme);
+			p_strdup(auth_request->pool, t_strcut(input_scheme, '.'));
 		return TRUE;
 	}
 

