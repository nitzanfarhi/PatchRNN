commit 03e4b18bfb0617bfc91d1930597f6bccb5bed40c
Author: Andrew Beekhof <andrew@beekhof.net>
Date:   Thu Nov 8 14:12:40 2012 +1100

    High: legacy: Reduce confusion by aborting when we find an active corosync cluster with no CMAN/pcmk plugin loaded

diff --git a/lib/cluster/legacy.c b/lib/cluster/legacy.c
index 37d0fe8fa..7719a62ae 100644
--- a/lib/cluster/legacy.c
+++ b/lib/cluster/legacy.c
@@ -1341,6 +1341,10 @@ find_corosync_variant(void)
     free(value);
 
     confdb_finalize(config);
+    if (found == pcmk_cluster_unknown) {
+        crm_err("Corosync is running, but Pacemaker could not find the CMAN or Pacemaker plugin loaded");
+        found = pcmk_cluster_invalid;
+    }
     return found;
 }
 

