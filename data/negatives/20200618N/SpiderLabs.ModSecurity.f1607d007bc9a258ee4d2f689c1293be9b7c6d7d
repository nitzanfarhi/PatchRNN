commit f1607d007bc9a258ee4d2f689c1293be9b7c6d7d
Author: brectanus <brectanus@9017d574-64ec-4062-9424-5e00b32a252b>
Date:   Fri Jun 1 15:21:04 2007 +0000

    Cleanup message output.  See #16.

diff --git a/apache2/re_operators.c b/apache2/re_operators.c
index 727be9c2..13806d63 100644
--- a/apache2/re_operators.c
+++ b/apache2/re_operators.c
@@ -295,15 +295,15 @@ static int msre_op_pm_execute(modsec_rec *msr, msre_rule *rule, msre_var *var, c
 
     rc = acmp_process_quick(&pt, &match, var->value, var->value_len);
     if (rc) {
-        char *pattern_escaped = log_escape(msr->mp, match ? match : "<Unknown Pattern>");
+        char *match_escaped = log_escape(msr->mp, match ? match : "<Unknown Match>");
 
         /* This message will be logged. */
-        if (strlen(pattern_escaped) > 252) {
-            *error_msg = apr_psprintf(msr->mp, "Pattern match \"%.252s ...\" at %s.",
-                pattern_escaped, var->name);
+        if (strlen(match_escaped) > 252) {
+            *error_msg = apr_psprintf(msr->mp, "Matched substring \"%.252s ...\" at %s.",
+                match_escaped, var->name);
         } else {
-            *error_msg = apr_psprintf(msr->mp, "Pattern match \"%s\" at %s.",
-                pattern_escaped, var->name);
+            *error_msg = apr_psprintf(msr->mp, "Matched substring \"%s\" at %s.",
+                match_escaped, var->name);
         }
         return 1;
     }

