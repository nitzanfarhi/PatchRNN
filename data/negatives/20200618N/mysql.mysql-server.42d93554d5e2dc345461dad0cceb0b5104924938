commit 42d93554d5e2dc345461dad0cceb0b5104924938
Author: Alfranio Correia <alfranio.correia@oracle.com>
Date:   Thu Dec 15 01:13:11 2011 +0000

    Enabled SHOW MASTER/SLAVE STATUS with GTIDs.

diff --git a/sql/rpl_master.cc b/sql/rpl_master.cc
index aea4d1781a3..043a804fd88 100644
--- a/sql/rpl_master.cc
+++ b/sql/rpl_master.cc
@@ -1499,7 +1499,7 @@ bool show_binlog_info(THD* thd)
 
     /Alfranio
   */
-  /*global_sid_lock.rdlock();
+  global_sid_lock.rdlock();
   const Gtid_set* gtid_set= gtid_state.get_logged_gtids();
   if (gtid_set->to_string(&gtid_set_buffer, &gtid_set_size))
   {
@@ -1508,7 +1508,7 @@ bool show_binlog_info(THD* thd)
     global_sid_lock.unlock();
     DBUG_RETURN(true);
   }
-  global_sid_lock.unlock();*/
+  global_sid_lock.unlock();
 #endif
 
   field_list.push_back(new Item_empty_string("File", FN_REFLEN));
diff --git a/sql/rpl_slave.cc b/sql/rpl_slave.cc
index 74d09c8c537..4aa147c85ea 100644
--- a/sql/rpl_slave.cc
+++ b/sql/rpl_slave.cc
@@ -2198,7 +2198,7 @@ bool show_master_info(THD* thd, Master_info* mi)
 
     /Alfranio
   */
-  /*global_sid_lock.wrlock();
+  global_sid_lock.wrlock();
   const Gtid_set* sql_gtid_set= gtid_state.get_logged_gtids();
   const Gtid_set* io_gtid_set= mi->rli->get_gtid_set();
   if (sql_gtid_set->to_string(&sql_gtid_set_buffer, &sql_gtid_set_size) ||
@@ -2210,7 +2210,7 @@ bool show_master_info(THD* thd, Master_info* mi)
     global_sid_lock.unlock();
     DBUG_RETURN(true);
   }
-  global_sid_lock.unlock();*/
+  global_sid_lock.unlock();
 #endif
 
   field_list.push_back(new Item_empty_string("Slave_IO_State",

