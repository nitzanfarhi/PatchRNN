commit ccd22298f5729db4cc18e2efa31440f9ee67335b
Author: Roi Martin <jroi.martin@gmail.com>
Date:   Sat Mar 18 11:47:40 2017 +0000

    Add extra checks to zign deserialization

diff --git a/libr/anal/sign.c b/libr/anal/sign.c
index 429e5d89a..57907c6e8 100644
--- a/libr/anal/sign.c
+++ b/libr/anal/sign.c
@@ -50,17 +50,29 @@ static bool deserialize(RSignItem *it, const char *k, const char *v) {
 			break;
 		case 2:
 			if (it->size > 0) {
+				if (strlen (token) != 2 * it->size) {
+					retval = false;
+					goto exit_function;
+				}
 				it->bytes = malloc (it->size);
 				r_hex_str2bin (token, it->bytes);
 			}
 			break;
 		case 3:
 			if (it->size > 0) {
+				if (strlen (token) != 2 * it->size) {
+					retval = false;
+					goto exit_function;
+				}
 				it->mask = malloc (it->size);
 				r_hex_str2bin (token, it->mask);
 			}
 			break;
 		case 4:
+			if (strlen (token) != 2 * sizeof (RSignMetrics)) {
+				retval = false;
+				goto exit_function;
+			}
 			r_hex_str2bin (token, (ut8 *) &it->metrics);
 			break;
 		default:

