commit b57a7831b12250695b0c5a09aeff68daec64ac31
Author: David Beer <dbeer@adaptivecomputing.com>
Date:   Wed Jul 9 12:12:55 2014 -0600

    TRQ-2722. Revert a change that made it impossible to re-create a node with the same name.
    
    If you deleted a node via qmgr and then created it the creation would always fail. Revert
    the change that caused this.

diff --git a/src/server/id_map.cpp b/src/server/id_map.cpp
index 12d3e6799..e0fea9580 100644
--- a/src/server/id_map.cpp
+++ b/src/server/id_map.cpp
@@ -132,6 +132,7 @@ int id_map::get_id(
   }
 
 
+
 const char *id_map::get_name(
 
   int id)
diff --git a/src/server/node_func.c b/src/server/node_func.c
index 115bdb424..93a90595a 100644
--- a/src/server/node_func.c
+++ b/src/server/node_func.c
@@ -1876,8 +1876,10 @@ int create_pbs_node(
     return(PBSE_SYSTEM);
     }
 
-  if (node_mapper.get_id(pname) != -1)
+  if ((pnode = find_nodebyname(pname)) != NULL)
     {
+    unlock_node(pnode, __func__, NULL, LOGLEVEL);
+
     free(pname);
     free(pul);
 

