commit 6b7e00ddcc6b4cd93ca6b96345854f9007ed0d78
Author: alvarofe <alvaro.felipe91@gmail.com>
Date:   Sat Aug 26 11:03:46 2017 +0200

    Use r_io_desc api insted to dereference pointers

diff --git a/libr/core/file.c b/libr/core/file.c
index 545e629c3..f2b6895cc 100644
--- a/libr/core/file.c
+++ b/libr/core/file.c
@@ -750,9 +750,6 @@ R_API RCoreFile *r_core_file_open(RCore *r, const char *file, int flags, ut64 lo
 	if (!flags) {
 		flags = R_IO_READ;
 	}
-	if (strstr (file, "malloc://")) {
-		flags = R_IO_READ | R_IO_WRITE;
-	}
 	r->io->bits = r->assembler->bits; // TODO: we need an api for this
 	fd = r_io_open_nomap (r->io, file, flags, 0644);
 	if (!fd && openmany > 2) {
diff --git a/libr/io/io.c b/libr/io/io.c
index 001a3baaa..33a97e1dc 100644
--- a/libr/io/io.c
+++ b/libr/io/io.c
@@ -616,9 +616,7 @@ R_API ut64 r_io_seek(RIO* io, ut64 offset, int whence) {
 		break;
 	case R_IO_SEEK_END:
 	default:
-		if (io && io->desc && io->desc->plugin && io->desc->plugin->lseek) {
-			return io->off = io->desc->plugin->lseek (io, io->desc, offset, whence);
-		}
+		io->off = r_io_desc_seek (io->desc, offset, whence);
 		break;
 	}
 	return io->off;

