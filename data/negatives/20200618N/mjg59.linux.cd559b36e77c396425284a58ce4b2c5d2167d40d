commit cd559b36e77c396425284a58ce4b2c5d2167d40d
Author: Larry Finger <Larry.Finger@lwfinger.net>
Date:   Sun Sep 13 15:55:13 2009 -0500

    ssb: Fix error when V1 SPROM extraction is forced
    
    When an SPROM revision is not recognized, the code falls back to a V1
    SPROM; however, that revision is not forced in the appropriate structure.
    
    Signed-off-by: Larry Finger <Larry.Finger@lwfinger.net>
    Signed-off-by: John W. Linville <linville@tuxdriver.com>

diff --git a/drivers/ssb/pci.c b/drivers/ssb/pci.c
index f853d5600ca7..9e50896233aa 100644
--- a/drivers/ssb/pci.c
+++ b/drivers/ssb/pci.c
@@ -600,6 +600,7 @@ static int sprom_extract(struct ssb_bus *bus, struct ssb_sprom *out,
 			ssb_printk(KERN_WARNING PFX "Unsupported SPROM"
 				   "  revision %d detected. Will extract"
 				   " v1\n", out->revision);
+			out->revision = 1;
 			sprom_extract_r123(out, in);
 		}
 	}

