commit 474d04d6a1e222b50dc376471885e12b19220e42
Author: roberto@quantal64 <roberto@quantal64>
Date:   Thu May 31 18:53:09 2012 +0200

    added a security check in the http router

diff --git a/plugins/http/http.c b/plugins/http/http.c
index b7051842..efd71f4e 100644
--- a/plugins/http/http.c
+++ b/plugins/http/http.c
@@ -437,6 +437,12 @@ int http_parse(struct http_session *h_session) {
 		hv = hv->next;
 	}
 
+	// security check
+	if (c >= MAX_HTTP_VEC-4) {
+		uwsgi_log("too much headers in request. skipping it.\n");
+		return 0;
+	}
+
 	return c;
 
 }

