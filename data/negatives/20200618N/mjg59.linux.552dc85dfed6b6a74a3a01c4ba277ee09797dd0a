commit 552dc85dfed6b6a74a3a01c4ba277ee09797dd0a
Author: Dominik Brodowski <linux@dominikbrodowski.net>
Date:   Wed Mar 1 14:04:52 2006 +0100

    [PATCH] pcmcia: socket.functions starts with 1
    
    socket.functions is the number of functions, and so must be one larger
    than the maximum function number.
    
    Signed-off-by: Dominik Brodowski <linux@dominikbrodowski.net>

diff --git a/drivers/pcmcia/ds.c b/drivers/pcmcia/ds.c
index 211aa84353fc..16159e9d1b2b 100644
--- a/drivers/pcmcia/ds.c
+++ b/drivers/pcmcia/ds.c
@@ -588,8 +588,8 @@ struct pcmcia_device * pcmcia_device_add(struct pcmcia_socket *s, unsigned int f
 	p_dev->socket = s;
 	p_dev->device_no = (s->device_count++);
 	p_dev->func   = function;
-	if (s->functions < function)
-		s->functions = function;
+	if (s->functions <= function)
+		s->functions = function + 1;
 
 	p_dev->dev.bus = &pcmcia_bus_type;
 	p_dev->dev.parent = s->dev.dev;

