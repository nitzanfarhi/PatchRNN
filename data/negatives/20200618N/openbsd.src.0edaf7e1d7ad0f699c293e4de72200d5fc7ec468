commit 0edaf7e1d7ad0f699c293e4de72200d5fc7ec468
Author: jsg <jsg@openbsd.org>
Date:   Thu Nov 12 14:18:45 2009 +0000

    Make sure we have enough space for the trailing \0 on prepend/append
    of dhcp options.
    
    found by parfait.
    
    ok krw@

diff --git a/sbin/dhclient/dhclient.c b/sbin/dhclient/dhclient.c
index ec81acf5c39..2eca62c46fe 100644
--- a/sbin/dhclient/dhclient.c
+++ b/sbin/dhclient/dhclient.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: dhclient.c,v 1.131 2009/07/19 00:18:02 stevesk Exp $	*/
+/*	$OpenBSD: dhclient.c,v 1.132 2009/11/12 14:18:45 jsg Exp $	*/
 
 /*
  * Copyright 2004 Henning Brauer <henning@openbsd.org>
@@ -1665,7 +1665,7 @@ supersede:
 				case ACTION_PREPEND:
 					len = config->defaults[i].len +
 					    lease->options[i].len;
-					if (len > sizeof(dbuf)) {
+					if (len >= sizeof(dbuf)) {
 						warning("no space to %s %s",
 						    "prepend option",
 						    dhcp_options[i].name);
@@ -1684,7 +1684,7 @@ supersede:
 				case ACTION_APPEND:
 					len = config->defaults[i].len +
 					    lease->options[i].len;
-					if (len > sizeof(dbuf)) {
+					if (len >= sizeof(dbuf)) {
 						warning("no space to %s %s",
 						    "append option",
 						    dhcp_options[i].name);

