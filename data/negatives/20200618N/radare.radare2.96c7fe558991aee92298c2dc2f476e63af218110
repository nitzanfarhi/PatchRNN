commit 96c7fe558991aee92298c2dc2f476e63af218110
Author: Sven Steinbauer <sven@unlogic.co.uk>
Date:   Wed Jun 21 12:33:16 2017 +0100

    Fix 64bit lea instruction in nz (#7795)
    
    FIX #7788

diff --git a/libr/asm/p/asm_x86_nz.c b/libr/asm/p/asm_x86_nz.c
index 123bc4cb1..f476c640e 100644
--- a/libr/asm/p/asm_x86_nz.c
+++ b/libr/asm/p/asm_x86_nz.c
@@ -1089,6 +1089,9 @@ static int oplea(RAsm *a, ut8 *data, const Opcode op){
 	int rm = 0;
 	if (op.operands[0].type & OT_REGALL &&
 	    op.operands[1].type & OT_MEMORY) {
+		if (a->bits == 64) {
+			data[l++] = 0x48;
+		}
 		data[l++] = 0x8d;
 		if (op.operands[1].regs[0] == X86R_UNDEFINED) {
 			int high = 0xff00 & op.operands[1].offset;

