commit 3183968cbfb76c02f357151f66a1260101f9d82c
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Sun Mar 25 23:29:30 2012 -0700

    Input: amijoy - add missing platform check
    
    On multi-platform kernels, the Amiga joystick driver may be initialized
    when running on Amiga only. Else it may crash later.
    Fortunately this driver is almost always compiled as a module (to avoid
    conflicts with the mouse driver), so it needs an explicit insmod to
    trigger a crash.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Dmitry Torokhov <dtor@mail.ru>

diff --git a/drivers/input/joystick/amijoy.c b/drivers/input/joystick/amijoy.c
index 0bc86204213e..3aa93bf60ae3 100644
--- a/drivers/input/joystick/amijoy.c
+++ b/drivers/input/joystick/amijoy.c
@@ -108,6 +108,9 @@ static int __init amijoy_init(void)
 	int i, j;
 	int err;
 
+	if (!MACH_IS_AMIGA)
+		return -ENODEV;
+
 	for (i = 0; i < 2; i++) {
 		if (!amijoy[i])
 			continue;

