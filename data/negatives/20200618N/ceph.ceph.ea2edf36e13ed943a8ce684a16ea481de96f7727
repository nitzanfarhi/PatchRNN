commit ea2edf36e13ed943a8ce684a16ea481de96f7727
Author: Haomai Wang <haomaiwang@gmail.com>
Date:   Thu Apr 9 15:11:59 2015 +0800

    Event: process event before pop it to avoid releasing
    
    Signed-off-by: Haomai Wang <haomaiwang@gmail.com>

diff --git a/src/msg/async/Event.cc b/src/msg/async/Event.cc
index f6680417e5..a2fb88cd69 100644
--- a/src/msg/async/Event.cc
+++ b/src/msg/async/Event.cc
@@ -373,9 +373,9 @@ int EventCenter::process_events(int timeout_microseconds)
     external_lock.Unlock();
     while (!cur_process.empty()) {
       EventCallbackRef e = cur_process.front();
-      cur_process.pop_front();
       if (e)
         e->do_request(0);
+      cur_process.pop_front();
     }
   }
   return numevents;

