commit 6489455495fc5bfbebcfe3f57e5d4fdd6a781091
Author: Laurent Aimar <fenrir@videolan.org>
Date:   Mon Sep 12 23:49:36 2011 +0200

    Check for invalid VLC value in smacker decoder.
    
    Signed-off-by: Martin Storsj√∂ <martin@martin.st>

diff --git a/libavcodec/smacker.c b/libavcodec/smacker.c
index 32ee39a2d..a841b6cde 100644
--- a/libavcodec/smacker.c
+++ b/libavcodec/smacker.c
@@ -139,6 +139,8 @@ static int smacker_decode_bigtree(GetBitContext *gb, HuffContext *hc, DBCtx *ctx
         b2 = get_bits_count(gb);
         i2 = ctx->v2->table ? get_vlc2(gb, ctx->v2->table, SMKTREE_BITS, 3) : 0;
         b2 = get_bits_count(gb) - b2;
+        if (i1 < 0 || i2 < 0)
+            return -1;
         val = ctx->recode1[i1] | (ctx->recode2[i2] << 8);
         if(val == ctx->escapes[0]) {
             ctx->last[0] = hc->current;

