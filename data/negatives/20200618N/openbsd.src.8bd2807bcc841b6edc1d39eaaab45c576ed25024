commit 8bd2807bcc841b6edc1d39eaaab45c576ed25024
Author: kjell <kjell@openbsd.org>
Date:   Thu Jun 1 01:41:49 2006 +0000

    find-file-other-window and find-buffer-other-window should split
    the window if you ask for whatever file you are currently visiting.
    pointed out, ok beck@

diff --git a/usr.bin/mg/buffer.c b/usr.bin/mg/buffer.c
index 52d0b3e21c9..4dcb2122152 100644
--- a/usr.bin/mg/buffer.c
+++ b/usr.bin/mg/buffer.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: buffer.c,v 1.58 2006/05/28 23:30:16 kjell Exp $	*/
+/*	$OpenBSD: buffer.c,v 1.59 2006/06/01 01:41:49 kjell Exp $	*/
 
 /* This file is in the public domain. */
 
@@ -89,7 +89,8 @@ poptobuffer(int f, int n)
 		bp = curbp->b_altb;
 	else if ((bp = bfind(bufn, TRUE)) == NULL)
 		return (FALSE);
-
+	if (bp == curbp)
+		return (splitwind(f, n));
 	/* and put it in a new window */
 	if ((wp = popbuf(bp)) == NULL)
 		return (FALSE);
diff --git a/usr.bin/mg/file.c b/usr.bin/mg/file.c
index 20809d53890..e1aea606821 100644
--- a/usr.bin/mg/file.c
+++ b/usr.bin/mg/file.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: file.c,v 1.55 2006/05/28 23:30:16 kjell Exp $	*/
+/*	$OpenBSD: file.c,v 1.56 2006/06/01 01:41:49 kjell Exp $	*/
 
 /* This file is in the public domain. */
 
@@ -152,6 +152,8 @@ poptofile(int f, int n)
 		return (FALSE);
 	if ((bp = findbuffer(adjf)) == NULL)
 		return (FALSE);
+	if (bp == curbp)
+		return (splitwind(f, n));
 	if ((wp = popbuf(bp)) == NULL)
 		return (FALSE);
 	curbp = bp;

