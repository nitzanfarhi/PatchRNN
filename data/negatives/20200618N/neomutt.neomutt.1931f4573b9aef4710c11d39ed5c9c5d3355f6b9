commit 1931f4573b9aef4710c11d39ed5c9c5d3355f6b9
Author: Thomas Roessler <roessler@does-not-exist.org>
Date:   Wed Jun 13 08:27:44 2001 +0000

    This patch closes a ridiculous bug where the SASL library could be
    used without being initialised. I don't understand why lots of people
    weren't having problems, unless no one who uses SASL uses POP :)
    
    closes 549
    
    From Brendan Cully.

diff --git a/pop_auth.c b/pop_auth.c
index 2df92212e..055307536 100644
--- a/pop_auth.c
+++ b/pop_auth.c
@@ -48,6 +48,9 @@ static pop_auth_res_t pop_auth_sasl (POP_DATA *pop_data)
   if (!pop_data->auth_list)
     return POP_A_UNAVAIL;
 
+  if (mutt_sasl_start () != SASL_OK)
+    return POP_A_FAILURE;
+
   if (mutt_sasl_client_new (pop_data->conn, &saslconn) < 0)
   {
     dprint (1, (debugfile, "pop_auth_sasl: Error allocating SASL connection.\n"));

