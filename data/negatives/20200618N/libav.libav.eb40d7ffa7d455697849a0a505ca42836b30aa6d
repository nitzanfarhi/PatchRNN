commit eb40d7ffa7d455697849a0a505ca42836b30aa6d
Author: Daniel Kang <daniel.d.kang@gmail.com>
Date:   Sat Jan 15 10:18:38 2011 +0000

    Check symbol validity to avoid a crash, fixes issue 2523.
    
    Patch by Daniel Kang, daniel.d.kang at gmail
    
    Originally committed as revision 26360 to svn://svn.ffmpeg.org/ffmpeg/trunk

diff --git a/libavcodec/ivi_common.c b/libavcodec/ivi_common.c
index b15845808..0e552bccf 100644
--- a/libavcodec/ivi_common.c
+++ b/libavcodec/ivi_common.c
@@ -404,6 +404,10 @@ int ff_ivi_decode_blocks(GetBitContext *gb, IVIBandDesc *band, IVITile *tile)
                         hi  = get_vlc2(gb, band->blk_vlc.tab->table, IVI_VLC_BITS, 1);
                         val = IVI_TOSIGNED((hi << 6) | lo); /* merge them and convert into signed val */
                     } else {
+                        if (sym >= 256U) {
+                            av_log(NULL, AV_LOG_ERROR, "Invalid sym encountered: %d.\n", sym);
+                            return -1;
+                        }
                         run = rvmap->runtab[sym];
                         val = rvmap->valtab[sym];
                     }

