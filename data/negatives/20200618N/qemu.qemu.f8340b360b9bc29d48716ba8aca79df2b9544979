commit f8340b360b9bc29d48716ba8aca79df2b9544979
Author: Edgar E. Iglesias <edgar.iglesias@xilinx.com>
Date:   Wed Sep 10 18:33:58 2014 +1000

    hw/ptimer: Do not artificially limit timers when using icount
    
    Reviewed-by: Paolo Bonzini <pbonzini@redhat.com>
    Signed-off-by: Edgar E. Iglesias <edgar.iglesias@xilinx.com>

diff --git a/hw/core/ptimer.c b/hw/core/ptimer.c
index 2abad1fa3d..8437bd6e8b 100644
--- a/hw/core/ptimer.c
+++ b/hw/core/ptimer.c
@@ -189,7 +189,7 @@ void ptimer_set_limit(ptimer_state *s, uint64_t limit, int reload)
      * on the current generation of host machines.
      */
 
-    if (limit * s->period < 10000 && s->period) {
+    if (!use_icount && limit * s->period < 10000 && s->period) {
         limit = 10000 / s->period;
     }
 

