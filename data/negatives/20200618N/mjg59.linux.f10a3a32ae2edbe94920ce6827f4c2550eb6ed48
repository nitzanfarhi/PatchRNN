commit f10a3a32ae2edbe94920ce6827f4c2550eb6ed48
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Dec 5 13:30:03 2008 -0800

    Revert "ACPI: battery: Convert discharge energy rate to current properly"
    
    This reverts commit 558073dd56707864f09d563b64e7c37c021e89d2, along with
    the failed try to fix the regression it caused ("ACPI: Fix ACPI battery
    regression introduced by commit 558073"), which just made things worse.
    
    Commit aaad077638be1a25871bcae5e43952d6b63abfca (that failed "Fix ACPI
    battery regression") got the voltage conversion confused, and fixed the
    problem with Rafael's battery monitor apparently just by mistake.
    
    So revert them both, getting us back to the 2.6.27 state in this, and
    let's revisit it when people understand what's going on.
    
    Noted-by: Paul Martin <pm@debian.org>
    Requested-by: Rafael J. Wysocki <rjw@sisk.pl>
    Cc: Len Brown <len.brown@intel.com>
    Cc: Alexey Starikovskiy <astarikovskiy@suse.de>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

diff --git a/drivers/acpi/battery.c b/drivers/acpi/battery.c
index 4fb3c12ac1d8..1423b0c0cd2e 100644
--- a/drivers/acpi/battery.c
+++ b/drivers/acpi/battery.c
@@ -173,19 +173,7 @@ static int acpi_battery_get_property(struct power_supply *psy,
 		val->intval = battery->voltage_now * 1000;
 		break;
 	case POWER_SUPPLY_PROP_CURRENT_NOW:
-		val->intval = battery->current_now;
-		if (battery->power_unit) {
-			val->intval *= 1000;
-		} else {
-			/*
-			 * If power units are mW, convert to mA by dividing by
-			 * current voltage.
-			 */
-			if (battery->voltage_now)
-				val->intval /= battery->voltage_now;
-			else
-				val->intval = -1;
-		}
+		val->intval = battery->current_now * 1000;
 		break;
 	case POWER_SUPPLY_PROP_CHARGE_FULL_DESIGN:
 	case POWER_SUPPLY_PROP_ENERGY_FULL_DESIGN:

