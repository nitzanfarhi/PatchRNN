commit f58f97fa9d258e4110ee1257a63cd1af51787f69
Author: Colin Leroy <colin@colino.net>
Date:   Sun May 1 11:29:10 2005 +0200

    [PATCH] USB: check for device in zd1201_resume
    
    My patch adding PM support for zd1201 didn't check for the device on
    resume, which can oops if the device has been removed.
    
    This patch fixes it.
    
    Signed-off-by: Colin Leroy <colin@colino.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

diff --git a/drivers/usb/net/zd1201.c b/drivers/usb/net/zd1201.c
index eb0bff535b3c..3b387b005739 100644
--- a/drivers/usb/net/zd1201.c
+++ b/drivers/usb/net/zd1201.c
@@ -1905,6 +1905,9 @@ static int zd1201_resume(struct usb_interface *interface)
 {
 	struct zd1201 *zd = usb_get_intfdata(interface);
 
+	if (!zd || !zd->dev)
+		return -ENODEV;
+
 	netif_device_attach(zd->dev);
 
 	if (zd->was_enabled)

