commit df05b9eea34242cff39427aa1782e012cd696979
Author: Guoli Shu <Kerry.Shu@Sun.COM>
Date:   Fri Oct 2 16:03:23 2009 -0700

    6877660 Copying x86.miniroot over network via on-disk GRUB for install hangs

diff --git a/usr/src/grub/grub-0.97/netboot/fsys_tftp.c b/usr/src/grub/grub-0.97/netboot/fsys_tftp.c
index 0ba70d06ba..04501e56d6 100644
--- a/usr/src/grub/grub-0.97/netboot/fsys_tftp.c
+++ b/usr/src/grub/grub-0.97/netboot/fsys_tftp.c
@@ -395,7 +395,7 @@ buf_fill (int abort)
 	/* Neither TFTP_OACK nor TFTP_DATA.  */
 	break;
 
-      if ((block || bcounter) && (block != prevblock + (unsigned short) 1))
+      if ((block || bcounter) && (block != (unsigned short) (prevblock + 1)))
 	/* Block order should be continuous */
 	tp.u.ack.block = htons (block = prevblock);
       

