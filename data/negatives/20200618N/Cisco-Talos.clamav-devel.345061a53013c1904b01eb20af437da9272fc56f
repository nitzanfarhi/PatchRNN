commit 345061a53013c1904b01eb20af437da9272fc56f
Author: Steven Morgan <smorgan@sourcefire.com>
Date:   Thu Mar 20 15:55:01 2014 -0400

    append .UNOFFICIAL to OpenIOC virus names.

diff --git a/libclamav/openioc.c b/libclamav/openioc.c
index 5184caa5c..1e60083c9 100644
--- a/libclamav/openioc.c
+++ b/libclamav/openioc.c
@@ -268,7 +268,7 @@ int openioc_parse(const char * fname, int fd, struct cl_engine *engine)
             *vp-- = '\0';
             hashlen--;
         }
-        virusname = mpool_malloc(engine->mempool, ioclen+hashlen+2);
+        virusname = mpool_malloc(engine->mempool, ioclen+hashlen+13);
         if (NULL == virusname) {
             cli_dbgmsg("openioc_parse: mpool_malloc for virname memory failed.\n");
             xmlTextReaderClose(reader);
@@ -305,7 +305,7 @@ int openioc_parse(const char * fname, int fd, struct cl_engine *engine)
                 *vp++ = *sp;
             }
         }
-        *vp = '\0';
+        strcpy (vp, ".UNOFFICIAL");
         rc = hm_addhash_str(engine->hm_hdb, hash, 0, virusname);
         if (rc != CL_SUCCESS)
             cli_dbgmsg("openioc_parse: hm_addhash_str failed with %i hash len %i for %s.\n",

