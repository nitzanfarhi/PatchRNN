commit 72d678b85f783c7fc9f227f3c60a32aed1b74fb3
Author: Yehuda Sadeh <yehuda@hq.newdream.net>
Date:   Wed Mar 7 22:25:47 2012 -0800

    cls_rgw: fix rgw_bucket_init_index
    
    was failing to error in case header already existed
    
    Signed-off-by: Yehuda Sadeh <yehuda@hq.newdream.net>

diff --git a/src/cls_rgw.cc b/src/cls_rgw.cc
index cb5716b495..52d03cd662 100644
--- a/src/cls_rgw.cc
+++ b/src/cls_rgw.cc
@@ -106,6 +106,7 @@ int rgw_bucket_init_index(cls_method_context_t hctx, bufferlist *in, bufferlist
 
   if (header_bl.length() != 0) {
     CLS_LOG("ERROR: index already initialized\n");
+    return -EINVAL;
   }
 
   rgw_bucket_dir dir;

