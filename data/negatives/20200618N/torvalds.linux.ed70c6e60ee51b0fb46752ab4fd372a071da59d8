commit ed70c6e60ee51b0fb46752ab4fd372a071da59d8
Author: Michael BÃ¼sch <mb@bu3sch.de>
Date:   Fri Jan 7 19:48:05 2011 +0100

    ssb: Ignore dangling ethernet cores on wireless devices
    
    Some Broadcom based wireless devices contain dangling ethernet cores.
    This triggers the ssb probing mechanism and tries to load the b44 driver
    on this core.
    Ignore the dangling core in the ssb core scanning code to avoid
    access to the core and failure of b44 probing.
    
    Signed-off-by: Michael Buesch <mb@bu3sch.de>
    Tested-by: Larry Finger <Larry.Finger@lwfinger.net>
    Signed-off-by: John W. Linville <linville@tuxdriver.com>

diff --git a/drivers/ssb/scan.c b/drivers/ssb/scan.c
index 5a0985d4ce15..29884c00c4d5 100644
--- a/drivers/ssb/scan.c
+++ b/drivers/ssb/scan.c
@@ -420,6 +420,16 @@ int ssb_bus_scan(struct ssb_bus *bus,
 			bus->pcicore.dev = dev;
 #endif /* CONFIG_SSB_DRIVER_PCICORE */
 			break;
+		case SSB_DEV_ETHERNET:
+			if (bus->bustype == SSB_BUSTYPE_PCI) {
+				if (bus->host_pci->vendor == PCI_VENDOR_ID_BROADCOM &&
+				    (bus->host_pci->device & 0xFF00) == 0x4300) {
+					/* This is a dangling ethernet core on a
+					 * wireless device. Ignore it. */
+					continue;
+				}
+			}
+			break;
 		default:
 			break;
 		}

