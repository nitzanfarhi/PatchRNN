commit d26a4cfd62f7b628d5209643cf7cc95b9296deb8
Author: nevun <meep@abc.se>
Date:   Tue Jan 10 00:55:38 2017 +0100

    Make debugging work a bit better on OpenBSD: nudge get_base_from_maps() so it does not return 0 on OpenBSD just because the memory mapping does not contain the file name. (#6455)
    
    Copied the fallback code from cmd_debug.c:r_debug_get_baddr().
    
    getBaddrFromDebugger() from radare2.c also does the right thing. r_debug_get_baddr() probably should be exposed through the api so everyone can use one, maybe correct, version.

diff --git a/libr/core/file.c b/libr/core/file.c
index db79a4535..373c8b699 100755
--- a/libr/core/file.c
+++ b/libr/core/file.c
@@ -276,6 +276,13 @@ static ut64 get_base_from_maps(RCore *core, const char *file) {
 			//b = map->addr;
 		}
 	}
+	// fallback resolution copied from cmd_debug.c:r_debug_get_baddr
+	r_list_foreach (core->dbg->maps, iter, map) {
+		if (map->perm == 5) { // r-x
+			return map->addr;
+		}
+	}
+
 	return b;
 }
 #endif

