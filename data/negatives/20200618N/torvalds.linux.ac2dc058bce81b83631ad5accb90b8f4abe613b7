commit ac2dc058bce81b83631ad5accb90b8f4abe613b7
Author: Dave Chinner <dchinner@redhat.com>
Date:   Wed Aug 17 08:41:34 2016 +1000

    iomap: prepare iomap_fiemap for attribute mappings
    
    By bassing through an -ENOENT, similar to the old XFS implementation of
    FIEMAP_FLAG_XATTR.
    
    Signed-off-by: Dave Chinner <dchinner@redhat.com>
    [hch: split from a larger patch]
    Signed-off-by: Christoph Hellwig <hch@lst.de>
    Reviewed-by: Dave Chinner <dchinner@redhat.com>
    Signed-off-by: Dave Chinner <david@fromorbit.com>

diff --git a/fs/iomap.c b/fs/iomap.c
index 56c19e617a26..d9d1f50c36aa 100644
--- a/fs/iomap.c
+++ b/fs/iomap.c
@@ -476,6 +476,9 @@ int iomap_fiemap(struct inode *inode, struct fiemap_extent_info *fi,
 	while (len > 0) {
 		ret = iomap_apply(inode, start, len, 0, ops, &ctx,
 				iomap_fiemap_actor);
+		/* inode with no (attribute) mapping will give ENOENT */
+		if (ret == -ENOENT)
+			break;
 		if (ret < 0)
 			return ret;
 		if (ret == 0)

