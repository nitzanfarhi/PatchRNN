commit 7f29b324658de9e42e75af45e2a198f3ba300031
Author: Timo Sirainen <tss@iki.fi>
Date:   Sat May 9 19:50:14 2015 +0300

    anvil: Penalty tracking was moving last checksums wrongly with memcpy().
    Depending on the OS/etc this could have caused the checksum tracking to go
    wrong. Found by Coverity.

diff --git a/src/anvil/penalty.c b/src/anvil/penalty.c
index dd5bfa118..5034421a8 100644
--- a/src/anvil/penalty.c
+++ b/src/anvil/penalty.c
@@ -105,8 +105,8 @@ penalty_bump_checksum(struct penalty_rec *rec, unsigned int checksum)
 	for (i = 0; i < count; i++) {
 		if (checksums[i] == checksum) {
 			if (i > 0) {
-				memcpy(checksums + 1, checksums,
-				       sizeof(checksums[0]) * i);
+				memmove(checksums + 1, checksums,
+					sizeof(checksums[0]) * i);
 				checksums[0] = checksum;
 			}
 			return TRUE;

