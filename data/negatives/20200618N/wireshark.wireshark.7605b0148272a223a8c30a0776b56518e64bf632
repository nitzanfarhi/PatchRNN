commit 7605b0148272a223a8c30a0776b56518e64bf632
Author: Anders Broman <anders.broman@ericsson.com>
Date:   Tue Mar 13 14:11:08 2012 +0000

    From Jose Pedro Oliveira:
    the shb_userappl value wasn't being changed.
    
    https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6937
    
    svn path=/trunk/; revision=41530

diff --git a/editcap.c b/editcap.c
index b714f5a6e8..3d75f4281b 100644
--- a/editcap.c
+++ b/editcap.c
@@ -1147,8 +1147,10 @@ main(int argc, char *argv[])
           filename = g_strdup(argv[optind+1]);
 
         /* If we don't have an application name add Editcap */
-        if(shb_hdr->shb_user_appl == NULL)
+        if(shb_hdr->shb_user_appl == NULL) {
           g_snprintf(appname, sizeof(appname), "Editcap " VERSION);
+          shb_hdr->shb_user_appl = appname;
+        }
 
         pdh = wtap_dump_open_ng(filename, out_file_type, out_frame_type,
           snaplen ? MIN(snaplen, wtap_snapshot_length(wth)) : wtap_snapshot_length(wth),
diff --git a/tshark.c b/tshark.c
index 8be0382296..d1cd96f470 100644
--- a/tshark.c
+++ b/tshark.c
@@ -2703,8 +2703,10 @@ load_cap_file(capture_file *cf, char *save_file, int out_file_type,
       snapshot_length = WTAP_MAX_PACKET_SIZE;
     }
     /* If we don't have an application name add Tshark */
-    if(shb_hdr->shb_user_appl == NULL)
+    if(shb_hdr->shb_user_appl == NULL) {
         g_snprintf(appname, sizeof(appname), "TShark " VERSION "%s", wireshark_svnversion);
+        shb_hdr->shb_user_appl = appname;
+    }
 
     pdh = wtap_dump_open_ng(save_file, out_file_type, linktype, snapshot_length,
         FALSE /* compressed */, shb_hdr, idb_inf, &err);

