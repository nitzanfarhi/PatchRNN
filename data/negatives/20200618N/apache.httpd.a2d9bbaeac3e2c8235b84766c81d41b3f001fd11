commit a2d9bbaeac3e2c8235b84766c81d41b3f001fd11
Author: Doug MacEachern <dougm@apache.org>
Date:   Sun Jun 25 22:50:10 2000 +0000

    parms needs err_directive incase execute_now() returns non-NULL (e.g. if LoadModule fails)
    
    
    git-svn-id: https://svn.apache.org/repos/asf/httpd/httpd/trunk@85692 13f79535-47bb-0310-9956-ffa450edef68

diff --git a/server/config.c b/server/config.c
index fae6451c8b..74b49e72eb 100644
--- a/server/config.c
+++ b/server/config.c
@@ -863,11 +863,18 @@ static const char * ap_build_config_sub(ap_pool_t *p, ap_pool_t *temp_pool,
 	return NULL;
     }
 
+    newdir = ap_pcalloc(p, sizeof(ap_directive_t));
+    newdir->filename = parms->config_file->name;
+    newdir->line_num = parms->config_file->line_number;
+    newdir->directive = cmd_name;
+    newdir->args = ap_pstrdup(p, args);
+
     if ((cmd = ap_find_command_in_modules(cmd_name, &mod)) != NULL) {
         if (cmd->req_override & EXEC_ON_READ) {
             const char *retval;
             ap_directive_t *sub_tree = NULL;
 
+            parms->err_directive = newdir;
             retval = execute_now(cmd_name, args, parms, p, temp_pool, 
                                  &sub_tree, *curr_parent);
             if (*current) {
@@ -892,12 +899,6 @@ static const char * ap_build_config_sub(ap_pool_t *p, ap_pool_t *temp_pool,
         }
     }
 
-    newdir = ap_pcalloc(p, sizeof(ap_directive_t));
-    newdir->filename = parms->config_file->name;
-    newdir->line_num = parms->config_file->line_number;
-    newdir->directive = cmd_name;
-    newdir->args = ap_pstrdup(p, args);
-
     if (cmd_name[0] == '<') {
         if (cmd_name[1] != '/') {
             (*current) = ap_add_node(curr_parent, *current, newdir, 1);

