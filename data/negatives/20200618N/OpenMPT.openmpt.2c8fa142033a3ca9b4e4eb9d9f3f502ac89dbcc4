commit 2c8fa142033a3ca9b4e4eb9d9f3f502ac89dbcc4
Author: JÃ¶rn Heusipp <manxorist@users.sourceforge.net>
Date:   Tue Feb 4 13:06:44 2014 +0000

    [Fix] PP20 unpacker: Add a check back that was missed in r3640.
    
    
    git-svn-id: https://source.openmpt.org/svn/openmpt/branches/manx/unpack-cleanup@3641 56274372-70c3-4bfc-bfc3-4c3a0b034d27

diff --git a/soundlib/Mmcmp.cpp b/soundlib/Mmcmp.cpp
index e0eb49dbf..7c6bcc2bd 100644
--- a/soundlib/Mmcmp.cpp
+++ b/soundlib/Mmcmp.cpp
@@ -711,6 +711,7 @@ bool UnpackPP20(std::vector<char> &unpackedData, FileReader &file)
 	dstLen |= file.ReadUint8() << 0;
 	if(dstLen < PP20_UNPACKED_SIZE_MIN) return false;
 	if(dstLen > PP20_UNPACKED_SIZE_MAX) return false;
+	if(dstLen > 16*file.GetLength()) return false;
 	unpackedData.resize(dstLen);
 	file.Seek(4);
 	PP20_DoUnpack(reinterpret_cast<const uint8 *>(file.GetRawData()), file.GetLength() - 4, reinterpret_cast<uint8 *>(&(unpackedData[0])), dstLen);

