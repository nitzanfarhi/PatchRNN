commit f5274c2d0d8d91076af8605187d762dfa0b92825
Author: Javi Merino <javi.merino@arm.com>
Date:   Mon Feb 6 15:45:36 2012 +0100

    ARM: 7319/1: Print debug info for SIGBUS in user faults
    
    Print debug information on user faults for SIGBUS if user_debug = 16
    in the kernel command line.
    
    Reference: <1327333344-26340-1-git-send-email-javi.merino@arm.com>
    
    Signed-off-by: Javi Merino <javi.merino@arm.com>
    Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>

diff --git a/arch/arm/mm/fault.c b/arch/arm/mm/fault.c
index bb7eac381a8e..40c43a94ba72 100644
--- a/arch/arm/mm/fault.c
+++ b/arch/arm/mm/fault.c
@@ -164,7 +164,8 @@ __do_user_fault(struct task_struct *tsk, unsigned long addr,
 	struct siginfo si;
 
 #ifdef CONFIG_DEBUG_USER
-	if (user_debug & UDBG_SEGV) {
+	if (((user_debug & UDBG_SEGV) && (sig == SIGSEGV)) ||
+	    ((user_debug & UDBG_BUS)  && (sig == SIGBUS))) {
 		printk(KERN_DEBUG "%s: unhandled page fault (%d) at 0x%08lx, code 0x%03x\n",
 		       tsk->comm, sig, addr, fsr);
 		show_pte(tsk->mm, addr);

