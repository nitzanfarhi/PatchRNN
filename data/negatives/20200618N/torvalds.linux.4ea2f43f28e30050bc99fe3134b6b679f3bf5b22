commit 4ea2f43f28e30050bc99fe3134b6b679f3bf5b22
Author: Wu Fengguang <fengguang.wu@intel.com>
Date:   Mon Dec 14 17:57:57 2009 -0800

    /dev/mem: remove redundant test on len
    
    The len test in write_kmem() is always true, so can be reduced.
    
    Signed-off-by: Wu Fengguang <fengguang.wu@intel.com>
    Acked-by: Andi Kleen <ak@linux.intel.com>
    Cc: Marcelo Tosatti <mtosatti@redhat.com>
    Cc: Greg Kroah-Hartman <gregkh@suse.de>
    Cc: Mark Brown <broonie@opensource.wolfsonmicro.com>
    Cc: Johannes Berg <johannes@sipsolutions.net>
    Cc: Avi Kivity <avi@qumranet.com>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

diff --git a/drivers/char/mem.c b/drivers/char/mem.c
index fba76fb55abf..f0a90590cb1a 100644
--- a/drivers/char/mem.c
+++ b/drivers/char/mem.c
@@ -581,14 +581,12 @@ static ssize_t write_kmem(struct file * file, const char __user * buf,
 
 			if (len > PAGE_SIZE)
 				len = PAGE_SIZE;
-			if (len) {
-				written = copy_from_user(kbuf, buf, len);
-				if (written) {
-					if (wrote + virtr)
-						break;
-					free_page((unsigned long)kbuf);
-					return -EFAULT;
-				}
+			written = copy_from_user(kbuf, buf, len);
+			if (written) {
+				if (wrote + virtr)
+					break;
+				free_page((unsigned long)kbuf);
+				return -EFAULT;
 			}
 			len = vwrite(kbuf, (char *)p, len);
 			count -= len;

