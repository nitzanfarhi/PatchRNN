commit 1fb4a17f6e47d86b25bfc4fd9df4301bca09c999
Author: Hartmut Birr <e9hack@googlemail.com>
Date:   Mon Jul 2 13:39:41 2007 -0300

    V4L/DVB (5822): Fix the return value in ttpci_budget_init()
    
    if the call to budget_register() fails in ttpci_budget_int(),
    ttpci_budget_init() returns success. The attached patch will
    fix this problem.
    
    Signed-off-by: Hartmut Birr <e9hack@googlemail.com>
    Signed-off-by: Michael Krufky <mkrufky@linuxtv.org>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@infradead.org>

diff --git a/drivers/media/dvb/ttpci/budget-core.c b/drivers/media/dvb/ttpci/budget-core.c
index 2557ac9620d0..b611f2b1f8bc 100644
--- a/drivers/media/dvb/ttpci/budget-core.c
+++ b/drivers/media/dvb/ttpci/budget-core.c
@@ -529,7 +529,7 @@ int ttpci_budget_init(struct budget *budget, struct saa7146_dev *dev,
 	if (bi->type != BUDGET_FS_ACTIVY)
 		saa7146_setgpio(dev, 2, SAA7146_GPIO_OUTHI);
 
-	if (budget_register(budget) == 0)
+	if ((ret = budget_register(budget)) == 0)
 		return 0; /* Everything OK */
 
 	/* An error occurred, cleanup resources */

