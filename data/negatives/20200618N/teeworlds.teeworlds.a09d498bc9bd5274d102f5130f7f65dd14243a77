commit a09d498bc9bd5274d102f5130f7f65dd14243a77
Author: oy <Tom_Adams@web.de>
Date:   Fri Nov 4 18:43:31 2016 +0100

    added some checks to snap handling

diff --git a/src/engine/client/client.cpp b/src/engine/client/client.cpp
index 55b3c5e4..b7b5909d 100644
--- a/src/engine/client/client.cpp
+++ b/src/engine/client/client.cpp
@@ -1234,7 +1234,7 @@ void CClient::ProcessServerPacket(CNetChunk *pPacket)
 
 			pData = (const char *)Unpacker.GetRaw(PartSize);
 
-			if(Unpacker.Error())
+			if(Unpacker.Error() || NumParts < 1 || NumParts > CSnapshot::MAX_PARTS || Part < 0 | Part >= NumParts || PartSize < 0 || PartSize > MAX_SNAPSHOT_PACKSIZE)
 				return;
 
 			if(GameTick >= m_CurrentRecvTick)
diff --git a/src/engine/shared/snapshot.h b/src/engine/shared/snapshot.h
index 94e7bbc7..a1e09117 100644
--- a/src/engine/shared/snapshot.h
+++ b/src/engine/shared/snapshot.h
@@ -31,7 +31,8 @@ class CSnapshot
 public:
 	enum
 	{
-		MAX_SIZE=64*1024
+		MAX_PARTS	= 64,
+		MAX_SIZE	= MAX_PARTS*1024
 	};
 
 	void Clear() { m_DataSize = 0; m_NumItems = 0; }

