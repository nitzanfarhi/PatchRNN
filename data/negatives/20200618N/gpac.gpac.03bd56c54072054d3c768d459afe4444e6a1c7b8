commit 03bd56c54072054d3c768d459afe4444e6a1c7b8
Author: Jean Le Feuvre <jeanlf@users.sourceforge.net>
Date:   Tue Dec 8 18:10:13 2009 +0000

    Removed support for "shutdown" function in VRML scripts as it may crash because of JS GC
    
    
    git-svn-id: http://svn.code.sf.net/p/gpac/code/trunk/gpac@1552 63c20433-aa62-49bd-875c-5a186b69a8fb

diff --git a/src/scenegraph/vrml_smjs.c b/src/scenegraph/vrml_smjs.c
index 3dbda3db5..0868bcae4 100644
--- a/src/scenegraph/vrml_smjs.c
+++ b/src/scenegraph/vrml_smjs.c
@@ -3750,9 +3750,13 @@ static void JS_PreDestroy(GF_Node *node)
 
 	GF_LOG(GF_LOG_DEBUG, GF_LOG_SCRIPT, ("[Script] Destroying script node %s", gf_node_get_log_name(node) ));
 
+	/*"shutdown" is no longer supported, as it is typically called when one of a parent node is destroyed through 
+	a GC call. Calling JS_LookupProperty or JS_CallFunctionValue when GC is running will crash SpiderMonkey*/
+#if 0
 	if (JS_LookupProperty(priv->js_ctx, priv->js_obj, "shutdown", &fval))
 		if (! JSVAL_IS_VOID(fval))
 			JS_CallFunctionValue(priv->js_ctx, priv->js_obj, fval, 0, NULL, &rval);
+#endif
 
 	/*unprotect all cached objects from GC*/
 	JS_ReleaseRootObjects(priv);

