commit 6461c8330e264be9d1ed11912b874b4054db2990
Author: Martin Pitt <martinpitt@gnome.org>
Date:   Fri May 24 09:35:44 2013 +0200

    dosfslabel: Do not read beyond string length (Closes: #709587).
    
    When checking whether the label contains any lower-case characters, do not read
    beyond the end of the string.
    
    Signed-off-by: Daniel Baumann <mail@daniel-baumann.ch>

diff --git a/src/dosfslabel.c b/src/dosfslabel.c
index edfb60c..f7df7f0 100644
--- a/src/dosfslabel.c
+++ b/src/dosfslabel.c
@@ -115,7 +115,7 @@ int main(int argc, char *argv[])
 		    "dosfslabel: labels can be no longer than 11 characters\n");
 	    exit(1);
 	}
-        for (i = 0; i < 11; i++)
+        for (i = 0; label[i] && i < 11; i++)
           /* don't know if here should be more strict !uppercase(label[i])*/
           if (islower(label[i])) {
             fprintf(stderr,

