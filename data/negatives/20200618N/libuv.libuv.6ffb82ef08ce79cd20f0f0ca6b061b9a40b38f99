commit 6ffb82ef08ce79cd20f0f0ca6b061b9a40b38f99
Author: Saúl Ibarra Corretgé <saghul@gmail.com>
Date:   Wed Jun 18 01:13:21 2014 +0200

    unix: don't run i/o callbacks after prepare callbacks
    
    Run them after timers, like Windows does.
    
    Closes #1317

diff --git a/src/unix/core.c b/src/unix/core.c
index 9680a2d0..402bb00e 100644
--- a/src/unix/core.c
+++ b/src/unix/core.c
@@ -283,9 +283,9 @@ int uv_run(uv_loop_t* loop, uv_run_mode mode) {
 
     uv__update_time(loop);
     uv__run_timers(loop);
+    uv__run_pending(loop);
     uv__run_idle(loop);
     uv__run_prepare(loop);
-    uv__run_pending(loop);
 
     timeout = 0;
     if ((mode & UV_RUN_NOWAIT) == 0)

