commit 3353bebe7c89725ab2f476b9d8d618259402d52e
Author: Len Brown <len.brown@intel.com>
Date:   Tue Nov 30 18:21:46 2010 -0500

    ACPI: video: fix build for VIDEO_OUTPUT_CONTROL=n
    
    drivers/built-in.o: In function `acpi_video_bus_put_devices':
    video.c:(.text+0x79663): undefined reference to
    `video_output_unregister'
    drivers/built-in.o: In function `acpi_video_bus_add':
    video.c:(.text+0x7b0b3): undefined reference to `video_output_register'
    
    Signed-off-by: Len Brown <len.brown@intel.com>

diff --git a/include/linux/video_output.h b/include/linux/video_output.h
index 2fb46bc9340d..ed5cdeb3604d 100644
--- a/include/linux/video_output.h
+++ b/include/linux/video_output.h
@@ -23,6 +23,7 @@
 #ifndef _LINUX_VIDEO_OUTPUT_H
 #define _LINUX_VIDEO_OUTPUT_H
 #include <linux/device.h>
+#include <linux/err.h>
 struct output_device;
 struct output_properties {
 	int (*set_state)(struct output_device *);
@@ -34,9 +35,23 @@ struct output_device {
 	struct device dev;
 };
 #define to_output_device(obj) container_of(obj, struct output_device, dev)
+#if	defined(CONFIG_VIDEO_OUTPUT_CONTROL) || defined(CONFIG_VIDEO_OUTPUT_CONTROL_MODULE)
 struct output_device *video_output_register(const char *name,
 	struct device *dev,
 	void *devdata,
 	struct output_properties *op);
 void video_output_unregister(struct output_device *dev);
+#else
+static struct output_device *video_output_register(const char *name,
+        struct device *dev,
+        void *devdata,
+        struct output_properties *op)
+{
+	return ERR_PTR(-ENODEV);
+}
+static void video_output_unregister(struct output_device *dev)
+{
+	return;
+}
+#endif
 #endif

