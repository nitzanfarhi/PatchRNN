commit 7c046c3c983010cdf8ca2b8384b59be6d890c517
Author: petr@mysql.com <>
Date:   Mon Nov 22 17:50:42 2004 +0300

    Fixed a problem with Innodb_buffer_pool_pages_latched status variable.

diff --git a/innobase/buf/buf0buf.c b/innobase/buf/buf0buf.c
index 376deedabec..d686b559528 100644
--- a/innobase/buf/buf0buf.c
+++ b/innobase/buf/buf0buf.c
@@ -2152,7 +2152,8 @@ buf_get_latched_pages_number(void)
 
                block = buf_pool_get_nth_block(buf_pool, i);
 
-               if ((block->buf_fix_count != 0) || (block->io_fix != 0))
+               if (((block->buf_fix_count != 0) || (block->io_fix != 0)) &&
+                    block->magic_n == BUF_BLOCK_MAGIC_N )
                        fixed_pages_number++;
         }
 

