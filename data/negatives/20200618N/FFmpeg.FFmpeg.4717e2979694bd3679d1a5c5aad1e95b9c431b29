commit 4717e2979694bd3679d1a5c5aad1e95b9c431b29
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Tue Nov 8 00:09:44 2011 +0100

    flvdec: skip duplicate indexes
    
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavformat/flvdec.c b/libavformat/flvdec.c
index d48d367500..e2f7f9c16d 100644
--- a/libavformat/flvdec.c
+++ b/libavformat/flvdec.c
@@ -152,6 +152,11 @@ static int parse_keyframes_index(AVFormatContext *s, AVIOContext *ioc, AVStream
         return 0;
     }
 
+    if(vstream->nb_index_entries>0){
+        av_log(s, AV_LOG_WARNING, "Skiping duplicate index\n");
+        return 0;
+    }
+
     while (avio_tell(ioc) < max_pos - 2 && amf_get_string(ioc, str_val, sizeof(str_val)) > 0) {
         int64_t** current_array;
         unsigned int arraylen;

