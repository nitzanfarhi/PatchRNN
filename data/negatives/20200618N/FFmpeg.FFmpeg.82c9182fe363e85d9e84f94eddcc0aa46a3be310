commit 82c9182fe363e85d9e84f94eddcc0aa46a3be310
Author: Reimar DÃ¶ffinger <Reimar.Doeffinger@gmx.de>
Date:   Sat Jul 4 18:24:43 2009 +0000

    If the end of the input buffer is reached while decoding MJPEG and at least
    a valid SOF was found, emulate an EOI.
    This allows e.g. to at least decode the available part of incomplete MJPEG frames.
    
    Originally committed as revision 19344 to svn://svn.ffmpeg.org/ffmpeg/trunk

diff --git a/libavcodec/mjpegdec.c b/libavcodec/mjpegdec.c
index a40dfdbef5..a18403d268 100644
--- a/libavcodec/mjpegdec.c
+++ b/libavcodec/mjpegdec.c
@@ -1479,6 +1479,10 @@ not_the_end:
             }
         }
     }
+    if (s->got_picture) {
+        av_log(avctx, AV_LOG_WARNING, "EOI missing, emulating\n");
+        goto eoi_parser;
+    }
     av_log(avctx, AV_LOG_FATAL, "No JPEG data found in image\n");
     return -1;
 the_end:

