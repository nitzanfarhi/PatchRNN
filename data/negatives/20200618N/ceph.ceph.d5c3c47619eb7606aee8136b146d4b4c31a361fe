commit d5c3c47619eb7606aee8136b146d4b4c31a361fe
Author: Joao Eduardo Luis <joao.luis@inktank.com>
Date:   Thu Oct 4 17:34:37 2012 +0100

    mon: Elector: clean ack set on election start
    
    We should never consider old 'acks' from monitors on a new election. We
    usually do it, but we didn't if an election expired, because this code
    didn't foresee the possibility of monitors changing ranks in-between
    elections -- which doesn't happen if we specify the monmap during the
    monitor's mkfs, but may happen when relying on 'mon initial peers'.
    
    Failing to do so triggered an assertion after fixing bug #3252.
    
    Backport: argonaut
    
    Signed-off-by: Joao Eduardo Luis <joao.luis@inktank.com>
    Signed-off-by: Sage Weil <sage@inktank.com>

diff --git a/src/mon/Elector.cc b/src/mon/Elector.cc
index 970b8e4438..684762d15f 100644
--- a/src/mon/Elector.cc
+++ b/src/mon/Elector.cc
@@ -67,6 +67,8 @@ void Elector::start()
     return;
   }
   dout(5) << "start -- can i be leader?" << dendl;
+
+  acked_me.clear();
   
   // start by trying to elect me
   if (epoch % 2 == 0) 

