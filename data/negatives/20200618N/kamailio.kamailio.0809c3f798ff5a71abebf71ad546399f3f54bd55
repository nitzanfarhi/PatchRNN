commit 0809c3f798ff5a71abebf71ad546399f3f54bd55
Author: Maxim Sobolev <sobomax@sippysoft.com>
Date:   Thu Nov 2 19:43:51 2006 +0000

    Improve system malloc support:
    
    1. Convert size argument into unsigned long when printing out, so that
    it doesn't generate compiler warning;
    
    2. In pkg_malloc() wrapper use less generic temporary variable name to
    avoid potential namespace conflicts with the modules code.
    
    3. Provide pkg_realloc() wrapper.
    
    Sponsored by:   Sippy Software, Inc.

diff --git a/mem/mem.h b/mem/mem.h
index 70e833abd..63c465c9e 100644
--- a/mem/mem.h
+++ b/mem/mem.h
@@ -123,9 +123,13 @@
 #	include <stdlib.h>
 #	include "memdbg.h"
 #	define pkg_malloc(s) \
-	(  { void *v; v=malloc((s)); \
-	   MDBG("malloc %p size %d end %p\n", v, (s), (char*)v+(s));\
-	   v; } )
+	(  { void *____v123; ____v123=malloc((s)); \
+	   MDBG("malloc %p size %lu end %p\n", ____v123, (unsigned long)(s), (char*)____v123+(s));\
+	   ____v123; } )
+#	define pkg_realloc(p, s) \
+	(  { void *____v123; ____v123=realloc(p, s); \
+	   MDBG("realloc %p size %lu end %p\n", ____v123, (unsigned long)(s), (char*)____v123+(s));\
+	    ____v123; } )
 #	define pkg_free(p)  do{ MDBG("free %p\n", (p)); free((p)); }while(0);
 #	define pkg_status()
 #endif

