commit 84d17760f67f1fb6b9f93821deb22c90c87bea7f
Author: Dai Ngo <dai.ngo@sun.com>
Date:   Thu Jul 22 19:44:38 2010 -0700

    6869194 zoneadm hanging on some local zone'ed systems

diff --git a/usr/src/uts/common/fs/autofs/auto_vnops.c b/usr/src/uts/common/fs/autofs/auto_vnops.c
index ebe3ce4055..25eede67fd 100644
--- a/usr/src/uts/common/fs/autofs/auto_vnops.c
+++ b/usr/src/uts/common/fs/autofs/auto_vnops.c
@@ -187,10 +187,13 @@ auto_getattr(
 		if (newvp == NULL)
 			goto defattr;
 
-		if (error = vn_vfsrlock_wait(vp))
+		if (error = vn_vfsrlock_wait(vp)) {
+			VN_RELE(newvp);
 			return (error);
+		}
 
 		vfsp = newvp->v_vfsp;
+		VN_RELE(newvp);
 	} else {
 		/*
 		 * Recursive auto_getattr/mount; go to the vfsp == NULL

