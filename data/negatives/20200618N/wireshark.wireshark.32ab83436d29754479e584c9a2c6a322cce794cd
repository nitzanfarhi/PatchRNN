commit 32ab83436d29754479e584c9a2c6a322cce794cd
Author: Pascal Quantin <pascal.quantin@gmail.com>
Date:   Sun Feb 11 20:52:42 2018 +0100

    SIGCOMP: use correct message length
    
    Since g2a80fe283c (2005-10-06!) length initialization was moved, and
    the message length is no more correct (previously tvb_length_remaining()
    was called with offset equal to 0, which is no more the case after the
    change).
    
    Bug: 14410
    Change-Id: I2f00be83fa17ad7344d0d75f4a899f169d7a622b
    Reviewed-on: https://code.wireshark.org/review/25735
    Petri-Dish: Pascal Quantin <pascal.quantin@gmail.com>
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    Petri-Dish: Anders Broman <a.broman58@gmail.com>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Michael Mann <mmann78@netscape.net>

diff --git a/epan/dissectors/packet-sigcomp.c b/epan/dissectors/packet-sigcomp.c
index 20ff5823fb..a05336b5b0 100644
--- a/epan/dissectors/packet-sigcomp.c
+++ b/epan/dissectors/packet-sigcomp.c
@@ -4520,7 +4520,7 @@ dissect_sigcomp_tcp(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *_
 
     col_clear(pinfo->cinfo, COL_INFO);
 
-    length = tvb_captured_length_remaining(tvb,offset);
+    length = tvb_reported_length(tvb);
 
 try_again:
     /* create display subtree for the protocol */

