commit 7de3dc31671e34d7414d88e8b091aa1b139641ad
Author: Stig Bj√∏rlykke <stig@bjorlykke.org>
Date:   Wed Aug 11 21:37:04 2010 +0000

    Call tvb_get_bits32() if leading_zero_bits > 16.
    
    svn path=/trunk/; revision=33775

diff --git a/epan/dissectors/packet-h264.c b/epan/dissectors/packet-h264.c
index c3fb0ddcf9..083e70f2bd 100644
--- a/epan/dissectors/packet-h264.c
+++ b/epan/dissectors/packet-h264.c
@@ -518,7 +518,9 @@ dissect_h264_exp_golomb_code(proto_tree *tree, int hf_index, tvbuff_t *tvb, gint
 	codenum = 1;
 	codenum = codenum << leading_zero_bits;
 	mask = codenum>>1;
-	if (leading_zero_bits > 8)
+	if (leading_zero_bits > 16)
+		value = tvb_get_bits32(tvb, bit_offset,leading_zero_bits, FALSE);
+	else if (leading_zero_bits > 8)
 		value = tvb_get_bits16(tvb, bit_offset,leading_zero_bits, FALSE);
 	else
 		value = tvb_get_bits8(tvb, bit_offset,leading_zero_bits );

