commit 4007cc88ceec8892b74792f0a10983b140beae72
Author: Vlad Yasevich <vladislav.yasevich@hp.com>
Date:   Fri Sep 4 18:21:00 2009 -0400

    sctp: Correctly track if AUTH has been bundled.
    
    We currently track if AUTH has been bundled using the 'auth'
    pointer to the chunk.  However, AUTH is disallowed after DATA
    is already in the packet, so we need to instead use the
    'has_auth' field.
    
    Signed-off-by: Vlad Yasevich <vladislav.yasevich@hp.com>

diff --git a/net/sctp/output.c b/net/sctp/output.c
index 1f9336177ee2..e47398c07185 100644
--- a/net/sctp/output.c
+++ b/net/sctp/output.c
@@ -220,7 +220,7 @@ static sctp_xmit_t sctp_packet_bundle_auth(struct sctp_packet *pkt,
 	/* See if this is an auth chunk we are bundling or if
 	 * auth is already bundled.
 	 */
-	if (chunk->chunk_hdr->type == SCTP_CID_AUTH || pkt->auth)
+	if (chunk->chunk_hdr->type == SCTP_CID_AUTH || pkt->has_auth)
 		return retval;
 
 	/* if the peer did not request this chunk to be authenticated,

