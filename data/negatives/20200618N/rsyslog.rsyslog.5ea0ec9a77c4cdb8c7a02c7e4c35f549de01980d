commit 5ea0ec9a77c4cdb8c7a02c7e4c35f549de01980d
Author: Andre Lorbach <alorbach@adiscon.com>
Date:   Thu Jun 11 23:55:44 2015 -0700

    KSI: Fixed saving of imprints

diff --git a/runtime/librsksi.c b/runtime/librsksi.c
index baabb1284..2a38a02fb 100644
--- a/runtime/librsksi.c
+++ b/runtime/librsksi.c
@@ -311,9 +311,11 @@ tlvWriteHash(ksifile ksi, uint16_t tlvtype, KSI_DataHash *rec)
 		reportKSIAPIErr(ksi->ctx, ksi, "KSI_DataHash_extract", r);
 		goto done;
 	}
-	tlvlen = digest_len;
+	tlvlen = 1 + digest_len;
 	r = tlv16Write(ksi, 0x00, tlvtype, tlvlen);
 	if(r != 0) goto done;
+	r = tlvbufAddOctet(ksi, hashIdentifier(ksi->hashAlg));
+	if(r != 0) goto done;
 	r = tlvbufAddOctetString(ksi, (unsigned char*)digest, digest_len);
 done:	return r;
 }
diff --git a/runtime/librsksi_read.c b/runtime/librsksi_read.c
index b2777df55..f68e7d6cd 100644
--- a/runtime/librsksi_read.c
+++ b/runtime/librsksi_read.c
@@ -350,7 +350,7 @@ rsksi_tlvDecodeIMPRINT(tlvrecord_t *rec, imprint_t **imprint)
 	}
 
 	imp->hashID = rec->data[0];
-	if(rec->tlvlen != /*1 + */ hashOutputLengthOctets(imp->hashID)) {
+	if(rec->tlvlen != 1 + hashOutputLengthOctets(imp->hashID)) {
 		r = RSGTE_LEN;
 		goto done;
 	}

