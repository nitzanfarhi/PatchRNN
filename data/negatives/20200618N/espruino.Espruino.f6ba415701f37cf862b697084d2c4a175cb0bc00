commit f6ba415701f37cf862b697084d2c4a175cb0bc00
Author: Gordon Williams <gw@pur3.co.uk>
Date:   Tue Apr 29 18:47:32 2014 +0100

    REAPPLY_TO_BE_SQUASHED: WIZnet improvements (specifically on HTTP server)

diff --git a/libs/network/wiznet/Ethernet/socket.c b/libs/network/wiznet/Ethernet/socket.c
index 94e118cc..89fe4bb1 100644
--- a/libs/network/wiznet/Ethernet/socket.c
+++ b/libs/network/wiznet/Ethernet/socket.c
@@ -53,6 +53,7 @@
 //! THE POSSIBILITY OF SUCH DAMAGE.
 //
 //*****************************************************************************
+#include "jsparse.h"
 #include "Ethernet/socket.h"
 
 //M20150401 : Typing Error
@@ -274,10 +275,12 @@ int8_t connect(uint8_t sn, uint8_t * addr, uint16_t port)
 	setSn_DIPR(sn,addr);
 	setSn_DPORT(sn,port);
 	setSn_CR(sn,Sn_CR_CONNECT);
-   while(getSn_CR(sn));
+   while(getSn_CR(sn) && !jspIsInterrupted());
    if(sock_io_mode & (1<<sn)) return SOCK_BUSY;
    while(getSn_SR(sn) != SOCK_ESTABLISHED)
    {
+        if (jspIsInterrupted())
+          return SOCKERR_TIMEOUT;
 		if (getSn_IR(sn) & Sn_IR_TIMEOUT)
 		{
 			setSn_IR(sn, Sn_IR_TIMEOUT);

