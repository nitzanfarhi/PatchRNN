commit ab0c127fbb21c19adb34b78ba26b84748d0cd4de
Author: Johan Hedberg <johan.hedberg@intel.com>
Date:   Mon Nov 2 14:39:16 2015 +0200

    Bluetooth: L2CAP: Fix checked range when allocating new CID
    
    The 'dyn_end' value is also a valid CID so it should be included in
    the range of values checked.
    
    Signed-off-by: Johan Hedberg <johan.hedberg@intel.com>
    Signed-off-by: Marcel Holtmann <marcel@holtmann.org>

diff --git a/net/bluetooth/l2cap_core.c b/net/bluetooth/l2cap_core.c
index 8fd36f59dcde..fdb7989e2997 100644
--- a/net/bluetooth/l2cap_core.c
+++ b/net/bluetooth/l2cap_core.c
@@ -239,7 +239,7 @@ static u16 l2cap_alloc_cid(struct l2cap_conn *conn)
 	else
 		dyn_end = L2CAP_CID_DYN_END;
 
-	for (cid = L2CAP_CID_DYN_START; cid < dyn_end; cid++) {
+	for (cid = L2CAP_CID_DYN_START; cid <= dyn_end; cid++) {
 		if (!__l2cap_get_chan_by_scid(conn, cid))
 			return cid;
 	}

