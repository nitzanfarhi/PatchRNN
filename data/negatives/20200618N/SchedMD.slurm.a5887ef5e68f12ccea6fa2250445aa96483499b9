commit a5887ef5e68f12ccea6fa2250445aa96483499b9
Author: Danny Auble <da@schedmd.com>
Date:   Mon Dec 7 16:58:51 2015 -0800

    Addition to 9f98610d3fc.  This handles the tres_alloc_cnt not existing in
    _calc_billable_tres that was missed there.

diff --git a/src/plugins/priority/multifactor/priority_multifactor.c b/src/plugins/priority/multifactor/priority_multifactor.c
index 56bb7b591b..ec85a70caf 100644
--- a/src/plugins/priority/multifactor/priority_multifactor.c
+++ b/src/plugins/priority/multifactor/priority_multifactor.c
@@ -756,6 +756,10 @@ static double _calc_billable_tres(struct job_record *job_ptr, time_t start_time)
 	double *billing_weights = NULL;
 	struct part_record *part_ptr = job_ptr->part_ptr;
 
+	/* We don't have any resources allocated, just return 0. */
+	if (!job_ptr->tres_alloc_cnt)
+		return 0;
+
 	/* Don't recalculate unless the job is new or resized */
 	if ((!fuzzy_equal(job_ptr->billable_tres, NO_VAL)) &&
 	    difftime(job_ptr->resize_time, start_time) < 0.0)

