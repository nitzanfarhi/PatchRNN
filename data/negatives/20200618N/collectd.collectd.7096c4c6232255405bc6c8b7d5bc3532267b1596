commit 7096c4c6232255405bc6c8b7d5bc3532267b1596
Author: Ruben Kerkhof <ruben@rubenkerkhof.com>
Date:   Sat Feb 28 20:05:14 2015 +0100

    Powerdns plugin: fix logging on failed lookup
    
    Don't look past the end of the array but check the boundary first.

diff --git a/src/powerdns.c b/src/powerdns.c
index a140a126..f3d40830 100644
--- a/src/powerdns.c
+++ b/src/powerdns.c
@@ -259,9 +259,6 @@ static void submit (const char *plugin_instance, /* {{{ */
     if (strcmp (lookup_table[i].name, pdns_type) == 0)
       break;
 
-  if (lookup_table[i].type == NULL)
-    return;
-
   if (i >= lookup_table_length)
   {
     INFO ("powerdns plugin: submit: Not found in lookup table: %s = %s;",
@@ -269,6 +266,9 @@ static void submit (const char *plugin_instance, /* {{{ */
     return;
   }
 
+  if (lookup_table[i].type == NULL)
+    return;
+
   type = lookup_table[i].type;
   type_instance = lookup_table[i].type_instance;
 

