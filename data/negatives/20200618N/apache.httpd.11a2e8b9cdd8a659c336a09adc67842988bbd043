commit 11a2e8b9cdd8a659c336a09adc67842988bbd043
Author: William A. Rowe Jr <wrowe@apache.org>
Date:   Thu May 3 04:15:21 2001 +0000

      Damnable casts
    
    Submitted by:  Jessie Oberreuter <jessieo@westside.com>
    
    
    git-svn-id: https://svn.apache.org/repos/asf/httpd/httpd/trunk@88980 13f79535-47bb-0310-9956-ffa450edef68

diff --git a/modules/arch/win32/mod_isapi.c b/modules/arch/win32/mod_isapi.c
index 2ce6bc2833..5753afbeaf 100644
--- a/modules/arch/win32/mod_isapi.c
+++ b/modules/arch/win32/mod_isapi.c
@@ -655,7 +655,7 @@ BOOL WINAPI WriteClient (HCONN ConnID, LPVOID Buffer, LPDWORD lpwdwBytes,
         ; /* XXX: Fake it */
 
     bb = apr_brigade_create(r->pool);
-    b = apr_bucket_transient_create(Buffer, (apr_size_t)lpwdwBytes);
+    b = apr_bucket_transient_create(Buffer, *lpwdwBytes);
     APR_BRIGADE_INSERT_TAIL(bb, b);
     b = apr_bucket_eos_create();
     APR_BRIGADE_INSERT_TAIL(bb, b);
@@ -728,6 +728,10 @@ static apr_off_t SendResponseHeaderEx(isapi_cid *cid, const char *stat,
     
     /* Headers will actually go when they are good and ready */
 
+    /* If all went well, tell the caller we consumed the headers complete */
+    if (!termch)
+        return(headlen);
+
     /* Any data left is sent directly by the caller, all we
      * give back is the size of the headers we consumed
      */

