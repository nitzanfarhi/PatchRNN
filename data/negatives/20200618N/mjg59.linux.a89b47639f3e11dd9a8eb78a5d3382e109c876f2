commit a89b47639f3e11dd9a8eb78a5d3382e109c876f2
Author: Michael Kerrisk <mtk.manpages@gmail.com>
Date:   Fri Sep 10 20:26:56 2010 +0000

    ipv4: enable getsockopt() for IP_NODEFRAG
    
    While integrating your man-pages patch for IP_NODEFRAG, I noticed
    that this option is settable by setsockopt(), but not gettable by
    getsockopt(). I suppose this is not intended. The (untested,
    trivial) patch below adds getsockopt() support.
    
    Signed-off-by: Michael kerrisk <mtk.manpages@gmail.com>
    Acked-by: Jiri Olsa <jolsa@redhat.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/net/ipv4/ip_sockglue.c b/net/ipv4/ip_sockglue.c
index 6c40a8c46e79..64b70ad162e3 100644
--- a/net/ipv4/ip_sockglue.c
+++ b/net/ipv4/ip_sockglue.c
@@ -1129,6 +1129,9 @@ static int do_ip_getsockopt(struct sock *sk, int level, int optname,
 	case IP_HDRINCL:
 		val = inet->hdrincl;
 		break;
+	case IP_NODEFRAG:
+		val = inet->nodefrag;
+		break;
 	case IP_MTU_DISCOVER:
 		val = inet->pmtudisc;
 		break;

