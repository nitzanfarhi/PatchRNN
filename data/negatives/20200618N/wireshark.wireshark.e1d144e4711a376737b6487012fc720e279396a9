commit e1d144e4711a376737b6487012fc720e279396a9
Author: Dario Lombardo <lomato@gmail.com>
Date:   Mon Aug 6 10:34:53 2018 +0200

    tvbuff: add assertion to tvb_skip_wsp_return().
    
    Minor indentation fixes.
    
    Change-Id: I0b22b1b247efc4f1db535eb1f7cb7e99c3637ba0
    Reviewed-on: https://code.wireshark.org/review/28981
    Reviewed-by: Dario Lombardo <lomato@gmail.com>
    Petri-Dish: Dario Lombardo <lomato@gmail.com>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>

diff --git a/epan/tvbuff.c b/epan/tvbuff.c
index 2711b8e202..e40401075a 100644
--- a/epan/tvbuff.c
+++ b/epan/tvbuff.c
@@ -3645,14 +3645,18 @@ tvb_skip_wsp(tvbuff_t *tvb, const gint offset, const gint maxlength)
 }
 
 gint
-tvb_skip_wsp_return(tvbuff_t *tvb, const gint offset) {
+tvb_skip_wsp_return(tvbuff_t *tvb, const gint offset)
+{
 	gint   counter = offset;
 	guint8 tempchar;
 
-	for(counter = offset; counter > 0 &&
+	DISSECTOR_ASSERT(tvb && tvb->initialized);
+
+	for (counter = offset; counter > 0 &&
 		((tempchar = tvb_get_guint8(tvb,counter)) == ' ' ||
 		tempchar == '\t' || tempchar == '\n' || tempchar == '\r'); counter--);
 	counter++;
+
 	return (counter);
 }
 

