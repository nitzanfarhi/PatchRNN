commit c67411593960f1a133657f0da930c8681a6a62b4
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Sun Mar 17 18:08:11 2002 +0000

    10l
    
    Originally committed as revision 336 to svn://svn.ffmpeg.org/ffmpeg/trunk

diff --git a/libavcodec/mpegvideo.c b/libavcodec/mpegvideo.c
index 15af25d7b..9b2367195 100644
--- a/libavcodec/mpegvideo.c
+++ b/libavcodec/mpegvideo.c
@@ -1675,6 +1675,7 @@ static int rate_estimate_qscale(MpegEncContext *s)
 
     diff= s->total_bits - wanted_bits;
     br_compensation= (s->bit_rate_tolerance - diff)/s->bit_rate_tolerance;
+    if(br_compensation<=0.0) br_compensation=0.001;
     q/=br_compensation;
 
     qscale= (int)(q + 0.5);

