commit a89e65bfb38cbbd7d5fd414dc337e58e6a0a584b
Author: okir <okir@c6295689-39f2-0310-b995-f0e70906c6a9>
Date:   Tue Jan 14 16:49:54 2003 +0000

    - mask out additional flags in the card type byte when asked for the AAK
    
    
    git-svn-id: https://www.opensc-project.org/svnp/opensc/trunk@862 c6295689-39f2-0310-b995-f0e70906c6a9

diff --git a/src/libopensc/card-flex.c b/src/libopensc/card-flex.c
index 56e733bc..9374f578 100644
--- a/src/libopensc/card-flex.c
+++ b/src/libopensc/card-flex.c
@@ -768,7 +768,7 @@ static int flex_get_default_key(struct sc_card *card,
 	prv = (struct flex_private_data *) card->drv_data;
 
 	/* These seem to be the default AAKs used by Schlumberger */
-	switch (prv->card_type) {
+	switch (prv->card_type & TYPE_MASK) {
 	case TYPE_CRYPTOFLEX:
 		key = "2c:15:e5:26:e9:3e:8a:19";
 		break;

