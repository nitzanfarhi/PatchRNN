commit a29ec08a1b649436248c140a3bc389bc11434c94
Author: Denis Kirjanov <kirjanov@gmail.com>
Date:   Tue Dec 8 20:36:00 2009 -0800

    mv643xx_eth: check for valid hw address (resubmit)
    
    Check for valid hw address.
    
    Signed-off-by: Denis Kirjanov <kirjanov@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/drivers/net/mv643xx_eth.c b/drivers/net/mv643xx_eth.c
index 796a493f95ab..1405a170bb43 100644
--- a/drivers/net/mv643xx_eth.c
+++ b/drivers/net/mv643xx_eth.c
@@ -1827,6 +1827,9 @@ static int mv643xx_eth_set_mac_address(struct net_device *dev, void *addr)
 {
 	struct sockaddr *sa = addr;
 
+	if (!is_valid_ether_addr(sa->sa_data))
+		return -EINVAL;
+
 	memcpy(dev->dev_addr, sa->sa_data, ETH_ALEN);
 
 	netif_addr_lock_bh(dev);

