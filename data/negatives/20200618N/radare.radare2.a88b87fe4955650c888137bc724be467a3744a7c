commit a88b87fe4955650c888137bc724be467a3744a7c
Author: jvoisin <julien.voisin@dustri.org>
Date:   Sat May 10 22:46:22 2014 +0200

    Fix CID 1134974

diff --git a/binr/rarun2/rarun2.c b/binr/rarun2/rarun2.c
index 6b5770f13..5894273de 100644
--- a/binr/rarun2/rarun2.c
+++ b/binr/rarun2/rarun2.c
@@ -86,11 +86,15 @@ static char *getstr(const char *src) {
 }
 
 static void parseline (char *b) {
+	int must_free = R_FALSE;
 	char *e = strchr (b, '=');
 	if (!e) return;
 	if (*b=='#') return;
 	*e++ = 0;
-	if (*e=='$') e = r_sys_getenv (e);
+	if (*e=='$') {
+		must_free = R_TRUE;
+		e = r_sys_getenv (e);
+	}
 	if (e == NULL) return;
 	if (!strcmp (b, "program")) _args[0] = _program = strdup (e);
 	else if (!strcmp (b, "system")) _system = strdup (e);
@@ -145,6 +149,8 @@ static void parseline (char *b) {
 			r_sys_setenv (e, v);
 		}
 	}
+	if (must_free == R_TRUE)
+		free (e);
 }
 
 #if __UNIX__

