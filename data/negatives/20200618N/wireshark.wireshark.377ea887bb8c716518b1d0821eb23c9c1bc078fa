commit 377ea887bb8c716518b1d0821eb23c9c1bc078fa
Author: Stig Bj√∏rlykke <stig@bjorlykke.org>
Date:   Mon Mar 12 17:18:54 2012 +0000

    Improved a if-check to avoid a analyzis warning.
    
    svn path=/trunk/; revision=41508

diff --git a/epan/dissectors/packet-http.c b/epan/dissectors/packet-http.c
index cea297868f..40d6288b41 100644
--- a/epan/dissectors/packet-http.c
+++ b/epan/dissectors/packet-http.c
@@ -2067,7 +2067,7 @@ header_fields_initialize_cb(void)
 	guint i;
 	gchar* header_name;
 
-	if (header_fields_hash) {
+	if (header_fields_hash && hf) {
 		guint hf_size = g_hash_table_size (header_fields_hash);
 		/* Unregister all fields */
 		for (i = 0; i < hf_size; i++) {
diff --git a/epan/dissectors/packet-imf.c b/epan/dissectors/packet-imf.c
index d636d02931..70bfc155a9 100644
--- a/epan/dissectors/packet-imf.c
+++ b/epan/dissectors/packet-imf.c
@@ -851,7 +851,7 @@ header_fields_initialize_cb (void)
   guint i;
   gchar *header_name;
 
-  if (custom_field_table) {
+  if (custom_field_table && hf) {
     guint hf_size = g_hash_table_size (custom_field_table);
     /* Unregister all fields */
     for (i = 0; i < hf_size; i++) {

