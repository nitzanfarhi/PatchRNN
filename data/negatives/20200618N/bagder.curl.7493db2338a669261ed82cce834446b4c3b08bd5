commit 7493db2338a669261ed82cce834446b4c3b08bd5
Author: Daniel Stenberg <daniel@haxx.se>
Date:   Mon Dec 3 12:57:45 2001 +0000

    Eric nailed a but in strnequal() for macintosh

diff --git a/lib/strequal.c b/lib/strequal.c
index 6859e26bd..df5d4f14b 100644
--- a/lib/strequal.c
+++ b/lib/strequal.c
@@ -63,6 +63,9 @@ int curl_strnequal(const char *first, const char *second, size_t max)
     first++;
     second++;
   }
+  if(0 == max)
+    return 1; /* they are equal this far */
+
   return toupper(*first) == toupper(*second);
 #endif
 }

