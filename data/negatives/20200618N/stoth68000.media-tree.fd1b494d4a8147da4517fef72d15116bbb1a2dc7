commit fd1b494d4a8147da4517fef72d15116bbb1a2dc7
Author: Luben Tuikov <ltuikov@yahoo.com>
Date:   Wed Nov 29 19:45:23 2006 -0800

    [SCSI] Fix sense key MEDIUM ERROR processing and retry
    
    1) If the device reports an uncorrectable MEDIUM ERROR, such
    as SK MEDIUM ERROR, ASC UNRECOVERED READ ERR, AMNF DATA
    FIELD or RECORD NOT FOUND, then: In scsi_check_sense()
    return SUCCESS so as to not retry -- the error is
    uncorrectable -- this speeds up total processing time.
    
    Signed-off-by: Luben Tuikov <ltuikov@yahoo.com>
    
    Extracted the MEDIUM ERROR piece and
    Signed-off-by: James Bottomley <James.Bottomley@SteelEye.com>

diff --git a/drivers/scsi/scsi_error.c b/drivers/scsi/scsi_error.c
index 8e5011d13a18..2dce06a58c08 100644
--- a/drivers/scsi/scsi_error.c
+++ b/drivers/scsi/scsi_error.c
@@ -359,6 +359,11 @@ static int scsi_check_sense(struct scsi_cmnd *scmd)
 		return SUCCESS;
 
 	case MEDIUM_ERROR:
+		if (sshdr.asc == 0x11 || /* UNRECOVERED READ ERR */
+		    sshdr.asc == 0x13 || /* AMNF DATA FIELD */
+		    sshdr.asc == 0x14) { /* RECORD NOT FOUND */
+			return SUCCESS;
+		}
 		return NEEDS_RETRY;
 
 	case HARDWARE_ERROR:

