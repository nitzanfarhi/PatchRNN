commit 4327aaf68ac84016f0e4884d3f08a5e19377ad4b
Author: Eileen Donlon <emdonlo@gmail.com>
Date:   Wed Apr 4 10:43:01 2012 -0400

    reject pcre modifiers U with B

diff --git a/src/detect-pcre.c b/src/detect-pcre.c
index 4a6a7469..1e88c35a 100644
--- a/src/detect-pcre.c
+++ b/src/detect-pcre.c
@@ -844,6 +844,10 @@ DetectPcreData *DetectPcreParse (char *regexstr)
                         SCLogError(SC_ERR_INVALID_SIGNATURE, "regex modifier 'U' inconsistent with 'I'");
                         goto error;
                     }
+                    if (pd->flags & DETECT_PCRE_RAWBYTES) {
+                        SCLogError(SC_ERR_INVALID_SIGNATURE, "regex modifier 'U' inconsistent with 'B'");
+                        goto error;
+                    }
                     pd->flags |= DETECT_PCRE_URI;
                     break;
                 case 'H': /* snort's option */

