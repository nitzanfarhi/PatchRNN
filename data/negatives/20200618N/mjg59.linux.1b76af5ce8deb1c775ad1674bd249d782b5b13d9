commit 1b76af5ce8deb1c775ad1674bd249d782b5b13d9
Author: Thomas Hellstrom <thellstrom@vmware.com>
Date:   Wed Feb 5 09:18:26 2014 +0100

    drm/ttm: Don't clear page metadata of imported sg pages
    
    These page pointers shouldn't be visible to TTM in the first place, but
    until we fix that up, don't clear the page metadata because that
    will upset the exporter.
    
    Reported-and-tested-by: Cristoph Haag <haagch.christoph@googleemail.com>
    Signed-off-by: Thomas Hellstrom <thellstrom@vmware.com>
    Reviewed-by: Jakob Bornecrantz <jakob@vmware.com>

diff --git a/drivers/gpu/drm/ttm/ttm_tt.c b/drivers/gpu/drm/ttm/ttm_tt.c
index 9af99084b344..75f319090043 100644
--- a/drivers/gpu/drm/ttm/ttm_tt.c
+++ b/drivers/gpu/drm/ttm/ttm_tt.c
@@ -380,6 +380,9 @@ static void ttm_tt_clear_mapping(struct ttm_tt *ttm)
 	pgoff_t i;
 	struct page **page = ttm->pages;
 
+	if (ttm->page_flags & TTM_PAGE_FLAG_SG)
+		return;
+
 	for (i = 0; i < ttm->num_pages; ++i) {
 		(*page)->mapping = NULL;
 		(*page++)->index = 0;

