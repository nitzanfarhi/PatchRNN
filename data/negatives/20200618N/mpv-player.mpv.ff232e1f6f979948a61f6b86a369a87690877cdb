commit ff232e1f6f979948a61f6b86a369a87690877cdb
Author: stefano <stefano@b3059339-0415-0410-9bf9-f77b7e298cf2>
Date:   Thu Mar 4 00:31:13 2010 +0000

    Fill the r, g, b values used for computing the c->pal_yuv table in the
    case where the source format is PIX_FMT_GRAY8.
    
    This is required as PIX_FMT_GRAY8 has been declared as a paletted
    format in FFmpeg r22191, fix GRAY8 -> RGB conversion.
    
    git-svn-id: svn://svn.mplayerhq.hu/mplayer/trunk@30826 b3059339-0415-0410-9bf9-f77b7e298cf2

diff --git a/libswscale/swscale.c b/libswscale/swscale.c
index 689233c07b..83607d2b77 100644
--- a/libswscale/swscale.c
+++ b/libswscale/swscale.c
@@ -1849,6 +1849,8 @@ int sws_scale(SwsContext *c, const uint8_t* const src[], const int srcStride[],
                 r= (i>>3    )*255;
                 g= ((i>>1)&3)*85;
                 b= (i&1     )*255;
+            } else if(c->srcFormat == PIX_FMT_GRAY8) {
+                r = g = b = i;
             } else {
                 assert(c->srcFormat == PIX_FMT_BGR4_BYTE);
                 b= (i>>3    )*255;

