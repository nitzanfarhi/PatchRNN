commit a0f5ab70f367aa105bee3be4b1bb5fa27ec522d1
Author: Michal Schmidt <mschmidt@redhat.com>
Date:   Wed Sep 16 22:55:02 2015 +0200

    sd-bus: correct size calculation in DBus fd receive
    
    The size of the allocated array for received file descriptors was
    incorrectly calculated. This did not matter when a single file
    descriptor was received, but for more descriptors the allocation was
    insufficient.

diff --git a/src/libsystemd/sd-bus/bus-socket.c b/src/libsystemd/sd-bus/bus-socket.c
index 735a775cb..d0b1e3d7d 100644
--- a/src/libsystemd/sd-bus/bus-socket.c
+++ b/src/libsystemd/sd-bus/bus-socket.c
@@ -985,7 +985,7 @@ int bus_socket_read_message(sd_bus *bus) {
                                         return -EIO;
                                 }
 
-                                f = realloc(bus->fds, sizeof(int) + (bus->n_fds + n));
+                                f = realloc(bus->fds, sizeof(int) * (bus->n_fds + n));
                                 if (!f) {
                                         close_many((int*) CMSG_DATA(cmsg), n);
                                         return -ENOMEM;

