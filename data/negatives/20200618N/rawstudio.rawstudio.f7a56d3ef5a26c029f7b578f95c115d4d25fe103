commit f7a56d3ef5a26c029f7b578f95c115d4d25fe103
Author: Anders Brander <anders@brander.dk>
Date:   Wed Feb 22 17:47:12 2006 +0000

    Fixed stupid multiply bug in rs_load_raw_from_memory().

diff --git a/src/rawstudio.c b/src/rawstudio.c
index 7386d5a8..c164e32d 100644
--- a/src/rawstudio.c
+++ b/src/rawstudio.c
@@ -324,13 +324,13 @@ rs_load_raw_from_memory(RS_IMAGE *rs)
 	gint color;
 	guint filters;
 
-    srcP[0] = rs->pixels[R]; mul[0] = (int) rs->raw->pre_mul[0];
-    srcP[1] = rs->pixels[G]; mul[1] = (int) rs->raw->pre_mul[1];
-    srcP[2] = rs->pixels[B]; mul[2] = (int) rs->raw->pre_mul[2];
+    srcP[0] = rs->pixels[R]; mul[0] = (int) (rs->raw->pre_mul[0] * 65536.0);
+    srcP[1] = rs->pixels[G]; mul[1] = (int) (rs->raw->pre_mul[1] * 65536.0);
+    srcP[2] = rs->pixels[B]; mul[2] = (int) (rs->raw->pre_mul[2] * 65536.0);
 	srcP[3] = 0;
-    srcP[4] = rs->pixels[R]; mul[4] = (int) rs->raw->pre_mul[0];
-    srcP[5] = rs->pixels[G2]; mul[5] = (int) rs->raw->pre_mul[1];
-    srcP[6] = rs->pixels[B]; mul[6] = (int) rs->raw->pre_mul[2];
+    srcP[4] = rs->pixels[R]; mul[4] = (int) (rs->raw->pre_mul[0] * 65536.0);
+    srcP[5] = rs->pixels[G2]; mul[5] = (int) (rs->raw->pre_mul[1] * 65536.0);
+    srcP[6] = rs->pixels[B]; mul[6] = (int) (rs->raw->pre_mul[2] * 65536.0);
 	srcP[7] = 0;
 	filters = rs->raw->filters;
 	for (y=0; y<rs->raw->height; y++)

