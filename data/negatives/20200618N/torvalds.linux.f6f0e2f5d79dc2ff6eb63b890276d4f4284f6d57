commit f6f0e2f5d79dc2ff6eb63b890276d4f4284f6d57
Author: Philipp Zabel <p.zabel@pengutronix.de>
Date:   Fri Mar 31 10:33:25 2017 -0300

    [media] tvp5150: allow get/set_fmt on the video source pad
    
    To let userspace propagate formats downstream in a media controller
    scenario, the video source pad (now pad 1, DEMOD_PAD_VID_OUT) must allow
    setting and getting the format. Incidentally, tvp5150_fill_fmt was
    implemented for this pad, not for the new analog input pad (now pad 0,
    DEMOD_PAD_IF_INPUT).
    
    Fixes: 55606310e77f ("[media] tvp5150: create the expected number of pads")
    
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>
    Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>

diff --git a/drivers/media/i2c/tvp5150.c b/drivers/media/i2c/tvp5150.c
index 48646a7f3fb0..abc3b18691d3 100644
--- a/drivers/media/i2c/tvp5150.c
+++ b/drivers/media/i2c/tvp5150.c
@@ -865,7 +865,7 @@ static int tvp5150_fill_fmt(struct v4l2_subdev *sd,
 	struct v4l2_mbus_framefmt *f;
 	struct tvp5150 *decoder = to_tvp5150(sd);
 
-	if (!format || format->pad)
+	if (!format || (format->pad != DEMOD_PAD_VID_OUT))
 		return -EINVAL;
 
 	f = &format->format;

