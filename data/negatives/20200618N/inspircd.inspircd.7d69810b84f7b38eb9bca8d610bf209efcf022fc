commit 7d69810b84f7b38eb9bca8d610bf209efcf022fc
Author: dz <dz@e03df62e-2008-0410-955e-edbf42e46eb7>
Date:   Sat Nov 21 16:05:57 2009 +0000

    allow channels starting with ## in m_banredirect.cpp, fixes bug #921 reported by Sm0ke0ut
    
    git-svn-id: http://svn.inspircd.org/repository/trunk/inspircd@12164 e03df62e-2008-0410-955e-edbf42e46eb7

diff --git a/src/modules/m_banredirect.cpp b/src/modules/m_banredirect.cpp
index cf6c27828..e2346b1d3 100644
--- a/src/modules/m_banredirect.cpp
+++ b/src/modules/m_banredirect.cpp
@@ -86,9 +86,13 @@ class BanRedirect : public ModeWatcher
 						start_pos = curr+1;
 						break;
 					case '#':
-						mask[current].assign(start_pos, curr);
-						current = CHAN;
-						start_pos = curr;
+						/* bug #921: don't barf when redirecting to ## channels */
+						if (current != CHAN)
+						{
+							mask[current].assign(start_pos, curr);
+							current = CHAN;
+							start_pos = curr;
+						}
 						break;
 				}
 			}

