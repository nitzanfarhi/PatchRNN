commit 7374794a899d5995341e51592babaf5098a0ed48
Author: Loren Merritt <lorenm@u.washington.edu>
Date:   Tue May 30 19:45:12 2006 +0000

    Snow: don't try to encode lossless with 9/7 wavelet, because it isn't lossless.
    
    Originally committed as revision 5433 to svn://svn.ffmpeg.org/ffmpeg/trunk

diff --git a/libavcodec/snow.c b/libavcodec/snow.c
index 59e283948d..d20b9604ba 100644
--- a/libavcodec/snow.c
+++ b/libavcodec/snow.c
@@ -4041,6 +4041,13 @@ static int encode_init(AVCodecContext *avctx)
         return -1;
     }
 
+    if(avctx->prediction_method == DWT_97
+       && (avctx->flags & CODEC_FLAG_QSCALE)
+       && avctx->global_quality == 0){
+        av_log(avctx, AV_LOG_ERROR, "the 9/7 wavelet is incompatible with lossless mode\n");
+        return -1;
+    }
+
     common_init(avctx);
     alloc_blocks(s);
 

