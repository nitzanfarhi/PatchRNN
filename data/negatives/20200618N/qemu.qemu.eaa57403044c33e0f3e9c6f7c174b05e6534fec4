commit eaa57403044c33e0f3e9c6f7c174b05e6534fec4
Author: Longpeng(Mike) <longpeng2@huawei.com>
Date:   Mon Dec 5 19:39:09 2016 +0800

    cryptodev: add xts(aes) support
    
    This patch add xts(aes) support.
    
    Signed-off-by: Longpeng(Mike) <longpeng2@huawei.com>
    Reviewed-by: Gonglei <arei.gonglei@huawei.com>
    Signed-off-by: Gonglei <arei.gonglei@huawei.com>

diff --git a/backends/cryptodev-builtin.c b/backends/cryptodev-builtin.c
index 57980cbd12..a4224f4b1e 100644
--- a/backends/cryptodev-builtin.c
+++ b/backends/cryptodev-builtin.c
@@ -197,6 +197,14 @@ static int cryptodev_builtin_create_cipher_session(
             return -1;
         }
         break;
+    case VIRTIO_CRYPTO_CIPHER_AES_XTS:
+        mode = QCRYPTO_CIPHER_MODE_XTS;
+        algo = cryptodev_builtin_get_aes_algo(sess_info->key_len,
+                                                    mode, errp);
+        if (algo < 0)  {
+            return -1;
+        }
+        break;
     case VIRTIO_CRYPTO_CIPHER_DES_ECB:
         mode = QCRYPTO_CIPHER_MODE_ECB;
         algo = QCRYPTO_CIPHER_ALG_DES_RFB;

