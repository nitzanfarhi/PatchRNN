commit acec0b0305289c702befd784a0b82f63f1b1bacd
Author: jyang <>
Date:   Thu Nov 19 13:12:22 2009 +0000

    branches/5.1: Use btr_free_root() instead of fseg_free() for
    the fix of bug #48469, because fseg_free() is not defined
    in the zip branch. And we could save one mini-trasaction started
    by fseg_free().
    
    Approved by Marko.

diff --git a/btr/btr0btr.c b/btr/btr0btr.c
index babc8d226e3..5e8831b5d5e 100644
--- a/btr/btr0btr.c
+++ b/btr/btr0btr.c
@@ -713,8 +713,7 @@ btr_create(
 				 PAGE_HEADER + PAGE_BTR_SEG_LEAF, mtr)) {
 			/* Not enough space for new segment, free root
 			segment before return. */
-			fseg_free(space, page_no,
-				  PAGE_HEADER + PAGE_BTR_SEG_TOP);
+			btr_free_root(space, page_no, mtr);
 
 			return(FIL_NULL);
 		}

