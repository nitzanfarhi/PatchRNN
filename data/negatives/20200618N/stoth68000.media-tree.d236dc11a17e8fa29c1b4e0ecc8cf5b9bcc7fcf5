commit d236dc11a17e8fa29c1b4e0ecc8cf5b9bcc7fcf5
Author: Rupesh Gujare <rupesh.gujare@atmel.com>
Date:   Thu Aug 22 17:38:49 2013 +0100

    staging: ozwpan: Check error condition before creating endpoint.
    
    Check if interface number is correct before creating an end point.
    
    Signed-off-by: Rupesh Gujare <rupesh.gujare@atmel.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

diff --git a/drivers/staging/ozwpan/ozhcd.c b/drivers/staging/ozwpan/ozhcd.c
index 4682d782abe7..d5a3900d4181 100644
--- a/drivers/staging/ozwpan/ozhcd.c
+++ b/drivers/staging/ozwpan/ozhcd.c
@@ -1247,6 +1247,8 @@ static int oz_build_endpoints_for_interface(struct usb_hcd *hcd,
 	int request_heartbeat = 0;
 
 	oz_dbg(ON, "interface[%d] = %p\n", if_ix, intf);
+	if (if_ix >= port->num_iface || port->iface == NULL)
+		return -ENOMEM;
 	for (i = 0; i < intf->desc.bNumEndpoints; i++) {
 		struct usb_host_endpoint *hep = &intf->endpoint[i];
 		u8 ep_addr = hep->desc.bEndpointAddress;

