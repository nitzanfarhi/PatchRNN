commit 2b1c47dadc4a664684cb4215c7352d71275675c1
Author: nobu <nobu@b2dd03c8-39d4-4d8f-98ff-823fe69b080e>
Date:   Sat Jan 11 03:15:01 2014 +0000

    bigdecimal.c: expand buffer
    
    * ext/bigdecimal/bigdecimal.c (BigMath_s_log): expand buffer size for
      64bit platforms.
    
    git-svn-id: svn+ssh://ci.ruby-lang.org/ruby/trunk@44558 b2dd03c8-39d4-4d8f-98ff-823fe69b080e

diff --git a/ext/bigdecimal/bigdecimal.c b/ext/bigdecimal/bigdecimal.c
index 3bc516687d..c5a3326fb7 100644
--- a/ext/bigdecimal/bigdecimal.c
+++ b/ext/bigdecimal/bigdecimal.c
@@ -2919,8 +2919,8 @@ get_vp_value:
     RB_GC_GUARD(vn) = SSIZET2NUM(n);
     expo = VpExponent10(vx);
     if (expo < 0 || expo >= 3) {
-	char buf[16];
-	snprintf(buf, 16, "1E%"PRIdVALUE, -expo);
+	char buf[SIZEOF_VALUE * CHAR_BIT / 3 + 4];
+	snprintf(buf, sizeof(buf), "1E%"PRIdVALUE, -expo);
 	x = BigDecimal_mult2(x, ToValue(VpCreateRbObject(1, buf)), vn);
     }
     else {

