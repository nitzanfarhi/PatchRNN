commit c8ba3e9f48dbce6c93afd5e46ed42a20a4f20959
Author: Zoltan Varga <vargaz@gmail.com>
Date:   Wed Mar 11 00:08:04 2015 -0400

    [runtime] Make the size of the pseudo classes created by make_generic_param_class () the same as a valuetype with one field of the appropriate type.

diff --git a/mono/metadata/class.c b/mono/metadata/class.c
index c1e734bcbe6..44f8d314213 100644
--- a/mono/metadata/class.c
+++ b/mono/metadata/class.c
@@ -6153,9 +6153,14 @@ make_generic_param_class (MonoGenericParam *param, MonoImage *image, gboolean is
 
 	/*Init these fields to sane values*/
 	klass->min_align = 1;
-	klass->instance_size = sizeof (gpointer);
+	/*
+	 * This makes sure the the value size of this class is equal to the size of the types the gparam is
+	 * constrained to, the JIT depends on this.
+	 */
+	klass->instance_size = sizeof (MonoObject) + mono_type_stack_size_internal (&klass->byval_arg, NULL, TRUE);
 	mono_memory_barrier ();
 	klass->size_inited = 1;
+	klass->setup_fields_called = 1;
 
 	mono_class_setup_supertypes (klass);
 

