commit cb0dc77de0d23615a845e45844a2e22fc224d7fe
Author: Al Viro <viro@zeniv.linux.org.uk>
Date:   Wed Mar 18 19:12:42 2009 -0700

    net: fix sctp breakage
    
    broken by commit 5e739d1752aca4e8f3e794d431503bfca3162df4; AFAICS should
    be -stable fodder as well...
    
    Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
    Aced-by: Vlad Yasevich <vladislav.yasevich@hp.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/net/sctp/endpointola.c b/net/sctp/endpointola.c
index 4c8d9f45ce09..905fda582b92 100644
--- a/net/sctp/endpointola.c
+++ b/net/sctp/endpointola.c
@@ -111,7 +111,8 @@ static struct sctp_endpoint *sctp_endpoint_init(struct sctp_endpoint *ep,
 		if (sctp_addip_enable) {
 			auth_chunks->chunks[0] = SCTP_CID_ASCONF;
 			auth_chunks->chunks[1] = SCTP_CID_ASCONF_ACK;
-			auth_chunks->param_hdr.length += htons(2);
+			auth_chunks->param_hdr.length =
+					htons(sizeof(sctp_paramhdr_t) + 2);
 		}
 	}
 

