commit 5e5052b3b016066b38e1ac2daccb9f70872a4c21
Author: Yan, Zheng <zyan@redhat.com>
Date:   Mon Dec 15 11:18:30 2014 +0800

    mds: update current_parent_since for newly snapshotted directory
    
    current_parent_since should be set to snapshot seq when the directory
    was created.
    
    Fixes: 10312
    Signed-off-by: Yan, Zheng <zyan@redhat.com>

diff --git a/src/mds/CInode.cc b/src/mds/CInode.cc
index 916a5cf11f..e0e176034d 100644
--- a/src/mds/CInode.cc
+++ b/src/mds/CInode.cc
@@ -371,7 +371,7 @@ sr_t *CInode::project_snaprealm(snapid_t snapid)
   } else {
     new_srnode = new sr_t();
     new_srnode->created = snapid;
-    new_srnode->current_parent_since = snapid;
+    new_srnode->current_parent_since = get_oldest_snap();
   }
   dout(10) << "project_snaprealm " << new_srnode << dendl;
   projected_nodes.back()->snapnode = new_srnode;

