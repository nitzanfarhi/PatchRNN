commit 8c3cb43bacde921834d3ff5f6ba7488c622b98a9
Author: Hiroshi Inoue <inoue@tpf.co.jp>
Date:   Fri Oct 19 05:39:14 2001 +0000

    Change SC_fetch() to not retrieve data in case the
    SQL_RETRIEVE_DATA option is SQL_RD_OFF. This would
    avoid a crash when scrolling Grid controls.

diff --git a/src/interfaces/odbc/statement.c b/src/interfaces/odbc/statement.c
index ea296ea7b3..ca5e8b1c31 100644
--- a/src/interfaces/odbc/statement.c
+++ b/src/interfaces/odbc/statement.c
@@ -780,8 +780,12 @@ SC_fetch(StatementClass *self)
 			updret = SQL_ROW_DELETED;
 		num_cols -= 2;
 	}
-	if (!self->options.retrieve_data) /* data isn't required */
+#endif /* DRIVER_CURSOR_IMPLEMENT */
+	if (self->options.retrieve_data == SQL_RD_OFF) /* data isn't required */
+#ifdef	DRIVER_CURSOR_IMPLEMENT
 		return updret ? updret + 10 : SQL_SUCCESS;
+#else
+		return	SQL_SUCCESS;
 #endif /* DRIVER_CURSOR_IMPLEMENT */
 	for (lf = 0; lf < num_cols; lf++)
 	{

