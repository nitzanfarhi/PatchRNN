commit 9bc18091a5e44a368827f539289b99788eb27d4e
Author: Florin Malita <fmalita@gmail.com>
Date:   Mon Jun 5 15:34:33 2006 -0700

    [PPPOE]: Missing result check in __pppoe_xmit().
    
    skb_clone() may fail, we should check the result.
    
    Coverity CID: 1215.
    
    Signed-off-by: Florin Malita <fmalita@gmail.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/drivers/net/pppoe.c b/drivers/net/pppoe.c
index 475dc930380f..0d101a18026a 100644
--- a/drivers/net/pppoe.c
+++ b/drivers/net/pppoe.c
@@ -861,6 +861,9 @@ static int __pppoe_xmit(struct sock *sk, struct sk_buff *skb)
 		 * give dev_queue_xmit something it can free.
 		 */
 		skb2 = skb_clone(skb, GFP_ATOMIC);
+
+		if (skb2 == NULL)
+			goto abort;
 	}
 
 	ph = (struct pppoe_hdr *) skb_push(skb2, sizeof(struct pppoe_hdr));

