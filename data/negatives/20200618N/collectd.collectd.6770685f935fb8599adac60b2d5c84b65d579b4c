commit 6770685f935fb8599adac60b2d5c84b65d579b4c
Author: Pierre-Yves Ritschard <pyr@spootnik.org>
Date:   Mon Jul 8 09:06:35 2013 +0200

    Test for end of oid tree without breaking collection loop.

diff --git a/src/snmp.c b/src/snmp.c
index 4f849320..ad81c892 100644
--- a/src/snmp.c
+++ b/src/snmp.c
@@ -1373,13 +1373,14 @@ static int csnmp_read_table (host_definition_t *host, data_definition_t *data)
         csnmp_table_values_t *vt;
         oid_t vb_name;
         oid_t suffix;
+        int ret;
 
         csnmp_oid_init (&vb_name, vb->name, vb->name_length);
 
         /* Calculate the current suffix. This is later used to check that the
          * suffix is increasing. This also checks if we left the subtree */
-        status = csnmp_oid_suffix (&suffix, &vb_name, data->values + i);
-        if (status != 0)
+        ret = csnmp_oid_suffix (&suffix, &vb_name, data->values + i);
+        if (ret != 0)
         {
           DEBUG ("snmp plugin: host = %s; data = %s; i = %i; "
               "Value probably left its subtree.",

