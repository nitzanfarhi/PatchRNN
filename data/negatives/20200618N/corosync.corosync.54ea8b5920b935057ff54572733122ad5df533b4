commit 54ea8b5920b935057ff54572733122ad5df533b4
Author: Steven Dake <sdake@redhat.com>
Date:   Wed Jun 29 21:32:08 2005 +0000

    defect 654
    wrong error code returned when checkpointSize > maxSections * maxSectionsSize in
    checkpoint open.
    
    
    git-svn-id: http://svn.fedorahosted.org/svn/corosync/trunk@718 fd59a12c-fef9-0310-b244-a6a79926bd2f

diff --git a/lib/ckpt.c b/lib/ckpt.c
index e4c9dbf5..883a3894 100644
--- a/lib/ckpt.c
+++ b/lib/ckpt.c
@@ -497,6 +497,13 @@ saCkptCheckpointOpen (
 		return (SA_AIS_ERR_INVALID_PARAM);
 	}
 
+	if (checkpointCreationAttributes &&
+		(checkpointCreationAttributes->checkpointSize >
+		(checkpointCreationAttributes->maxSections * checkpointCreationAttributes->maxSectionSize))) {
+
+		return (SA_AIS_ERR_INVALID_PARAM);
+	}
+
 	error = saHandleInstanceGet (&ckptHandleDatabase, ckptHandle,
 		(void *)&ckptInstance);
 	if (error != SA_AIS_OK) {

