commit 6c92efa39a00e3ea6186eeaa0c490af1b0ff27de
Author: msuvajac <msuvajac@gmail.com>
Date:   Tue Jan 21 11:23:41 2014 +0100

    Made 64bit machine define compatible with Windows.

diff --git a/libyara/exefiles.c b/libyara/exefiles.c
index 6864162..8e1ed8f 100644
--- a/libyara/exefiles.c
+++ b/libyara/exefiles.c
@@ -68,7 +68,7 @@ PIMAGE_NT_HEADERS yr_get_pe_header(
 
   if (pe_header->Signature == IMAGE_NT_SIGNATURE &&
       (pe_header->FileHeader.Machine == IMAGE_FILE_MACHINE_I386 ||
-       pe_header->FileHeader.Machine == IMAGE_FILE_MACHINE_X64) &&
+       pe_header->FileHeader.Machine == IMAGE_FILE_MACHINE_AMD64) &&
       buffer_length > headers_size)
   {
     return pe_header;
diff --git a/libyara/pe.h b/libyara/pe.h
index 5ae1996..5384173 100644
--- a/libyara/pe.h
+++ b/libyara/pe.h
@@ -114,7 +114,7 @@ typedef struct _IMAGE_FILE_HEADER {
 
 
 #define IMAGE_FILE_MACHINE_I386              0x014c  // Intel 386.
-#define IMAGE_FILE_MACHINE_X64               0x8664  // Intel x64.
+#define IMAGE_FILE_MACHINE_AMD64             0x8664  // Intel x64.
 
 //
 // Directory format.

