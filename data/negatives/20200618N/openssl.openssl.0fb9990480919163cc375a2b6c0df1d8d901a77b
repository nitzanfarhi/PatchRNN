commit 0fb9990480919163cc375a2b6c0df1d8d901a77b
Author: Dr. Stephen Henson <steve@openssl.org>
Date:   Mon Jun 8 13:23:00 2015 +0100

    return correct NID for undefined object
    
    Reviewed-by: Tim Hudson <tjh@openssl.org>

diff --git a/crypto/objects/obj_dat.c b/crypto/objects/obj_dat.c
index 27d61b3a43..e8a6b139dd 100644
--- a/crypto/objects/obj_dat.c
+++ b/crypto/objects/obj_dat.c
@@ -397,6 +397,9 @@ int OBJ_obj2nid(const ASN1_OBJECT *a)
     if (a->nid != 0)
         return (a->nid);
 
+    if (a->length == 0)
+        return NID_undef;
+
     if (added != NULL) {
         ad.type = ADDED_DATA;
         ad.obj = (ASN1_OBJECT *)a; /* XXX: ugly but harmless */

