commit a3ab1dc072407db308bdfdd21c82d4eacaa377e9
Author: Thomas Huth <thuth@redhat.com>
Date:   Thu Aug 16 13:35:52 2018 +0200

    net: Silence 'has no peer' messages in testing mode
    
    When running qtests with -nodefaults, we are not interested in
    these 'XYZ has no peer' messages.
    
    Signed-off-by: Thomas Huth <thuth@redhat.com>
    Message-Id: <1534419358-10932-3-git-send-email-thuth@redhat.com>
    Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

diff --git a/vl.c b/vl.c
index 16b913f9d5..7055df3621 100644
--- a/vl.c
+++ b/vl.c
@@ -4559,11 +4559,10 @@ int main(int argc, char **argv, char **envp)
      * (2) CONFIG_SLIRP not set, in which case the implicit "-net nic"
      * sets up a nic that isn't connected to anything.
      */
-    if (!default_net) {
+    if (!default_net && (!qtest_enabled() || has_defaults)) {
         net_check_clients();
     }
 
-
     if (boot_once) {
         qemu_boot_set(boot_once, &error_fatal);
         qemu_register_reset(restore_boot_order, g_strdup(boot_order));

