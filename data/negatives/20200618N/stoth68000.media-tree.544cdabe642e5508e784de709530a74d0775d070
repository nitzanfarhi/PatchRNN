commit 544cdabe642e5508e784de709530a74d0775d070
Author: John Traill <john.traill@freescale.com>
Date:   Tue Jul 17 05:17:23 2007 +0400

    [POWERPC] 8xx: Set initial memory limit.
    
    The 8xx can only support a max of 8M during early boot (it seems a lot of
    8xx boards only have 8M so the bug was never triggered), but the early
    allocator isn't aware of this.  The following change makes it able to run
    with larger memory.
    
    Signed-off-by: John Traill <john.traill@freescale.com>
    Signed-off-by: Vitaly Bordug <vitb@kernel.crashing.org>
    Signed-off-by: Scott Wood <scottwood@freescale.com>
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

diff --git a/arch/powerpc/mm/init_32.c b/arch/powerpc/mm/init_32.c
index 27c234fb5118..977cb1ee5e72 100644
--- a/arch/powerpc/mm/init_32.c
+++ b/arch/powerpc/mm/init_32.c
@@ -132,6 +132,9 @@ void __init MMU_init(void)
 	/* 601 can only access 16MB at the moment */
 	if (PVR_VER(mfspr(SPRN_PVR)) == 1)
 		__initial_memory_limit = 0x01000000;
+	/* 8xx can only access 8MB at the moment */
+	if (PVR_VER(mfspr(SPRN_PVR)) == 0x50)
+		__initial_memory_limit = 0x00800000;
 
 	/* parse args from command line */
 	MMU_setup();

