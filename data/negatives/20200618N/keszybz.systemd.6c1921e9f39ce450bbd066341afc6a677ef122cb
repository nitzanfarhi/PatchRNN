commit 6c1921e9f39ce450bbd066341afc6a677ef122cb
Author: Franck Bui <fbui@suse.com>
Date:   Mon Jun 26 15:22:10 2017 +0200

    fstab-util: introduce fstab_has_fstype() helper

diff --git a/src/shared/fstab-util.c b/src/shared/fstab-util.c
index 5675b0bea..ec2e868ca 100644
--- a/src/shared/fstab-util.c
+++ b/src/shared/fstab-util.c
@@ -34,6 +34,26 @@
 #include "strv.h"
 #include "util.h"
 
+int fstab_has_fstype(const char *fstype) {
+        _cleanup_endmntent_ FILE *f = NULL;
+        struct mntent *m;
+
+        f = setmntent("/etc/fstab", "re");
+        if (!f)
+                return errno == ENOENT ? false : -errno;
+
+        for (;;) {
+                errno = 0;
+                m = getmntent(f);
+                if (!m)
+                        return errno != 0 ? -errno : false;
+
+                if (streq(m->mnt_type, fstype))
+                        return true;
+        }
+        return false;
+}
+
 int fstab_is_mount_point(const char *mount) {
         _cleanup_endmntent_ FILE *f = NULL;
         struct mntent *m;
diff --git a/src/shared/fstab-util.h b/src/shared/fstab-util.h
index bae8c0a89..bbf044135 100644
--- a/src/shared/fstab-util.h
+++ b/src/shared/fstab-util.h
@@ -25,6 +25,7 @@
 #include "macro.h"
 
 int fstab_is_mount_point(const char *mount);
+int fstab_has_fstype(const char *fstype);
 
 int fstab_filter_options(const char *opts, const char *names, const char **namefound, char **value, char **filtered);
 

