commit c1252a5615d9e69cac50570e8de70e5036a67908
Author: Thiago de Arruda <tpadilha84@gmail.com>
Date:   Fri Jan 2 21:03:25 2015 -0300

    syntax: Take rgb fg/bg when allocating cterm attr number

diff --git a/src/nvim/syntax.c b/src/nvim/syntax.c
index c2fb34cde..884a563fe 100644
--- a/src/nvim/syntax.c
+++ b/src/nvim/syntax.c
@@ -7209,9 +7209,10 @@ set_hl_attr (
    * For the color term mode: If there are other than "normal"
    * highlighting attributes, need to allocate an attr number.
    */
-  if (sgp->sg_cterm_fg == 0 && sgp->sg_cterm_bg == 0)
+  if (sgp->sg_cterm_fg == 0 && sgp->sg_cterm_bg == 0
+      && sgp->sg_rgb_fg == -1 && sgp->sg_rgb_bg == -1) {
     sgp->sg_cterm_attr = sgp->sg_cterm;
-  else {
+  } else {
     at_en.ae_attr = abstract_ui ? sgp->sg_gui : sgp->sg_cterm;
     at_en.ae_u.cterm.fg_color = sgp->sg_cterm_fg;
     at_en.ae_u.cterm.bg_color = sgp->sg_cterm_bg;

