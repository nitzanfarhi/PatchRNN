commit 79ba11d24b28ead94b976c4d7c8bf8e6c349eb36
Author: Ard Biesheuvel <ard.biesheuvel@linaro.org>
Date:   Tue Jan 24 17:11:40 2017 +0000

    arm64: kernel: do not mark reserved memory regions as IORESOURCE_BUSY
    
    Memory regions marked as NOMAP should not be used for general allocation
    by the kernel, and should not even be covered by the linear mapping
    (hence the name). However, drivers or other subsystems (such as ACPI)
    that access the firmware directly may legally access them, which means
    it is also reasonable for such drivers to claim them by invoking
    request_resource(). Currently, this is prevented by the fact that arm64's
    request_standard_resources() marks reserved regions as IORESOURCE_BUSY.
    
    So drop the IORESOURCE_BUSY flag from these requests.
    
    Reported-by: Hanjun Guo <hanjun.guo@linaro.org>
    Signed-off-by: Ard Biesheuvel <ard.biesheuvel@linaro.org>
    Signed-off-by: Will Deacon <will.deacon@arm.com>

diff --git a/arch/arm64/kernel/setup.c b/arch/arm64/kernel/setup.c
index b5222094ab52..952e2c0dabd5 100644
--- a/arch/arm64/kernel/setup.c
+++ b/arch/arm64/kernel/setup.c
@@ -209,7 +209,7 @@ static void __init request_standard_resources(void)
 		res = alloc_bootmem_low(sizeof(*res));
 		if (memblock_is_nomap(region)) {
 			res->name  = "reserved";
-			res->flags = IORESOURCE_MEM | IORESOURCE_BUSY;
+			res->flags = IORESOURCE_MEM;
 		} else {
 			res->name  = "System RAM";
 			res->flags = IORESOURCE_SYSTEM_RAM | IORESOURCE_BUSY;

