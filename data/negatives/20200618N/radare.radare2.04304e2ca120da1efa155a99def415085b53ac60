commit 04304e2ca120da1efa155a99def415085b53ac60
Author: pancake <pancake@nopcode.org>
Date:   Sat Apr 8 00:26:28 2017 +0200

    Fixes for rcons_push/pop

diff --git a/libr/cons/cons.c b/libr/cons/cons.c
index 839bb7869..0731ff94b 100755
--- a/libr/cons/cons.c
+++ b/libr/cons/cons.c
@@ -521,6 +521,9 @@ R_API void r_cons_filter() {
 
 R_API void r_cons_push() {
 	if (I.cons_stack) {
+		if (I.buffer_len < 1) {
+			return;
+		}
 		RConsStack *data = R_NEW0 (RConsStack);
 		data->buf = malloc (I.buffer_len);
 		if (!data->buf) {
@@ -552,7 +555,7 @@ R_API void r_cons_pop() {
 		if (!data) {
 			return;
 		}
-		if (!data->buf) {
+		if (!data->buf || data->buf_size < 1 || data->buf_len < 1) {
 			free (data);
 			return;
 		}

