commit 066ad0926a53ea6ee9d5cb3e348160a881145e73
Author: Joakim Plate <elupus@ecce.se>
Date:   Fri Feb 3 19:13:43 2012 +0000

    tmv: Check return value of avio_seek and avoid modifying state if it fails
    
    Signed-off-by: Paul B Mahol <onemda@gmail.com>
    Signed-off-by: Justin Ruggles <justin.ruggles@gmail.com>

diff --git a/libavformat/tmv.c b/libavformat/tmv.c
index 0f8ab597ad..8a96b721ab 100644
--- a/libavformat/tmv.c
+++ b/libavformat/tmv.c
@@ -174,7 +174,8 @@ static int tmv_read_seek(AVFormatContext *s, int stream_index,
     pos = timestamp *
           (tmv->audio_chunk_size + tmv->video_chunk_size + tmv->padding);
 
-    avio_seek(s->pb, pos + TMV_HEADER_SIZE, SEEK_SET);
+    if (avio_seek(s->pb, pos + TMV_HEADER_SIZE, SEEK_SET) < 0)
+        return -1;
     tmv->stream_index = 0;
     return 0;
 }

