commit ae0fba066378295379d50fd667181a4987f0a49c
Author: pancake <pancake@nopcode.org>
Date:   Fri Jan 19 15:38:20 2018 +0100

    Fix dir.magic

diff --git a/libr/core/cconfig.c b/libr/core/cconfig.c
index 52d581c73..28ad2f0b6 100644
--- a/libr/core/cconfig.c
+++ b/libr/core/cconfig.c
@@ -2473,7 +2473,11 @@ R_API int r_core_config_init(RCore *core) {
 
 	/* dir */
 	SETCB ("dir.dbgsnap", ".", &cb_dbgsnap, "Path to session dump files");
-	SETPREF ("dir.magic", R_MAGIC_PATH, "Path to r_magic files");
+	{
+		char *path = r_str_newf ("%s/" R_MAGIC_PATH, r_config_get (core->config, "dir.prefix"));
+		SETPREF ("dir.magic", path, "Path to r_magic files");
+		free (path);
+	}
 #if __WINDOWS__
 	SETPREF ("dir.plugins", "plugins", "Path to plugin files to be loaded at startup");
 #else

