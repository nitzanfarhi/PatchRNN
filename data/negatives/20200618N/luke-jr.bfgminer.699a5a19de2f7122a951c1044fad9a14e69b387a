commit 699a5a19de2f7122a951c1044fad9a14e69b387a
Author: Luke Dashjr <luke-jr+git@utopios.org>
Date:   Tue Oct 8 19:50:27 2013 +0000

    fpgautils: Check for fgets error

diff --git a/fpgautils.c b/fpgautils.c
index 79b5003d..8220c6f1 100644
--- a/fpgautils.c
+++ b/fpgautils.c
@@ -1020,7 +1020,8 @@ bool load_bitstream_intelhex(bytes_t *rv, const char *dname, const char *fn)
 			applog(LOG_ERR, "Error reading '%s'", fn);
 			goto ihxerr;
 		}
-		fgets(buf, sizeof(buf), F);
+		if (!fgets(buf, sizeof(buf), F))
+			goto ihxerr;
 		if (unlikely(buf[0] != ':'))
 			goto ihxerr;
 		if (unlikely(!(

