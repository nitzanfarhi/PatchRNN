commit d980b42b90452e50a4475cb8db6d4e6c300deff9
Author: psychon <psychon@726aef4b-f618-498e-8847-2d620e286838>
Date:   Wed May 20 08:48:22 2009 +0000

    Ask SSL clients for a ssl cert
    
    
    git-svn-id: https://znc.svn.sourceforge.net/svnroot/znc/trunk@1510 726aef4b-f618-498e-8847-2d620e286838

diff --git a/znc.h b/znc.h
index 791a8c84..7aca2ea8 100644
--- a/znc.h
+++ b/znc.h
@@ -287,6 +287,9 @@ public:
 		if (IsSSL()) {
 			bSSL = true;
 			m_pListener->SetPemLocation(CZNC::Get().GetPemLocation());
+
+			// Ask the client for a cert, if it got none, nothing bad happens
+			m_pListener->SetRequireClientCertFlags(SSL_VERIFY_PEER);
 		}
 #endif
 

