commit d5e05878caac35b0c8e852791ccfcc77a1390958
Author: Cristy <urban-warrior@imagemagick.org>
Date:   Fri Aug 4 07:28:44 2017 -0400

    https://github.com/ImageMagick/ImageMagick/issues/645

diff --git a/coders/psd.c b/coders/psd.c
index e7c4406af..de5578bac 100644
--- a/coders/psd.c
+++ b/coders/psd.c
@@ -1741,6 +1741,12 @@ static MagickBooleanType ReadPSDLayersInternal(Image *image,
                 unsigned char
                   *info;
 
+                if (length > GetBlobSize(image))
+                  {
+                    layer_info=DestroyLayerInfo(layer_info,number_layers);
+                    ThrowBinaryException(CorruptImageError,
+                      "InsufficientImageDataInFile",image->filename);
+                  }
                 layer_info[i].info=AcquireStringInfo((const size_t) length);
                 info=GetStringInfoDatum(layer_info[i].info);
                 (void) ReadBlob(image,(const size_t) length,info);

