commit 006660b94aab6d1f562b8ec7e884a8c99fa6ecb8
Author: Johan Danielsson <joda@pdc.kth.se>
Date:   Sun Oct 3 15:45:04 1999 +0000

    (set_command_prot): set command protection level
    
    
    git-svn-id: svn://svn.h5l.se/heimdal/trunk/heimdal@7077 ec53bebd-3082-4978-b11e-865c3cabbd6b

diff --git a/appl/ftp/ftp/security.c b/appl/ftp/ftp/security.c
index b17bdaa13..ab45b48d6 100644
--- a/appl/ftp/ftp/security.c
+++ b/appl/ftp/ftp/security.c
@@ -603,6 +603,14 @@ sec_prot_internal(int level)
     return 0;
 }
 
+enum protection_level
+set_command_prot(enum protection_level level)
+{
+    enum protection_level old = command_prot;
+    command_prot = level;
+    return old;
+}
+
 void
 sec_prot(int argc, char **argv)
 {
@@ -633,7 +641,7 @@ sec_prot(int argc, char **argv)
 	    return;
 	}
     } else if(strcasecmp(argv[1], "command") == 0)
-	command_prot = level;
+	set_command_prot(level);
     else
 	goto usage;
     code = 0;

