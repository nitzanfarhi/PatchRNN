commit 7f01a4192cdf4565eadee457f76e6b5196e35e0b
Author: Alex Converse <alex.converse@gmail.com>
Date:   Wed Jun 29 13:41:47 2011 -0700

    adts: Fix PCE copying.
    
    Parse the extension flag bit when reading the MPEG4 AudioSpecificConfig.
    
    This has nothing to do with SBR/PS contradictory to what was noted when it was removed.

diff --git a/libavformat/adtsenc.c b/libavformat/adtsenc.c
index e858a81d9..75649e24d 100644
--- a/libavformat/adtsenc.c
+++ b/libavformat/adtsenc.c
@@ -59,6 +59,10 @@ int ff_adts_decode_extradata(AVFormatContext *s, ADTSContext *adts, uint8_t *buf
         av_log(s, AV_LOG_ERROR, "Scalable configurations are not allowed in ADTS\n");
         return -1;
     }
+    if (get_bits(&gb, 1)) {
+        av_log(s, AV_LOG_ERROR, "Extension flag is not allowed in ADTS\n");
+        return -1;
+    }
     if (!adts->channel_conf) {
         init_put_bits(&pb, adts->pce_data, MAX_PCE_SIZE);
 

