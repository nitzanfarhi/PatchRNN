commit 1a58a3befaccdf84f5a31e3cecd26c8d57c10890
Author: Johan Hovold <johan@hovoldconsulting.com>
Date:   Wed Sep 2 17:37:38 2015 +0200

    greybus: core: fix hd-creation error path
    
    Make sure to return an errno when a host-device buffer-size check fails.
    
    Fixes: 1f92f6404614 ("core: return error code when creating host device")
    Signed-off-by: Johan Hovold <johan@hovoldconsulting.com>
    Reviewed-by: Viresh Kumar <viresh.kumar@linaro.org>

diff --git a/drivers/staging/greybus/core.c b/drivers/staging/greybus/core.c
index 3ba744b0e998..605a0887dc61 100644
--- a/drivers/staging/greybus/core.c
+++ b/drivers/staging/greybus/core.c
@@ -184,7 +184,7 @@ struct greybus_host_device *greybus_create_hd(struct greybus_host_driver *driver
 
 	if (buffer_size_max < GB_OPERATION_MESSAGE_SIZE_MIN) {
 		dev_err(parent, "greybus host-device buffers too small\n");
-		return NULL;
+		return ERR_PTR(-EINVAL);
 	}
 
 	if (num_cports == 0 || num_cports > CPORT_ID_MAX) {

