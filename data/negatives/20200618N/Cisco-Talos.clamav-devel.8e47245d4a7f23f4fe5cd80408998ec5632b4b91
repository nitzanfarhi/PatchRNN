commit 8e47245d4a7f23f4fe5cd80408998ec5632b4b91
Author: aCaB <acab@clamav.net>
Date:   Wed Mar 10 01:53:24 2010 +0100

    don't cache possible unwanted

diff --git a/libclamav/cache.c b/libclamav/cache.c
index 4cd6c60f1..456d0aaa9 100644
--- a/libclamav/cache.c
+++ b/libclamav/cache.c
@@ -651,7 +651,7 @@ void cache_add(unsigned char *md5, size_t size, cli_ctx *ctx) {
     uint32_t level;
     struct CACHE *c;
 
-    if(!ctx || !ctx->engine || !ctx->engine->cache)
+    if(!ctx || !ctx->engine || !ctx->engine->cache || ctx->found_possibly_unwanted)
        return;
 
     level =  (*ctx->fmap && (*ctx->fmap)->dont_cache_flag) ? ctx->recursion : 0;

