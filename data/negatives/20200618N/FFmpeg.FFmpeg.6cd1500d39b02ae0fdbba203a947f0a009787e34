commit 6cd1500d39b02ae0fdbba203a947f0a009787e34
Author: Kostya Shishkov <kostya.shishkov@gmail.com>
Date:   Sun Dec 16 12:45:38 2007 +0000

    RV40 decoder should use availability cache
    
    Originally committed as revision 11230 to svn://svn.ffmpeg.org/ffmpeg/trunk

diff --git a/libavcodec/rv40.c b/libavcodec/rv40.c
index a08666340f..f0e0d915f8 100644
--- a/libavcodec/rv40.c
+++ b/libavcodec/rv40.c
@@ -213,13 +213,13 @@ static int rv40_decode_mb_info(RV34DecContext *r)
     if(--r->s.mb_skip_run)
          return RV34_MB_SKIP;
 
-    if(r->avail[0])
+    if(r->avail_cache[5-1])
         blocks[r->mb_type[mb_pos - 1]]++;
-    if(r->avail[1]){
+    if(r->avail_cache[5-4]){
         blocks[r->mb_type[mb_pos - s->mb_stride]]++;
-        if(r->avail[2])
+        if(r->avail_cache[5-2])
             blocks[r->mb_type[mb_pos - s->mb_stride + 1]]++;
-        if(r->avail[3])
+        if(r->avail_cache[5-5])
             blocks[r->mb_type[mb_pos - s->mb_stride - 1]]++;
     }
 

