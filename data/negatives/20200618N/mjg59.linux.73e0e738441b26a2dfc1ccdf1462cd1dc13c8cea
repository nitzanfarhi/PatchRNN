commit 73e0e738441b26a2dfc1ccdf1462cd1dc13c8cea
Author: Miklos Szeredi <mszeredi@suse.cz>
Date:   Wed Jul 1 16:25:56 2015 +0200

    fuse: reset waiting
    
    Reset req->waiting in fuse_put_request().  This is needed for correct
    accounting in fc->num_waiting for reserved requests.
    
    Signed-off-by: Miklos Szeredi <mszeredi@suse.cz>

diff --git a/fs/fuse/dev.c b/fs/fuse/dev.c
index 6aa4803510e7..24f1d77b87a4 100644
--- a/fs/fuse/dev.c
+++ b/fs/fuse/dev.c
@@ -287,8 +287,10 @@ void fuse_put_request(struct fuse_conn *fc, struct fuse_req *req)
 			spin_unlock(&fc->lock);
 		}
 
-		if (req->waiting)
+		if (req->waiting) {
 			atomic_dec(&fc->num_waiting);
+			req->waiting = 0;
+		}
 
 		if (req->stolen_file)
 			put_reserved_req(fc, req);

