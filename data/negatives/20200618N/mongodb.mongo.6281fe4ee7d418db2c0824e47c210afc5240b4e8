commit 6281fe4ee7d418db2c0824e47c210afc5240b4e8
Author: Eliot Horowitz <eliot@10gen.com>
Date:   Tue Sep 1 17:08:57 2009 -0400

    const BSONObj

diff --git a/client/dbclient.cpp b/client/dbclient.cpp
index e776d144f5..615447d6f3 100644
--- a/client/dbclient.cpp
+++ b/client/dbclient.cpp
@@ -128,12 +128,13 @@ namespace mongo {
         return runCommand(dbname, b.done(), *info);
     }
 
-    unsigned long long DBClientWithCommands::count(const string &_ns, BSONObj query) { 
+    unsigned long long DBClientWithCommands::count(const string &_ns, const BSONObj& query) { 
         NamespaceString ns(_ns);
         BSONObj cmd = BSON( "count" << ns.coll << "query" << query );
         BSONObj res;
         if( !runCommand(ns.db.c_str(), cmd, res) )
             uasserted(string("count fails:") + res.toString());
+        cout << "cmd: " << cmd << "\n\t" << res << endl;
         return res.getIntField("n");
     }
 
diff --git a/client/dbclient.h b/client/dbclient.h
index f758b23c36..86a56e0b51 100644
--- a/client/dbclient.h
+++ b/client/dbclient.h
@@ -330,7 +330,7 @@ namespace mongo {
         /** count number of objects in collection ns that match the query criteria specified
             throws UserAssertion if database returns an error
         */
-        unsigned long long count(const string &ns, BSONObj query = BSONObj());
+        unsigned long long count(const string &ns, const BSONObj& query = BSONObj());
 
         string createPasswordDigest( const string &username , const string &clearTextPassword );
 

