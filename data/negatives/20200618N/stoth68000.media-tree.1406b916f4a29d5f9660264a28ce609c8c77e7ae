commit 1406b916f4a29d5f9660264a28ce609c8c77e7ae
Author: J. R. Okajima <hooanon05g@gmail.com>
Date:   Wed Feb 19 00:27:53 2014 +0900

    nfsd: fix lost nfserrno() call in nfsd_setattr()
    
    There is a regression in
            208d0ac 2014-01-07 nfsd4: break only delegations when appropriate
    which deletes an nfserrno() call in nfsd_setattr() (by accident,
    probably), and NFSD becomes ignoring an error from VFS.
    
    Signed-off-by: J. Bruce Fields <bfields@redhat.com>

diff --git a/fs/nfsd/vfs.c b/fs/nfsd/vfs.c
index 017d3cb5e99b..6d7be3f80356 100644
--- a/fs/nfsd/vfs.c
+++ b/fs/nfsd/vfs.c
@@ -449,6 +449,7 @@ nfsd_setattr(struct svc_rqst *rqstp, struct svc_fh *fhp, struct iattr *iap,
 	fh_lock(fhp);
 	host_err = notify_change(dentry, iap, NULL);
 	fh_unlock(fhp);
+	err = nfserrno(host_err);
 
 out_put_write_access:
 	if (size_change)

