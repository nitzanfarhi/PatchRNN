commit b8cf182ad70762aec5354b1f5b5f17cc8e9d3180
Author: Dirk Lemstra <dirk@git.imagemagick.org>
Date:   Sat Mar 31 08:24:32 2018 +0200

    Only support up to 3 channels.

diff --git a/coders/rla.c b/coders/rla.c
index a34007239..f3fab923b 100644
--- a/coders/rla.c
+++ b/coders/rla.c
@@ -221,6 +221,8 @@ static Image *ReadRLAImage(const ImageInfo *image_info,ExceptionInfo *exception)
   rla_info.number_matte_channels=(short) ReadBlobMSBShort(image);
   if (rla_info.number_matte_channels < 0)
     ThrowReaderException(CorruptImageError,"ImproperImageHeader");
+  if ((rla_info.number_channels > 3) || (rla_info.number_matte_channels > 3))
+    ThrowReaderException(CoderError,"Unsupported number of channels");
   if (rla_info.number_channels == 0)
     rla_info.number_channels=3;
   rla_info.number_channels+=rla_info.number_matte_channels;

