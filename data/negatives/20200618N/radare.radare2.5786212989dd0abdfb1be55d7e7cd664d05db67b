commit 5786212989dd0abdfb1be55d7e7cd664d05db67b
Author: pancake <pancake@nopcode.org>
Date:   Fri Jan 30 00:54:28 2015 +0100

    x86.cs: identify PUSH vs UPUSH

diff --git a/libr/anal/p/anal_x86_cs.c b/libr/anal/p/anal_x86_cs.c
index 418323dd4..017787b0d 100644
--- a/libr/anal/p/anal_x86_cs.c
+++ b/libr/anal/p/anal_x86_cs.c
@@ -411,11 +411,12 @@ static int analop(RAnal *a, RAnalOp *op, ut64 addr, const ut8 *buf, int len) {
 					esilprintf (op,  "%d,%s,-=,%s,%s,=[%d]", rs, sp, dst, sp, rs);
 					free (dst);
 				}
-				op->type = R_ANAL_OP_TYPE_PUSH;
 				switch (INSOP(0).type) {
 				case X86_OP_IMM:
 					op->ptr = INSOP(0).imm;
+					op->type = R_ANAL_OP_TYPE_PUSH;
 				default:
+					op->type = R_ANAL_OP_TYPE_UPUSH;
 					break;
 				}
 				op->stackop = R_ANAL_STACK_INC;

