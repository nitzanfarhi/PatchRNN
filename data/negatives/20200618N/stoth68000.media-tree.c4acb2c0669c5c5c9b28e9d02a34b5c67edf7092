commit c4acb2c0669c5c5c9b28e9d02a34b5c67edf7092
Author: Gregory Haskins <ghaskins@novell.com>
Date:   Fri Jun 27 14:29:55 2008 -0600

    sched: terminate newidle balancing once at least one task has moved over
    
    Inspired by Peter Zijlstra.
    
    Signed-off-by: Gregory Haskins <ghaskins@novell.com>
    Cc: npiggin@suse.de
    Cc: rostedt@goodmis.org
    Acked-by: Peter Zijlstra <a.p.zijlstra@chello.nl>
    Signed-off-by: Ingo Molnar <mingo@elte.hu>

diff --git a/kernel/sched.c b/kernel/sched.c
index 677c80b9a6b5..d99aeabeb72f 100644
--- a/kernel/sched.c
+++ b/kernel/sched.c
@@ -3013,6 +3013,10 @@ static int move_tasks(struct rq *this_rq, int this_cpu, struct rq *busiest,
 				max_load_move - total_load_moved,
 				sd, idle, all_pinned, &this_best_prio);
 		class = class->next;
+
+		if (idle == CPU_NEWLY_IDLE && this_rq->nr_running)
+			break;
+
 	} while (class && max_load_move > total_load_moved);
 
 	return total_load_moved > 0;

