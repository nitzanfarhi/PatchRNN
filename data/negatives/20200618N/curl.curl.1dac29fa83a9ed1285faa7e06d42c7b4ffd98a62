commit 1dac29fa83a9ed1285faa7e06d42c7b4ffd98a62
Author: Steve Holme <steve_holme@hotmail.com>
Date:   Fri Feb 22 19:58:42 2013 +0000

    imap.c: Fixed an incorrect variable reference
    
    Fixed an incorrect variable reference which was introduced in commit
    a1701eea289f as a result of a copy and paste from SMTP/POP3.

diff --git a/lib/imap.c b/lib/imap.c
index 0b7dbc391..8525c89be 100644
--- a/lib/imap.c
+++ b/lib/imap.c
@@ -378,7 +378,7 @@ static bool imap_endofresp(struct connectdata *conn, char *line, size_t len,
           wordlen++;
 
         /* Does the server support the STARTTLS capability? */
-        if(len >= 8 && !memcmp(line, "STARTTLS", 8))
+        if(wordlen >= 8 && !memcmp(line, "STARTTLS", 8))
           imapc->tls_supported = TRUE;
 
         /* Has the server explicitly disabled clear text authentication? */

