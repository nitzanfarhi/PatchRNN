commit 5e203e846133e28d0e36ca70ef1c30e72a922c14
Author: Timo Sirainen <tss@iki.fi>
Date:   Fri Feb 20 18:29:30 2009 -0500

    virtual: Crashfix on a specific configuration.
    
    --HG--
    branch : HEAD

diff --git a/src/plugins/virtual/virtual-config.c b/src/plugins/virtual/virtual-config.c
index 7a877fc48..8c411015d 100644
--- a/src/plugins/virtual/virtual-config.c
+++ b/src/plugins/virtual/virtual-config.c
@@ -243,6 +243,11 @@ static int virtual_config_expand_wildcards(struct virtual_parse_context *ctx)
 
 	/* get patterns we want to list */
 	wboxes = array_get_modifiable(&wildcard_boxes, &count);
+	if (count == 0) {
+		/* only negative wildcards - doesn't really make sense.
+		   just ignore. */
+		return 0;
+	}
 	patterns = t_new(const char *, count + 1);
 	for (i = 0; i < count; i++)
 		patterns[i] = wboxes[i]->name;

