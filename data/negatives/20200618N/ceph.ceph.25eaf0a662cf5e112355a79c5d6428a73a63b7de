commit 25eaf0a662cf5e112355a79c5d6428a73a63b7de
Author: Pan Liu <pan.liu@istuary.com>
Date:   Sun Feb 26 08:22:17 2017 +0800

    rbd: allow users to remove rbd image when Ceph cluster becomes full.
    
    Signed-off-by: Pan Liu <liupan1111@gmail.com>

diff --git a/src/tools/rbd/action/Remove.cc b/src/tools/rbd/action/Remove.cc
index 9b2c4eb5ba..b407534252 100644
--- a/src/tools/rbd/action/Remove.cc
+++ b/src/tools/rbd/action/Remove.cc
@@ -53,6 +53,8 @@ int execute(const po::variables_map &vm) {
     return r;
   }
 
+  io_ctx.set_osdmap_full_try();
+
   librbd::RBD rbd;
   r = do_delete(rbd, io_ctx, image_name.c_str(),
                 vm[at::NO_PROGRESS].as<bool>());

