commit e5992c05ffaa405cd291aa9fbca042ad47d53632
Author: Dmitry Artamonow <mad_soft@inbox.ru>
Date:   Fri Apr 30 21:31:36 2010 +0100

    ARM: 6076/1: SA1100: add processor check to sa1110-cpufreq driver
    
    Just to make sure that this driver won't run on StrongArm SA1100
    when both SA1100 and SA1110 cpufreq drivers are built in (usually
    in multimachine config). SA1100 driver already has similar check.
    
    Signed-off-by: Dmitry Artamonow <mad_soft@inbox.ru>
    Acked-by: Eric Miao <eric.y.miao@gmail.com>
    Acked-by: Kristoffer Ericson <kristoffer.ericson@gmail.com>
    Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>

diff --git a/arch/arm/mach-sa1100/cpu-sa1110.c b/arch/arm/mach-sa1100/cpu-sa1110.c
index 63b32b68b296..7252874d328b 100644
--- a/arch/arm/mach-sa1100/cpu-sa1110.c
+++ b/arch/arm/mach-sa1100/cpu-sa1110.c
@@ -363,6 +363,9 @@ static int __init sa1110_clk_init(void)
 	struct sdram_params *sdram;
 	const char *name = sdram_name;
 
+	if (!cpu_is_sa1110())
+		return -ENODEV;
+
 	if (!name[0]) {
 		if (machine_is_assabet())
 			name = "TC59SM716-CL3";

