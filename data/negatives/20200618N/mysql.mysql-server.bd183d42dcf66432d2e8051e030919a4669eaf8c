commit bd183d42dcf66432d2e8051e030919a4669eaf8c
Author: kostja@bodhi.local <>
Date:   Wed Jul 12 19:19:43 2006 +0400

    Fix a valgrind warning in type_date test.

diff --git a/sql/item_timefunc.cc b/sql/item_timefunc.cc
index 7dff3000b5b..9e1962835c8 100644
--- a/sql/item_timefunc.cc
+++ b/sql/item_timefunc.cc
@@ -492,10 +492,11 @@ bool make_date_time(DATE_TIME_FORMAT *format, TIME *l_time,
   const char *ptr, *end;
   MY_LOCALE *locale;
   THD *thd= current_thd;
-  char buf[128]; 
-  String tmp(buf, thd->variables.character_set_results);
+  char buf[STRING_BUFFER_USUAL_SIZE];
+  String tmp(buf, sizeof(buf), thd->variables.character_set_results);
   uint errors= 0;
 
+  tmp.length(0);
   str->length(0);
   str->set_charset(&my_charset_bin);
   locale = thd->variables.lc_time_names;

