commit 76c7d3ffe3acddf5619bd796e0b8fa5dc6ecdb39
Author: krzysztof.h1@wp.pl <krzysztof.h1@wp.pl>
Date:   Tue May 8 00:39:56 2007 -0700

    pm2fb: reset transparency settings
    
    This patch resets transparency settings when depth changes.  Otherwise the 16
    and 24-bit modes work incorrectly after switching from 32-bit mode.
    
    Signed-off-by: Krzysztof Helt < krzysztof.h1@wp.pl>
    Signed-off-by: Antonino Daplas <adaplas@gmail.com>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

diff --git a/drivers/video/pm2fb.c b/drivers/video/pm2fb.c
index 2a8ba6022d3d..33f17a96a569 100644
--- a/drivers/video/pm2fb.c
+++ b/drivers/video/pm2fb.c
@@ -645,6 +645,8 @@ static int pm2fb_check_var(struct fb_var_screeninfo *var, struct fb_info *info)
 		return -EINVAL;
 	}
 
+	var->transp.offset = 0;
+	var->transp.length = 0;
 	switch(var->bits_per_pixel) {
 	case 8:
 		var->red.length = var->green.length = var->blue.length = 8;

