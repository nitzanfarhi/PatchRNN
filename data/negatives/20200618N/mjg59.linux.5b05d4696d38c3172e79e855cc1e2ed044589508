commit 5b05d4696d38c3172e79e855cc1e2ed044589508
Author: Michael Buesch <mb@bu3sch.de>
Date:   Sat Aug 1 12:04:19 2009 -0300

    thinkpad-acpi: restrict procfs count value to sane upper limit
    
    Signed-off-by: Michael Buesch <mb@bu3sch.de>
    Acked-by: Henrique de Moraes Holschuh <hmh@hmh.eng.br>
    Signed-off-by: Len Brown <len.brown@intel.com>

diff --git a/drivers/platform/x86/thinkpad_acpi.c b/drivers/platform/x86/thinkpad_acpi.c
index 27d68e719e90..18f9ee63c50a 100644
--- a/drivers/platform/x86/thinkpad_acpi.c
+++ b/drivers/platform/x86/thinkpad_acpi.c
@@ -766,6 +766,8 @@ static int dispatch_procfs_write(struct file *file,
 
 	if (!ibm || !ibm->write)
 		return -EINVAL;
+	if (count > PAGE_SIZE - 2)
+		return -EINVAL;
 
 	kernbuf = kmalloc(count + 2, GFP_KERNEL);
 	if (!kernbuf)

