commit ccef9c6adce404f5507b7ad1da0471bc345be5df
Author: Sebastien Ponce <sebastien.ponce@cern.ch>
Date:   Fri Mar 6 16:37:47 2015 +0100

    XrdCeph: Do not fail an open with O_TRUNC flag if the file is created

diff --git a/src/XrdCeph/XrdCephPosix.cc b/src/XrdCeph/XrdCephPosix.cc
index 1b405b3d..d6327f21 100644
--- a/src/XrdCeph/XrdCephPosix.cc
+++ b/src/XrdCeph/XrdCephPosix.cc
@@ -464,7 +464,8 @@ int ceph_posix_open(XrdOucEnv* env, const char *pathname, int flags, mode_t mode
   // in case of O_TRUNC, we should truncate the file
   if (flags & O_TRUNC) {
     int rc = ceph_posix_internal_truncate(fr, 0);
-    if (rc < 0) return rc;
+    // fail only if file exists and cannot be truncated
+    if (rc < 0 && rc != -ENOENT) return rc;
   }
   return g_nextCephFd-1;
 }

