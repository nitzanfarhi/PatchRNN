commit 3a7200af3d9227767869f451ed747aff07d8df48
Author: Mel Gorman <mgorman@suse.de>
Date:   Wed Sep 11 14:22:19 2013 -0700

    mm: compaction: do not compact pgdat for order-0
    
    If kswapd was reclaiming for a high order and resets it to 0 due to
    fragmentation it will still call compact_pgdat.  For the most part, this
    will fail a compaction_suitable() test and not compact but it is
    unnecessarily sloppy.  It could be fixed in the caller but fix it in the
    API instead.
    
    [dhillf@gmail.com: pointed out that it was a potential problem]
    Signed-off-by: Mel Gorman <mgorman@suse.de>
    Cc: Hillf Danton <dhillf@gmail.com>
    Acked-by: Minchan Kim <minchan@kernel.org>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

diff --git a/mm/compaction.c b/mm/compaction.c
index 05ccb4cc0bdb..c43789388cd8 100644
--- a/mm/compaction.c
+++ b/mm/compaction.c
@@ -1131,6 +1131,9 @@ void compact_pgdat(pg_data_t *pgdat, int order)
 		.sync = false,
 	};
 
+	if (!order)
+		return;
+
 	__compact_pgdat(pgdat, &cc);
 }
 

