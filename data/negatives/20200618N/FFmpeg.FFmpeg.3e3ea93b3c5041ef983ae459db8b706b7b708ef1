commit 3e3ea93b3c5041ef983ae459db8b706b7b708ef1
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Tue Apr 5 00:06:11 2011 +0200

    mpegts: Put CODEC_ID_NONE check back that was removed by mistake in 5b56ad03
    
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavformat/mpegts.c b/libavformat/mpegts.c
index 71e8d7318f..4ce9598e15 100644
--- a/libavformat/mpegts.c
+++ b/libavformat/mpegts.c
@@ -704,7 +704,7 @@ static int mpegts_push_data(MpegTSFilter *filter,
                         code != 0x1ff && code != 0x1f2 && /* program_stream_directory, DSMCC_stream */
                         code != 0x1f8) {                  /* ITU-T Rec. H.222.1 type E stream */
                         pes->state = MPEGTS_PESHEADER;
-                        if (!pes->st->request_probe) {
+                        if (pes->st->codec->codec_id == CODEC_ID_NONE && !pes->st->request_probe) {
                             av_dlog(pes->stream, "pid=%x stream_type=%x probing\n",
                                     pes->pid, pes->stream_type);
                             pes->st->request_probe= 1;

