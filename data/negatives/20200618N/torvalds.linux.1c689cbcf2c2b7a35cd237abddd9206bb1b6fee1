commit 1c689cbcf2c2b7a35cd237abddd9206bb1b6fee1
Author: Kulikov Vasiliy <segooon@gmail.com>
Date:   Fri Jul 16 20:13:02 2010 +0400

    arch/tile: check kmalloc() result
    
    If kmalloc() fails exit with -ENOMEM.
    
    Signed-off-by: Kulikov Vasiliy <segooon@gmail.com>
    Acked-by: Chris Metcalf <cmetcalf@tilera.com>

diff --git a/arch/tile/kernel/hardwall.c b/arch/tile/kernel/hardwall.c
index 7bf0627b733d..584b965dc824 100644
--- a/arch/tile/kernel/hardwall.c
+++ b/arch/tile/kernel/hardwall.c
@@ -364,6 +364,8 @@ static struct hardwall_info *hardwall_create(
 	/* Allocate a new rectangle optimistically. */
 	rect = kmalloc(sizeof(struct hardwall_info),
 			GFP_KERNEL | __GFP_ZERO);
+	if (rect == NULL)
+		return ERR_PTR(-ENOMEM);
 	INIT_LIST_HEAD(&rect->task_head);
 
 	/* Compute the rectangle size and validate that it's plausible. */

