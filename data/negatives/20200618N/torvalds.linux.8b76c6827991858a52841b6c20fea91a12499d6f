commit 8b76c6827991858a52841b6c20fea91a12499d6f
Author: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
Date:   Wed May 25 11:34:52 2011 +0200

    fbdev: da8xx: use display information in info not in var for panning
    
    We must not use any information in the passed var besides xoffset,
    yoffset and vmode as otherwise applications might abuse it.
    
    Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>

diff --git a/drivers/video/da8xx-fb.c b/drivers/video/da8xx-fb.c
index fcdac872522d..8d4e4ebd9977 100644
--- a/drivers/video/da8xx-fb.c
+++ b/drivers/video/da8xx-fb.c
@@ -877,8 +877,8 @@ static int da8xx_pan_display(struct fb_var_screeninfo *var,
 
 			start	= fix->smem_start +
 				new_var.yoffset * fix->line_length +
-				new_var.xoffset * var->bits_per_pixel / 8;
-			end	= start + var->yres * fix->line_length - 1;
+				new_var.xoffset * fbi->var.bits_per_pixel / 8;
+			end	= start + fbi->var.yres * fix->line_length - 1;
 			par->dma_start	= start;
 			par->dma_end	= end;
 		}

