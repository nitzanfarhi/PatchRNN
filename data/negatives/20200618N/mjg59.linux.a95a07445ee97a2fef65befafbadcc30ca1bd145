commit a95a07445ee97a2fef65befafbadcc30ca1bd145
Author: Koki Sanagi <sanagi.koki@jp.fujitsu.com>
Date:   Wed Jan 4 20:23:38 2012 +0000

    igb: reset PHY after recovering from PHY power down
    
    According to 82576_Datasheet.pdf, PHY setting is lost after PHY power down.
    So resetting PHY is needed when recovering from PHY power down to set a default
    setting to PHY register.
    Owing to this lack, NIC doesn't link up in some rare situation.
    
    Signed-off-by: Koki Sanagi <sanagi.koki@jp.fujitsu.com>
    Tested-by: Aaron Brown <aaron.f.brown@intel.com>
    Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/drivers/net/ethernet/intel/igb/igb_main.c b/drivers/net/ethernet/intel/igb/igb_main.c
index fac71e21e0a4..01e5e89ef959 100644
--- a/drivers/net/ethernet/intel/igb/igb_main.c
+++ b/drivers/net/ethernet/intel/igb/igb_main.c
@@ -1507,6 +1507,7 @@ void igb_power_up_link(struct igb_adapter *adapter)
 		igb_power_up_phy_copper(&adapter->hw);
 	else
 		igb_power_up_serdes_link_82575(&adapter->hw);
+	igb_reset_phy(&adapter->hw);
 }
 
 /**

