commit 0d3b24f9cf1755d3a9e2a81c10b1f15f3a707f6a
Author: William Pitcock <nenolod@atheme.org>
Date:   Sat May 30 13:30:57 2009 -0500

    presence: Create presence metadata tracking structures where appropriate.

diff --git a/include/client.h b/include/client.h
index de054320..9f8709a5 100644
--- a/include/client.h
+++ b/include/client.h
@@ -96,6 +96,7 @@ struct User
 	int refcnt;		/* Number of times this block is referenced */
 
 	char suser[NICKLEN+1];
+	struct Dictionary *metadata;
 };
 
 struct Server
@@ -177,8 +178,6 @@ struct Client
 	pre_client_t *preClient;
 
 	time_t large_ctcp_sent; /* ctcp to large group sent, relax flood checks */
-
-	struct Dictionary *metadata;
 };
 
 struct LocalUser
diff --git a/src/client.c b/src/client.c
index 7aa5b941..b372e881 100644
--- a/src/client.c
+++ b/src/client.c
@@ -1657,8 +1657,10 @@ make_user(struct Client *client_p)
 	{
 		user = (struct User *) rb_bh_alloc(user_heap);
 		user->refcnt = 1;
+		user->metadata = irc_dictionary_create(irccmp);
 		client_p->user = user;
 	}
+
 	return user;
 }
 

