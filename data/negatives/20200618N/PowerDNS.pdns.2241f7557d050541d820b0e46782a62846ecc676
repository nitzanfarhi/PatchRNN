commit 2241f7557d050541d820b0e46782a62846ecc676
Author: Bert Hubert <bert.hubert@netherlabs.nl>
Date:   Mon Apr 18 18:47:33 2011 +0000

    fix two sqlite bugs within zone2sql
    
    
    git-svn-id: svn://svn.powerdns.com/pdns/trunk/pdns@2167 d19b8d6e-7fed-0310-83ef-9ca221ded41b

diff --git a/pdns/backends/bind/zone2sql.cc b/pdns/backends/bind/zone2sql.cc
index 53c8e2aca..9e3801ec4 100644
--- a/pdns/backends/bind/zone2sql.cc
+++ b/pdns/backends/bind/zone2sql.cc
@@ -263,7 +263,7 @@ int main(int argc, char **argv)
             startNewTransaction();
             
             if(!::arg().mustDo("slave")) {
-              if(g_mode==POSTGRES || g_mode==MYSQL) {
+              if(g_mode==POSTGRES || g_mode==MYSQL || g_mode==SQLITE) {
                 cout<<"insert into domains (name,type) values ("<<toLower(sqlstr(stripDot(i->name)))<<",'NATIVE');"<<endl;
               }
               else if(g_mode==ORACLE) {
@@ -340,8 +340,12 @@ int main(int argc, char **argv)
     exit(0);
   }
   
-  if(::arg().mustDo("transactions") && g_intransaction)
-    cout<<"COMMIT WORK;"<<endl;
+  if(::arg().mustDo("transactions") && g_intransaction) {
+    if(g_mode != SQLITE)
+      cout<<"COMMIT WORK;"<<endl;
+    else
+      cout<<"COMMIT;"<<endl;
+  }
   return 1;
 
 }

