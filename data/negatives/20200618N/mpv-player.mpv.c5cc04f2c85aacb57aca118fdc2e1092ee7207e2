commit c5cc04f2c85aacb57aca118fdc2e1092ee7207e2
Author: bertrand <bertrand@b3059339-0415-0410-9bf9-f77b7e298cf2>
Date:   Tue Sep 3 01:25:31 2002 +0000

    Checked if the connection succeeded before writing in the socket.
    
    
    git-svn-id: svn://svn.mplayerhq.hu/mplayer/trunk@7251 b3059339-0415-0410-9bf9-f77b7e298cf2

diff --git a/libmpdemux/asf_mmst_streaming.c b/libmpdemux/asf_mmst_streaming.c
index 28ce7ea7f4..dc0a94df91 100644
--- a/libmpdemux/asf_mmst_streaming.c
+++ b/libmpdemux/asf_mmst_streaming.c
@@ -513,11 +513,19 @@ int asf_mmst_streaming_start(stream_t *stream)
   URL_t *url1 = stream->streaming_ctrl->url;
   int s = stream->fd;
 
+  if( s>0 ) {
+	  close( stream->fd );
+	  stream->fd = -1;
+  }
+  
   /* parse url */
   path = strchr(url1->file,'/') + 1;
 
   url1->port=1755;
   s = connect2Server( url1->hostname, url1->port );
+  if( s<0 ) {
+	  return s;
+  }
   printf ("connected\n");
 
   /*

