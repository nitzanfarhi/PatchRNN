commit 95058c64d193939465666419319f384c48d1a0a2
Author: Armin Novak <armin.novak@gmail.com>
Date:   Wed Feb 24 20:16:33 2016 +0100

    Fixed argument checks and return values.

diff --git a/libfreerdp/core/timezone.c b/libfreerdp/core/timezone.c
index 1aee3ba87..637afa64e 100644
--- a/libfreerdp/core/timezone.c
+++ b/libfreerdp/core/timezone.c
@@ -82,10 +82,15 @@ BOOL rdp_read_client_time_zone(wStream* s, rdpSettings* settings)
 {
 	LPTIME_ZONE_INFORMATION tz;
 
+    if (!s || !settings)
+        return FALSE;
+
 	if (Stream_GetRemainingLength(s) < 172)
 		return FALSE;
 
 	tz = settings->ClientTimeZone;
+    if (!tz)
+        return FALSE;
 
 	Stream_Read_UINT32(s, tz->Bias); /* Bias */
 
@@ -111,12 +116,15 @@ BOOL rdp_read_client_time_zone(wStream* s, rdpSettings* settings)
  * @param settings settings
  */
 
-void rdp_write_client_time_zone(wStream* s, rdpSettings* settings)
+BOOL rdp_write_client_time_zone(wStream* s, rdpSettings* settings)
 {
 	LPTIME_ZONE_INFORMATION tz;
 	DWORD rc;
 
 	tz = settings->ClientTimeZone;
+    if (!tz)
+        return FALSE;
+
 	rc = GetTimeZoneInformation(tz);
 
 	/* Bias */
@@ -146,4 +154,7 @@ void rdp_write_client_time_zone(wStream* s, rdpSettings* settings)
 	/* DaylightBias */
 	Stream_Write_UINT32(s, tz->DaylightBias);
 	DEBUG_TIMEZONE("DaylightBias=%d", tz->DaylightBias);
+
+    return TRUE
 }
+
diff --git a/libfreerdp/core/timezone.h b/libfreerdp/core/timezone.h
index d40940988..92b2c7af1 100644
--- a/libfreerdp/core/timezone.h
+++ b/libfreerdp/core/timezone.h
@@ -32,7 +32,7 @@
 #include <winpr/stream.h>
 
 BOOL rdp_read_client_time_zone(wStream* s, rdpSettings* settings);
-void rdp_write_client_time_zone(wStream* s, rdpSettings* settings);
+BOOL rdp_write_client_time_zone(wStream* s, rdpSettings* settings);
 
 #define TIMEZONE_TAG FREERDP_TAG("core.timezone")
 #ifdef WITH_DEBUG_TIMEZONE

