commit 57eb776feac497c8e5b561c0a24156245f0c08db
Author: Andre Guedes <andre.guedes@openbossa.org>
Date:   Wed Oct 30 19:01:41 2013 -0300

    Bluetooth: Add an extra check in mgmt_device_disconnected()
    
    This patch adds an extra check in mgmt_device_disconnected() so we only
    send the "Device Disconnected" event if it is ACL_LINK or LE_LINK link
    type.
    
    Signed-off-by: Andre Guedes <andre.guedes@openbossa.org>
    Signed-off-by: Marcel Holtmann <marcel@holtmann.org>

diff --git a/net/bluetooth/mgmt.c b/net/bluetooth/mgmt.c
index 6a74aa776541..a03ca3ca91bf 100644
--- a/net/bluetooth/mgmt.c
+++ b/net/bluetooth/mgmt.c
@@ -4595,6 +4595,9 @@ void mgmt_device_disconnected(struct hci_dev *hdev, bdaddr_t *bdaddr,
 	struct mgmt_ev_device_disconnected ev;
 	struct sock *sk = NULL;
 
+	if (link_type != ACL_LINK && link_type != LE_LINK)
+		return;
+
 	mgmt_pending_foreach(MGMT_OP_DISCONNECT, hdev, disconnect_rsp, &sk);
 
 	bacpy(&ev.addr.bdaddr, bdaddr);

