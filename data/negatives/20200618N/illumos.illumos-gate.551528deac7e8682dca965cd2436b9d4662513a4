commit 551528deac7e8682dca965cd2436b9d4662513a4
Author: ps216548 <none@none>
Date:   Mon Mar 17 02:58:06 2008 -0700

    6521585 metasync dumps core if its argument is not a valid metadevice name

diff --git a/usr/src/cmd/lvm/util/metasync.c b/usr/src/cmd/lvm/util/metasync.c
index e2b7ae70d8..4d36d35cf6 100644
--- a/usr/src/cmd/lvm/util/metasync.c
+++ b/usr/src/cmd/lvm/util/metasync.c
@@ -19,7 +19,7 @@
  * CDDL HEADER END
  */
 /*
- * Copyright 2006 Sun Microsystems, Inc.  All rights reserved.
+ * Copyright 2008 Sun Microsystems, Inc.  All rights reserved.
  * Use is subject to license terms.
  */
 
@@ -104,7 +104,7 @@ main(
 
 	/* initialize */
 	if (md_init(argc, argv, 0, 1, ep) != 0 ||
-			meta_check_root(ep) != 0) {
+	    meta_check_root(ep) != 0) {
 		mde_perror(ep, "");
 		md_exit(sp, 1);
 	}
@@ -167,7 +167,7 @@ main(
 	 * MD_DEF_RESYNC_BUF_SIZE
 	 */
 	if ((argc > 0) && (isdigit(argv[0][0]))) {
-		if ((size = atoi(argv[optind++])) < 0) {
+		if ((size = atoi(argv[0])) < 0) {
 			md_eprintf(gettext(
 			    "illegal buffer size %s\n"),
 			    argv[0]);

