commit 6d5a051238609ba67604947c44adfff0fe1c1cec
Author: deraadt <deraadt@openbsd.org>
Date:   Tue Jun 24 07:48:40 1997 +0000

    delay free of mf_mount until after last use; tegge@idt.unit.no

diff --git a/usr.sbin/amd/amd/mntfs.c b/usr.sbin/amd/amd/mntfs.c
index 7662e86a39b..3c110ed39a9 100644
--- a/usr.sbin/amd/amd/mntfs.c
+++ b/usr.sbin/amd/amd/mntfs.c
@@ -38,7 +38,7 @@
 
 #ifndef lint
 /*static char sccsid[] = "from: @(#)mntfs.c	8.1 (Berkeley) 6/6/93";*/
-static char *rcsid = "$Id: mntfs.c,v 1.1.1.1 1995/10/18 08:47:10 deraadt Exp $";
+static char *rcsid = "$Id: mntfs.c,v 1.2 1997/06/24 07:48:40 deraadt Exp $";
 #endif /* not lint */
 
 
@@ -234,7 +234,6 @@ static void uninit_mntfs(mf, rmd)
 mntfs *mf;
 int rmd;
 {
-	if (mf->mf_mount) free((voidp) mf->mf_mount);
 	if (mf->mf_auto) free((voidp) mf->mf_auto);
 	if (mf->mf_mopts) free((voidp) mf->mf_mopts);
 	if (mf->mf_remopts) free((voidp) mf->mf_remopts);
@@ -246,6 +245,7 @@ int rmd;
 	 */
 	if (rmd && (mf->mf_flags & MFF_MKMNT))
 		rmdirs(mf->mf_mount);
+	if (mf->mf_mount) free((voidp) mf->mf_mount);
 
 	/*
 	 * Clean up the file server

