commit 90fdd6130f5c0053c48e8c8e247091739b6e4092
Author: Linas Vepstas <linas@austin.ibm.com>
Date:   Mon Mar 19 14:55:10 2007 -0500

    [POWERPC] EEH: hotplug recovery bugfix
    
    If a device driver does not have native PCI error recovery,
    a hotplug error recovery will be attemped. In this case,
    the device driver will not report back whether its healthy
    or not; simply assume that it is.
    
    Signed-off-by: Linas Vepstas <linas@austin.ibm.com>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

diff --git a/arch/powerpc/platforms/pseries/eeh_driver.c b/arch/powerpc/platforms/pseries/eeh_driver.c
index 550fad2199ad..d73c297b0234 100644
--- a/arch/powerpc/platforms/pseries/eeh_driver.c
+++ b/arch/powerpc/platforms/pseries/eeh_driver.c
@@ -438,7 +438,8 @@ struct pci_dn * handle_eeh_events (struct eeh_event *event)
 	}
 
 	/* All devices should claim they have recovered by now. */
-	if (result != PCI_ERS_RESULT_RECOVERED) {
+	if ((result != PCI_ERS_RESULT_RECOVERED) &&
+	    (result != PCI_ERS_RESULT_NONE)) {
 		printk(KERN_WARNING "EEH: Not recovered\n");
 		goto hard_fail;
 	}

