commit 562c0b139aa2162e8880b3c979bc3dfd353bb630
Author: Pieter Lexis <pieter.lexis@powerdns.com>
Date:   Fri Jul 29 12:21:25 2016 +0200

    Auth: PDNSException for bad SOA MNAME or RNAME
    
    This prevents blowing up the bind backend on startup when one zone
    contains a bad SOA record.

diff --git a/pdns/zoneparser-tng.cc b/pdns/zoneparser-tng.cc
index d1f8bacf7..c4f4becba 100644
--- a/pdns/zoneparser-tng.cc
+++ b/pdns/zoneparser-tng.cc
@@ -452,8 +452,12 @@ bool ZoneParserTNG::get(DNSResourceRecord& rr, std::string* comment)
     if(recparts.size() > 7)
       throw PDNSException("SOA record contents for "+rr.qname.toString()+" contains too many parts");
     if(recparts.size() > 1) {
-      recparts[0]=toCanonic(d_zonename, recparts[0]).toStringRootDot();
-      recparts[1]=toCanonic(d_zonename, recparts[1]).toStringRootDot();
+      try {
+        recparts[0]=toCanonic(d_zonename, recparts[0]).toStringRootDot();
+        recparts[1]=toCanonic(d_zonename, recparts[1]).toStringRootDot();
+      } catch (runtime_error &re) {
+        throw PDNSException(re.what());
+      }
     }
     rr.content.clear();
     for(string::size_type n = 0; n < recparts.size(); ++n) {

