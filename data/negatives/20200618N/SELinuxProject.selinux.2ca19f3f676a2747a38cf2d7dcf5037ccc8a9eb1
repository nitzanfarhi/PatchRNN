commit 2ca19f3f676a2747a38cf2d7dcf5037ccc8a9eb1
Author: Dan Walsh <dwalsh@redhat.com>
Date:   Fri May 25 07:11:21 2012 -0400

    libselinux: asprintf return code must be checked
    
    Signed-off-by: Eric Paris <eparis@redhat.com>
    Acked-by: Dan Walsh <dwalsh@redhat.com>

diff --git a/libselinux/src/label.c b/libselinux/src/label.c
index a9e0853c..89e28f19 100644
--- a/libselinux/src/label.c
+++ b/libselinux/src/label.c
@@ -47,7 +47,8 @@ static char *selabel_sub(struct selabel_sub *ptr, const char *src)
 		if (strncmp(src, ptr->src, ptr->slen) == 0 ) {
 			if (src[ptr->slen] == '/' || 
 			    src[ptr->slen] == 0) {
-				asprintf(&dst, "%s%s", ptr->dst, &src[ptr->slen]);
+				if (asprintf(&dst, "%s%s", ptr->dst, &src[ptr->slen]) < 0)
+					return NULL;
 				return dst;
 			}
 		}

