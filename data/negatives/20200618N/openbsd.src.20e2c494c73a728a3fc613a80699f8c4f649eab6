commit 20e2c494c73a728a3fc613a80699f8c4f649eab6
Author: claudio <claudio@openbsd.org>
Date:   Thu Jan 6 15:35:06 2011 +0000

    Pass the magic LUN -1 to VSCSI_REQPROBE so that all LU are probed
    by the midlayer. With help from dlg@

diff --git a/usr.sbin/iscsid/connection.c b/usr.sbin/iscsid/connection.c
index 8204f7f6d1d..6b5fa772865 100644
--- a/usr.sbin/iscsid/connection.c
+++ b/usr.sbin/iscsid/connection.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: connection.c,v 1.5 2011/01/04 13:12:40 claudio Exp $ */
+/*	$OpenBSD: connection.c,v 1.6 2011/01/06 15:35:06 claudio Exp $ */
 
 /*
  * Copyright (c) 2009 Claudio Jeker <claudio@openbsd.org>
@@ -330,7 +330,7 @@ int
 c_do_loggedin(struct connection *c, enum c_event ev)
 {
 	if (ev == CONN_EV_LOGGED_IN)
-		vscsi_event(VSCSI_REQPROBE, c->session->target, 0);
+		vscsi_event(VSCSI_REQPROBE, c->session->target, -1);
 	else
 		initiator_discovery(c->session);
 	return (CONN_LOGGED_IN);

