commit 38f4332418be56f559de8cb71734490b1149ee03
Author: Eliot Horowitz <eliot@10gen.com>
Date:   Mon Jun 21 17:57:56 2010 -0400

    fix bad result handling SERVER-1275

diff --git a/client/dbclient.cpp b/client/dbclient.cpp
index 9edb43278b..ee95cd3604 100644
--- a/client/dbclient.cpp
+++ b/client/dbclient.cpp
@@ -804,6 +804,7 @@ namespace mongo {
         /* check for errors.  the only one we really care about at
          this stage is "not master" */
         if ( clientPaired && nReturned ) {
+            assert(data);
             BSONObj o(data);
             BSONElement e = o.firstElement();
             if ( strcmp(e.fieldName(), "$err") == 0 &&
diff --git a/client/dbclient.h b/client/dbclient.h
index 0bb2cf7560..d1b0619c36 100644
--- a/client/dbclient.h
+++ b/client/dbclient.h
@@ -213,7 +213,7 @@ namespace mongo {
         virtual bool call( Message &toSend, Message &response, bool assertOk=true ) = 0;
         virtual void say( Message &toSend ) = 0;
         virtual void sayPiggyBack( Message &toSend ) = 0;
-        virtual void checkResponse( const string &data, int nReturned ) {}
+        virtual void checkResponse( const char* data, int nReturned ) {}
 
         /* used by QueryOption_Exhaust.  To use that your subclass must implement this. */
         virtual void recv( Message& m ) { assert(false); }

