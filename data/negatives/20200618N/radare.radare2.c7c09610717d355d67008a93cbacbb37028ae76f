commit c7c09610717d355d67008a93cbacbb37028ae76f
Author: pancake <pancake@nopcode.org>
Date:   Mon Sep 28 02:32:38 2015 +0200

    Fix #3369 - omf parser crash

diff --git a/libr/bin/format/omf/omf.c b/libr/bin/format/omf/omf.c
index 24b6ee047..63cd5b128 100644
--- a/libr/bin/format/omf/omf.c
+++ b/libr/bin/format/omf/omf.c
@@ -85,8 +85,11 @@ static int load_omf_lnames(OMF_record *record, const char *buf, ut64 buf_size) {
 	record->content = ret;
 
 	while (tmp_size < record->size - 1) {
+		int next;
 		ret->nb_elem++;
-		tmp_size += buf[3 + tmp_size] + 1;
+		next = buf[3 + tmp_size] + 1;
+		if (next<1) break;
+		tmp_size += next;
 	}
 	if (!(ret->elems = R_NEWS0 (char *, ret->nb_elem))) {
 		R_FREE(ret);

