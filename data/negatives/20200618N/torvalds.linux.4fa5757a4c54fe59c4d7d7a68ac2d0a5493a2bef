commit 4fa5757a4c54fe59c4d7d7a68ac2d0a5493a2bef
Author: Michael Hennerich <michael.hennerich@analog.com>
Date:   Mon Oct 5 21:43:43 2009 -0700

    Input: ad7879 - pass up error codes from probe functions
    
    If the sub-probe functions fail, we need to pass up the error code to the
    higher levels from the probe function.  We currently always return 0 even
    if there was an error so higher levels don't report problems.
    
    Signed-off-by: Michael Hennerich <michael.hennerich@analog.com>
    Signed-off-by: Mike Frysinger <vapier@gentoo.org>
    Signed-off-by: Dmitry Torokhov <dtor@mail.ru>

diff --git a/drivers/input/touchscreen/ad7879.c b/drivers/input/touchscreen/ad7879.c
index 806464177e02..b965101074ec 100644
--- a/drivers/input/touchscreen/ad7879.c
+++ b/drivers/input/touchscreen/ad7879.c
@@ -645,7 +645,7 @@ static int __devinit ad7879_probe(struct spi_device *spi)
 		kfree(ts);
 	}
 
-	return 0;
+	return error;
 }
 
 static int __devexit ad7879_remove(struct spi_device *spi)
@@ -732,7 +732,7 @@ static int __devinit ad7879_probe(struct i2c_client *client,
 		kfree(ts);
 	}
 
-	return 0;
+	return error;
 }
 
 static int __devexit ad7879_remove(struct i2c_client *client)

