commit 34121cd412cbd93a4871c517d2dfe4c1651e1d51
Author: jonas oreland <jonas@mysql.com>
Date:   Fri Jun 17 11:13:52 2011 +0200

    ndb - make sure we never return estimates < 2

diff --git a/sql/ha_ndbcluster.cc b/sql/ha_ndbcluster.cc
index dc952bc3586..e6ce13145db 100644
--- a/sql/ha_ndbcluster.cc
+++ b/sql/ha_ndbcluster.cc
@@ -11303,7 +11303,15 @@ ha_ndbcluster::records_in_range(uint inx, key_range *min_key,
       ha_rows rows= HA_POS_ERROR;
       int err= ndb_index_stat_get_rir(inx, min_key, max_key, &rows);
       if (err == 0)
+      {
+        /**
+         * optmizer thinks that all values < 2 are exact...but
+         * but we don't provide exact statistics
+         */
+        if (rows < 2)
+          rows = 2;
         DBUG_RETURN(rows);
+      }
       /*fall through*/
     }
 

