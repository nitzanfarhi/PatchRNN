commit 98163086fc67b137f8dc805ad48195b0394d10b5
Author: Charles Haley <>
Date:   Tue May 18 06:23:38 2010 +0100

    First pass at winutil.c to associate usb vendor ids with drives

diff --git a/src/calibre/utils/windows/winutil.c b/src/calibre/utils/windows/winutil.c
index 2f176043b2..42b6462313 100644
--- a/src/calibre/utils/windows/winutil.c
+++ b/src/calibre/utils/windows/winutil.c
@@ -560,6 +560,7 @@ get_device_ancestors(HDEVINFO hDevInfo, DWORD index, PyObject *candidates, BOOL
         return NULL;
     }
     interfaceDetailData->cbSize = sizeof (SP_INTERFACE_DEVICE_DETAIL_DATA);
+    devInfoData.cbSize = sizeof(SP_DEVINFO_DATA);
 
     status = SetupDiGetDeviceInterfaceDetail (
                   hDevInfo,                 // Interface Device info handle

