commit ece09246c5f0286979c16005cc8aa081f73932e7
Author: Graham Leggett <minfrin@apache.org>
Date:   Sat Apr 7 14:06:13 2001 +0000

    Sockets weren't being closed if the proxy could not connect to
    a remote machine...
    PR:
    Obtained from:
    Reviewed by:
    
    
    git-svn-id: https://svn.apache.org/repos/asf/httpd/httpd/trunk@88751 13f79535-47bb-0310-9956-ffa450edef68

diff --git a/modules/proxy/proxy_http.c b/modules/proxy/proxy_http.c
index 359fe30f62..18f3ec6394 100644
--- a/modules/proxy/proxy_http.c
+++ b/modules/proxy/proxy_http.c
@@ -349,6 +349,7 @@ int ap_proxy_http_handler(request_rec *r, char *url,
 
 	/* handle a permanent error from the above loop */
 	if (failed) {
+	    apr_socket_close(sock);
 	    if (proxyname) {
 		return DECLINED;
 	    }

