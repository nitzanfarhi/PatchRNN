commit bd0975a86eb3a6e10005bec308b315df89ab4f4d
Author: √Ålvaro Felipe Melchor <alvaro.felipe91@gmail.com>
Date:   Sat May 23 13:35:31 2015 +0200

    Fix #2610

diff --git a/libr/core/cmd_anal.c b/libr/core/cmd_anal.c
index e1a5f4721..a37b3d2dd 100644
--- a/libr/core/cmd_anal.c
+++ b/libr/core/cmd_anal.c
@@ -1733,6 +1733,7 @@ static void cmd_anal_opcode(RCore *core, const char *input) {
 static void cmd_anal_calls(RCore *core, const char *input) {
 	int minop = 1; // 4
 	ut8 buf[32];
+	RBinFile *binfile;
 	RAnalOp op;
 	ut64 addr, addr_end;
 	ut64 len = r_num_math (core->num, input);
@@ -1743,6 +1744,15 @@ static void cmd_anal_calls(RCore *core, const char *input) {
 	if (len<1) {
 		len = r_num_math (core->num, "$SS-($$-$S)"); // section size
 	}
+	binfile = r_core_bin_cur (core);
+	if (!binfile){
+		eprintf ("cur binfile null\n");
+		return;
+	}
+	if (len > binfile->size){
+		eprintf ("section size greater than file size\n");
+		return;
+	}
 	addr = core->offset;
 	addr_end = addr + len;
 	while (addr < addr_end) {

