commit fd202bdf656b707375744429b96fc9901e0c1d80
Author: nicm <nicm@openbsd.org>
Date:   Wed Sep 23 14:42:48 2009 +0000

    Remove PROMPT_HIDDEN code which is now unused.

diff --git a/usr.bin/tmux/status.c b/usr.bin/tmux/status.c
index af32c3453c0..a9d5d74ddf8 100644
--- a/usr.bin/tmux/status.c
+++ b/usr.bin/tmux/status.c
@@ -1,4 +1,4 @@
-/* $OpenBSD: status.c,v 1.35 2009/09/23 06:18:48 nicm Exp $ */
+/* $OpenBSD: status.c,v 1.36 2009/09/23 14:42:48 nicm Exp $ */
 
 /*
  * Copyright (c) 2007 Nicholas Marriott <nicm@users.sourceforge.net>
@@ -673,8 +673,6 @@ status_prompt_clear(struct client *c)
 	xfree(c->prompt_string);
 	c->prompt_string = NULL;
 
-	if (c->prompt_flags & PROMPT_HIDDEN)
-		memset(c->prompt_buffer, 0, strlen(c->prompt_buffer));
 	xfree(c->prompt_buffer);
 	c->prompt_buffer = NULL;
 
@@ -739,26 +737,17 @@ status_prompt_redraw(struct client *c)
 				left--;
 			size = left;
 		}
-		if (c->prompt_flags & PROMPT_HIDDEN)
-			size = 0;
-		else {
-			screen_write_puts(&ctx, &gc,
-			    "%.*s", (int) left, c->prompt_buffer + off);
-		}
+		screen_write_puts(
+		    &ctx, &gc, "%.*s", (int) left, c->prompt_buffer + off);
 
 		for (i = len + size; i < c->tty.sx; i++)
 			screen_write_putc(&ctx, &gc, ' ');
 
 		/* Draw a fake cursor. */
 		ch = ' ';
-		if (c->prompt_flags & PROMPT_HIDDEN)
-			screen_write_cursormove(&ctx, len, 0);
-		else {
-			screen_write_cursormove(&ctx,
-			    len + c->prompt_index - off, 0);
-			if (c->prompt_index < strlen(c->prompt_buffer))
-				ch = c->prompt_buffer[c->prompt_index];
-		}
+		screen_write_cursormove(&ctx, len + c->prompt_index - off, 0);
+		if (c->prompt_index < strlen(c->prompt_buffer))
+			ch = c->prompt_buffer[c->prompt_index];
 		gc.attr ^= GRID_ATTR_REVERSE;
 		screen_write_putc(&ctx, &gc, ch);
 	}
@@ -892,8 +881,6 @@ status_prompt_key(struct client *c, int key)
 	case MODEKEYEDIT_HISTORYUP:
 		if (ARRAY_LENGTH(&c->prompt_hdata) == 0)
 			break;
-		if (c->prompt_flags & PROMPT_HIDDEN)
-			memset(c->prompt_buffer, 0, strlen(c->prompt_buffer));
 	       	xfree(c->prompt_buffer);
 
 		c->prompt_buffer = xstrdup(ARRAY_ITEM(&c->prompt_hdata,
@@ -905,8 +892,6 @@ status_prompt_key(struct client *c, int key)
 		c->flags |= CLIENT_STATUS;
 		break;
 	case MODEKEYEDIT_HISTORYDOWN:
-		if (c->prompt_flags & PROMPT_HIDDEN)
-			memset(c->prompt_buffer, 0, strlen(c->prompt_buffer));
 		xfree(c->prompt_buffer);
 
 		if (c->prompt_hindex != 0) {
diff --git a/usr.bin/tmux/tmux.h b/usr.bin/tmux/tmux.h
index 804335a83c7..7bf679bf47b 100644
--- a/usr.bin/tmux/tmux.h
+++ b/usr.bin/tmux/tmux.h
@@ -1,4 +1,4 @@
-/* $OpenBSD: tmux.h,v 1.116 2009/09/23 12:03:31 nicm Exp $ */
+/* $OpenBSD: tmux.h,v 1.117 2009/09/23 14:42:48 nicm Exp $ */
 
 /*
  * Copyright (c) 2007 Nicholas Marriott <nicm@users.sourceforge.net>
@@ -958,8 +958,7 @@ struct client {
 	void		 (*prompt_freefn)(void *);
 	void		*prompt_data;
 
-#define PROMPT_HIDDEN 0x1
-#define PROMPT_SINGLE 0x2
+#define PROMPT_SINGLE 0x1
 	int		 prompt_flags;
 
 	u_int		 prompt_hindex;

