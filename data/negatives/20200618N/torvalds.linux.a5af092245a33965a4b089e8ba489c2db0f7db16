commit a5af092245a33965a4b089e8ba489c2db0f7db16
Author: Axel Lin <axel.lin@ingics.com>
Date:   Fri Nov 16 17:09:22 2012 +0800

    generic-adc-battery: Fix checking return value of request_any_context_irq
    
    On failure, request_any_context_irq() returns a negative value. On
    success, it returns either IRQC_IS_HARDIRQ or IRQC_IS_NESTED.
    
    Signed-off-by: Axel Lin <axel.lin@ingics.com>
    Signed-off-by: Anton Vorontsov <anton.vorontsov@linaro.org>

diff --git a/drivers/power/generic-adc-battery.c b/drivers/power/generic-adc-battery.c
index 9bdf44470396..4a00ef7a8795 100644
--- a/drivers/power/generic-adc-battery.c
+++ b/drivers/power/generic-adc-battery.c
@@ -327,7 +327,7 @@ static int __devinit gab_probe(struct platform_device *pdev)
 		ret = request_any_context_irq(irq, gab_charged,
 				IRQF_TRIGGER_RISING | IRQF_TRIGGER_FALLING,
 				"battery charged", adc_bat);
-		if (ret)
+		if (ret < 0)
 			goto err_gpio;
 	}
 

