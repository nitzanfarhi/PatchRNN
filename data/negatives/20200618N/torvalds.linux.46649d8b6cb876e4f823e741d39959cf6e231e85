commit 46649d8b6cb876e4f823e741d39959cf6e231e85
Author: Ander Conselvan de Oliveira <ander.conselvan.de.oliveira@intel.com>
Date:   Mon Apr 24 13:47:18 2017 +0300

    drm/i915/glk: Don't allow 12 bpc when htotal is too big
    
    Display workaround #1139 for Geminilake instructs us to restrict HDMI
    to 8 bpc when htotal is greater than 5460. Otherwise, the pipe is unable
    to generate a proper signal and is left in a state where corruption is
    seen with other modes.
    
    Bugzilla: https://bugs.freedesktop.org/show_bug.cgi?id=100440
    Cc: Shashank Sharma <shashank.sharma@intel.com>
    Signed-off-by: Ander Conselvan de Oliveira <ander.conselvan.de.oliveira@intel.com>
    Reviewed-by: Shashank Sharma <shashank.sharma@intel.com>
    Link: http://patchwork.freedesktop.org/patch/msgid/20170424104718.26448-1-ander.conselvan.de.oliveira@intel.com

diff --git a/drivers/gpu/drm/i915/intel_hdmi.c b/drivers/gpu/drm/i915/intel_hdmi.c
index 6efc3cb8c471..52f0b2d5fad2 100644
--- a/drivers/gpu/drm/i915/intel_hdmi.c
+++ b/drivers/gpu/drm/i915/intel_hdmi.c
@@ -1327,6 +1327,11 @@ static bool hdmi_12bpc_possible(struct intel_crtc_state *crtc_state)
 			return false;
 	}
 
+	/* Display Wa #1139 */
+	if (IS_GLK_REVID(dev_priv, 0, GLK_REVID_A1) &&
+	    crtc_state->base.adjusted_mode.htotal > 5460)
+		return false;
+
 	return true;
 }
 

