commit 370822671ff62050f4e77a26870669d754edcea0
Author: Anton Kochkov <anton.kochkov@gmail.com>
Date:   Tue May 27 02:06:29 2014 +0400

    Fix CID 1215262

diff --git a/libr/core/core.c b/libr/core/core.c
index b3dfb15a3..64be5a81a 100644
--- a/libr/core/core.c
+++ b/libr/core/core.c
@@ -1106,8 +1106,10 @@ reaccept:
 							if (i>0) {
 								int r;
 								ptr = (ut8 *) malloc (i+6);
-								if (!ptr)
+								if (!ptr) {
+									fclose (fd);
 									return R_FALSE;
+								}
 								r = fread (ptr+5, i, 1, fd);
 								ptr[5+r]='\0';
 							}

