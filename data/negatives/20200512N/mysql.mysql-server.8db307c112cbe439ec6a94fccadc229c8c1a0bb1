commit 8db307c112cbe439ec6a94fccadc229c8c1a0bb1
Author: Satya Bodapati <satya.bodapati@oracle.com>
Date:   Tue Apr 11 22:00:40 2017 +0530

    Bug#25775881 - INNODB ASSERTION DURING INITIALIZE IF FAILED TO CREATE TABLESPACES.OPEN.1
    
    Problem:
    --------
    The problem happens only when mysqld process is run as root user and
    creates datadir as mysql user. When InnoDB creates tablespaces.open.(1|2)
    files using absolute path to fopen(), file creation fails with permission
    denied error. Since this file cannot be opened for writing, a fatal error
    is thrown.
    
    Fix:
    ----
    When creating the tablespaces.open.(1|2) files, an absoulte path is formed.
    This is not necessary. Just create the path based on srv_log_group_home_dir
    and the tablespace.open.(1|2) file.
    
    Reviewed-By: Jimmy Yang <jimmy.yang@oracle.com>
    RB: 16012

diff --git a/storage/innobase/fil/fil0fil.cc b/storage/innobase/fil/fil0fil.cc
index 068b55b6fb4..ff7a6ddf0e7 100644
--- a/storage/innobase/fil/fil0fil.cc
+++ b/storage/innobase/fil/fil0fil.cc
@@ -7961,9 +7961,16 @@ Fil_Open::to_file()
 		break;
 	}
 
-	std::string abs_path = get_path(srv_log_group_home_dir, filename);
+	std::string	path_filename(srv_log_group_home_dir);
+	/* Append PATH separator */
+	if ((path_filename.length() != 0)
+	    && (*path_filename.rbegin() != OS_PATH_SEPARATOR)) {
+		path_filename += OS_PATH_SEPARATOR;
+	}
+
+	path_filename.append(filename);
 
-	write(abs_path.c_str(), VERSION_1, data.length(), zlen, dst);
+	write(path_filename.c_str(), VERSION_1, data.length(), zlen, dst);
 
 	ut_free(dst);
 

