commit fd92d4e2ddb1928c2d6f07df6658702555201145
Author: Frederick Cheung <frederick.cheung@gmail.com>
Date:   Thu Jul 27 12:46:46 2017 +0100

    optimize symbols as keys

diff --git a/ext/bson/bson_native.c b/ext/bson/bson_native.c
index c30b87d..88d9c6f 100644
--- a/ext/bson/bson_native.c
+++ b/ext/bson/bson_native.c
@@ -285,6 +285,9 @@ static int put_hash_callback(VALUE key, VALUE val, VALUE context){
     case T_STRING:
       bson_byte_buffer_put_bson_key(b, key, validating_keys);
       break;
+    case T_SYMBOL:
+      bson_byte_buffer_put_bson_key(b, rb_sym_to_s(key), validating_keys);
+      break;
     default:
       rb_bson_byte_buffer_put_cstring(buffer, rb_funcall(key, rb_intern("to_bson_key"),1,validating_keys));
   }

