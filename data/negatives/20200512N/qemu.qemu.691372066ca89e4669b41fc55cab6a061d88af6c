commit 691372066ca89e4669b41fc55cab6a061d88af6c
Author: Ulrich Hecht <uli@suse.de>
Date:   Thu Sep 17 21:08:37 2009 +0300

    linux-user: getpriority errno fix
    
    getpriority returned wrong errno; fixes LTP test getpriority02.
    
    Signed-off-by: Ulrich Hecht <uli@suse.de>
    Signed-off-by: Riku Voipio <riku.voipio@iki.fi>

diff --git a/linux-user/syscall.c b/linux-user/syscall.c
index d07c381f02..baf00e0bf9 100644
--- a/linux-user/syscall.c
+++ b/linux-user/syscall.c
@@ -5311,7 +5311,7 @@ abi_long do_syscall(void *cpu_env, int num, abi_long arg1,
         /* libc does special remapping of the return value of
          * sys_getpriority() so it's just easiest to call
          * sys_getpriority() directly rather than through libc. */
-        ret = sys_getpriority(arg1, arg2);
+        ret = get_errno(sys_getpriority(arg1, arg2));
         break;
     case TARGET_NR_setpriority:
         ret = get_errno(setpriority(arg1, arg2, arg3));

