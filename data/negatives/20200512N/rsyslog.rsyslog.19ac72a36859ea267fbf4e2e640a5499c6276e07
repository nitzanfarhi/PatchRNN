commit 19ac72a36859ea267fbf4e2e640a5499c6276e07
Author: Rainer Gerhards <rgerhards@adiscon.com>
Date:   Tue Sep 16 13:12:50 2008 +0200

    fixing previous patch, time() call was accidently left in
    
    in one case, which was not on the focus of the initial testing
    cases.

diff --git a/tools/syslogd.c b/tools/syslogd.c
index f9c3965d8..f51947bf6 100644
--- a/tools/syslogd.c
+++ b/tools/syslogd.c
@@ -1331,11 +1331,11 @@ static int parseRFCSyslogMsg(msg_t *pMsg, int flags)
 	 */
 
 	/* TIMESTAMP */
-	datetime.getCurrTime(&(pMsg->tTIMESTAMP)); /* initialize timestamp */
+	memcpy(&pMsg->tTIMESTAMP, &pMsg->tRcvdAt, sizeof(struct syslogTime));
 	if(datetime.ParseTIMESTAMP3339(&(pMsg->tTIMESTAMP),  &p2parse) == RS_RET_OK) {
 		if(flags & IGNDATE) {
 			/* we need to ignore the msg data, so simply copy over reception date */
-			datetime.getCurrTime(&(pMsg->tTIMESTAMP)); /* use the current time! */
+			memcpy(&pMsg->tTIMESTAMP, &pMsg->tRcvdAt, sizeof(struct syslogTime));
 		}
 	} else {
 		dbgprintf("no TIMESTAMP detected!\n");

