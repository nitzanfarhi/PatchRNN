commit 97bf2e99934bdfd3f91914e6c935271b62567470
Author: Johan Hedberg <johan.hedberg@intel.com>
Date:   Fri Jul 4 12:37:16 2014 +0300

    Bluetooth: Fix missing return statement in process_adv_report
    
    If we're doing passive scanning we shouldn't proceed with any of the
    code that deals with active scanning (pending reports, etc.). This patch
    fixes a missing return statement for the passive scanning section in the
    process_adv_report() function.
    
    Signed-off-by: Johan Hedberg <johan.hedberg@intel.com>
    Signed-off-by: Marcel Holtmann <marcel@holtmann.org>

diff --git a/net/bluetooth/hci_event.c b/net/bluetooth/hci_event.c
index 20317e516e74..e0407e674061 100644
--- a/net/bluetooth/hci_event.c
+++ b/net/bluetooth/hci_event.c
@@ -4256,6 +4256,7 @@ static void process_adv_report(struct hci_dev *hdev, u8 type, bdaddr_t *bdaddr,
 			flags = 0;
 		mgmt_device_found(hdev, bdaddr, LE_LINK, bdaddr_type, NULL,
 				  rssi, flags, data, len, NULL, 0);
+		return;
 	}
 
 	/* When receiving non-connectable or scannable undirected

