commit aaef2a638220b875ae7ad96efcecaaa660ff9fee
Author: Zoltan Varga <vargaz@gmail.com>
Date:   Sun Jun 12 18:46:16 2011 +0200

    Add an assert to detect TLS mismatches between the aot compilation and runtime environment.

diff --git a/mono/mini/aot-runtime.c b/mono/mini/aot-runtime.c
index fc58efdfa63..cbc95608ec1 100644
--- a/mono/mini/aot-runtime.c
+++ b/mono/mini/aot-runtime.c
@@ -564,6 +564,7 @@ decode_method_ref_with_target (MonoAotModule *module, MethodRef *ref, MonoMethod
 			int atype = decode_value (p, &p);
 
 			ref->method = mono_gc_get_managed_allocator_by_type (atype);
+			g_assert (ref->method);
 			break;
 		}
 		case MONO_WRAPPER_WRITE_BARRIER:

