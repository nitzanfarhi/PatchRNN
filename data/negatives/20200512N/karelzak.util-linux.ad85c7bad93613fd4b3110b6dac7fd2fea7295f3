commit ad85c7bad93613fd4b3110b6dac7fd2fea7295f3
Author: Karel Zak <kzak@redhat.com>
Date:   Wed Mar 27 14:50:52 2013 +0100

    sulogin: don't run if not found passww entry [coverity scan]
    
    sulogin(8) should not run if there is no /etc/{passwd,shadow} entry
    and --force command line option is no specified otherwise NULL pointer
    dereference is possible.
    
    Signed-off-by: Karel Zak <kzak@redhat.com>

diff --git a/login-utils/sulogin.c b/login-utils/sulogin.c
index 621df1e4f..71308583c 100644
--- a/login-utils/sulogin.c
+++ b/login-utils/sulogin.c
@@ -877,6 +877,7 @@ int main(int argc, char **argv)
 	if ((pwd = getrootpwent(opt_e)) == NULL) {
 		warnx(_("cannot open password database."));
 		sleep(2);
+		return EXIT_FAILURE;
 	}
 
 	/*

