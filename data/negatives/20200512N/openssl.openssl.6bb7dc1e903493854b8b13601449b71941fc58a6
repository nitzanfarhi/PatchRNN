commit 6bb7dc1e903493854b8b13601449b71941fc58a6
Author: Dr. Stephen Henson <steve@openssl.org>
Date:   Wed Jul 15 11:02:24 2009 +0000

    Updates from 1.0.0-stable

diff --git a/crypto/dso/dso_win32.c b/crypto/dso/dso_win32.c
index c5b00c0d13..6fb6c54181 100644
--- a/crypto/dso/dso_win32.c
+++ b/crypto/dso/dso_win32.c
@@ -355,6 +355,7 @@ static struct file_st *win32_splitter(DSO *dso, const char *filename,
 				DSOerr(DSO_F_WIN32_SPLITTER,
 					DSO_R_INCORRECT_FILE_SYNTAX);
 				/*goto err;*/
+				OPENSSL_free(result);
 				return(NULL);
 				}
 			result->device = start;
@@ -621,6 +622,8 @@ static char *win32_merger(DSO *dso, const char *filespec1, const char *filespec2
 
 		merged = win32_joiner(dso, filespec1_split);
 		}
+	OPENSSL_free(filespec1_split);
+	OPENSSL_free(filespec2_split);
 	return(merged);
 	}
 

