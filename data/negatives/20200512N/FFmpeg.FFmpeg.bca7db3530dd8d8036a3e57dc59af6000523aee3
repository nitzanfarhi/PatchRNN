commit bca7db3530dd8d8036a3e57dc59af6000523aee3
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Sat Aug 4 00:22:28 2007 +0000

    detect MS wav codecs
    fixes detection of audio codec though not playback of surge-2-16-L-ms11.mov
    
    Originally committed as revision 9885 to svn://svn.ffmpeg.org/ffmpeg/trunk

diff --git a/libavformat/mov.c b/libavformat/mov.c
index 1956a80dd6..f0b7d320bb 100644
--- a/libavformat/mov.c
+++ b/libavformat/mov.c
@@ -603,6 +603,9 @@ static int mov_read_stsd(MOVContext *c, ByteIOContext *pb, MOV_atom_t atom)
 
         st->codec->codec_tag = format;
         id = codec_get_id(codec_movaudio_tags, format);
+        if (id<=0 && (format&0xFFFF) == 'm' + ('s'<<8))
+            id = codec_get_id(codec_wav_tags, bswap_32(format)&0xFFFF);
+
         if (st->codec->codec_type != CODEC_TYPE_VIDEO && id > 0) {
             st->codec->codec_type = CODEC_TYPE_AUDIO;
         } else if (st->codec->codec_type != CODEC_TYPE_AUDIO && /* do not overwrite codec type */

