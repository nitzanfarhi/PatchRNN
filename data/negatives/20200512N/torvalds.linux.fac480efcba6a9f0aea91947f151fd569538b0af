commit fac480efcba6a9f0aea91947f151fd569538b0af
Author: Paul E. McKenney <paulmck@linux.vnet.ibm.com>
Date:   Thu Jan 30 17:06:30 2014 -0800

    rcutorture: Add diagnostic for unscheduled system shutdown
    
    Currently, rcutorture can terminate via rmmod, via self-shutdown,
    via something else shutting the system down, or of course the usual
    catastrophic termination.  The first two get flagged, so this commit adds
    a message for the third.  For the fourth, your warranty is void as always.
    
    Signed-off-by: Paul E. McKenney <paulmck@linux.vnet.ibm.com>
    Reviewed-by: Josh Triplett <josh@joshtriplett.org>

diff --git a/kernel/torture.c b/kernel/torture.c
index ed360cf948da..d51de3029a5c 100644
--- a/kernel/torture.c
+++ b/kernel/torture.c
@@ -438,10 +438,12 @@ static int torture_shutdown_notify(struct notifier_block *unused1,
 				   unsigned long unused2, void *unused3)
 {
 	mutex_lock(&fullstop_mutex);
-	if (fullstop == FULLSTOP_DONTSTOP)
+	if (fullstop == FULLSTOP_DONTSTOP) {
+		VERBOSE_TOROUT_STRING("Unscheduled system shutdown detected");
 		fullstop = FULLSTOP_SHUTDOWN;
-	else
+	} else {
 		pr_warn("Concurrent rmmod and shutdown illegal!\n");
+	}
 	mutex_unlock(&fullstop_mutex);
 	return NOTIFY_DONE;
 }

