commit a61ef10262a327ce0c622f6c9b6e99e902e885a6
Author: unknown <joreland@mysql.com>
Date:   Sat Jan 1 17:57:50 2005 +0100

    ndb - post merge fixes
    
    
    ndb/src/kernel/blocks/dbtup/DbtupRoutines.cpp:
      merge

diff --git a/ndb/src/kernel/blocks/dbtup/DbtupRoutines.cpp b/ndb/src/kernel/blocks/dbtup/DbtupRoutines.cpp
index 3c25e675a5e..015d555e67d 100644
--- a/ndb/src/kernel/blocks/dbtup/DbtupRoutines.cpp
+++ b/ndb/src/kernel/blocks/dbtup/DbtupRoutines.cpp
@@ -807,13 +807,17 @@ Dbtup::updateFixedSizeTHManyWordNotNULL(Uint32* inBuffer,
       if (charsetFlag) {
         ljam();
         Tablerec* regTabPtr = tabptr.p;
+	Uint32 typeId = AttributeDescriptor::getType(attrDescriptor);
         Uint32 bytes = AttributeDescriptor::getSizeInBytes(attrDescriptor);
         Uint32 i = AttributeOffset::getCharsetPos(attrDes2);
         ndbrequire(i < regTabPtr->noOfCharsets);
         // not const in MySQL
         CHARSET_INFO* cs = regTabPtr->charsetArray[i];
         const char* ssrc = (const char*)&inBuffer[tInBufIndex + 1];
-        if ((*cs->cset->well_formed_len)(cs, ssrc, ssrc + bytes, ZNIL) != bytes) {
+	// fast fix bug#7340
+        if (typeId != NDB_TYPE_TEXT &&
+	    (*cs->cset->well_formed_len)(cs, ssrc, ssrc+bytes, ZNIL) != bytes)
+	{
           ljam();
           terrorCode = ZINVALID_CHAR_FORMAT;
           return false;

