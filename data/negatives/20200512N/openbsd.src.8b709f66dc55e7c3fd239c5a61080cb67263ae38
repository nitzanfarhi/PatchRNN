commit 8b709f66dc55e7c3fd239c5a61080cb67263ae38
Author: millert <millert@openbsd.org>
Date:   Tue Mar 20 21:01:08 2007 +0000

    Set umask to 077 when saving messages in the outbox (not enabled
    by default).  From veenhuizen at users dot sourceforge dot net

diff --git a/usr.bin/mail/send.c b/usr.bin/mail/send.c
index 6bb9180015a..eaaa66ee82a 100644
--- a/usr.bin/mail/send.c
+++ b/usr.bin/mail/send.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: send.c,v 1.17 2003/06/03 02:56:11 millert Exp $	*/
+/*	$OpenBSD: send.c,v 1.18 2007/03/20 21:01:08 millert Exp $	*/
 /*	$NetBSD: send.c,v 1.6 1996/06/08 19:48:39 christos Exp $	*/
 
 /*
@@ -34,7 +34,7 @@
 #if 0
 static const char sccsid[] = "@(#)send.c	8.1 (Berkeley) 6/6/93";
 #else
-static const char rcsid[] = "$OpenBSD: send.c,v 1.17 2003/06/03 02:56:11 millert Exp $";
+static const char rcsid[] = "$OpenBSD: send.c,v 1.18 2007/03/20 21:01:08 millert Exp $";
 #endif
 #endif /* not lint */
 
@@ -558,8 +558,12 @@ savemail(char *name, FILE *fi)
 	FILE *fo;
 	char buf[BUFSIZ];
 	time_t now;
+	mode_t m;
 
-	if ((fo = Fopen(name, "a")) == NULL) {
+	m = umask(077);
+	fo = Fopen(name, "a");
+	(void)umask(m);
+	if (fo == NULL) {
 		warn("%s", name);
 		return(-1);
 	}

