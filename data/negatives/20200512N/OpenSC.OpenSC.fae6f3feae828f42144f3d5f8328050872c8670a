commit fae6f3feae828f42144f3d5f8328050872c8670a
Author: nils <nils@c6295689-39f2-0310-b995-f0e70906c6a9>
Date:   Fri Jun 23 16:09:18 2006 +0000

    fix apdu types and response buffer length
    
    git-svn-id: https://www.opensc-project.org/svnp/opensc/trunk@2977 c6295689-39f2-0310-b995-f0e70906c6a9

diff --git a/src/libopensc/card-oberthur.c b/src/libopensc/card-oberthur.c
index a6227b80..f47f3c97 100644
--- a/src/libopensc/card-oberthur.c
+++ b/src/libopensc/card-oberthur.c
@@ -153,12 +153,12 @@ auth_select_aid(sc_card_t *card)
 	unsigned char cm[7] = {0xA0,0x00,0x00,0x00,0x03,0x00,0x00};
 
 	/* Select Card Manager (to deselect previously selected application) */
-	sc_format_apdu(card, &apdu, SC_APDU_CASE_3_SHORT, 0xA4, 0x04, 0x00);
+	sc_format_apdu(card, &apdu, SC_APDU_CASE_4_SHORT, 0xA4, 0x04, 0x00);
 	apdu.lc = sizeof(cm);
 	apdu.le = sizeof(cm)+4;
 	apdu.data = cm;
 	apdu.datalen = sizeof(cm);
-	apdu.resplen = sizeof(apdu.resp);
+	apdu.resplen = sizeof(apdu_resp);
 	apdu.resp = apdu_resp;
 
 	rv = sc_transmit_apdu(card, &apdu);
@@ -180,7 +180,7 @@ auth_select_aid(sc_card_t *card)
 			*(apdu.resp+17)*0x100 + *(apdu.resp+18));
 	}
 
-	sc_format_apdu(card, &apdu, SC_APDU_CASE_3_SHORT, 0xA4, 0x04, 0x00);
+	sc_format_apdu(card, &apdu, SC_APDU_CASE_4_SHORT, 0xA4, 0x04, 0x00);
 	apdu.resp = apdu_resp;
 
 	/* Try to select known AID */

