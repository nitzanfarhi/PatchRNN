commit 548ec1a8061dee6d094592b4c8787863d9551183
Author: Love Hörnquist Åstrand <lha@kth.se>
Date:   Sat Dec 2 08:49:16 2006 +0000

    Check if header is there
    
    
    git-svn-id: svn://svn.h5l.se/heimdal/trunk/heimdal@19200 ec53bebd-3082-4978-b11e-865c3cabbd6b

diff --git a/lib/des/rsa-imath.c b/lib/des/rsa-imath.c
index 4e445db78..bdd087f84 100644
--- a/lib/des/rsa-imath.c
+++ b/lib/des/rsa-imath.c
@@ -187,6 +187,8 @@ imath_rsa_public_decrypt(int flen, const unsigned char* from,
     mp_int_clear(&us);
 
     /* head zero was skipped by mp_int_to_unsigned */
+    if (*p == 0)
+	return -7;
     if (*p != 1)
 	return -6;
     size--; p++;

