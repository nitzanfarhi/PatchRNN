commit 0c6303cc06954c336a8221522e9ddf056125afab
Author: Aniket Nagarnaik <aniketn@marvell.com>
Date:   Thu Jul 16 08:05:22 2015 -0700

    mwifiex: use maximum ssid length as 0xfe for p2p
    
    0xfe is basically a magic number used to ask firmware match
    provided string in a SSID. In this case, firmware will
    return scan results containing"DIRECT-" string.
    
    Signed-off-by: Aniket Nagarnaik <aniketn@marvell.com>
    Signed-off-by: Amitkumar Karwar <akarwar@marvell.com>
    Signed-off-by: Kalle Valo <kvalo@codeaurora.org>

diff --git a/drivers/net/wireless/mwifiex/scan.c b/drivers/net/wireless/mwifiex/scan.c
index ef2bef8399c2..ef8da8ebcbab 100644
--- a/drivers/net/wireless/mwifiex/scan.c
+++ b/drivers/net/wireless/mwifiex/scan.c
@@ -909,6 +909,10 @@ mwifiex_config_scan(struct mwifiex_private *priv,
 				wildcard_ssid_tlv->max_ssid_length =
 							IEEE80211_MAX_SSID_LEN;
 
+			if (!memcmp(user_scan_in->ssid_list[i].ssid,
+				    "DIRECT-", 7))
+				wildcard_ssid_tlv->max_ssid_length = 0xfe;
+
 			memcpy(wildcard_ssid_tlv->ssid,
 			       user_scan_in->ssid_list[i].ssid, ssid_len);
 

