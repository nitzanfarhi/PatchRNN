commit 34256c0245613363d07db47d3916fc50547fe401
Author: Timo Sirainen <tss@iki.fi>
Date:   Sat Aug 15 12:05:34 2015 +0200

    dsync: If mailbox is already deleted locally, don't attempt to delete it again.
    This only caused an unnecessary desync warning / exit code.

diff --git a/src/doveadm/dsync/dsync-mailbox-tree-sync.c b/src/doveadm/dsync/dsync-mailbox-tree-sync.c
index f0a149e8d..c6a6bf5e8 100644
--- a/src/doveadm/dsync/dsync-mailbox-tree-sync.c
+++ b/src/doveadm/dsync/dsync-mailbox-tree-sync.c
@@ -164,7 +164,8 @@ sync_delete_mailbox_node(struct dsync_mailbox_tree_sync_ctx *ctx,
 			guid_128_to_string(node->mailbox_guid), reason);
 	}
 
-	if (tree == ctx->local_tree) {
+	if (tree == ctx->local_tree &&
+	    node->existence != DSYNC_MAILBOX_NODE_DELETED) {
 		/* delete this mailbox locally */
 		i_assert(ctx->sync_type != DSYNC_MAILBOX_TREES_SYNC_TYPE_PRESERVE_LOCAL);
 		change = array_append_space(&ctx->changes);

