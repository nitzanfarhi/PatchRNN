commit 2936bec1ffb80f94c8da7874fb58e0358917c703
Author: Nguyen Anh Quynh <aquynh@gmail.com>
Date:   Mon Jan 11 14:07:30 2016 +0800

    x86: fix issue #544 for AT&T syntax

diff --git a/arch/X86/X86ATTInstPrinter.c b/arch/X86/X86ATTInstPrinter.c
index ec8f2e42..ee65afc7 100644
--- a/arch/X86/X86ATTInstPrinter.c
+++ b/arch/X86/X86ATTInstPrinter.c
@@ -165,7 +165,16 @@ static void printi512mem(MCInst *MI, unsigned OpNo, SStream *O)
 
 static void printf32mem(MCInst *MI, unsigned OpNo, SStream *O)
 {
-	MI->x86opsize = 4;
+	switch(MCInst_getOpcode(MI)) {
+		default:
+			MI->x86opsize = 4;
+			break;
+		case X86_FBSTPm:
+		case X86_FBLDm:
+			// TODO: fix this in tablegen instead
+			MI->x86opsize = 10;
+			break;
+	}
 	printMemReference(MI, OpNo, O);
 }
 
diff --git a/arch/X86/X86IntelInstPrinter.c b/arch/X86/X86IntelInstPrinter.c
index fe458858..9dcceb08 100644
--- a/arch/X86/X86IntelInstPrinter.c
+++ b/arch/X86/X86IntelInstPrinter.c
@@ -183,18 +183,18 @@ static void printi512mem(MCInst *MI, unsigned OpNo, SStream *O)
 
 static void printf32mem(MCInst *MI, unsigned OpNo, SStream *O)
 {
-    switch(MCInst_getOpcode(MI)) {
-        default:
-            SStream_concat0(O, "dword ptr ");
-            MI->x86opsize = 4;
-            break;
-        case X86_FBSTPm:
-        case X86_FBLDm:
-            // TODO: fix this in tablegen instead
-            SStream_concat0(O, "tbyte ptr ");
-            MI->x86opsize = 10;
-            break;
-    }
+	switch(MCInst_getOpcode(MI)) {
+		default:
+			SStream_concat0(O, "dword ptr ");
+			MI->x86opsize = 4;
+			break;
+		case X86_FBSTPm:
+		case X86_FBLDm:
+			// TODO: fix this in tablegen instead
+			SStream_concat0(O, "tbyte ptr ");
+			MI->x86opsize = 10;
+			break;
+	}
 
 	printMemReference(MI, OpNo, O);
 }

