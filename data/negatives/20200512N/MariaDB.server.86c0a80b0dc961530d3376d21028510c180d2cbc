commit 86c0a80b0dc961530d3376d21028510c180d2cbc
Author: Tor Didriksen <tor.didriksen@oracle.com>
Date:   Thu Nov 1 17:23:06 2012 +0100

    Bug#14840488 VALGRIND ERRORS IN MYSQL_CLIENT_TEST
    
    Add missing DBUG_RETURNs, otherwise the debug-stack gets messed up,
    and _db_enter_ and _db_exit_ will access data outside the current stack frame.

diff --git a/libmysql/libmysql.c b/libmysql/libmysql.c
index 5d153317150..f7eb19520b7 100644
--- a/libmysql/libmysql.c
+++ b/libmysql/libmysql.c
@@ -4653,7 +4653,7 @@ int STDCALL mysql_stmt_fetch_column(MYSQL_STMT *stmt, MYSQL_BIND *my_bind,
   if ((int) stmt->state < (int) MYSQL_STMT_FETCH_DONE)
   {
     set_stmt_error(stmt, CR_NO_DATA, unknown_sqlstate, NULL);
-    return 1;
+    DBUG_RETURN(1);
   }
   if (column >= stmt->field_count)
   {
diff --git a/tests/mysql_client_test.c b/tests/mysql_client_test.c
index c38695db1b1..e6544e99c7e 100644
--- a/tests/mysql_client_test.c
+++ b/tests/mysql_client_test.c
@@ -15278,6 +15278,7 @@ static void test_bug27876()
 
   rc= mysql_query(mysql, "set names default");
   myquery(rc);
+  DBUG_VOID_RETURN;
 }
 
 

