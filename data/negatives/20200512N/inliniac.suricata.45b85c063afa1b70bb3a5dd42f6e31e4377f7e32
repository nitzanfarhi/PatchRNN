commit 45b85c063afa1b70bb3a5dd42f6e31e4377f7e32
Author: Victor Julien <victor@inliniac.net>
Date:   Thu Feb 18 16:51:29 2010 +0100

    Fix segv in http log module.

diff --git a/src/log-httplog.c b/src/log-httplog.c
index 186d53cb..2923144f 100644
--- a/src/log-httplog.c
+++ b/src/log-httplog.c
@@ -99,7 +99,10 @@ TmEcode LogHttpLogIPv4(ThreadVars *tv, Packet *p, void *data, PacketQueue *pq)
         goto end;
     }
 
-    if ( !(htp_state->flags & HTP_FLAG_NEW_REQUEST)) {
+    if (htp_state->connp == NULL)
+        goto end;
+
+    if (!(htp_state->flags & HTP_FLAG_NEW_REQUEST)) {
         SCLogDebug("no new http request , so no request logging");
         goto end;
     }
@@ -196,7 +199,10 @@ TmEcode LogHttpLogIPv6(ThreadVars *tv, Packet *p, void *data, PacketQueue *pq)
         goto end;
     }
 
-    if ( !(htp_state->flags & HTP_FLAG_NEW_REQUEST)) {
+    if (htp_state->connp == NULL)
+        goto end;
+
+    if (!(htp_state->flags & HTP_FLAG_NEW_REQUEST)) {
         SCLogDebug("no new http request , so no request logging");
         goto end;
     }

