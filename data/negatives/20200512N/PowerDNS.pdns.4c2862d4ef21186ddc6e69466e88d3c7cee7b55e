commit 4c2862d4ef21186ddc6e69466e88d3c7cee7b55e
Author: Remi Gacogne <remi.gacogne@powerdns.com>
Date:   Thu Mar 24 16:14:00 2016 +0100

    Check the packet size in dnspcap2protobuf

diff --git a/pdns/dnspcap2protobuf.cc b/pdns/dnspcap2protobuf.cc
index 448dcfb78..2b7698a8a 100644
--- a/pdns/dnspcap2protobuf.cc
+++ b/pdns/dnspcap2protobuf.cc
@@ -89,6 +89,9 @@ int main(int argc, char **argv)
     if (!dh->qdcount)
       continue;
 
+    if (pr.d_len < sizeof(dnsheader))
+      continue;
+
     uint16_t qtype, qclass;
     DNSName qname;
     try {

