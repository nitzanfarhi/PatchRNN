commit 252ed3a24c512d1131c641dd0b2c5a15dd49e5d7
Author: bar@mysql.com <>
Date:   Fri Sep 2 10:35:51 2005 +0500

    sp_head.cc:
      Fix crash reported in bug 12849.
      It doesn't fix the whole problem though.
      Let Pem fix it later.

diff --git a/sql/sp_head.cc b/sql/sp_head.cc
index 4358a37daa6..e04523902db 100644
--- a/sql/sp_head.cc
+++ b/sql/sp_head.cc
@@ -244,8 +244,8 @@ sp_eval_func_item(THD *thd, Item **it_addr, enum enum_field_types type,
     }
     DBUG_PRINT("info",("STRING_RESULT: %*s",
                        s->length(), s->c_ptr_quick()));
-    CREATE_ON_CALLERS_ARENA(it= new(reuse, &rsize)
-                            Item_string(it->collation.collation),
+    CHARSET_INFO *itcs= it->collation.collation;
+    CREATE_ON_CALLERS_ARENA(it= new(reuse, &rsize) Item_string(itcs),
                             use_callers_arena, &backup_current_arena);
     /*
       We have to use special constructor and allocate string

