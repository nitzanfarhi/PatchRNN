commit 68d25b439263ded6894627bd2e269ad2c9455ad0
Author: Pieter Lexis <pieter.lexis@powerdns.com>
Date:   Fri Jul 10 14:21:55 2015 +0200

    DNSName: fix getTSIGHashEnum() in misc.cc

diff --git a/pdns/misc.cc b/pdns/misc.cc
index 199639341..1379315dc 100644
--- a/pdns/misc.cc
+++ b/pdns/misc.cc
@@ -1011,19 +1011,20 @@ uint64_t udpErrorStats(const std::string& str)
 
 bool getTSIGHashEnum(const DNSName& algoName, TSIGHashEnum& algoEnum)
 {
-  if (algoName == "hmac-md5.sig-alg.reg.int." || algoName == "hmac-md5.") // FIXME400
+  string strAlgoName = algoName.toString();
+  if (strAlgoName == "hmac-md5.sig-alg.reg.int." || strAlgoName == "hmac-md5.") // FIXME400
     algoEnum = TSIG_MD5;
-  else if (algoName == "hmac-sha1.")
+  else if (strAlgoName == "hmac-sha1.")
     algoEnum = TSIG_SHA1;
-  else if (algoName == "hmac-sha224.")
+  else if (strAlgoName == "hmac-sha224.")
     algoEnum = TSIG_SHA224;
-  else if (algoName == "hmac-sha256.")
+  else if (strAlgoName == "hmac-sha256.")
     algoEnum = TSIG_SHA256;
-  else if (algoName == "hmac-sha384.")
+  else if (strAlgoName == "hmac-sha384.")
     algoEnum = TSIG_SHA384;
-  else if (algoName == "hmac-sha512.")
+  else if (strAlgoName == "hmac-sha512.")
     algoEnum = TSIG_SHA512;
-  else if (algoName == "gss-tsig.")
+  else if (strAlgoName == "gss-tsig.")
     algoEnum = TSIG_GSS;
   else {
      return false;

