commit 884795e60f31f0442f6afb2a4cae5a30bc128e27
Author: Peter Wu <peter@lekensteyn.nl>
Date:   Tue Jan 26 18:38:41 2016 +0100

    wslua: do not free TVB for data sources
    
    Bug: 12050
    Change-Id: If094f78f683776ba2ea3ddd848ec9018cba064b8
    Reviewed-on: https://code.wireshark.org/review/13554
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>
    Petri-Dish: Peter Wu <peter@lekensteyn.nl>
    Tested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>
    Reviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>

diff --git a/epan/wslua/wslua_byte_array.c b/epan/wslua/wslua_byte_array.c
index 53843f9407..5390fc366e 100644
--- a/epan/wslua/wslua_byte_array.c
+++ b/epan/wslua/wslua_byte_array.c
@@ -355,9 +355,9 @@ WSLUA_CONSTRUCTOR ByteArray_tvb (lua_State *L) {
     data = (guint8 *)g_memdup(ba->data, ba->len);
 
     tvb = (Tvb)g_malloc(sizeof(struct _wslua_tvb));
-    tvb->ws_tvb = tvb_new_real_data(data, ba->len,ba->len);
+    tvb->ws_tvb = tvb_new_child_real_data(lua_tvb, data, ba->len,ba->len);
     tvb->expired = FALSE;
-    tvb->need_free = TRUE;
+    tvb->need_free = FALSE;
     tvb_set_free_cb(tvb->ws_tvb, g_free);
 
     add_new_data_source(lua_pinfo, tvb->ws_tvb, name);

