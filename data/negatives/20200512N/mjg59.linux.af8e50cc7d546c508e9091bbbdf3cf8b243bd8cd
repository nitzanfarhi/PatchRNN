commit af8e50cc7d546c508e9091bbbdf3cf8b243bd8cd
Author: Eric Paris <eparis@redhat.com>
Date:   Fri Aug 24 15:59:00 2012 -0400

    SELinux: use define for number of bits in the mnt flags mask
    
    We had this random hard coded value of '8' in the code (I put it there)
    for the number of bits to check for mount options.  This is stupid.  Instead
    use the #define we already have which tells us the number of mount
    options.
    
    Signed-off-by: Eric Paris <eparis@redhat.com>

diff --git a/security/selinux/hooks.c b/security/selinux/hooks.c
index 863f20590186..e13d65a62104 100644
--- a/security/selinux/hooks.c
+++ b/security/selinux/hooks.c
@@ -466,9 +466,12 @@ static int selinux_get_mnt_opts(const struct super_block *sb,
 	if (!ss_initialized)
 		return -EINVAL;
 
+	/* make sure we always check enough bits to cover the mask */
+	BUILD_BUG_ON(SE_MNTMASK >= (1 << NUM_SEL_MNT_OPTS));
+
 	tmp = sbsec->flags & SE_MNTMASK;
 	/* count the number of mount options for this sb */
-	for (i = 0; i < 8; i++) {
+	for (i = 0; i < NUM_SEL_MNT_OPTS; i++) {
 		if (tmp & 0x01)
 			opts->num_mnt_opts++;
 		tmp >>= 1;

