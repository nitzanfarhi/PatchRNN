commit dda6ba4101f5b8a1121f261aea969709ce45fc76
Author: Florian MÃ¤rkl <info@florianmaerkl.de>
Date:   Sat Dec 16 17:53:04 2017 +0100

    Add /O command

diff --git a/libr/core/cmd_search.c b/libr/core/cmd_search.c
index d86ce14cc..70108aa58 100644
--- a/libr/core/cmd_search.c
+++ b/libr/core/cmd_search.c
@@ -34,6 +34,7 @@ static const char *help_msg_slash[] = {
 	"/m", " magicfile", "search for matching magic file (use blocksize)",
 	"/M", " ", "search for known filesystems and mount them automatically",
 	"/o", " [n]", "show offset of n instructions backward",
+	"/O", " [n]", "same as /o, but with a different fallback if anal cannot be used",
 	"/p", " patternsize", "search for pattern of given size",
 	"/P", " patternsize", "search similar blocks",
 	"/r[erwx]", "[?] sym.printf", "analyze opcode reference an offset (/re for esil)",
@@ -2537,6 +2538,19 @@ reread:
 		}
 		break;
 	}
+	case 'O': { // "/O" alternative to "/o"
+		ut64 addr, n = input[param_offset - 1] ? r_num_math (core->num, input + param_offset) : 1;
+		if (!n) {
+			n = 1;
+		}
+		addr = r_core_prevop_addr_force (core, core->offset, n);
+		if (json) {
+			r_cons_printf ("[%"PFMT64u "]", addr);
+		} else {
+			r_cons_printf ("0x%08"PFMT64x "\n", addr);
+		}
+		break;
+	}
 	case 'R':
 		if (input[1] == '?') {
 			r_core_cmd_help (core, help_msg_slash_R);

