commit 36836c8eb9add532ae09357b6862c33e6af86a04
Author: Yukihiro "Matz" Matsumoto <matz@ruby-lang.org>
Date:   Thu Mar 20 16:10:12 2014 +0900

    should restore proc after rescue; close #1891

diff --git a/src/vm.c b/src/vm.c
index 2ed82a27..ffdbb618 100644
--- a/src/vm.c
+++ b/src/vm.c
@@ -1387,7 +1387,8 @@ RETRY_TRY_BLOCK:
           }
         }
       L_RESCUE:
-        irep = ci->proc->body.irep;
+        proc = ci->proc;
+        irep = proc->body.irep;
         pool = irep->pool;
         syms = irep->syms;
         regs = mrb->c->stack = ci[1].stackent;

