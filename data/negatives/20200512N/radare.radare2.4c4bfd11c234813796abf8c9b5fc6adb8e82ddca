commit 4c4bfd11c234813796abf8c9b5fc6adb8e82ddca
Author: pancake <pancake@nopcode.org>
Date:   Sun Jan 3 01:40:09 2016 +0100

    Enforce size in section.findMatching

diff --git a/libr/io/section.c b/libr/io/section.c
index d3b275f75..b2c9f1b94 100644
--- a/libr/io/section.c
+++ b/libr/io/section.c
@@ -30,14 +30,20 @@ R_API RIOSection *r_io_section_get_name(RIO *io, const char *name) {
 	return NULL;
 }
 
+// update name and rwx, size is experimental
 static RIOSection *findMatching (RIO *io, ut64 paddr, ut64 vaddr, ut64 size, ut64 vsize, int rwx, const char *name) {
 	RListIter *iter;
 	RIOSection *s;
 	r_list_foreach (io->sections, iter, s) {
 		if (s->offset != paddr) continue;
 		if (s->vaddr != vaddr) continue;
+#if 1
+		if (s->size != size) continue;
+		if (s->vsize != vsize) continue;
+#else
 		s->size = size;
 		s->vsize = vsize;
+#endif
 		s->rwx = rwx;
 		if (name && strcmp (name, s->name)) {
 			strcpy (s->name, name); /// XXX overflow here

