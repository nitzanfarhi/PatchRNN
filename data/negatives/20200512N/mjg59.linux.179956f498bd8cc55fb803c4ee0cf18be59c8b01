commit 179956f498bd8cc55fb803c4ee0cf18be59c8b01
Author: Atsushi Nemoto <anemo@mba.ocn.ne.jp>
Date:   Thu Feb 21 22:50:54 2008 +0900

    macb: Fix speed setting
    
    Fix NCFGR.SPD setting on 10Mbps.  This bug was introduced by
    conversion to generic PHY layer in kernel 2.6.23.
    
    Signed-off-by: Atsushi Nemoto <anemo@mba.ocn.ne.jp>
    Signed-off-by: Jeff Garzik <jeff@garzik.org>

diff --git a/drivers/net/macb.c b/drivers/net/macb.c
index 81bf005ff280..1d210ed46130 100644
--- a/drivers/net/macb.c
+++ b/drivers/net/macb.c
@@ -148,7 +148,7 @@ static void macb_handle_link_change(struct net_device *dev)
 
 			if (phydev->duplex)
 				reg |= MACB_BIT(FD);
-			if (phydev->speed)
+			if (phydev->speed == SPEED_100)
 				reg |= MACB_BIT(SPD);
 
 			macb_writel(bp, NCFGR, reg);

