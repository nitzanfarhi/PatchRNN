commit a44136a12137ad08502fcbd7f74207da43ff5a95
Author: Alan T. DeKok <aland@freeradius.org>
Date:   Thu Mar 15 09:03:22 2012 -0400

    Set "close on exec" flag
    
    Just to be safe.

diff --git a/src/main/listen.c b/src/main/listen.c
index eb13b67a8..f51cafe52 100644
--- a/src/main/listen.c
+++ b/src/main/listen.c
@@ -2072,6 +2072,21 @@ static int listen_bind(rad_listen_t *this)
 		radlog(L_ERR, "Failed opening %s: %s", buffer, strerror(errno));
 		return -1;
 	}
+
+#ifdef FD_CLOEXEC
+	/*
+	 *	We don't want child processes inheriting these
+	 *	file descriptors.
+	 */
+	rcode = fcntl(this->fd, F_GETFD);
+	if (rcode >= 0) {
+		if (fcntl(this->fd, F_SETFD, rcode | FD_CLOEXEC) < 0) {
+			close(this->fd);
+			radlog(L_ERR, "Failed setting close on exec: %s", strerror(errno));
+			return -1;
+		}
+	}
+#endif
 		
 	/*
 	 *	Bind to a device BEFORE touching IP addresses.

