commit 7e44bcfd8a3b0947bdc7e325671ec5fc4401cb21
Author: ridiculousfish <corydoras@ridiculousfish.com>
Date:   Sat May 3 19:57:20 2014 -0700

    Make inotify-based universal variable notifier tests pass

diff --git a/env_universal_common.cpp b/env_universal_common.cpp
index 78c2515f..e726e4c4 100644
--- a/env_universal_common.cpp
+++ b/env_universal_common.cpp
@@ -1665,7 +1665,7 @@ class universal_notifier_inotify_t : public universal_notifier_t
         {
             struct inotify_event evt = {};
             ssize_t read_amt = read(watch_fd, &evt, sizeof evt);
-            if (read_amt >= sizeof evt)
+            if (read_amt >= (ssize_t)sizeof evt)
             {
                 if (evt.mask & (IN_DELETE_SELF | IN_MOVE_SELF))
                 {
diff --git a/fish_tests.cpp b/fish_tests.cpp
index 7256c3df..f6feda77 100644
--- a/fish_tests.cpp
+++ b/fish_tests.cpp
@@ -2371,7 +2371,9 @@ static void test_universal_notifiers()
     test_notifiers_with_strategy(universal_notifier_t::strategy_notifyd);
 #endif
 #if __linux || linux
+    if (system("mkdir -p /tmp/fish_uvars_test/ && touch /tmp/fish_uvars_test/varsfile.txt")) err(L"mkdir failed");
     test_notifiers_with_strategy(universal_notifier_t::strategy_inotify);
+    if (system("rm -Rf /tmp/fish_uvars_test/")) err(L"rm failed");
 #endif
 }
 

