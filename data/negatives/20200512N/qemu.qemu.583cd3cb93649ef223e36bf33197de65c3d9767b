commit 583cd3cb93649ef223e36bf33197de65c3d9767b
Author: Adam Lackorzynski <adam@os.inf.tu-dresden.de>
Date:   Sun Aug 15 15:58:32 2010 +0200

    target-i386: svm: Fix MSRPM check
    
    Correct the calculation of the offset in the msrpm
    for the MSR range 0 - 0x1fff.
    
    Signed-off-by: Adam Lackorzynski <adam@os.inf.tu-dresden.de>
    Signed-off-by: Anthony Liguori <aliguori@us.ibm.com>

diff --git a/target-i386/op_helper.c b/target-i386/op_helper.c
index c50e818e72..ec6b3e9384 100644
--- a/target-i386/op_helper.c
+++ b/target-i386/op_helper.c
@@ -5237,7 +5237,7 @@ void helper_svm_check_intercept_param(uint32_t type, uint64_t param)
             switch((uint32_t)ECX) {
             case 0 ... 0x1fff:
                 t0 = (ECX * 2) % 8;
-                t1 = ECX / 8;
+                t1 = (ECX * 2) / 8;
                 break;
             case 0xc0000000 ... 0xc0001fff:
                 t0 = (8192 + ECX - 0xc0000000) * 2;

