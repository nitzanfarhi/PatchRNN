commit b99707d7ee887f9df8b3f7cf75e1e9dbf3206df3
Author: Marcel Holtmann <marcel@holtmann.org>
Date:   Thu Oct 3 02:54:11 2013 -0700

    Bluetooth: Drop packets on ATT fixed channel on BR/EDR
    
    The ATT fixed channel is only valid when using LE connections. On
    BR/EDR it is required to go through L2CAP connection oriented
    channel for ATT.
    
    Drop ATT packets when they are received on a BR/EDR connection.
    
    Signed-off-by: Marcel Holtmann <marcel@holtmann.org>
    Signed-off-by: Johan Hedberg <johan.hedberg@intel.com>

diff --git a/net/bluetooth/l2cap_core.c b/net/bluetooth/l2cap_core.c
index 102a510a153a..583517e1dd43 100644
--- a/net/bluetooth/l2cap_core.c
+++ b/net/bluetooth/l2cap_core.c
@@ -6431,8 +6431,12 @@ drop:
 static void l2cap_att_channel(struct l2cap_conn *conn,
 			      struct sk_buff *skb)
 {
+	struct hci_conn *hcon = conn->hcon;
 	struct l2cap_chan *chan;
 
+	if (hcon->type != LE_LINK)
+		goto drop;
+
 	chan = l2cap_global_chan_by_scid(BT_CONNECTED, L2CAP_CID_ATT,
 					 conn->src, conn->dst);
 	if (!chan)

