commit a171e782a97d4ba55d7fa02f9a46904288b2c229
Author: Axel Lin <axel.lin@gmail.com>
Date:   Tue Mar 27 15:17:26 2012 +0800

    regulator: wm831x-dcdc: Fix the logic to choose best current limit setting
    
    Current code in wm831x_buckv_set_current_limit actually set the current limit
    setting greater than specified range.
    
    Fix the logic in wm831x_buckv_set_current_limit to choose the
    smallest current limit setting falls within the specified range.
    
    Signed-off-by: Axel Lin <axel.lin@gmail.com>
    Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com>

diff --git a/drivers/regulator/wm831x-dcdc.c b/drivers/regulator/wm831x-dcdc.c
index 3044001f3cf6..ff810e787eac 100644
--- a/drivers/regulator/wm831x-dcdc.c
+++ b/drivers/regulator/wm831x-dcdc.c
@@ -380,7 +380,8 @@ static int wm831x_buckv_set_current_limit(struct regulator_dev *rdev,
 	int i;
 
 	for (i = 0; i < ARRAY_SIZE(wm831x_dcdc_ilim); i++) {
-		if (max_uA <= wm831x_dcdc_ilim[i])
+		if ((min_uA <= wm831x_dcdc_ilim[i]) &&
+		    (wm831x_dcdc_ilim[i] <= max_uA))
 			break;
 	}
 	if (i == ARRAY_SIZE(wm831x_dcdc_ilim))

