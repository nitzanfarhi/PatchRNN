commit 54d863abfe3ba0c8817a3a1c387e45f048c1cfb0
Author: Paul Wouters <paul@xelerance.com>
Date:   Sun Apr 3 16:28:30 2011 +0200

    Use protocol values from netinet/in.h instead of hard-coded values

diff --git a/programs/pluto/kernel_netlink.c b/programs/pluto/kernel_netlink.c
index 6ce934d7a..78d43e547 100644
--- a/programs/pluto/kernel_netlink.c
+++ b/programs/pluto/kernel_netlink.c
@@ -599,7 +599,7 @@ netlink_raw_eroute(const ip_address *this_host
      * therefore, this code extracts upper 8 bits and lower 8 bits and puts
      * into source and destination ports before passing to NETKEY. */
 
-    if( 1 == transport_proto /*icmp*/ || 58 == transport_proto /*ipv6-icmp*/) {
+    if( transport_proto == IPPROTO_ICMP || transport_proto == IPPROTO_ICMPV6) {
 	u_int16_t icmp_type;
 	u_int16_t icmp_code;
 

