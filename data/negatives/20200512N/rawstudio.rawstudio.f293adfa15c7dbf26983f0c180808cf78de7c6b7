commit f293adfa15c7dbf26983f0c180808cf78de7c6b7
Author: Anders Lauritsen <ducklord@users.noreply.github.com>
Date:   Wed Jul 12 17:57:38 2006 +0000

    Fixed bug with upscaling. upscaling now enabled in interface.

diff --git a/src/rawstudio.c b/src/rawstudio.c
index 5dea9a9b..da5503b2 100644
--- a/src/rawstudio.c
+++ b/src/rawstudio.c
@@ -718,7 +718,7 @@ rs_new()
 {
 	RS_BLOB *rs;
 	rs = g_malloc(sizeof(RS_BLOB));
-	rs->scale = gtk_adjustment_new(0.5, 0.1, 1.0, 0.01, 0.1, 0.0);
+	rs->scale = gtk_adjustment_new(0.5, 0.1, 2.0, 0.01, 0.1, 0.0);
 	rs->gamma = 0.0;
 	rs_conf_get_double(CONF_GAMMAVALUE, &rs->gamma);
 	if(rs->gamma < 0.1)
diff --git a/src/rs-image.c b/src/rs-image.c
index d1cae197..702ea181 100644
--- a/src/rs-image.c
+++ b/src/rs-image.c
@@ -184,9 +184,8 @@ inline gushort
 	x2 = x1 + 1;
 	y2 = y1 + 1;
 
-
-	if( x2 > out->w ) x2 = out->w;
-	if( y2 > out->h ) y2 = out->h;
+	if (unlikely(x2 >= in->w)) x2 = in->w - 1;
+	if (unlikely(y2 >= in->h)) y2 = in->h - 1;
 
 	gushort col11 = in->pixels[x1*4+y1*in->rowstride+col_offset];
 	gushort col12 = in->pixels[x1*4+y2*in->rowstride+col_offset];

