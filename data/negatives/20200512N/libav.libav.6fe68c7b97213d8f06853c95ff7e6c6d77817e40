commit 6fe68c7b97213d8f06853c95ff7e6c6d77817e40
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Fri Dec 26 16:38:55 2008 +0000

    Factorize "avctx->width + 2" out to avoid someone mistakenly changing
    some but not all.
    
    Originally committed as revision 16336 to svn://svn.ffmpeg.org/ffmpeg/trunk

diff --git a/libavcodec/faxcompr.c b/libavcodec/faxcompr.c
index 10a073041..c01a1ef75 100644
--- a/libavcodec/faxcompr.c
+++ b/libavcodec/faxcompr.c
@@ -280,15 +280,16 @@ int ff_ccitt_unpack(AVCodecContext *avctx,
     GetBitContext gb;
     int *runs, *ref, *runend;
     int ret;
+    int runsize= avctx->width + 2;
 
-    runs = av_malloc((avctx->width + 2) * sizeof(runs[0]));
-    ref  = av_malloc((avctx->width + 2) * sizeof(ref[0]));
+    runs = av_malloc(runsize * sizeof(runs[0]));
+    ref  = av_malloc(runsize * sizeof(ref[0]));
     ref[0] = avctx->width;
     ref[1] = 0;
     ref[2] = 0;
     init_get_bits(&gb, src, srcsize*8);
     for(j = 0; j < height; j++){
-        runend = runs + avctx->width + 2;
+        runend = runs + runsize;
         if(compr == TIFF_G4){
             ret = decode_group3_2d_line(avctx, &gb, avctx->width, runs, runend, ref);
             if(ret < 0){

