commit d24ee26f8b87e6a7904d1a9e3a261502c02a3c00
Author: Andrei Pelinescu-Onciul <andrei@iptel.org>
Date:   Wed Aug 1 00:05:42 2007 +0000

    - support for setting the source address in tcp_send() and tcpconn_get()
      (should allow for a better tcp force_send_socket() in the future)
    - add multiple aliases for each connection, to cover all the search
     possiblities: (dst_ip, dst_port), (local_ip, dst_ip, dst_port),
      (local_ip, local_port, dst_ip, dst_port).
    - improved connection hash function

diff --git a/modules_s/tls/tls_select.c b/modules_s/tls/tls_select.c
index 3c6fc3f36..a7368869e 100644
--- a/modules_s/tls/tls_select.c
+++ b/modules_s/tls/tls_select.c
@@ -71,7 +71,7 @@ struct tcp_connection* get_cur_connection(struct sip_msg* msg)
 		return 0;
 	}
 
-	c = tcpconn_get(msg->rcv.proto_reserved1, 0, 0, tls_con_lifetime);
+	c = tcpconn_get(msg->rcv.proto_reserved1, 0, 0, 0, tls_con_lifetime);
 	if (c && c->type != PROTO_TLS) {
 		ERR("Connection found but is not TLS\n");
 		tcpconn_put(c);

