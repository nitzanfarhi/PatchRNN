commit 7ea930a03060ed259db52a7d8ac58a217ef5c8ce
Author: okir <okir@c6295689-39f2-0310-b995-f0e70906c6a9>
Date:   Thu Oct 30 12:03:31 2003 +0000

    - return error if cflex_create_dummy_chvs fails
    
    
    git-svn-id: https://www.opensc-project.org/svnp/opensc/trunk@1575 c6295689-39f2-0310-b995-f0e70906c6a9

diff --git a/src/pkcs15init/pkcs15-cflex.c b/src/pkcs15init/pkcs15-cflex.c
index 3f6700f1..15df48e0 100644
--- a/src/pkcs15init/pkcs15-cflex.c
+++ b/src/pkcs15init/pkcs15-cflex.c
@@ -512,6 +512,12 @@ cflex_create_pin_file(sc_profile_t *profile, sc_card_t *card,
 	ndummies = cflex_create_dummy_chvs(profile, card,
 				file, SC_AC_OP_UPDATE,
 				dummies);
+	if (ndummies < 0) {
+		sc_error(card->ctx,
+			"Unable to create dummy CHV file: %s",
+			sc_strerror(ndummies));
+		return ndummies;
+	}
 
 	r = sc_pkcs15init_update_file(profile, card, file, buffer, 23);
 	if (r >= 0)

