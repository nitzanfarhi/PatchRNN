commit 7410210f198c88ad9563f6ac5b50218063d91070
Author: Daniel Stenberg <daniel@haxx.se>
Date:   Thu Sep 4 10:08:53 2003 +0000

    avoid proxy (and other) auth if no user+password is given

diff --git a/lib/http.c b/lib/http.c
index f4d200eeb..3b447dddc 100644
--- a/lib/http.c
+++ b/lib/http.c
@@ -196,8 +196,10 @@ CURLcode http_auth_headers(struct connectdata *conn,
   if(!data->state.authstage) {
     if(conn->bits.httpproxy && conn->bits.proxy_user_passwd)
       Curl_http_auth_stage(data, 407);
-    else
+    else if(conn->bits.user_passwd)
       Curl_http_auth_stage(data, 401);
+    else
+      return CURLE_OK; /* no authentication with no user or password */
   }
 
   /* To prevent the user+password to get sent to other than the original

