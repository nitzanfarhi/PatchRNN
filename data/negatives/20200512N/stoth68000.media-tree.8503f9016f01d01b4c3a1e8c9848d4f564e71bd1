commit 8503f9016f01d01b4c3a1e8c9848d4f564e71bd1
Author: Rupesh Gujare <rupesh.gujare@atmel.com>
Date:   Wed Aug 28 12:43:16 2013 +0100

    staging: ozwpan: Return error, if PD is not connected.
    
    Return error if we receive write(), while PD is not connected.
    
    Signed-off-by: Rupesh Gujare <rupesh.gujare@atmel.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

diff --git a/drivers/staging/ozwpan/ozcdev.c b/drivers/staging/ozwpan/ozcdev.c
index 50722eab7e1f..6ccb64fb0786 100644
--- a/drivers/staging/ozwpan/ozcdev.c
+++ b/drivers/staging/ozwpan/ozcdev.c
@@ -162,6 +162,8 @@ static ssize_t oz_cdev_write(struct file *filp, const char __user *buf,
 	spin_unlock_bh(&g_cdev.lock);
 	if (pd == NULL)
 		return -ENXIO;
+	if (!(pd->state & OZ_PD_S_CONNECTED))
+		return -EAGAIN;
 	eb = &pd->elt_buff;
 	ei = oz_elt_info_alloc(eb);
 	if (ei == NULL) {

