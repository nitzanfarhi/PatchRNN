commit c32b4084ec73053684a508f3032f788abf38f2da
Author: Justin.He/justin.he@dev3-240.dev.cn.tlan <>
Date:   Tue Mar 13 18:13:06 2007 +0800

    BUG#25880, Adding new column to ndb_dd table moves data for non_indexed fields in memory
    correct the inconsistency between columns' storage type with table's storage_media & tablespace

diff --git a/sql/ha_ndbcluster.cc b/sql/ha_ndbcluster.cc
index 86a2f9d8544..aa3de5311cf 100644
--- a/sql/ha_ndbcluster.cc
+++ b/sql/ha_ndbcluster.cc
@@ -4831,7 +4831,8 @@ int ha_ndbcluster::create(const char *name,
     if ((my_errno= create_ndb_column(col, field, create_info)))
       DBUG_RETURN(my_errno);
  
-    if (create_info->storage_media == HA_SM_DISK)
+    if (create_info->storage_media == HA_SM_DISK ||
+        create_info->tablespace)
       col.setStorageType(NdbDictionary::Column::StorageTypeDisk);
     else
       col.setStorageType(NdbDictionary::Column::StorageTypeMemory);

