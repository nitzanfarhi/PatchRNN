commit 5821d2ea9ef4a7100a3fc6f26a4d62c4251eabe3
Author: joreland@mysql.com <>
Date:   Sun Aug 15 21:15:40 2004 +0200

    1) Removed to hard require
    2) Fix variable scope for irix compiler

diff --git a/ndb/src/kernel/blocks/dblqh/DblqhMain.cpp b/ndb/src/kernel/blocks/dblqh/DblqhMain.cpp
index fada8738ae9..6b4a78380be 100644
--- a/ndb/src/kernel/blocks/dblqh/DblqhMain.cpp
+++ b/ndb/src/kernel/blocks/dblqh/DblqhMain.cpp
@@ -5912,10 +5912,18 @@ void Dblqh::execACCKEYREF(Signal* signal)
      * Only primary replica can get ZTUPLE_ALREADY_EXIST || ZNO_TUPLE_FOUND
      *
      * Unless it's a simple or dirty read
+     *
+     * NOT TRUE!
+     * 1) op1 - primary insert ok
+     * 2) op1 - backup insert fail (log full or what ever)
+     * 3) op1 - delete ok @ primary
+     * 4) op1 - delete fail @ backup
+     *
+     * -> ZNO_TUPLE_FOUND is possible
      */
     ndbrequire
       (tcPtr->seqNoReplica == 0 ||
-       (errCode != ZTUPLE_ALREADY_EXIST && errCode != ZNO_TUPLE_FOUND) ||
+       errCode != ZTUPLE_ALREADY_EXIST ||
        (tcPtr->operation == ZREAD && (tcPtr->dirtyOp || tcPtr->opSimple)));
   }
   tcPtr->abortState = TcConnectionrec::ABORT_FROM_LQH;
diff --git a/ndb/test/src/NDBT_Tables.cpp b/ndb/test/src/NDBT_Tables.cpp
index 2bb63ce8729..ff6db3e892c 100644
--- a/ndb/test/src/NDBT_Tables.cpp
+++ b/ndb/test/src/NDBT_Tables.cpp
@@ -849,7 +849,7 @@ NDBT_Tables::createTable(Ndb* pNdb, const char* _name, bool _temp,
     }
     
     Uint32 i = 0;
-    for(Uint32 i = 0; indexes[i].m_table != 0; i++){
+    for(i = 0; indexes[i].m_table != 0; i++){
       if(strcmp(indexes[i].m_table, _name) != 0)
 	continue;
       Uint32 j = 0;

