commit 78ba87d130caba9105e6a259bdae2891eb8b4d6f
Author: Francois-Xavier Le Bail <devel.fx.lebail@orange.fr>
Date:   Fri Mar 10 10:02:48 2017 +0100

    BGP: Fix a test invalid on a 32 bits system
    
    The 'len - (tptr - pptr)' expression type is 'unsigned int' on a 32 bits
    system.
    Thus the conversion changes negative values to positive ones and the > 0
    test is invalid.
    Update the expression to compare two pointers.

diff --git a/print-bgp.c b/print-bgp.c
index 33c482e6..04f0c3fa 100644
--- a/print-bgp.c
+++ b/print-bgp.c
@@ -1726,7 +1726,7 @@ bgp_attr_print(netdissect_options *ndo,
 			ND_PRINT((ndo, ", no SNPA"));
                 }
 
-		while (len - (tptr - pptr) > 0) {
+		while (tptr < pptr + len) {
                     switch (af<<8 | safi) {
                     case (AFNUM_INET<<8 | SAFNUM_UNICAST):
                     case (AFNUM_INET<<8 | SAFNUM_MULTICAST):
@@ -1894,7 +1894,7 @@ bgp_attr_print(netdissect_options *ndo,
 
 		tptr += 3;
 
-		while (len - (tptr - pptr) > 0) {
+		while (tptr < pptr + len) {
                     switch (af<<8 | safi) {
                     case (AFNUM_INET<<8 | SAFNUM_UNICAST):
                     case (AFNUM_INET<<8 | SAFNUM_MULTICAST):

