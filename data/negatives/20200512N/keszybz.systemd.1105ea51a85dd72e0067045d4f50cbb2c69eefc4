commit 1105ea51a85dd72e0067045d4f50cbb2c69eefc4
Author: David Herrmann <dh.herrmann@gmail.com>
Date:   Mon Aug 24 13:41:03 2015 +0200

    sd-bus: don't list activators as proper peers
    
    If a connection passed KDBUS_HELLO_ACTIVATOR, it cannot do I/O on the
    bus. Hence, we should not treat it as proper peer. To actually query it,
    you have to explicitly ask for activators.
    
    This makes kdbus in-line with what dbus-daemon does.

diff --git a/src/libsystemd/sd-bus/bus-control.c b/src/libsystemd/sd-bus/bus-control.c
index 92b12f2ae..95c7d4ebe 100644
--- a/src/libsystemd/sd-bus/bus-control.c
+++ b/src/libsystemd/sd-bus/bus-control.c
@@ -257,7 +257,7 @@ static int kernel_get_list(sd_bus *bus, uint64_t flags, char ***x) {
         KDBUS_FOREACH(name, name_list, cmd.list_size) {
                 struct kdbus_item *item;
 
-                if ((flags & KDBUS_LIST_UNIQUE) && name->id != previous_id) {
+                if ((flags & KDBUS_LIST_UNIQUE) && name->id != previous_id && !(name->flags & KDBUS_HELLO_ACTIVATOR)) {
                         char *n;
 
                         if (asprintf(&n, ":1.%llu", (unsigned long long) name->id) < 0) {

