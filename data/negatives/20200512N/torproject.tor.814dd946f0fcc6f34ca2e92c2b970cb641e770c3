commit 814dd946f0fcc6f34ca2e92c2b970cb641e770c3
Author: Roger Dingledine <arma@torproject.org>
Date:   Tue Jan 4 11:26:08 2005 +0000

    fix duplicate dns_cancel_pending_resolve reported by Giorgos Pallas
    
    
    svn:r3293

diff --git a/src/or/dns.c b/src/or/dns.c
index ac24de243..e70b277c3 100644
--- a/src/or/dns.c
+++ b/src/or/dns.c
@@ -568,7 +568,10 @@ int connection_dns_finished_flushing(connection_t *conn) {
 int connection_dns_reached_eof(connection_t *conn) {
   log_fn(LOG_WARN,"Read eof. Worker died unexpectedly.");
   if (conn->state == DNSWORKER_STATE_BUSY) {
-    dns_cancel_pending_resolve(conn->address);
+    /* don't cancel the resolve here -- it would be cancelled in
+     * connection_about_to_close_connection(), since conn is still
+     * in state BUSY
+     */
     num_dnsworkers_busy--;
   }
   num_dnsworkers--;

