commit 5854dbca9b235f8cdd414a0961018763d2d5bf77
Author: Huang Ying <ying.huang@intel.com>
Date:   Fri Oct 8 16:24:14 2010 +0800

    KVM: MCE: Add MCG_SER_P into KVM_MCE_CAP_SUPPORTED
    
    Now we have MCG_SER_P (and corresponding SRAO/SRAR MCE) support in
    kernel and QEMU-KVM, the MCG_SER_P should be added into
    KVM_MCE_CAP_SUPPORTED to make all these code really works.
    
    Reported-by: Dean Nelson <dnelson@redhat.com>
    Signed-off-by: Huang Ying <ying.huang@intel.com>
    Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>

diff --git a/arch/x86/kvm/x86.c b/arch/x86/kvm/x86.c
index dcee64e4434f..2e090784863a 100644
--- a/arch/x86/kvm/x86.c
+++ b/arch/x86/kvm/x86.c
@@ -73,7 +73,7 @@
 #define CR8_RESERVED_BITS (~(unsigned long)X86_CR8_TPR)
 
 #define KVM_MAX_MCE_BANKS 32
-#define KVM_MCE_CAP_SUPPORTED MCG_CTL_P
+#define KVM_MCE_CAP_SUPPORTED (MCG_CTL_P | MCG_SER_P)
 
 /* EFER defaults:
  * - enable syscall per default because its emulated by KVM

