commit 40f7e6e4be2b9e664b3ee83efdda542768943b2c
Author: Yan Jun <yan.jun8@zte.com.cn>
Date:   Wed Mar 9 16:05:39 2016 +0800

    msg: async: trim already sent for outcoming_bl more efficiently
    
    Signed-off-by: Yan Jun <yan.jun8@zte.com.cn>

diff --git a/src/msg/async/AsyncConnection.cc b/src/msg/async/AsyncConnection.cc
index bbe8875c59..561d9f54f3 100644
--- a/src/msg/async/AsyncConnection.cc
+++ b/src/msg/async/AsyncConnection.cc
@@ -395,9 +395,7 @@ ssize_t AsyncConnection::_try_send(bool send, bool more)
   // trim already sent for outcoming_bl
   if (sent_bytes) {
     if (sent_bytes < outcoming_bl.length()) {
-      bufferlist bl;
-      outcoming_bl.splice(sent_bytes, outcoming_bl.length()-sent_bytes, &bl);
-      bl.swap(outcoming_bl);
+      outcoming_bl.splice(0, sent_bytes);
     } else {
       outcoming_bl.clear();
     }

