commit 42e5e1084eeecf4b80cfba3557388b4d0942772c
Author: Andres Amaya Garcia <andres.amayagarcia@arm.com>
Date:   Thu Jul 20 16:27:03 2017 +0100

    Add goto cleanup; for consistency md.c

diff --git a/library/md.c b/library/md.c
index a84f3042d..625b34c5e 100644
--- a/library/md.c
+++ b/library/md.c
@@ -358,8 +358,9 @@ int mbedtls_md_hmac_starts( mbedtls_md_context_t *ctx, const unsigned char *key,
 
     if( ( ret = ctx->md_info->starts_func( ctx->md_ctx ) ) != 0 )
         goto cleanup;
-    ret = ctx->md_info->update_func( ctx->md_ctx, ipad,
-                                     ctx->md_info->block_size );
+    if( ( ret = ctx->md_info->update_func( ctx->md_ctx, ipad,
+                                           ctx->md_info->block_size ) ) != 0 )
+        goto cleanup;
 
 cleanup:
     mbedtls_zeroize( sum, sizeof( sum ) );

