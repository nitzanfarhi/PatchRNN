commit 7bd46344df500439e0c90aaec23d8a61f055e7d9
Author: Sebastian Hahn <sebastian@torproject.org>
Date:   Wed Nov 16 17:44:20 2011 +0100

    Eat all whitespace after a control command

diff --git a/src/or/control.c b/src/or/control.c
index 4d86a2375..109eb8857 100644
--- a/src/or/control.c
+++ b/src/or/control.c
@@ -1055,7 +1055,7 @@ handle_control_authenticate(control_connection_t *conn, uint32_t len,
   int bad_cookie=0, bad_password=0;
   smartlist_t *sl = NULL;
 
-  if (!len || TOR_ISSPACE(body[0])) {
+  if (!len) {
     password = tor_strdup("");
     password_len = 0;
   } else if (TOR_ISXDIGIT(body[0])) {
@@ -3118,7 +3118,7 @@ connection_control_process_inbuf(control_connection_t *conn)
   args = conn->incoming_cmd+cmd_len+1;
   tor_assert(data_len>(size_t)cmd_len);
   data_len -= (cmd_len+1); /* skip the command and NUL we added after it */
-  while (*args == ' ' || *args == '\t') {
+  while (TOR_ISSPACE(*args)) {
     ++args;
     --data_len;
   }

