commit 69ca634663cc00a1af75b32dc0be6300455267c9
Author: Andrew McDonnell <bugs@andrewmcdonnell.net>
Date:   Sat Aug 10 20:13:20 2013 +0930

    Deal with  properly

diff --git a/storage/oqgraph/ha_oqgraph.cc b/storage/oqgraph/ha_oqgraph.cc
index f0394c62332..0066b110a2b 100644
--- a/storage/oqgraph/ha_oqgraph.cc
+++ b/storage/oqgraph/ha_oqgraph.cc
@@ -882,7 +882,10 @@ int ha_oqgraph::index_read_idx(byte * buf, uint index, const byte * key,
   // so we pass the string now.
   // In the future we should refactor parse_latch_string_to_legacy_int()
   // into oqgraph instead.
-  graph->retainLatchFieldValue(latchFieldValue.c_ptr_safe());
+  if (latchp)
+    graph->retainLatchFieldValue(latchFieldValue.c_ptr_safe());
+  else
+    graph->retainLatchFieldValue(NULL);
     
   
   DBUG_PRINT( "oq-debug", ("index_read_idx ::>> search(latch:%s,%ld,%ld)", 
@@ -1095,7 +1098,7 @@ ha_rows ha_oqgraph::records_in_range(uint inx, key_range *min_key,
       min_key->flag != HA_READ_KEY_EXACT ||
       max_key->flag != HA_READ_AFTER_KEY)
   {
-    if (min_key->length == key->key_part[0].store_length)
+    if (min_key->length == key->key_part[0].store_length && !key->key_part[0].field->is_null()) /* ensure select * from x where latch is null is consistent with no latch */
     {
       // If latch is not null and equals 0, return # nodes      
         

