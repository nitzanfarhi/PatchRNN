commit d62262a0260760dc536b4d2fff0bee2b1c18052c
Author: paul <paul>
Date:   Mon Nov 17 09:08:45 2003 +0000

    2003-11-17 Hasso Tepper <hasso@estpak.ee>
    
            * ripd/ripd.c: rip_create_socket() privs were not dropped if bind
              failed.

diff --git a/ripd/ripd.c b/ripd/ripd.c
index accac5e9..df6cf6cf 100644
--- a/ripd/ripd.c
+++ b/ripd/ripd.c
@@ -1882,6 +1882,8 @@ rip_create_socket ()
   if (ret < 0)
     {
       perror ("bind");
+      if (ripd_privs.change (ZPRIVS_LOWER))
+        zlog_err ("rip_create_socket: could not lower privs");
       return ret;
     }
   if (ripd_privs.change (ZPRIVS_LOWER))

