commit 160122205638127eddd8673d2bab46d297d62f4e
Author: Jason Ish <ish@unx.ca>
Date:   Wed Mar 2 09:54:07 2016 -0600

    alert-debuglog: trigger rotation on non-decoder events as well
    
    The write handling was missed for non-decoder events that
    would trigger rotation after a HUP.

diff --git a/src/alert-debuglog.c b/src/alert-debuglog.c
index 5df1f4c1..43bbbf98 100644
--- a/src/alert-debuglog.c
+++ b/src/alert-debuglog.c
@@ -321,8 +321,8 @@ static TmEcode AlertDebugLogger(ThreadVars *tv, const Packet *p, void *thread_da
     }
 
     SCMutexLock(&aft->file_ctx->fp_mutex);
-    (void)MemBufferPrintToFPAsString(aft->buffer, aft->file_ctx->fp);
-    fflush(aft->file_ctx->fp);
+    aft->file_ctx->Write((const char *)MEMBUFFER_BUFFER(aft->buffer),
+        MEMBUFFER_OFFSET(aft->buffer), aft->file_ctx);
     aft->file_ctx->alerts += p->alerts.cnt;
     SCMutexUnlock(&aft->file_ctx->fp_mutex);
 

