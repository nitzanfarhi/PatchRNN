commit e0e2396bdb5b2575dd09619d36bcce944f9c2cc6
Author: Uri Simchoni <urisimchoni@gmail.com>
Date:   Thu Sep 1 23:52:38 2016 +0300

    SMB2: dissect class and infolevel in get quota info request
    
    (actually, in [MS-SMB2] those are called "InfoType" and
    "FileInfoClass", respectively)
    
    Change-Id: Id583be4574cea5ce092c374a5624a4bd17d5d4c6
    Signed-off-by: Uri Simchoni <urisimchoni@gmail.com>
    Reviewed-on: https://code.wireshark.org/review/17443
    Reviewed-by: Anders Broman <a.broman58@gmail.com>

diff --git a/epan/dissectors/packet-smb2.c b/epan/dissectors/packet-smb2.c
index 404cade486..cf168bebcb 100644
--- a/epan/dissectors/packet-smb2.c
+++ b/epan/dissectors/packet-smb2.c
@@ -580,6 +580,7 @@ static const value_string smb2_class_vals[] = {
 	{ SMB2_CLASS_FILE_INFO,	"FILE_INFO"},
 	{ SMB2_CLASS_FS_INFO,	"FS_INFO"},
 	{ SMB2_CLASS_SEC_INFO,	"SEC_INFO"},
+	{ SMB2_CLASS_QUOTA_INFO, "QUOTA_INFO"},
 	{ SMB2_CLASS_POSIX_INFO, "POSIX_INFO"},
 	{ 0, NULL }
 };
@@ -4288,6 +4289,11 @@ dissect_smb2_class_infolevel(packet_info *pinfo, tvbuff_t *tvb, int offset, prot
 		hfindex = hf_smb2_infolevel_sec_info;
 		vsx = &smb2_sec_info_levels_ext;
 		break;
+	case SMB2_CLASS_QUOTA_INFO:
+		/* infolevel is not being used for quota */
+		hfindex = hf_smb2_infolevel;
+		vsx = NULL;
+		break;
 	case SMB2_CLASS_POSIX_INFO:
 		hfindex = hf_smb2_infolevel_posix_info;
 		vsx = &smb2_posix_info_levels_ext;

