commit e0b5efcb6ba6f0613a44106e5f9e099c7eecda56
Author: pancake <pancake@nopcode.org>
Date:   Wed Jan 27 02:54:13 2016 +0100

    Fix #4004 - support xor r8-r15 in the x86.nz assembler

diff --git a/libr/asm/p/asm_x86_nz.c b/libr/asm/p/asm_x86_nz.c
index 8a1e20f0c..bf82d490f 100644
--- a/libr/asm/p/asm_x86_nz.c
+++ b/libr/asm/p/asm_x86_nz.c
@@ -866,8 +866,13 @@ SETNP/SETPO - Set if No Parity / Set if Parity Odd (386+)
 			} else pfx = 0xc0;
 			arg0 = getreg (arg);
 			if (a->bits==64) {
-				if (*arg=='r')
-					data[l++] = 0x48;
+				if (*arg=='r') {
+					if (arg[1]>'7' || (arg[2] >= '0' && arg[2]<='9')) {
+						data[l++] = 0x4d;
+					} else {
+						data[l++] = 0x48;
+					}
+				}
 				data[l++] = 0x31; // NOTE: 0x33 is also a valid encoding for xor.. polimorfi?
 				data[l++] = arg0 | (getreg(arg2)<<3) | pfx;
 			} else {

