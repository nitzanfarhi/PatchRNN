commit d905ed33feadf5234f4bcaae016a290dbf4738ad
Author: Kurtis Rader <krader@skepticism.us>
Date:   Sun Jan 15 19:27:53 2017 -0800

    another glibc EIO workaround
    
    Partial fix for #3737 and #3644

diff --git a/src/exec.cpp b/src/exec.cpp
index 50b09d55..ca98afa5 100644
--- a/src/exec.cpp
+++ b/src/exec.cpp
@@ -929,6 +929,8 @@ void exec_job(parser_t &parser, job_t *j) {
                         bool builtin_io_done = do_builtin_io(outbuff.data(), outbuff.size(),
                                                              errbuff.data(), errbuff.size());
                         if (!builtin_io_done && errno != EPIPE) {
+                            redirect_tty_output();  // workaround glibc bug
+                            debug(0, "!builtin_io_done and errno != EPIPE");
                             show_stackframe(L'E');
                         }
                         fork_was_skipped = true;

