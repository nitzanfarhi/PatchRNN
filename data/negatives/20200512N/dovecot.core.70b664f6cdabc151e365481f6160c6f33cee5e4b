commit 70b664f6cdabc151e365481f6160c6f33cee5e4b
Author: Timo Sirainen <tss@iki.fi>
Date:   Mon Sep 16 12:49:13 2002 +0300

    modifylog opening was buggy
    
    --HG--
    branch : HEAD

diff --git a/src/lib-index/mail-modifylog.c b/src/lib-index/mail-modifylog.c
index 3b6fb00ee..eab0838a5 100644
--- a/src/lib-index/mail-modifylog.c
+++ b/src/lib-index/mail-modifylog.c
@@ -364,7 +364,7 @@ static int mail_modifylog_open_and_verify(MailModifyLog *log, const char *path)
 		(void)unlink(path);
 	}
 
-	if (ret != -1 && hdr.indexid != log->index->indexid) {
+	if (ret > 0 && hdr.indexid != log->index->indexid) {
 		index_set_error(log->index, "IndexID mismatch for modify log "
 				"file %s", path);
 		ret = -1;
@@ -373,12 +373,12 @@ static int mail_modifylog_open_and_verify(MailModifyLog *log, const char *path)
 		(void)unlink(path);
 	}
 
-	if (ret != -1 && hdr.sync_id == SYNC_ID_FULL) {
+	if (ret > 0 && hdr.sync_id == SYNC_ID_FULL) {
 		/* full */
 		ret = 0;
 	}
 
-	if (ret == 1) {
+	if (ret > 0) {
 		log->fd = fd;
 		log->filepath = i_strdup(path);
 	} else {

