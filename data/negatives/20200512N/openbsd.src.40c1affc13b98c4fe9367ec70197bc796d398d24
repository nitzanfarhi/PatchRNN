commit 40c1affc13b98c4fe9367ec70197bc796d398d24
Author: tedu <tedu@openbsd.org>
Date:   Wed Oct 22 23:05:11 2003 +0000

    err on strdup failure.  from vink joris.

diff --git a/usr.bin/tn3270/sys_curses/system.c b/usr.bin/tn3270/sys_curses/system.c
index 5b5a89291ca..858b8c0e7db 100644
--- a/usr.bin/tn3270/sys_curses/system.c
+++ b/usr.bin/tn3270/sys_curses/system.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: system.c,v 1.15 2003/07/10 00:06:51 david Exp $	*/
+/*	$OpenBSD: system.c,v 1.16 2003/10/22 23:05:11 tedu Exp $	*/
 
 /*-
  * Copyright (c) 1988 The Regents of the University of California.
@@ -31,7 +31,7 @@
 
 #ifndef lint
 /*static char sccsid[] = "from: @(#)system.c	4.5 (Berkeley) 4/26/91";*/
-static char rcsid[] = "$OpenBSD: system.c,v 1.15 2003/07/10 00:06:51 david Exp $";
+static char rcsid[] = "$OpenBSD: system.c,v 1.16 2003/10/22 23:05:11 tedu Exp $";
 #endif /* not lint */
 
 #include <sys/types.h>
@@ -638,13 +638,15 @@ char	*argv[];
     struct timeval tv;
     long ikey;
 
-    keyname = strdup("/tmp/apiXXXXXXXXXX");
+    if ((keyname = strdup("/tmp/apiXXXXXXXXXX")) == NULL)
+	    err(1, "strdup");
     if ((fd = mkstemp(keyname)) == -1) {
 	perror("open");
 	free(keyname);
 	return 0;
     }
-    keyname = strdup(sockNAME);
+    if ((keyname = strdup(sockNAME)) == NULL)
+	    err(1, "strdup");
 
     /* Now, get seed for random */
 

