commit fb659b1713dd583ed0a75abe0143b14a1b8a0b4d
Author: Luke Dashjr <luke-jr+git@utopios.org>
Date:   Thu Sep 27 06:38:12 2012 +0000

    Avoid strndup for Windows compatibility

diff --git a/miner.c b/miner.c
index e26a8a9f..43a0cb14 100644
--- a/miner.c
+++ b/miner.c
@@ -1519,7 +1519,9 @@ static bool work_decode(const json_t *val, struct work *work)
 					ae = cbappendsz;
 					truncatewarning = false;
 				} else {
-					char *tmp = strndup(opt_coinbase_sig, ae);
+					char *tmp = malloc(ae + 1);
+					memcpy(tmp, opt_coinbase_sig, ae);
+					tmp[ae] = '\0';
 					applog((truncatewarning ? LOG_DEBUG : LOG_WARNING),
 					       "Pool %u truncating appended coinbase signature at %d bytes: %s(%s)",
 					       work->pool->pool_no, ae, tmp, &opt_coinbase_sig[ae]);

