commit 1704071a7e69447c84be9eb012a53dbc262ca017
Author: Mickey Sola <msola@sourcefire.com>
Date:   Mon Aug 31 11:07:01 2015 -0400

    Improving memory handling on ddd thread exit.

diff --git a/clamd/onaccess_ddd.c b/clamd/onaccess_ddd.c
index 38713b2d8..6ffab7947 100644
--- a/clamd/onaccess_ddd.c
+++ b/clamd/onaccess_ddd.c
@@ -414,6 +414,8 @@ void *onas_ddd_th(void *arg) {
 
 static void onas_ddd_exit(int sig) {
 	logg("*ScanOnAccess: onas_ddd_exit(), signal %d\n", sig);
+	onas_free_ht(ddd_ht);
+	free(wdlt);
 	pthread_exit(NULL);
 	logg("ScanOnAccess: stopped\n");
 }
diff --git a/clamd/onaccess_fan.c b/clamd/onaccess_fan.c
index d8c6ea03e..12620ee35 100644
--- a/clamd/onaccess_fan.c
+++ b/clamd/onaccess_fan.c
@@ -54,7 +54,6 @@ static pthread_t ddd_pid;
 
 static void onas_fan_exit(int sig)
 {
-
 	logg("*ScanOnAccess: onas_fan_exit(), signal %d\n", sig);
 	
 	pthread_kill(ddd_pid, SIGUSR1);

