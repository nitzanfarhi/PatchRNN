commit 67235b483d2634466088b1ca8481cb947055436c
Author: Embedthis Software <dev@embedthis.com>
Date:   Sun Jun 13 16:51:14 2010 -0700

    Fix parsing dates in 1899 and prior to 1900

diff --git a/src/deps/mpr/mprLib.c b/src/deps/mpr/mprLib.c
index d3ac79553..c8d459756 100644
--- a/src/deps/mpr/mprLib.c
+++ b/src/deps/mpr/mprLib.c
@@ -19585,7 +19585,7 @@ char *mprFormatTime(MprCtx ctx, cchar *fmt, struct tm *tp)
             break;
 
         case 's':                                       /* seconds since epoch */
-            mprPutFmtToBuf(buf, "%d", mprMakeUniversalTime(ctx, tp) / MS_PER_SEC);
+            mprPutFmtToBuf(buf, "%d", mprMakeTime(ctx, tp) / MS_PER_SEC);
             break;
 
         case 'T':
@@ -19845,7 +19845,7 @@ int mprParseTime(MprCtx ctx, MprTime *time, cchar *dateString, int zoneFlags, st
                 *time = value;
                 mprFree(str);
                 return 0;
-            } else if (value > 32 || (tm.tm_mday >= 0 && tm.tm_year < 0)) {
+            } else if (value > 32 || (tm.tm_mday >= 0 && tm.tm_year == -MAXINT)) {
                 if (value >= 1000) {
                     fullYear = 1;
                 }
@@ -20014,7 +20014,7 @@ static void validateTime(MprCtx ctx, struct tm *tp, struct tm *defaults)
         swapDayMonth(tp);
     }
 
-    if (tp->tm_year >= 0 && tp->tm_mon >= 0 && tp->tm_mday >= 0 && tp->tm_hour >= 0) {
+    if (tp->tm_year != -MAXINT && tp->tm_mon >= 0 && tp->tm_mday >= 0 && tp->tm_hour >= 0) {
         /*  Everything defined */
         return;
     }

