commit 777c2f389e463428fd7e2871051a84d7fe84b172
Author: Gregory Haskins <ghaskins@novell.com>
Date:   Mon Dec 29 09:39:50 2008 -0500

    sched: only try to push a task on wakeup if it is migratable
    
    There is no sense in wasting time trying to push a task away that
    cannot move anywhere else.  We gain no benefit from trying to push
    other tasks at this point, so if the task being woken up is non
    migratable, just skip the whole operation.  This reduces overhead
    in the wakeup path for certain tasks.
    
    Signed-off-by: Gregory Haskins <ghaskins@novell.com>

diff --git a/kernel/sched_rt.c b/kernel/sched_rt.c
index d047f288c411..8d33843cb2c4 100644
--- a/kernel/sched_rt.c
+++ b/kernel/sched_rt.c
@@ -1314,7 +1314,8 @@ static void task_wake_up_rt(struct rq *rq, struct task_struct *p)
 {
 	if (!task_running(rq, p) &&
 	    !test_tsk_need_resched(rq->curr) &&
-	    rq->rt.overloaded)
+	    rq->rt.overloaded &&
+	    p->rt.nr_cpus_allowed > 1)
 		push_rt_tasks(rq);
 }
 

