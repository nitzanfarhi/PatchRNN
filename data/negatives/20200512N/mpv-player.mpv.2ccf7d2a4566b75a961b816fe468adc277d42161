commit 2ccf7d2a4566b75a961b816fe468adc277d42161
Author: atmos4 <atmos4@b3059339-0415-0410-9bf9-f77b7e298cf2>
Date:   Sun Feb 10 00:16:46 2002 +0000

    Don't read index for -forceidx and -nodix (speedup with bad media and not needed anyway)
    
    
    git-svn-id: svn://svn.mplayerhq.hu/mplayer/trunk@4622 b3059339-0415-0410-9bf9-f77b7e298cf2

diff --git a/libmpdemux/aviheader.c b/libmpdemux/aviheader.c
index 9be2f8f3d8..13947dd19f 100644
--- a/libmpdemux/aviheader.c
+++ b/libmpdemux/aviheader.c
@@ -54,7 +54,8 @@ while(1){
       demuxer->movi_end=demuxer->movi_start+len;
       mp_msg(MSGT_HEADER,MSGL_V,"Found movie at 0x%X - 0x%X\n",(int)demuxer->movi_start,(int)demuxer->movi_end);
       if(demuxer->stream->end_pos) demuxer->movi_end=demuxer->stream->end_pos;
-      if(index_mode==-2) break; // reading from non-seekable source (stdin)
+      if(index_mode==-2 || index_mode==2 || index_mode==0)
+        break; // reading from non-seekable source (stdin) or forced index or no index forced
       len=(len+1)&(~1);
       stream_skip(demuxer->stream,len);
     }

