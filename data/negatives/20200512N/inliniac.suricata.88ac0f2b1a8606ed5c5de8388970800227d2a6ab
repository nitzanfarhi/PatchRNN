commit 88ac0f2b1a8606ed5c5de8388970800227d2a6ab
Author: Jason Ish <ish@unx.ca>
Date:   Mon Dec 11 15:49:34 2017 -0600

    eve: tls: respect global metadata config

diff --git a/src/output-json-tls.c b/src/output-json-tls.c
index 18d45dce..375c8a69 100644
--- a/src/output-json-tls.c
+++ b/src/output-json-tls.c
@@ -102,6 +102,7 @@ typedef struct OutputTlsCtx_ {
     LogFileCtx *file_ctx;
     uint32_t flags;  /** Store mode */
     uint64_t fields; /** Store fields */
+    bool include_metadata;
 } OutputTlsCtx;
 
 
@@ -361,6 +362,10 @@ static int JsonTlsLogger(ThreadVars *tv, void *thread_data, const Packet *p,
         return 0;
     }
 
+    if (tls_ctx->include_metadata) {
+        JsonAddMetadata(p, f, js);
+    }
+
     json_t *tjs = json_object();
     if (tjs == NULL) {
         free(js);
@@ -565,6 +570,7 @@ static OutputInitResult OutputTlsLogInitSub(ConfNode *conf, OutputCtx *parent_ct
     }
 
     tls_ctx->file_ctx = ojc->file_ctx;
+    tls_ctx->include_metadata = ojc->include_metadata;
 
     if ((tls_ctx->fields & LOG_TLS_FIELD_CERTIFICATE) &&
             (tls_ctx->fields & LOG_TLS_FIELD_CHAIN)) {

