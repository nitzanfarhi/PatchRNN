commit bc0553df7b8d654eb2e8ba434692f487e05abd02
Author: Timo Sirainen <tss@iki.fi>
Date:   Sun Aug 14 20:41:44 2011 +0300

    fts: fts_expunge_log_uid_count() returned garbage on nonexistent log.

diff --git a/src/plugins/fts/fts-expunge-log.c b/src/plugins/fts/fts-expunge-log.c
index 0250051ad..9b6f05c4a 100644
--- a/src/plugins/fts/fts-expunge-log.c
+++ b/src/plugins/fts/fts-expunge-log.c
@@ -327,8 +327,10 @@ int fts_expunge_log_uid_count(struct fts_expunge_log *log,
 {
 	int ret;
 
-	if ((ret = fts_expunge_log_reopen_if_needed(log, FALSE)) <= 0)
+	if ((ret = fts_expunge_log_reopen_if_needed(log, FALSE)) <= 0) {
+		*expunges_r = 0;
 		return ret;
+	}
 
 	return fts_expunge_log_read_expunge_count(log, expunges_r);
 }

