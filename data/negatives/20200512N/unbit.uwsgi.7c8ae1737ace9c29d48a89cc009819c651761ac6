commit 7c8ae1737ace9c29d48a89cc009819c651761ac6
Author: Unbit <info@unbit.it>
Date:   Sun Feb 17 09:33:03 2013 +0100

    fixed reports in xmpp alarm

diff --git a/plugins/alarm_xmpp/gloox.cc b/plugins/alarm_xmpp/gloox.cc
index 767d3c5a..2aa01742 100644
--- a/plugins/alarm_xmpp/gloox.cc
+++ b/plugins/alarm_xmpp/gloox.cc
@@ -25,6 +25,8 @@ class Jabbo : public ConnectionListener{
 			p = strtok_r(NULL, ",", &ctx);
 		}
 
+		full_jid = jab_username;
+
         	JID jid(jab_username);
         	client = new Client( jid, jab_password );
         	client->registerConnectionListener(this);
@@ -52,11 +54,11 @@ class Jabbo : public ConnectionListener{
 		event_queue_add_fd_read(u_thread->queue, fd);
 		event_queue_add_fd_read(u_thread->queue, u_thread->pipe[1]);
 		u_connected = 1;
-		uwsgi_log("[uwsgi-alarm-xmpp] connected to the XMPP server\n");
+		uwsgi_log_alarm("-xmpp] (%s) connected to the XMPP server\n", full_jid);
     	}
 
     	virtual void onDisconnect(ConnectionError e) {
-		uwsgi_log("[uwsgi-alarm-xmpp] trying reconnect to the XMPP server...\n");
+		uwsgi_log_alarm("-xmpp] (%s) trying reconnect to the XMPP server...\n", full_jid);
 		if (u_connected) {
 			// no need to remove it as it is already closed...
 			//event_queue_del_fd(u_thread->queue, fd, event_queue_read());
@@ -69,12 +71,12 @@ class Jabbo : public ConnectionListener{
     	}
 
 	virtual void onResourceBindError(const Error *error) {
-		uwsgi_log("[uwsgi-alarm-xmpp] onResourceBindError(): %s\n", error->text().c_str());
+		uwsgi_log_alarm("-xmpp] (%s) onResourceBindError(): %s\n", full_jid, error->text().c_str());
 		client->disconnect();
 	}
 
 	virtual void onSessionCreateError(const Error *error) {
-		uwsgi_log("[uwsgi-alarm-xmpp] onSessionCreateError(): %s\n", error->text().c_str());
+		uwsgi_log_alarm("-xmpp] (%s) onSessionCreateError(): %s\n", full_jid, error->text().c_str());
 		client->disconnect();
 	}
 
@@ -83,6 +85,7 @@ class Jabbo : public ConnectionListener{
 	}
 
 	Client* client;
+	char *full_jid;
 	int fd;
 	int u_connected;
 	struct uwsgi_thread *u_thread;

