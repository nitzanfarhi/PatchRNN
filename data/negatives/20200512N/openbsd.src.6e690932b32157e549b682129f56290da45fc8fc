commit 6e690932b32157e549b682129f56290da45fc8fc
Author: deraadt <deraadt@openbsd.org>
Date:   Sat Oct 11 03:44:02 2014 +0000

    obvious reallocarray

diff --git a/libexec/rpc.rstatd/rstatd.c b/libexec/rpc.rstatd/rstatd.c
index 3df74833f90..925d55ee07d 100644
--- a/libexec/rpc.rstatd/rstatd.c
+++ b/libexec/rpc.rstatd/rstatd.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: rstatd.c,v 1.23 2009/10/27 23:59:31 deraadt Exp $	*/
+/*	$OpenBSD: rstatd.c,v 1.24 2014/10/11 03:44:02 deraadt Exp $	*/
 
 /*-
  * Copyright (c) 1993, John Brezak
@@ -161,7 +161,7 @@ my_svc_run(void)
 			exit(0);
 		}
 		if (svc_max_pollfd > saved_max_pollfd) {
-			newp = realloc(pfd, sizeof(*pfd) * svc_max_pollfd);
+			newp = reallocarray(pfd, svc_max_pollfd, sizeof(*pfd));
 			if (newp == NULL) {
 				free(pfd);
 				perror("svc_run: - realloc failed");
@@ -170,7 +170,7 @@ my_svc_run(void)
 			pfd = newp;
 			saved_max_pollfd = svc_max_pollfd;
 		}
-		memcpy(pfd, svc_pollfd, sizeof(*pfd) * svc_max_pollfd);
+		memcpy(pfd, svc_pollfd, svc_max_pollfd * sizeof(*pfd));
 
 		nready = poll(pfd, svc_max_pollfd, INFTIM);
 		switch (nready) {

