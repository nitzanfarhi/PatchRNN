commit 30e2bab2d6e22188c6d36a09cdcffb4748d2dbe5
Author: Miao Xie <miaox@cn.fujitsu.com>
Date:   Thu May 27 16:28:40 2010 +0800

    ext3: update ctime when changing the file's permission by setfacl
    
    ext3 didn't update the ctime of the file when its permission was changed.
    
    Steps to reproduce:
     # touch aaa
     # stat -c %Z aaa
     1275289822
     # setfacl -m  'u::x,g::x,o::x' aaa
     # stat -c %Z aaa
     1275289822                             <- unchanged
    
    But, according to the spec of the ctime, ext3 must update it.
    
    Signed-off-by: Miao Xie <miaox@cn.fujitsu.com>
    Signed-off-by: Jan Kara <jack@suse.cz>

diff --git a/fs/ext3/acl.c b/fs/ext3/acl.c
index 01552abbca3c..8a11fe212183 100644
--- a/fs/ext3/acl.c
+++ b/fs/ext3/acl.c
@@ -205,6 +205,7 @@ ext3_set_acl(handle_t *handle, struct inode *inode, int type,
 					return error;
 				else {
 					inode->i_mode = mode;
+					inode->i_ctime = CURRENT_TIME_SEC;
 					ext3_mark_inode_dirty(handle, inode);
 					if (error == 0)
 						acl = NULL;

