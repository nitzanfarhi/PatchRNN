commit b9b8874f8fd541a71491cb0cf44cf72afcbcf0db
Author: Yu Watanabe <watanabe.yu+github@gmail.com>
Date:   Wed Aug 8 12:48:47 2018 +0900

    journal: fix size of buffer

diff --git a/src/journal/journald-syslog.c b/src/journal/journald-syslog.c
index dc192d5a7..031c7adee 100644
--- a/src/journal/journald-syslog.c
+++ b/src/journal/journald-syslog.c
@@ -406,7 +406,7 @@ void server_process_syslog_message(
         if (syslog_ts_len > 0) {
                 const size_t hlen = strlen("SYSLOG_TIMESTAMP=");
 
-                t = newa(char, hlen + raw_len);
+                t = newa(char, hlen + syslog_ts_len);
                 memcpy(t, "SYSLOG_TIMESTAMP=", hlen);
                 memcpy(t + hlen, syslog_ts, syslog_ts_len);
 

