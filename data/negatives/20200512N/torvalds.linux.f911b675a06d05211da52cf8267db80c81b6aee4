commit f911b675a06d05211da52cf8267db80c81b6aee4
Author: Julian Anastasov <ja@ssi.bg>
Date:   Sat Mar 5 15:03:23 2016 +0200

    ipvs: allow rescheduling after RST
    
    "RFC 5961, 4.2. Mitigation" describes a mechanism to request
    client to confirm with RST the restart of TCP connection
    before resending its SYN. As result, IPVS can see SYNs for
    existing connection in CLOSE state. Add check to allow
    rescheduling in this state.
    
    Signed-off-by: Julian Anastasov <ja@ssi.bg>
    Signed-off-by: Simon Horman <horms@verge.net.au>

diff --git a/net/netfilter/ipvs/ip_vs_core.c b/net/netfilter/ipvs/ip_vs_core.c
index 4da560005b0e..b9a4082afa3a 100644
--- a/net/netfilter/ipvs/ip_vs_core.c
+++ b/net/netfilter/ipvs/ip_vs_core.c
@@ -1089,6 +1089,7 @@ static inline bool is_new_conn_expected(const struct ip_vs_conn *cp,
 	switch (cp->protocol) {
 	case IPPROTO_TCP:
 		return (cp->state == IP_VS_TCP_S_TIME_WAIT) ||
+		       (cp->state == IP_VS_TCP_S_CLOSE) ||
 			((conn_reuse_mode & 2) &&
 			 (cp->state == IP_VS_TCP_S_FIN_WAIT) &&
 			 (cp->flags & IP_VS_CONN_F_NOOUTPUT));

