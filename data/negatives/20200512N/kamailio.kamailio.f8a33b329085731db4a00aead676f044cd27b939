commit f8a33b329085731db4a00aead676f044cd27b939
Author: Andrei Pelinescu-Onciul <andrei@iptel.org>
Date:   Mon May 4 10:41:07 2009 +0200

    core expr eval: fix script functions failure check
    
    script/module functions integer/boolean evaluation did not respect
    the module return convention (>0 success, <0 failure).
    
    Reported-by: Daniel-Constantin Mierla <miconda@gmail.com>

diff --git a/rvalue.c b/rvalue.c
index 897fb4d97..f75c6e97f 100644
--- a/rvalue.c
+++ b/rvalue.c
@@ -693,8 +693,8 @@ int rval_get_int(struct run_act_ctx* h, struct sip_msg* msg,
 			break;
 		case RV_ACTION_ST:
 			if (rv->v.action)
-				*i=run_actions(h, rv->v.action, msg);
-			else 
+				*i=(run_actions(h, rv->v.action, msg)>0);
+			else
 				*i=0;
 			break;
 		case RV_SEL:
@@ -796,8 +796,8 @@ int rval_get_tmp_str(struct run_act_ctx* h, struct sip_msg* msg,
 			break;
 		case RV_ACTION_ST:
 			if (rv->v.action)
-				i=run_actions(h, rv->v.action, msg);
-			else 
+				i=(run_actions(h, rv->v.action, msg)>0);
+			else
 				i=0;
 			tmpv->s=int2str(i, &tmpv->len);
 			break;

