commit 8ec37034ef36b89cfb060bd9273db24e6acb1b3a
Author: Johan Hedberg <johan.hedberg@intel.com>
Date:   Wed Feb 22 22:02:50 2012 +0200

    Bluetooth: mgmt: Fix return value for set_class
    
    The return parameters for Set Device Class should consist of the new
    class value.
    
    Signed-off-by: Johan Hedberg <johan.hedberg@intel.com>
    Acked-by: Marcel Holtmann <marcel@holtmann.org>

diff --git a/net/bluetooth/mgmt.c b/net/bluetooth/mgmt.c
index 6850a8b46c62..23421f05abf2 100644
--- a/net/bluetooth/mgmt.c
+++ b/net/bluetooth/mgmt.c
@@ -1470,7 +1470,7 @@ static int set_dev_class(struct sock *sk, u16 index, void *data, u16 len)
 
 	if (err == 0)
 		err = cmd_complete(sk, index, MGMT_OP_SET_DEV_CLASS, 0,
-								NULL, 0);
+							hdev->dev_class, 3);
 
 unlock:
 	hci_dev_unlock(hdev);

