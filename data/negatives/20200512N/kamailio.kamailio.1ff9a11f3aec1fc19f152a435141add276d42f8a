commit 1ff9a11f3aec1fc19f152a435141add276d42f8a
Author: Daniel-Constantin Mierla <miconda@gmail.com>
Date:   Wed Jan 31 10:16:50 2007 +0000

    - proper translation of parsed_uri for To/From headers (reported by Norman Brandiger)
    
    
    git-svn-id: https://openser.svn.sourceforge.net/svnroot/openser/trunk@1556 689a6050-402a-0410-94f2-e92a70836424

diff --git a/modules_k/tm/sip_msg.c b/modules_k/tm/sip_msg.c
index b9ccc624c..bf3fbac30 100644
--- a/modules_k/tm/sip_msg.c
+++ b/modules_k/tm/sip_msg.c
@@ -582,10 +582,10 @@ do { \
 					((struct to_body*)new_hdr->parsed)->tag_value.s =
 						translate_pointer( new_msg->buf , org_msg->buf ,
 						((struct to_body*)hdr->parsed)->tag_value.s );
-				if ( (((struct to_body*)hdr->parsed)->parsed_uri.user.s)
-				|| (((struct to_body*)hdr->parsed)->parsed_uri.host.s) )
+				if ( (((struct to_body*)new_hdr->parsed)->parsed_uri.user.s)
+				|| (((struct to_body*)new_hdr->parsed)->parsed_uri.host.s) )
 					uri_trans(new_msg->buf, org_msg->buf,
-							&((struct to_body*)hdr->parsed)->parsed_uri);
+							&((struct to_body*)new_hdr->parsed)->parsed_uri);
 
 				/*to params*/
 				to_prm = ((struct to_body*)(hdr->parsed))->param_lst;

