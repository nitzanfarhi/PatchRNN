commit 07535a890200e640517be0ae04fcff28860ecd37
Author: Stephan Kulow <coolo@suse.de>
Date:   Wed Jul 23 16:03:14 2014 +0200

    fix full frame updates for VNC clients
    
    If the client asks for !incremental frame updates, it has lost its content
    so dirty doesn't matter - it has to see the full frame, so setting force_update
    
    Signed-off-by: Stephan Kulow <coolo@suse.de>
    Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
    Reviewed-by: Peter Lieven <pl@kamp.de>

diff --git a/ui/vnc.c b/ui/vnc.c
index 548588aab8..06d6ca009e 100644
--- a/ui/vnc.c
+++ b/ui/vnc.c
@@ -1878,6 +1878,7 @@ static void framebuffer_update_request(VncState *vs, int incremental,
         return;
     }
 
+    vs->force_update = 1;
     vnc_set_area_dirty(vs->dirty, width, height, x, y, w, h);
 }
 

