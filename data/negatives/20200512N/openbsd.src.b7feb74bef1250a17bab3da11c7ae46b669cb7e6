commit b7feb74bef1250a17bab3da11c7ae46b669cb7e6
Author: bluhm <bluhm@openbsd.org>
Date:   Thu Jan 6 14:01:36 2011 +0000

    Put htons() around ip_randomid() for pf scrub random-id to make it
    consistent with the network stack.
    ok mcbride@ henning@

diff --git a/sys/net/pf_norm.c b/sys/net/pf_norm.c
index 8df15a68c31..356927177ef 100644
--- a/sys/net/pf_norm.c
+++ b/sys/net/pf_norm.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: pf_norm.c,v 1.124 2010/12/31 12:26:57 bluhm Exp $ */
+/*	$OpenBSD: pf_norm.c,v 1.125 2011/01/06 14:01:36 bluhm Exp $ */
 
 /*
  * Copyright 2001 Niels Provos <provos@citi.umich.edu>
@@ -1333,7 +1333,7 @@ pf_scrub_ip(struct mbuf **m0, u_int16_t flags, u_int8_t min_ttl, u_int8_t tos)
 	if (flags & PFSTATE_RANDOMID && !(h->ip_off & ~htons(IP_DF))) {
 		u_int16_t ip_id = h->ip_id;
 
-		h->ip_id = ip_randomid();
+		h->ip_id = htons(ip_randomid());
 		h->ip_sum = pf_cksum_fixup(h->ip_sum, ip_id, h->ip_id, 0);
 	}
 }

