commit e81a362b5f0622f6b431eee56fb0aac888a8f18c
Author: Con Kolivas <kernel@kolivas.org>
Date:   Thu Aug 25 23:33:41 2011 +1000

    Bump threshhold for lag up to maximum queued but no staged work.

diff --git a/main.c b/main.c
index 05105dc1..9daf28ce 100644
--- a/main.c
+++ b/main.c
@@ -3103,7 +3103,8 @@ retry:
 			ret = true;
 			goto out;
 		}
-		if (requested && requests_queued() > 1 && !pool_tset(pool, &pool->lagging)) {
+		if (requested && requests_queued() >= opt_queue + mining_threads &&
+		    !pool_tset(pool, &pool->lagging)) {
 			applog(LOG_WARNING, "Pool %d not providing work fast enough",
 				pool->pool_no);
 			pool->localgen_occasions++;

