commit fb4bd0adc4b5b6538933b098a67851d8f99b5ca3
Author: Jaroslav Kysela <perex@suse.cz>
Date:   Tue May 31 15:44:23 2005 +0200

    [ALSA] OSS PCM emulation - The final fix for SNDCTL_DSP_GETOPTR problem
    
    ALSA<-OSS emulation
    The problem was negative result (info.bytes) in a specific condition at
    playback startup.
    
    Signed-off-by: Jaroslav Kysela <perex@suse.cz>

diff --git a/sound/core/oss/pcm_oss.c b/sound/core/oss/pcm_oss.c
index 468fca8894d9..203470df5857 100644
--- a/sound/core/oss/pcm_oss.c
+++ b/sound/core/oss/pcm_oss.c
@@ -1539,10 +1539,13 @@ static int snd_pcm_oss_get_ptr(snd_pcm_oss_file_t *pcm_oss_file, int stream, str
 	} else {
 		delay = snd_pcm_oss_bytes(substream, delay) + fixup;
 		info.blocks = delay / runtime->oss.period_bytes;
-		if (stream == SNDRV_PCM_STREAM_PLAYBACK)
+		if (stream == SNDRV_PCM_STREAM_PLAYBACK) {
+			if (runtime->oss.bytes == 0)
+				delay = 0;
 			info.bytes = (runtime->oss.bytes - delay) & INT_MAX;
-		else
+		} else {
 			info.bytes = (runtime->oss.bytes + delay) & INT_MAX;
+		}
 	}
 	if (copy_to_user(_info, &info, sizeof(info)))
 		return -EFAULT;

