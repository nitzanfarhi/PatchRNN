commit f691ba36d5cbce8346bee8661b4553c830fd86af
Author: macvicar <macvicar@facebook.com>
Date:   Sat Aug 14 17:58:25 2010 -0700

    Make gettimeofday() match the PHP implementation
    
    Summary:
    The PHP implementation of gettimeofday() returns an integer
    instead of a boolean for dsttime.
    
    (even if the value really is a boolean)
    
    Some code does a strict match so things will fail.
    
    Test Plan:
    Make sure dsttime is an integer
    
    <?php
    
    var_dump(gettimeofday()));
    
    DiffCamp Revision: 145849
    Reviewed By: hzhao
    CC: hphp-diffs@lists, hzhao
    Revert Plan:
    OK

diff --git a/src/runtime/base/time/timestamp.cpp b/src/runtime/base/time/timestamp.cpp
index 48cd36ef19..fd62062c28 100644
--- a/src/runtime/base/time/timestamp.cpp
+++ b/src/runtime/base/time/timestamp.cpp
@@ -44,7 +44,7 @@ Array TimeStamp::CurrentTime() {
   ret.set("sec", (int)tp.tv_sec);
   ret.set("usec", (int)tp.tv_usec);
   ret.set("minuteswest", (int)(-offset->offset / 60));
-  ret.set("dsttime", (bool)offset->is_dst);
+  ret.set("dsttime", (int)offset->is_dst);
 
   timelib_time_offset_dtor(offset);
   return ret;

