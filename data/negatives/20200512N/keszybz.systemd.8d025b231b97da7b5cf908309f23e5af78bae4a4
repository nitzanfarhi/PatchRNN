commit 8d025b231b97da7b5cf908309f23e5af78bae4a4
Author: Lennart Poettering <lennart@poettering.net>
Date:   Fri Apr 23 23:26:19 2010 +0200

    main: don't open console in --test mode

diff --git a/main.c b/main.c
index 5b23c937b..d2721fd09 100644
--- a/main.c
+++ b/main.c
@@ -615,7 +615,7 @@ int main(int argc, char *argv[]) {
 
         /* Reset the console, but only if this is really init and we
          * are freshly booted */
-        if (running_as == MANAGER_INIT)
+        if (running_as == MANAGER_INIT && action == ACTION_RUN)
                 console_setup(getpid() == 1 && !serialization);
 
         /* Make sure D-Bus doesn't fiddle with the SIGPIPE handlers */

