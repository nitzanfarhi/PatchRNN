commit 967f617aa7992e889d514d5e7fd60709dd14bfa3
Author: Kristina Chodorow <k@ubuntu.(none)>
Date:   Wed Sep 8 15:40:21 2010 -0400

    fix balancing of escaped //s SERVER-1758

diff --git a/shell/dbshell.cpp b/shell/dbshell.cpp
index 798b4e0cfd..00273ba3ad 100644
--- a/shell/dbshell.cpp
+++ b/shell/dbshell.cpp
@@ -354,6 +354,9 @@ bool isBalanced( string code ){
             i++;
             while ( i < code.size() && code[i] != '\'' ) i++;
             break;
+        case '\\':
+            if ( i+1 < code.size() && code[i+1] == '/') i++;
+            continue;
         }
     }
 
@@ -373,6 +376,8 @@ public:
         assert( isBalanced( "// {" ) );
         assert( ! isBalanced( "// \n {" ) );
         assert( ! isBalanced( "\"//\" {" ) );
+        assert( isBalanced( "{x:/x\\//}" ) );
+        assert( ! isBalanced( "{ \\/// }" ) );
 
     }
 } balnaced_test;

