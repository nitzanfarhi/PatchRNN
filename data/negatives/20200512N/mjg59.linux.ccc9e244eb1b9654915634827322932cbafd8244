commit ccc9e244eb1b9654915634827322932cbafd8244
Author: Laura Abbott <lauraa@codeaurora.org>
Date:   Tue Feb 4 23:08:57 2014 +0000

    arm64: Align CMA sizes to PAGE_SIZE
    
    dma_alloc_from_contiguous takes number of pages for a size.
    Align up the dma size passed in to page size to avoid truncation
    and allocation failures on sizes less than PAGE_SIZE.
    
    Cc: Will Deacon <will.deacon@arm.com>
    Signed-off-by: Laura Abbott <lauraa@codeaurora.org>
    Signed-off-by: Catalin Marinas <catalin.marinas@arm.com>

diff --git a/arch/arm64/mm/dma-mapping.c b/arch/arm64/mm/dma-mapping.c
index 45b5ab54c9ee..fbd76785c5db 100644
--- a/arch/arm64/mm/dma-mapping.c
+++ b/arch/arm64/mm/dma-mapping.c
@@ -45,6 +45,7 @@ static void *arm64_swiotlb_alloc_coherent(struct device *dev, size_t size,
 	if (IS_ENABLED(CONFIG_DMA_CMA)) {
 		struct page *page;
 
+		size = PAGE_ALIGN(size);
 		page = dma_alloc_from_contiguous(dev, size >> PAGE_SHIFT,
 							get_order(size));
 		if (!page)

