commit 2aa080fc933cac47205bc79f026fc89dab0e5149
Author: Bruce Momjian <bruce@momjian.us>
Date:   Mon Aug 31 17:49:18 1998 +0000

    indexing.c cleanups.

diff --git a/src/backend/catalog/index.c b/src/backend/catalog/index.c
index 4a46528e0f..260f29d98c 100644
--- a/src/backend/catalog/index.c
+++ b/src/backend/catalog/index.c
@@ -7,7 +7,7 @@
  *
  *
  * IDENTIFICATION
- *	  $Header: /cvsroot/pgsql/src/backend/catalog/index.c,v 1.57 1998/08/28 04:57:19 momjian Exp $
+ *	  $Header: /cvsroot/pgsql/src/backend/catalog/index.c,v 1.58 1998/08/31 17:49:16 momjian Exp $
  *
  *
  * INTERFACE ROUTINES
@@ -1281,8 +1281,7 @@ FormIndexDatum(int numberOfAttributes,
 	{
 		offset = AttrNumberGetAttrOffset(i);
 
-		datum[offset] =
-			PointerGetDatum(GetIndexValue(heapTuple,
+		datum[offset] =	PointerGetDatum(GetIndexValue(heapTuple,
 										  heapDescriptor,
 										  offset,
 										  attributeNumber,
diff --git a/src/backend/catalog/indexing.c b/src/backend/catalog/indexing.c
index 504cca5c3f..86a3c0d68b 100644
--- a/src/backend/catalog/indexing.c
+++ b/src/backend/catalog/indexing.c
@@ -8,7 +8,7 @@
  *
  *
  * IDENTIFICATION
- *	  $Header: /cvsroot/pgsql/src/backend/catalog/indexing.c,v 1.23 1998/08/30 23:25:55 momjian Exp $
+ *	  $Header: /cvsroot/pgsql/src/backend/catalog/indexing.c,v 1.24 1998/08/31 17:49:17 momjian Exp $
  *
  *-------------------------------------------------------------------------
  */
@@ -132,8 +132,7 @@ CatalogIndexInsert(Relation *idescs,
 		pgIndexP = (IndexTupleForm) GETSTRUCT(pgIndexTup);
 
 		/*
-		 * Compute the number of attributes we are indexing upon. very
-		 * important - can't assume one if this is a functional index.
+		 * Compute the number of attributes we are indexing upon.
 		 */
 		for (attnumP = (&pgIndexP->indkey[0]), natts = 0;
 			 *attnumP != InvalidAttrNumber;
@@ -301,7 +300,7 @@ AttributeNumIndexScan(Relation heapRelation,
 						   (bits16) 0x0,
 						   (AttrNumber) 1,
 						   (RegProcedure)F_OIDEQ,
-						   Int32GetDatum(relid));
+						   ObjectIdGetDatum(relid));
 
 	ScanKeyEntryInitialize(&skey[1],
 						   (bits16) 0x0,
diff --git a/src/backend/catalog/pg_proc.c b/src/backend/catalog/pg_proc.c
index 5cd560907b..2e83652ac8 100644
--- a/src/backend/catalog/pg_proc.c
+++ b/src/backend/catalog/pg_proc.c
@@ -7,7 +7,7 @@
  *
  *
  * IDENTIFICATION
- *	  $Header: /cvsroot/pgsql/src/backend/catalog/pg_proc.c,v 1.20 1998/08/24 01:37:47 momjian Exp $
+ *	  $Header: /cvsroot/pgsql/src/backend/catalog/pg_proc.c,v 1.21 1998/08/31 17:49:18 momjian Exp $
  *
  *-------------------------------------------------------------------------
  */
@@ -129,7 +129,6 @@ ProcedureCreate(char *procedureName,
 
 	if (!strcmp(languageName, "sql"))
 	{
-
 		/*
 		 * If this call is defining a set, check if the set is already
 		 * defined by looking to see whether this call's function text
@@ -142,6 +141,7 @@ ProcedureCreate(char *procedureName,
 			tup = SearchSysCacheTuple(PROSRC,
 									  PointerGetDatum(prosrctext),
 									  0, 0, 0);
+			pfree(prosrctext);
 			if (HeapTupleIsValid(tup))
 				return tup->t_oid;
 		}
@@ -152,8 +152,7 @@ ProcedureCreate(char *procedureName,
 							  0, 0, 0);
 
 	if (!HeapTupleIsValid(tup))
-		elog(ERROR, "ProcedureCreate: no such language %s",
-			 languageName);
+		elog(ERROR, "ProcedureCreate: no such language %s", languageName);
 
 	languageObjectId = tup->t_oid;
 

