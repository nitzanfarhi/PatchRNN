commit 024c059fae2eb7bab2bc8b50cc7b5afccae34916
Author: Nick Mathewson <nickm@torproject.org>
Date:   Thu Apr 8 03:05:08 2004 +0000

    Force tor_malloc(0) to always be sane
    
    
    svn:r1558

diff --git a/src/common/util.c b/src/common/util.c
index 935aadea9..c5dd6aa97 100644
--- a/src/common/util.c
+++ b/src/common/util.c
@@ -69,6 +69,10 @@
 void *tor_malloc(size_t size) {
   void *result;
 
+  /* Some libcs don't do the right thing on size==0. Override them. */
+  if (size==0) {
+    size=1;
+  }
   result = malloc(size);
 
   if(!result) {

