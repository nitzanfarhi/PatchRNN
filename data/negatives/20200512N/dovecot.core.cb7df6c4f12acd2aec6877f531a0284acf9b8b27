commit cb7df6c4f12acd2aec6877f531a0284acf9b8b27
Author: Timo Sirainen <tss@iki.fi>
Date:   Tue Feb 25 21:10:45 2003 +0200

    Don't delete ".." dirs outside our imap root.
    
    --HG--
    branch : HEAD

diff --git a/src/lib-storage/index/maildir/maildir-list.c b/src/lib-storage/index/maildir/maildir-list.c
index 255c1570a..2fbba6ec2 100644
--- a/src/lib-storage/index/maildir/maildir-list.c
+++ b/src/lib-storage/index/maildir/maildir-list.c
@@ -231,8 +231,9 @@ static struct mailbox_list *maildir_list_next(struct mailbox_list_context *ctx)
 			   or the process trying to delete it had died.
 
 			   delete it ourself if it's been there longer than
-			   one hour */
-			if (st.st_mtime < 3600)
+			   one hour. don't touch it if it's outside our
+			   mail root dir. */
+			if (st.st_mtime < 3600 && *ctx->prefix == '\0')
 				(void)unlink_directory(path, TRUE);
 			continue;
 		}

