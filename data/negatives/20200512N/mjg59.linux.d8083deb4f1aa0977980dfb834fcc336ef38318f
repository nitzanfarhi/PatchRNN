commit d8083deb4f1aa0977980dfb834fcc336ef38318f
Author: Stephen Hemminger <shemminger@vyatta.com>
Date:   Fri May 13 16:03:24 2011 -0400

    bridge: fix forwarding of IPv6
    
    The commit 6b1e960fdbd75dcd9bcc3ba5ff8898ff1ad30b6e
        bridge: Reset IPCB when entering IP stack on NF_FORWARD
    broke forwarding of IPV6 packets in bridge because it would
    call bp_parse_ip_options with an IPV6 packet.
    
    Reported-by: Noah Meyerhans <noahm@debian.org>
    Signed-off-by: Stephen Hemminger <shemminger@vyatta.com>
    Reviewed-by: Eric Dumazet <eric.dumazet@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>

diff --git a/net/bridge/br_netfilter.c b/net/bridge/br_netfilter.c
index f3bc322c5891..74ef4d4846a4 100644
--- a/net/bridge/br_netfilter.c
+++ b/net/bridge/br_netfilter.c
@@ -737,7 +737,7 @@ static unsigned int br_nf_forward_ip(unsigned int hook, struct sk_buff *skb,
 		nf_bridge->mask |= BRNF_PKT_TYPE;
 	}
 
-	if (br_parse_ip_options(skb))
+	if (pf == PF_INET && br_parse_ip_options(skb))
 		return NF_DROP;
 
 	/* The physdev module checks on this */

