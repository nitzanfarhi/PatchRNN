commit 21e75891b7e9fed4a6cffa99852278a2347e3b41
Author: Gilbert Clark gc355804@ohio.edu <gilbert@junkshot.icir.org>
Date:   Tue Jul 5 17:36:29 2011 -0700

    Adding 'delete' fixes into fastpath.

diff --git a/src/LogMgr.cc b/src/LogMgr.cc
index 0925e9953..b28e9a513 100644
--- a/src/LogMgr.cc
+++ b/src/LogMgr.cc
@@ -951,6 +951,8 @@ bool LogMgr::Write(EnumVal* id, RecordVal* columns)
 		DBG_LOG(DBG_LOGGING, "Wrote record to filter '%s' on stream '%s'",
 			filter->name.c_str(), stream->name.c_str());
 #endif
+		
+		delete[] vals;
 		}
 
 	Unref(columns);
@@ -1041,6 +1043,7 @@ LogVal* LogMgr::ValToLogVal(Val* val, BroType* ty)
 		for ( int i = 0; i < lval->val.set_val.size; i++ )
 			lval->val.set_val.vals[i] = ValToLogVal(set->Index(i));
 
+		delete set;
 		break;
 		}
 
diff --git a/src/LogWriter.cc b/src/LogWriter.cc
index 6e12e3a6e..d1e4245ab 100644
--- a/src/LogWriter.cc
+++ b/src/LogWriter.cc
@@ -16,6 +16,9 @@ LogWriter::~LogWriter()
 	if ( buf )
 		free(buf);
 
+	for(int i = 0; i < num_fields; ++i)
+		delete fields[i];
+	
 	delete [] fields;
 	}
 

