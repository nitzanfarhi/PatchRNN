commit bb8f2b0773a14232c6b99b0f70ff950130c7e315
Author: pancake <pancake@nopcode.org>
Date:   Tue Jul 31 21:03:31 2018 +0100

    Fix #10865 - hang_03 - skip invalid sections when marking data words

diff --git a/binr/radare2/radare2.c b/binr/radare2/radare2.c
index 1c43c8e10..bf023f047 100644
--- a/binr/radare2/radare2.c
+++ b/binr/radare2/radare2.c
@@ -1439,7 +1439,7 @@ int main(int argc, char **argv, char **envp) {
 		}
 	}
 
-	if (mustSaveHistory(r.config)) {
+	if (mustSaveHistory (r.config)) {
 		r_line_hist_save (R2_HOME_HISTORY);
 	}
 	// TODO: kill thread
diff --git a/libr/anal/meta.c b/libr/anal/meta.c
index 87cfed31f..c84c2b69f 100644
--- a/libr/anal/meta.c
+++ b/libr/anal/meta.c
@@ -34,7 +34,7 @@ Keys:
 static char *meta_inrange_get (RAnal *a, ut64 addr, int size) {
 	ut64 base = META_RANGE_BASE (addr);
 	ut64 base2 = META_RANGE_BASE (addr + size) + 1;
-	char * res = NULL;
+	char *res = NULL;
 	// return string array of all the offsets where there are stuff
 	for (; base < base2; base += META_RANGE_SIZE) {
 		const char *key = sdb_fmt ("range.0x%"PFMT64x, base);
diff --git a/libr/bin/p/bin_mach0.c b/libr/bin/p/bin_mach0.c
index e61bf7885..4de10798a 100644
--- a/libr/bin/p/bin_mach0.c
+++ b/libr/bin/p/bin_mach0.c
@@ -134,7 +134,9 @@ static RList* sections(RBinFile *bf) {
 			const int sz = 8;
 #endif
 			int len = sections[i].size / sz;
-			ptr->format = r_str_newf ("Cd %d[%d]", sz, len);
+			if (len < bf->size) {
+				ptr->format = r_str_newf ("Cd %d[%d]", sz, len);
+			}
 		}
 		ptr->name[R_BIN_SIZEOF_STRINGS] = 0;
 		handle_data_sections (ptr);

