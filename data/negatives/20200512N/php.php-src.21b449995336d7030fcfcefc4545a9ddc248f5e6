commit 21b449995336d7030fcfcefc4545a9ddc248f5e6
Author: Moriyoshi Koizumi <moriyoshi@php.net>
Date:   Sat Jan 18 18:31:13 2003 +0000

    Fixed bug #21726 and #21730

diff --git a/ext/standard/scanf.c b/ext/standard/scanf.c
index b1277379a3..9983ecb721 100644
--- a/ext/standard/scanf.c
+++ b/ext/standard/scanf.c
@@ -762,9 +762,9 @@ PHPAPI int php_sscanf_internal(	char *string, char *format,
             case 'n':
                 if (!(flags & SCAN_SUPPRESS)) {
                     if (numVars) {
-                        current = args[objIndex++];
-                        convert_to_long( *current );
-                        ZVAL_STRINGL( *current, string, end-string, 1);
+						current = args[objIndex++];
+                        zval_dtor( *current );
+                        ZVAL_LONG( *current, (long)(string - baseString) );
                     } else {
                         add_index_long(*return_value, objIndex++, string - baseString);
                     }
@@ -883,8 +883,8 @@ PHPAPI int php_sscanf_internal(	char *string, char *format,
             if (!(flags & SCAN_SUPPRESS)) {
                 if (numVars) {
                     current = args[objIndex++];
-                    convert_to_string( *current );
-                    ZVAL_STRINGL( *current, string, end-string, 1);
+					zval_dtor( *current );
+					ZVAL_STRINGL( *current, string, end-string, 1);
                 } else {
                     add_index_stringl( *return_value, objIndex++, string, end-string, 1);
                 }

