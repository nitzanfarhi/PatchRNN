commit 0d93a06bc1c3ec3eac6851b7dd8ff86108e8f9b8
Author: kettenis <kettenis@openbsd.org>
Date:   Sun Jun 26 20:32:36 2011 +0000

    Fix some inconsistencies in how we build 64-bit addresses from OF properties.

diff --git a/sys/arch/sparc64/dev/psycho.c b/sys/arch/sparc64/dev/psycho.c
index 6f2d3232cf1..97da3a46080 100644
--- a/sys/arch/sparc64/dev/psycho.c
+++ b/sys/arch/sparc64/dev/psycho.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: psycho.c,v 1.67 2010/12/04 17:06:32 miod Exp $	*/
+/*	$OpenBSD: psycho.c,v 1.68 2011/06/26 20:32:36 kettenis Exp $	*/
 /*	$NetBSD: psycho.c,v 1.39 2001/10/07 20:30:41 eeh Exp $	*/
 
 /*
@@ -1027,7 +1027,7 @@ psycho_bus_map(bus_space_tag_t t, bus_space_tag_t t0, bus_addr_t offset,
 			continue;
 
 		paddr = pp->pp_range[i].phys_lo + offset;
-		paddr |= ((bus_addr_t)pp->pp_range[i].phys_hi << 32);
+		paddr |= ((bus_addr_t)pp->pp_range[i].phys_hi) << 32;
 		DPRINTF(PDB_BUSMAP,
 		    ("\n_psycho_bus_map: mapping paddr space %lx offset %lx "
 			"paddr %qx",
@@ -1066,7 +1066,7 @@ psycho_bus_mmap(bus_space_tag_t t, bus_space_tag_t t0, bus_addr_t paddr,
 			continue;
 
 		paddr = pp->pp_range[i].phys_lo + offset;
-		paddr |= ((bus_addr_t)pp->pp_range[i].phys_hi << 32);
+		paddr |= ((bus_addr_t)pp->pp_range[i].phys_hi) << 32;
 		DPRINTF(PDB_BUSMAP, ("\npsycho_bus_mmap: mapping paddr "
 		    "space %lx offset %lx paddr %qx",
 		    (long)ss, (long)offset,
diff --git a/sys/arch/sparc64/dev/pyro.c b/sys/arch/sparc64/dev/pyro.c
index aad1360d6e6..77cc1b4e17c 100644
--- a/sys/arch/sparc64/dev/pyro.c
+++ b/sys/arch/sparc64/dev/pyro.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: pyro.c,v 1.20 2010/12/05 15:15:14 kettenis Exp $	*/
+/*	$OpenBSD: pyro.c,v 1.21 2011/06/26 20:32:36 kettenis Exp $	*/
 
 /*
  * Copyright (c) 2002 Jason L. Wright (jason@thought.net)
@@ -494,7 +494,7 @@ _pyro_bus_mmap(bus_space_tag_t t, bus_space_tag_t t0, bus_addr_t paddr,
 			continue;
 
 		paddr = pbm->pp_range[i].phys_lo + offset;
-		paddr |= ((bus_addr_t)pbm->pp_range[i].phys_hi<<32);
+		paddr |= ((bus_addr_t)pbm->pp_range[i].phys_hi) << 32;
 		return ((*t->parent->sparc_bus_mmap)
 		    (t, t0, paddr, off, prot, flags));
 	}
diff --git a/sys/arch/sparc64/dev/schizo.c b/sys/arch/sparc64/dev/schizo.c
index 5d6e6ef89c3..1ed9e1b525d 100644
--- a/sys/arch/sparc64/dev/schizo.c
+++ b/sys/arch/sparc64/dev/schizo.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: schizo.c,v 1.61 2010/12/04 17:06:32 miod Exp $	*/
+/*	$OpenBSD: schizo.c,v 1.62 2011/06/26 20:32:36 kettenis Exp $	*/
 
 /*
  * Copyright (c) 2002 Jason L. Wright (jason@thought.net)
@@ -714,7 +714,7 @@ schizo_bus_mmap(bus_space_tag_t t, bus_space_tag_t t0, bus_addr_t paddr,
 			continue;
 
 		paddr = pbm->sp_range[i].phys_lo + offset;
-		paddr |= ((bus_addr_t)pbm->sp_range[i].phys_hi<<32);
+		paddr |= ((bus_addr_t)pbm->sp_range[i].phys_hi) << 32;
 		return ((*t->parent->sparc_bus_mmap)
 		    (t, t0, paddr, off, prot, flags));
 	}
diff --git a/sys/arch/sparc64/dev/vpci.c b/sys/arch/sparc64/dev/vpci.c
index 147c3e6a6e4..94dbda8a8f9 100644
--- a/sys/arch/sparc64/dev/vpci.c
+++ b/sys/arch/sparc64/dev/vpci.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: vpci.c,v 1.6 2010/12/05 15:15:14 kettenis Exp $	*/
+/*	$OpenBSD: vpci.c,v 1.7 2011/06/26 20:32:36 kettenis Exp $	*/
 /*
  * Copyright (c) 2008 Mark Kettenis <kettenis@openbsd.org>
  *
@@ -400,7 +400,7 @@ vpci_bus_mmap(bus_space_tag_t t, bus_space_tag_t t0, bus_addr_t paddr,
 			continue;
 
 		paddr = pbm->vp_range[i].phys_lo + offset;
-		paddr |= ((bus_addr_t)pbm->vp_range[i].phys_hi<<32);
+		paddr |= ((bus_addr_t)pbm->vp_range[i].phys_hi) << 32;
 		return ((*t->parent->sparc_bus_mmap)
 		    (t, t0, paddr, off, prot, flags));
 	}

