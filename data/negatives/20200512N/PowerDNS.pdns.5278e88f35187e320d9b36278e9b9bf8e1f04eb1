commit 5278e88f35187e320d9b36278e9b9bf8e1f04eb1
Author: Bert Hubert <bert.hubert@netherlabs.nl>
Date:   Mon Dec 21 20:33:22 2009 +0000

    this may _finally_ solve the complaints about 'mysql server has gone away'
    Backend error: Failed to execute mysql_query, perhaps connection died? Err=1: MySQL server has gone away
    Closes ticket 237
    
    
    git-svn-id: svn://svn.powerdns.com/pdns/trunk/pdns@1461 d19b8d6e-7fed-0310-83ef-9ca221ded41b

diff --git a/modules/gmysqlbackend/smysql.cc b/modules/gmysqlbackend/smysql.cc
index 329f262bf..703aa4cb9 100644
--- a/modules/gmysqlbackend/smysql.cc
+++ b/modules/gmysqlbackend/smysql.cc
@@ -16,6 +16,9 @@ SMySQL::SMySQL(const string &database, const string &host, uint16_t port, const
 {
   mysql_init(&d_db);
   mysql_options(&d_db, MYSQL_READ_DEFAULT_GROUP, "client");
+  my_bool reconnect = 1;
+  mysql_options(&d_db, MYSQL_OPT_RECONNECT, &reconnect);
+  
   if (!mysql_real_connect(&d_db, host.empty() ? 0 : host.c_str(), 
 			  user.empty() ? 0 : user.c_str(), 
 			  password.empty() ? 0 : password.c_str(),

