commit 14180ae43350d8eb52e4da63cb8c4fe73ea5db2d
Author: Zoltan Varga <vargaz@gmail.com>
Date:   Tue Mar 10 17:27:22 2015 -0400

    [jit] Fix the handling of byref locals in mono_allocate_stack_slots2 ().

diff --git a/mono/mini/mini.c b/mono/mini/mini.c
index 3f0eb344859..7d66a436153 100755
--- a/mono/mini/mini.c
+++ b/mono/mini/mini.c
@@ -1329,6 +1329,7 @@ mono_allocate_stack_slots2 (MonoCompile *cfg, gboolean backward, guint32 *stack_
 		if (cfg->disable_reuse_stack_slots)
 			reuse_slot = FALSE;
 
+		t = mini_get_underlying_type (cfg, t);
 		switch (t->type) {
 		case MONO_TYPE_GENERICINST:
 			if (!mono_type_generic_inst_is_valuetype (t)) {

