commit 75874d5cc8efef22457072e14103dc55f164e64e
Author: Chuck Ebbert <76306.1226@compuserve.com>
Date:   Thu Mar 23 02:59:52 2006 -0800

    [PATCH] i386: fix dump_stack()
    
    i386 has a small bug in the stack dump code where it prints an extra log
    level code.  Remove that and fix the alignment of normal stack dump
    printout.  Also remove some unnecessary printk() calls.
    
    Signed-off-by: Chuck Ebbert <76306.1226@compuserve.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

diff --git a/arch/i386/kernel/traps.c b/arch/i386/kernel/traps.c
index a807a2da581d..1b7ad4115d81 100644
--- a/arch/i386/kernel/traps.c
+++ b/arch/i386/kernel/traps.c
@@ -217,19 +217,17 @@ static void show_stack_log_lvl(struct task_struct *task, unsigned long *esp,
 	for(i = 0; i < kstack_depth_to_print; i++) {
 		if (kstack_end(stack))
 			break;
-		if (i && ((i % 8) == 0)) {
-			printk("\n");
-			printk("%s       ", log_lvl);
-		}
+		if (i && ((i % 8) == 0))
+			printk("\n%s       ", log_lvl);
 		printk("%08lx ", *stack++);
 	}
-	printk("\n");
-	printk("%sCall Trace:\n", log_lvl);
+	printk("\n%sCall Trace:\n", log_lvl);
 	show_trace_log_lvl(task, esp, log_lvl);
 }
 
 void show_stack(struct task_struct *task, unsigned long *esp)
 {
+	printk("       ");
 	show_stack_log_lvl(task, esp, "");
 }
 

