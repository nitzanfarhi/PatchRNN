commit fe5a85aea0fa56c99b2f334fa7a71f8bd9c69ead
Author: Victor Julien <victor@inliniac.net>
Date:   Sat May 30 11:31:30 2015 +0200

    decode: add erspan counter

diff --git a/src/decode-erspan.c b/src/decode-erspan.c
index 9325f6b8..ff6390b5 100644
--- a/src/decode-erspan.c
+++ b/src/decode-erspan.c
@@ -45,6 +45,8 @@
 
 int DecodeERSPAN(ThreadVars *tv, DecodeThreadVars *dtv, Packet *p, uint8_t *pkt, uint16_t len, PacketQueue *pq)
 {
+    StatsIncr(tv, dtv->counter_erspan);
+
     if (len < sizeof(ErspanHdr)) {
         ENGINE_SET_EVENT(p,ERSPAN_HEADER_TOO_SMALL);
         return TM_ECODE_FAILED;
diff --git a/src/decode.c b/src/decode.c
index 49896d8e..682e0b3c 100644
--- a/src/decode.c
+++ b/src/decode.c
@@ -400,6 +400,7 @@ void DecodeRegisterPerfCounters(DecodeThreadVars *dtv, ThreadVars *tv)
     dtv->counter_mpls = StatsRegisterCounter("decoder.mpls", tv);
     dtv->counter_avg_pkt_size = StatsRegisterAvgCounter("decoder.avg_pkt_size", tv);
     dtv->counter_max_pkt_size = StatsRegisterMaxCounter("decoder.max_pkt_size", tv);
+    dtv->counter_erspan = StatsRegisterMaxCounter("decoder.erspan", tv);
 
     dtv->counter_defrag_ipv4_fragments =
         StatsRegisterCounter("defrag.ipv4.fragments", tv);
diff --git a/src/decode.h b/src/decode.h
index 1c02a3ed..a07b24bd 100644
--- a/src/decode.h
+++ b/src/decode.h
@@ -610,6 +610,7 @@ typedef struct DecodeThreadVars_
     uint16_t counter_ipv6inipv6;
     uint16_t counter_avg_pkt_size;
     uint16_t counter_max_pkt_size;
+    uint16_t counter_erspan;
 
     /** frag stats - defrag runs in the context of the decoder. */
     uint16_t counter_defrag_ipv4_fragments;

