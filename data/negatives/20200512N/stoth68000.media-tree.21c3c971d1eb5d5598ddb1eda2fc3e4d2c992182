commit 21c3c971d1eb5d5598ddb1eda2fc3e4d2c992182
Author: Ken-ichirou MATSUZAWA <chamaken@gmail.com>
Date:   Tue Jan 5 09:31:40 2016 +0900

    netfilter: nfnetlink_queue: just returns error for unknown command
    
    This patch stops processing options for unknown command.
    
    Signed-off-by: Ken-ichirou MATSUZAWA <chamas@h4.dion.ne.jp>
    Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>

diff --git a/net/netfilter/nfnetlink_queue.c b/net/netfilter/nfnetlink_queue.c
index 57951ce621b1..c1f6df4cfe88 100644
--- a/net/netfilter/nfnetlink_queue.c
+++ b/net/netfilter/nfnetlink_queue.c
@@ -1182,7 +1182,7 @@ static int nfqnl_recv_config(struct net *net, struct sock *ctnl,
 			break;
 		default:
 			ret = -ENOTSUPP;
-			break;
+			goto err_out_unlock;
 		}
 	}
 

