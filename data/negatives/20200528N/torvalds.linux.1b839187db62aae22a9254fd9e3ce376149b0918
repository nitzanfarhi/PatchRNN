commit 1b839187db62aae22a9254fd9e3ce376149b0918
Author: Javier González <javier@cnexlabs.com>
Date:   Fri Oct 13 14:46:46 2017 +0200

    lightnvm: fail fast on passthrough commands
    
    Make LightNVM passhtrough commands fail fast. User space will then take
    care of re-submitting.
    
    Fixes: 84d4add793c6 ('lightnvm: add ioctls for vector I/Os')
    Signed-off-by: Javier González <javier@cnexlabs.com>
    Signed-off-by: Matias Bjørling <m@bjorling.me>
    Signed-off-by: Jens Axboe <axboe@kernel.dk>

diff --git a/drivers/nvme/host/lightnvm.c b/drivers/nvme/host/lightnvm.c
index 1f79e3f141e6..6017153c2439 100644
--- a/drivers/nvme/host/lightnvm.c
+++ b/drivers/nvme/host/lightnvm.c
@@ -600,8 +600,6 @@ static int nvme_nvm_submit_user_cmd(struct request_queue *q,
 
 	rq->timeout = timeout ? timeout : ADMIN_TIMEOUT;
 
-	rq->cmd_flags &= ~REQ_FAILFAST_DRIVER;
-
 	if (ppa_buf && ppa_len) {
 		ppa_list = dma_pool_alloc(dev->dma_pool, GFP_KERNEL, &ppa_dma);
 		if (!ppa_list) {

