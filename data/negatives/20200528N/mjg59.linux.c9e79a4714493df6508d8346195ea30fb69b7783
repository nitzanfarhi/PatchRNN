commit c9e79a4714493df6508d8346195ea30fb69b7783
Author: Luciano Coelho <coelho@ti.com>
Date:   Tue Sep 27 16:22:35 2011 +0300

    wl12xx: set max_sched_scan_ie_len correctly
    
    The wiphy max_sched_scan_ie_len attribute was not set correctly and
    remained as 0, so when IEs were being passed in a scheduled scan, we
    were returning -EINVAL.
    
    Fix this by setting the attribute properly.
    
    Signed-off-by: Luciano Coelho <coelho@ti.com>

diff --git a/drivers/net/wireless/wl12xx/main.c b/drivers/net/wireless/wl12xx/main.c
index e2d6edd2fcd2..b1b405b576cc 100644
--- a/drivers/net/wireless/wl12xx/main.c
+++ b/drivers/net/wireless/wl12xx/main.c
@@ -4679,6 +4679,9 @@ int wl1271_init_ieee80211(struct wl1271 *wl)
 	wl->hw->wiphy->max_scan_ie_len = WL1271_CMD_TEMPL_DFLT_SIZE -
 			sizeof(struct ieee80211_header);
 
+	wl->hw->wiphy->max_sched_scan_ie_len = WL1271_CMD_TEMPL_DFLT_SIZE -
+		sizeof(struct ieee80211_header);
+
 	wl->hw->wiphy->flags |= WIPHY_FLAG_AP_UAPSD;
 
 	/* make sure all our channels fit in the scanned_ch bitmask */

