commit aebbbe55b51fd70e2ec4f8938210eb1772eb623b
Author: ts143224 <none@none>
Date:   Tue Aug 7 12:37:23 2007 -0700

    6570668 iSCSI delete_008 modify_001 modify_003 failing with TPGT has no ip-addr errors create_009 failing
    6575041 iSCSI TM set statSN to 0 on a Task Management Abort Task Response

diff --git a/usr/src/cmd/iscsi/iscsitgtd/iscsi_ffp.c b/usr/src/cmd/iscsi/iscsitgtd/iscsi_ffp.c
index e4ad6bcaa1..957c58b6d1 100644
--- a/usr/src/cmd/iscsi/iscsitgtd/iscsi_ffp.c
+++ b/usr/src/cmd/iscsi/iscsitgtd/iscsi_ffp.c
@@ -244,6 +244,10 @@ handle_task_mgt(iscsi_conn_t *c, iscsi_hdr_t *p, char *ahs, int ahslen)
 	rsp->flags	= ISCSI_FLAG_FINAL;
 	rsp->itt	= hp->itt;
 
+	(void) pthread_mutex_lock(&c->c_mutex);
+	rsp->statsn	= htonl(c->c_statsn++);
+	(void) pthread_mutex_unlock(&c->c_mutex);
+
 	(void) pthread_mutex_lock(&c->c_sess->s_mutex);
 	if (ntohl(hp->cmdsn) > c->c_sess->s_seencmdsn)
 		c->c_sess->s_seencmdsn = ntohl(hp->cmdsn);
diff --git a/usr/src/cmd/iscsi/iscsitgtd/mgmt_modify.c b/usr/src/cmd/iscsi/iscsitgtd/mgmt_modify.c
index 4b29c89ccb..274834d111 100644
--- a/usr/src/cmd/iscsi/iscsitgtd/mgmt_modify.c
+++ b/usr/src/cmd/iscsi/iscsitgtd/mgmt_modify.c
@@ -324,9 +324,6 @@ modify_target(tgt_node_t *x, ucred_t *cred)
 			    != NULL) {
 				isns_mods |= ISNS_MOD_TPGT;
 				break;
-			} else {
-				xml_rtn_msg(&msg, ERR_TPGT_NO_IPADDR);
-				return (msg);
 			}
 		}
 

