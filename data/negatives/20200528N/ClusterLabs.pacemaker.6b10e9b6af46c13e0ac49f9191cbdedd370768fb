commit 6b10e9b6af46c13e0ac49f9191cbdedd370768fb
Author: Andrew Beekhof <andrew@beekhof.net>
Date:   Wed May 26 07:12:23 2004 +0000

    Tweak the priority of actions, remove some redundant ones.
    
    CVS patchset: 3129
    CVS date: 2004/05/26 07:12:23
    
    Mercurial revision: 814f4dfa0a35df5fb15cf31f52d5b5efd6fbc470

diff --git a/crm/crmd/fsa.c b/crm/crmd/fsa.c
index 65341f8b5..8f36802d8 100644
--- a/crm/crmd/fsa.c
+++ b/crm/crmd/fsa.c
@@ -402,11 +402,10 @@ s_crmd_fsa(enum crmd_fsa_cause cause,
 		ELSEIF_FSA_ACTION(A_HA_CONNECT, do_ha_control)
 		ELSEIF_FSA_ACTION(A_LRM_CONNECT,do_lrm_control)
 		ELSEIF_FSA_ACTION(A_CCM_CONNECT,do_ccm_control)
-		ELSEIF_FSA_ACTION(A_ANNOUNCE,	do_announce)
 		
 		/* sub-system start */
-		ELSEIF_FSA_ACTION(A_PE_START,	do_pe_control)
 		ELSEIF_FSA_ACTION(A_TE_START,	do_te_control)
+		ELSEIF_FSA_ACTION(A_PE_START,	do_pe_control)
 		
 		/* sub-system restart
 		 */
@@ -429,9 +428,11 @@ s_crmd_fsa(enum crmd_fsa_cause cause,
 		ELSEIF_FSA_ACTION(A_SHUTDOWN_REQ,	do_shutdown_req)
 		ELSEIF_FSA_ACTION(A_MSG_ROUTE,		do_msg_route)
 		ELSEIF_FSA_ACTION(A_RECOVER,		do_recover)
+		ELSEIF_FSA_ACTION(A_JOIN_ACK,		do_ack_welcome)
+		ELSEIF_FSA_ACTION(A_ANNOUNCE,		do_announce)
 		ELSEIF_FSA_ACTION(A_ELECTION_VOTE,	do_election_vote)
-		ELSEIF_FSA_ACTION(A_ELECT_TIMER_START,	do_election_timer_ctrl)
 		ELSEIF_FSA_ACTION(A_ELECT_TIMER_STOP,	do_election_timer_ctrl)
+		ELSEIF_FSA_ACTION(A_ELECT_TIMER_START,	do_election_timer_ctrl)
 		ELSEIF_FSA_ACTION(A_ELECTION_COUNT,	do_election_count_vote)
 		ELSEIF_FSA_ACTION(A_ELECTION_TIMEOUT,	do_election_timer_ctrl)
 		
@@ -455,7 +456,6 @@ s_crmd_fsa(enum crmd_fsa_cause cause,
 		ELSEIF_FSA_ACTION(A_DC_RELEASE,		do_dc_release)
 		ELSEIF_FSA_ACTION(A_JOIN_WELCOME_ALL,	do_send_welcome)
 		ELSEIF_FSA_ACTION(A_JOIN_WELCOME,	do_send_welcome)
-		ELSEIF_FSA_ACTION(A_JOIN_ACK,		do_ack_welcome)
 		ELSEIF_FSA_ACTION(A_JOIN_PROCESS_ACK,	do_process_welcome_ack)
 		
 		/*
@@ -977,6 +977,9 @@ fsa_action2string(long long action)
 		case A_TE_STOP:
 			actionAsText = "A_TE_STOP";
 			break;
+		case A_TE_CANCEL:
+			actionAsText = "A_TE_CANCEL";
+			break;
 		case A_TE_COPYTO:
 			actionAsText = "A_TE_COPYTO";
 			break;
diff --git a/crm/crmd/fsa_matrix.h b/crm/crmd/fsa_matrix.h
index 50688cb28..b37808c18 100644
--- a/crm/crmd/fsa_matrix.h
+++ b/crm/crmd/fsa_matrix.h
@@ -725,18 +725,18 @@ const long long crmd_fsa_actions [MAXINPUT][MAXSTATE] = {
 
 /* Got an I_NODE_JOIN */
 	{
-		/* S_IDLE		==> */	A_TE_CANCEL|A_JOIN_WELCOME|A_PE_INVOKE,
+		/* S_IDLE		==> */	A_TE_CANCEL|A_JOIN_WELCOME,
 		/* S_ELECTION		==> */	A_WARN,
-		/* S_INTEGRATION	==> */	A_TE_CANCEL|A_JOIN_WELCOME|A_PE_INVOKE,
+		/* S_INTEGRATION	==> */	A_TE_CANCEL|A_JOIN_WELCOME,
 		/* S_NOT_DC		==> */	A_WARN,
-		/* S_POLICY_ENGINE	==> */	A_TE_CANCEL|A_JOIN_WELCOME|A_PE_INVOKE,
+		/* S_POLICY_ENGINE	==> */	A_TE_CANCEL|A_JOIN_WELCOME,
 		/* S_RECOVERY		==> */	A_WARN,
-		/* S_RECOVERY_DC	==> */	A_TE_CANCEL|A_JOIN_WELCOME|A_PE_INVOKE,
+		/* S_RECOVERY_DC	==> */	A_TE_CANCEL|A_JOIN_WELCOME,
 		/* S_RELEASE_DC		==> */	A_WARN,
 		/* S_PENDING		==> */	A_WARN,
 		/* S_STOPPING		==> */	A_WARN,
 		/* S_TERMINATE		==> */	A_WARN,
-		/* S_TRANSITION_ENGINE	==> */	A_TE_CANCEL|A_JOIN_WELCOME|A_PE_INVOKE,
+		/* S_TRANSITION_ENGINE	==> */	A_TE_CANCEL|A_JOIN_WELCOME,
 	},
 
 /* Got an I_NODE_LEFT */

