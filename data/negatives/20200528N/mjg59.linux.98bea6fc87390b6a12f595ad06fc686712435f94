commit 98bea6fc87390b6a12f595ad06fc686712435f94
Author: Atsushi Nemoto <anemo@mba.ocn.ne.jp>
Date:   Tue Dec 22 00:48:57 2009 +0900

    MIPS: TXx9: Cleanup builtin-cmdline processing
    
    Since commit 898d357b5262f9e26bc2418e01f8676e80d9867e (lmo) /
    6acc7d485c24c00e111c61b2e6dff9180faebcae (kernel.org) ("Fix and enhance
    built-in kernel command line") arcs_cmdline[] does not contain built-in
    command line.  The commit introduce CONFIG_CMDLINE_BOOL and
    CONFIG_CMDLINE_OVERRIDE to control built-in command line, and now we can
    use them instead of platform-specific built-in command line processing.
    
    Signed-off-by: Atsushi Nemoto <anemo@mba.ocn.ne.jp>
    Patchwork: http://patchwork.linux-mips.org/patch/802/
    Signed-off-by: Ralf Baechle <ralf@linux-mips.org>

diff --git a/arch/mips/txx9/generic/setup.c b/arch/mips/txx9/generic/setup.c
index 06e801c7e258..e27809b6d04f 100644
--- a/arch/mips/txx9/generic/setup.c
+++ b/arch/mips/txx9/generic/setup.c
@@ -160,7 +160,6 @@ static void __init prom_init_cmdline(void)
 	int argc;
 	int *argv32;
 	int i;			/* Always ignore the "-c" at argv[0] */
-	static char builtin[COMMAND_LINE_SIZE] __initdata;
 
 	if (fw_arg0 >= CKSEG0 || fw_arg1 < CKSEG0) {
 		/*
@@ -174,20 +173,6 @@ static void __init prom_init_cmdline(void)
 		argv32 = (int *)fw_arg1;
 	}
 
-	/* ignore all built-in args if any f/w args given */
-	/*
-	 * But if built-in strings was started with '+', append them
-	 * to command line args.  If built-in was started with '-',
-	 * ignore all f/w args.
-	 */
-	builtin[0] = '\0';
-	if (arcs_cmdline[0] == '+')
-		strcpy(builtin, arcs_cmdline + 1);
-	else if (arcs_cmdline[0] == '-') {
-		strcpy(builtin, arcs_cmdline + 1);
-		argc = 0;
-	} else if (argc <= 1)
-		strcpy(builtin, arcs_cmdline);
 	arcs_cmdline[0] = '\0';
 
 	for (i = 1; i < argc; i++) {
@@ -201,12 +186,6 @@ static void __init prom_init_cmdline(void)
 		} else
 			strcat(arcs_cmdline, str);
 	}
-	/* append saved builtin args */
-	if (builtin[0]) {
-		if (arcs_cmdline[0])
-			strcat(arcs_cmdline, " ");
-		strcat(arcs_cmdline, builtin);
-	}
 }
 
 static int txx9_ic_disable __initdata;

