commit 226d35c84591f1901c2a13819031549909faa1f5
Author: Andreas Cadhalpun <Andreas.Cadhalpun@googlemail.com>
Date:   Wed Nov 9 00:38:50 2016 +0100

    escape124: reject codebook size 0
    
    It causes a cb_depth of 32, leading to assertion failures in get_bits.
    
    Reviewed-by: Michael Niedermayer <michael@niedermayer.cc>
    Signed-off-by: Andreas Cadhalpun <Andreas.Cadhalpun@googlemail.com>

diff --git a/libavcodec/escape124.c b/libavcodec/escape124.c
index b872b3a53d..c3174ce6ef 100644
--- a/libavcodec/escape124.c
+++ b/libavcodec/escape124.c
@@ -249,6 +249,10 @@ static int escape124_decode_frame(AVCodecContext *avctx,
                 // This codebook can be cut off at places other than
                 // powers of 2, leaving some of the entries undefined.
                 cb_size = get_bits_long(&gb, 20);
+                if (!cb_size) {
+                    av_log(avctx, AV_LOG_ERROR, "Invalid codebook size 0.\n");
+                    return AVERROR_INVALIDDATA;
+                }
                 cb_depth = av_log2(cb_size - 1) + 1;
             } else {
                 cb_depth = get_bits(&gb, 4);

