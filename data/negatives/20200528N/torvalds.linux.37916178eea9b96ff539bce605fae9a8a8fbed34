commit 37916178eea9b96ff539bce605fae9a8a8fbed34
Author: Paul Burton <paul.burton@imgtec.com>
Date:   Sat Aug 12 21:36:13 2017 -0700

    MIPS: CPS: Read GIC_VL_IDENT directly, not via irqchip driver
    
    Rather than calling the gic_read_local_vp_id() function from the GIC
    irqchip driver, call read_gic_vl_ident() to read the GIC_VL_IDENT
    register directly. This will allow us to remove gic_read_local_vp_id()
    from the irqchip driver in a further patch, since that driver doesn't
    actually care about the register's value.
    
    Signed-off-by: Paul Burton <paul.burton@imgtec.com>
    Cc: Jason Cooper <jason@lakedaemon.net>
    Cc: Marc Zyngier <marc.zyngier@arm.com>
    Cc: Thomas Gleixner <tglx@linutronix.de>
    Cc: linux-mips@linux-mips.org
    Patchwork: https://patchwork.linux-mips.org/patch/17023/
    Signed-off-by: Ralf Baechle <ralf@linux-mips.org>

diff --git a/arch/mips/kernel/smp-cps.c b/arch/mips/kernel/smp-cps.c
index 0d9cda6a77de..c316a0f9e6fb 100644
--- a/arch/mips/kernel/smp-cps.c
+++ b/arch/mips/kernel/smp-cps.c
@@ -368,7 +368,7 @@ static void cps_init_secondary(void)
 		dmt();
 
 	if (mips_cm_revision() >= CM_REV_CM3) {
-		unsigned ident = gic_read_local_vp_id();
+		unsigned int ident = read_gic_vl_ident();
 
 		/*
 		 * Ensure that our calculation of the VP ID matches up with

