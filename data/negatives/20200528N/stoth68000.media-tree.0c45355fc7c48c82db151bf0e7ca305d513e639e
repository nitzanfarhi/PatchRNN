commit 0c45355fc7c48c82db151bf0e7ca305d513e639e
Author: Benjamin LaHaise <bcrl@kvack.org>
Date:   Wed Jul 17 09:34:24 2013 -0400

    aio: fix build when migration is disabled
    
    When "fs/aio: Add support to aio ring pages migration" was applied, it
    broke the build when CONFIG_MIGRATION was disabled.  Wrap the migration
    code with a test for CONFIG_MIGRATION to fix this and save a few bytes
    when migration is disabled.
    
    Signed-off-by: Benjamin LaHaise <bcrl@kvack.org>

diff --git a/fs/aio.c b/fs/aio.c
index cbd0afe77273..dedeea01e4e4 100644
--- a/fs/aio.c
+++ b/fs/aio.c
@@ -181,6 +181,7 @@ static int aio_set_page_dirty(struct page *page)
 	return 0;
 }
 
+#if IS_ENABLED(CONFIG_MIGRATION)
 static int aio_migratepage(struct address_space *mapping, struct page *new,
 			struct page *old, enum migrate_mode mode)
 {
@@ -208,10 +209,13 @@ static int aio_migratepage(struct address_space *mapping, struct page *new,
 
 	return rc;
 }
+#endif
 
 static const struct address_space_operations aio_ctx_aops = {
 	.set_page_dirty = aio_set_page_dirty,
+#if IS_ENABLED(CONFIG_MIGRATION)
 	.migratepage	= aio_migratepage,
+#endif
 };
 
 static int aio_setup_ring(struct kioctx *ctx)

