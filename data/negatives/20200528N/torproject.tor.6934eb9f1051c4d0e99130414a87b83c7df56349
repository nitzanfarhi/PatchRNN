commit 6934eb9f1051c4d0e99130414a87b83c7df56349
Author: Roger Dingledine <arma@torproject.org>
Date:   Fri Sep 27 23:34:51 2002 +0000

    mozilla actually cares about the reply version
    
    tor can now interface directly with mozilla, as a socks 4 host.
    but note that mozilla does the dns resolution itself, so you're leaking
    anonymity.
    
    
    svn:r119

diff --git a/src/or/connection_ap.c b/src/or/connection_ap.c
index eee068a28..a4f20a564 100644
--- a/src/or/connection_ap.c
+++ b/src/or/connection_ap.c
@@ -341,7 +341,7 @@ int ap_handshake_socks_reply(connection_t *conn, char result) {
 
   assert(conn);
 
-  socks4_info.version = 4;
+  socks4_info.version = 0;
   socks4_info.command = result;
   socks4_info.destport[0] = socks4_info.destport[1] = 0;
   socks4_info.destip[0] = socks4_info.destip[1] = socks4_info.destip[2] = socks4_info.destip[3] = 0;

