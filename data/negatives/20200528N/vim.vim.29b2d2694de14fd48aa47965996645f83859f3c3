commit 29b2d2694de14fd48aa47965996645f83859f3c3
Author: Bram Moolenaar <Bram@vim.org>
Date:   Sun Sep 10 19:07:28 2006 +0000

    updated for version 7.0-098

diff --git a/src/ex_docmd.c b/src/ex_docmd.c
index 3378092e6..bb57a1068 100644
--- a/src/ex_docmd.c
+++ b/src/ex_docmd.c
@@ -8422,6 +8422,15 @@ ex_redir(eap)
 	else
 	    EMSG2(_(e_invarg2), eap->arg);
     }
+
+    /* Make sure redirection is not off.  Can happen for cmdline completion
+     * that indirectly invokes a command to catch its output. */
+    if (redir_fd != NULL
+#ifdef FEAT_EVAL
+			  || redir_reg || redir_vname
+#endif
+							)
+	redir_off = FALSE;
 }
 
 /*
diff --git a/src/ex_getln.c b/src/ex_getln.c
index 617c24614..e00663139 100644
--- a/src/ex_getln.c
+++ b/src/ex_getln.c
@@ -324,6 +324,9 @@ getcmdline(firstc, count, indent)
      */
     for (;;)
     {
+	redir_off = TRUE;	/* Don't redirect the typed command.
+				   Repeated, because a ":redir" inside
+				   completion may switch it on. */
 #ifdef USE_ON_FLY_SCROLL
 	dont_scroll = FALSE;	/* allow scrolling here */
 #endif
diff --git a/src/version.c b/src/version.c
index 6cb788ca0..acff8abd7 100644
--- a/src/version.c
+++ b/src/version.c
@@ -666,6 +666,8 @@ static char *(features[]) =
 
 static int included_patches[] =
 {   /* Add new patch number below this line */
+/**/
+    98,
 /**/
     97,
 /**/

