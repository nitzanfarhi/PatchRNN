commit d83aa1e0e44784e1f38698a839f8a353c87027eb
Author: Jason Dillaman <dillaman@redhat.com>
Date:   Thu Jun 16 09:38:28 2016 -0400

    librbd: force-remove journal when disabling feature and removing image
    
    If mirroring is enabled, it's nearly certain that the peer rbd-mirror
    daemon will be a registered client within the journal. Without
    forcing the removal, this would prevent the removal from occurring.
    
    Signed-off-by: Jason Dillaman <dillaman@redhat.com>

diff --git a/src/librbd/Journal.cc b/src/librbd/Journal.cc
index b874005843..d4ae06bef6 100644
--- a/src/librbd/Journal.cc
+++ b/src/librbd/Journal.cc
@@ -424,7 +424,7 @@ int Journal<I>::remove(librados::IoCtx &io_ctx, const std::string &image_id) {
     return r;
   }
 
-  r = journaler.remove(false);
+  r = journaler.remove(true);
   if (r < 0) {
     lderr(cct) << "failed to remove journal: " << cpp_strerror(r) << dendl;
     return r;

