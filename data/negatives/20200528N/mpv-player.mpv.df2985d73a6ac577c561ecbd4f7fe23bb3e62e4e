commit df2985d73a6ac577c561ecbd4f7fe23bb3e62e4e
Author: arpi <arpi@b3059339-0415-0410-9bf9-f77b7e298cf2>
Date:   Wed Oct 23 17:51:49 2002 +0000

    automatic rotation for mode 4..7, based on
    patch by Balatoni Denes <pnis@coder.hu>
    
    
    git-svn-id: svn://svn.mplayerhq.hu/mplayer/trunk@7872 b3059339-0415-0410-9bf9-f77b7e298cf2

diff --git a/libmpcodecs/vf_rotate.c b/libmpcodecs/vf_rotate.c
index 23d3005ab1..bc4e279eb7 100644
--- a/libmpcodecs/vf_rotate.c
+++ b/libmpcodecs/vf_rotate.c
@@ -56,7 +56,13 @@ static void rotate(unsigned char* dst,unsigned char* src,int dststride,int srcst
 static int config(struct vf_instance_s* vf,
         int width, int height, int d_width, int d_height,
 	unsigned int flags, unsigned int outfmt){
-    
+    if (vf->priv->direction & 4) {
+	if (width<height) vf->priv->direction&=3;
+    }
+    if (vf->priv->direction & 4){
+	vf->put_image=vf_next_put_image; // passthru mode!
+	return vf_next_config(vf,width,height,d_width,d_height,flags,outfmt);
+    }
     return vf_next_config(vf,height,width,d_height,d_width,flags,outfmt);
 }
 

