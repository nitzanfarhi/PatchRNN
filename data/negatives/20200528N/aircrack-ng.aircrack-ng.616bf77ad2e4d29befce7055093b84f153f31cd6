commit 616bf77ad2e4d29befce7055093b84f153f31cd6
Author: Joseph Benden <joe@benden.us>
Date:   Wed Jun 13 16:46:23 2018 -0700

    The returned value is the position into the key variable, on success.

diff --git a/test/glib/test-wpapsk.c b/test/glib/test-wpapsk.c
index 3f21d067..83ef07b8 100644
--- a/test/glib/test-wpapsk.c
+++ b/test/glib/test-wpapsk.c
@@ -149,7 +149,7 @@ static void test_simd_can_crack(gconstpointer test_data)
 
 		memset(key, 0, sizeof(key));
 
-		strcpy(key[i], "12345678");
+		strcpy(key[1] + (128 * i), "12345678");
 #if 1
 		if ((rc = dso_ac_crypto_engine_wpa_crack(&engine,
 									   key,
@@ -165,7 +165,7 @@ static void test_simd_can_crack(gconstpointer test_data)
 			>= 0)
 		{
 			// does the returned SIMD lane equal where we placed the key?
-			g_assert_cmpint(rc, >=, 0);
+			g_assert_cmpint(rc, ==, i);
 		}
 #else
 		(void) eapol;

