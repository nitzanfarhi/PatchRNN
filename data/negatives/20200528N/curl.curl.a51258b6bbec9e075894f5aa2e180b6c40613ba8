commit a51258b6bbec9e075894f5aa2e180b6c40613ba8
Author: Daniel Stenberg <daniel@haxx.se>
Date:   Tue May 13 12:11:31 2003 +0000

    before using if2ip(), check if the address is an ip address and skip it if
    it is.

diff --git a/lib/ftp.c b/lib/ftp.c
index 5b79662c2..7b4d8abab 100644
--- a/lib/ftp.c
+++ b/lib/ftp.c
@@ -1212,7 +1212,13 @@ CURLcode ftp_use_port(struct connectdata *conn)
   bool sa_filled_in = FALSE;
 
   if(data->set.ftpport) {
-    if(Curl_if2ip(data->set.ftpport, myhost, sizeof(myhost))) {
+    in_addr_t in;
+
+    /* First check if the given name is an IP address */
+    in=inet_addr(data->set.ftpport);
+
+    if((in == CURL_INADDR_NONE) &&
+       Curl_if2ip(data->set.ftpport, myhost, sizeof(myhost))) {
       h = Curl_resolv(data, myhost, 0);
     }
     else {

