commit 512345be2549308b8ae8e85a3ff7f6d56a38e5f6
Author: Paul E. McKenney <paulmck@us.ibm.com>
Date:   Sun May 1 08:59:03 2005 -0700

    [PATCH] Add deprecated_for_modules
    
    Add a deprecated_for_modules macro that allows symbols to be deprecated only
    when used by modules, as suggested by Andrew Morton some months back.
    
    Signed-off-by: Paul E. McKenney <paulmck@us.ibm.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

diff --git a/include/linux/compiler.h b/include/linux/compiler.h
index 487725cf0d0d..d7378215b851 100644
--- a/include/linux/compiler.h
+++ b/include/linux/compiler.h
@@ -90,6 +90,12 @@ extern void __chk_io_ptr(void __iomem *);
 # define __deprecated		/* unimplemented */
 #endif
 
+#ifdef MODULE
+#define __deprecated_for_modules __deprecated
+#else
+#define __deprecated_for_modules
+#endif
+
 #ifndef __must_check
 #define __must_check
 #endif

