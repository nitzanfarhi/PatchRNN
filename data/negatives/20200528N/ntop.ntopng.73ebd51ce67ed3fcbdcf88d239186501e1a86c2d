commit 73ebd51ce67ed3fcbdcf88d239186501e1a86c2d
Author: Simone Mainardi <mainardi@ntop.org>
Date:   Thu Apr 12 14:33:19 2018 +0200

    Disables CGI support in mongoose
    
    No need to execute cgi, so it is safer to disable this support.

diff --git a/third-party/mongoose/mongoose.c b/third-party/mongoose/mongoose.c
index d8f3f04c..ea5e8851 100644
--- a/third-party/mongoose/mongoose.c
+++ b/third-party/mongoose/mongoose.c
@@ -291,6 +291,11 @@ typedef int SOCKET;
 #endif
 #endif
 
+#ifdef  _NTOP_CLASS_H_
+/* Disables CGI support, safer and prevents mongoose forking */
+#define NO_CGI
+#endif
+
 #define MONGOOSE_VERSION "3.7"
 #define PASSWORDS_FILE_NAME ".htpasswd"
 #define CGI_ENVIRONMENT_SIZE 4096
@@ -5430,7 +5435,9 @@ struct mg_context *mg_start(const struct mg_callbacks *callbacks,
   // won't kill the whole process.
   (void) signal(SIGPIPE, SIG_IGN);
   // Also ignoring SIGCHLD to let the OS to reap zombies properly.
+#ifndef NO_CGI /* Only CGI support causes mongoose to fork */
   (void) signal(SIGCHLD, SIG_IGN);
+#endif
 #endif // !_WIN32
 
   (void) pthread_mutex_init(&ctx->mutex, NULL);

