commit b273c2c2f2d2d13dc0bfa8923d52fbaf8fa56ae8
Author: Ricardo Ribalda Delgado <ricardo.ribalda@gmail.com>
Date:   Mon Feb 2 20:27:11 2015 +0100

    x86/apic: Fix the devicetree build in certain configs
    
    Without this patch:
    
      LD      init/built-in.o
      arch/x86/built-in.o: In function `dtb_lapic_setup': kernel/devicetree.c:155:
      undefined reference to `apic_force_enable'
      Makefile:923: recipe for target 'vmlinux' failed
      make: *** [vmlinux] Error 1
    
    Signed-off-by: Ricardo Ribalda Delgado <ricardo.ribalda@gmail.com>
    Reviewed-by: Maciej W. Rozycki <macro@linux-mips.org>
    Cc: David Rientjes <rientjes@google.com>
    Cc: Jan Beulich <JBeulich@suse.com>
    Link: http://lkml.kernel.org/r/1422905231-16067-1-git-send-email-ricardo.ribalda@gmail.com
    Signed-off-by: Ingo Molnar <mingo@kernel.org>

diff --git a/arch/x86/include/asm/apic.h b/arch/x86/include/asm/apic.h
index 92003f3c8a42..efc3b22d896e 100644
--- a/arch/x86/include/asm/apic.h
+++ b/arch/x86/include/asm/apic.h
@@ -213,7 +213,15 @@ void register_lapic_address(unsigned long address);
 extern void setup_boot_APIC_clock(void);
 extern void setup_secondary_APIC_clock(void);
 extern int APIC_init_uniprocessor(void);
+
+#ifdef CONFIG_X86_64
+static inline int apic_force_enable(unsigned long addr)
+{
+	return -1;
+}
+#else
 extern int apic_force_enable(unsigned long addr);
+#endif
 
 extern int apic_bsp_setup(bool upmode);
 extern void apic_ap_setup(void);

