commit 466de9183570fe9fd21ef167951488fc9d513fcb
Author: Ben Hutchings <ben@decadent.org.uk>
Date:   Sat Mar 19 04:26:10 2011 +0000

    kconfig: Avoid buffer underrun in choice input
    
    commit 40aee729b350672c2550640622416a855e27938f ('kconfig: fix default
    value for choice input') fixed some cases where kconfig would select
    the wrong option from a choice with a single valid option and thus
    enter an infinite loop.
    
    However, this broke the test for user input of the form 'N?', because
    when kconfig selects the single valid option the input is zero-length
    and the test will read the byte before the input buffer.  If this
    happens to contain '?' (as it will in a mips build on Debian unstable
    today) then kconfig again enters an infinite loop.
    
    Signed-off-by: Ben Hutchings <ben@decadent.org.uk>
    Cc: stable@kernel.org [2.6.17+]
    Signed-off-by: Michal Marek <mmarek@suse.cz>

diff --git a/scripts/kconfig/conf.c b/scripts/kconfig/conf.c
index 659326c3e895..006ad817cd5f 100644
--- a/scripts/kconfig/conf.c
+++ b/scripts/kconfig/conf.c
@@ -332,7 +332,7 @@ static int conf_choice(struct menu *menu)
 		}
 		if (!child)
 			continue;
-		if (line[strlen(line) - 1] == '?') {
+		if (line[0] && line[strlen(line) - 1] == '?') {
 			print_help(child);
 			continue;
 		}

