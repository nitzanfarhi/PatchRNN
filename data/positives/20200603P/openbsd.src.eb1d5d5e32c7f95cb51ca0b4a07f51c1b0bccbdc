commit eb1d5d5e32c7f95cb51ca0b4a07f51c1b0bccbdc
Author: deraadt <deraadt@openbsd.org>
Date:   Thu Nov 12 16:25:22 2009 +0000

    free flagsp if flags variable indicates it was not used, found by parfait; ok millert

diff --git a/sbin/dump/main.c b/sbin/dump/main.c
index 202d1015d22..140026e463d 100644
--- a/sbin/dump/main.c
+++ b/sbin/dump/main.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: main.c,v 1.43 2009/10/27 23:59:32 deraadt Exp $	*/
+/*	$OpenBSD: main.c,v 1.44 2009/11/12 16:25:22 deraadt Exp $	*/
 /*	$NetBSD: main.c,v 1.14 1997/06/05 11:13:24 lukem Exp $	*/
 
 /*-
@@ -677,11 +677,12 @@ obsolete(int *argcp, char **argvp[])
 		}
 	}
 
-	/* Terminate flags. */
+	/* Terminate flags, or toss the buffer we did not use. */
 	if (flags) {
 		*p = '\0';
 		*nargv++ = flagsp;
-	}
+	} else
+		free(flagsp);
 
 	/* Copy remaining arguments. */
 	while ((*nargv++ = *argv++))

