commit 743db2d903bc4e963a31496328d847d69f75047c
Author: Dan Carpenter <error27@gmail.com>
Date:   Tue May 25 11:51:10 2010 +0200

    kobject: free memory if netlink_kernel_create() fails
    
    There is a kfree(ue_sk) missing on the error path if
    netlink_kernel_create() fails.
    
    Signed-off-by: Dan Carpenter <error27@gmail.com>
    Reviewed-by: "Eric W. Biederman" <ebiederm@xmission.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

diff --git a/lib/kobject_uevent.c b/lib/kobject_uevent.c
index e2eb989d3223..b93579504dfa 100644
--- a/lib/kobject_uevent.c
+++ b/lib/kobject_uevent.c
@@ -380,6 +380,7 @@ static int uevent_net_init(struct net *net)
 	if (!ue_sk->sk) {
 		printk(KERN_ERR
 		       "kobject_uevent: unable to create netlink socket!\n");
+		kfree(ue_sk);
 		return -ENODEV;
 	}
 	mutex_lock(&uevent_sock_mutex);

