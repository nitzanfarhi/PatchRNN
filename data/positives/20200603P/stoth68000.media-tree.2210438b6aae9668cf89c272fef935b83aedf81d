commit 2210438b6aae9668cf89c272fef935b83aedf81d
Author: Lars-Peter Clausen <lars@metafoo.de>
Date:   Wed Jul 8 22:14:48 2015 +0200

    ASoC: Free card DAPM context on snd_soc_instantiate_card() error path
    
    Make sure the to free the card DAPM context if snd_soc_instantiate_card()
    fails, otherwise the memory allocated for the DAPM widgets is leaked.
    
    Signed-off-by: Lars-Peter Clausen <lars@metafoo.de>
    Signed-off-by: Mark Brown <broonie@kernel.org>

diff --git a/sound/soc/soc-core.c b/sound/soc/soc-core.c
index 3a4a5c0e3f97..0e1e69c7abd5 100644
--- a/sound/soc/soc-core.c
+++ b/sound/soc/soc-core.c
@@ -1716,6 +1716,7 @@ static int snd_soc_instantiate_card(struct snd_soc_card *card)
 	if (card->remove)
 		card->remove(card);
 
+	snd_soc_dapm_free(&card->dapm);
 	soc_cleanup_card_debugfs(card);
 	snd_card_free(card->snd_card);
 

