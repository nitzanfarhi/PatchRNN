commit cffea0f8b25c94b28e6edf7360fee9326ce0ba05
Author: Alan T. DeKok <aland@freeradius.org>
Date:   Sat Jul 28 10:32:19 2012 -0400

    Call globfree() if glob() returns error.
    
    Closes bug #207.
    
    glob may PARTIALLY fill out the data before returning error
    (sigh)

diff --git a/src/main/detail.c b/src/main/detail.c
index a2eb3be07..34bd88343 100644
--- a/src/main/detail.c
+++ b/src/main/detail.c
@@ -215,6 +215,7 @@ static int detail_open(rad_listen_t *this)
 
 			memset(&files, 0, sizeof(files));
 			if (glob(filename, 0, NULL, &files) != 0) {
+				globfree(&files);
 				return 0;
 			}
 

