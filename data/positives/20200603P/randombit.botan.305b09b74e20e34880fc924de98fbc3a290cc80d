commit 305b09b74e20e34880fc924de98fbc3a290cc80d
Author: lloyd <lloyd@randombit.net>
Date:   Fri Apr 12 15:34:59 2013 +0000

    Avoid null pointer deref if key was not set in AES

diff --git a/src/block/aes/aes.cpp b/src/block/aes/aes.cpp
index 232d0dc0a..f8d632c44 100644
--- a/src/block/aes/aes.cpp
+++ b/src/block/aes/aes.cpp
@@ -417,6 +417,8 @@ void aes_encrypt_n(const byte in[], byte out[],
                    const secure_vector<u32bit>& EK,
                    const secure_vector<byte>& ME)
    {
+   BOTAN_ASSERT(EK.size() && ME.size() == 16, "Key was set");
+
    const size_t BLOCK_SIZE = 16;
 
    const u32bit* TE0 = TE;
@@ -528,6 +530,8 @@ void aes_decrypt_n(const byte in[], byte out[], size_t blocks,
                    const secure_vector<u32bit>& DK,
                    const secure_vector<byte>& MD)
    {
+   BOTAN_ASSERT(DK.size() && MD.size() == 16, "Key was set");
+
    const size_t BLOCK_SIZE = 16;
 
    const u32bit* TD0 = TD;

