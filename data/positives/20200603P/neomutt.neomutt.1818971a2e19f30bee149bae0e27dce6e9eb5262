commit 1818971a2e19f30bee149bae0e27dce6e9eb5262
Author: Thomas Roessler <roessler@does-not-exist.org>
Date:   Tue Nov 10 20:23:29 1998 +0000

    Fix a possible buffer overflow.  (This seems to be the one noticed
    by Pavel Gulchouck <gul@lucky.net>.)

diff --git a/edit.c b/edit.c
index 3fe95224a..6cf7bd72c 100644
--- a/edit.c
+++ b/edit.c
@@ -357,7 +357,7 @@ int mutt_builtin_editor (const char *path, HEADER *msg, HEADER *cur)
 	  if (Context)
 	  {
 	    if (!*p && cur)
-	    {
+ 	    {
 	      /* include the current message */
 	      p = tmp + strlen (tmp) + 1;
 	      snprintf (tmp + strlen (tmp), sizeof (tmp) - strlen (tmp), " %d",
@@ -447,7 +447,7 @@ int mutt_builtin_editor (const char *path, HEADER *msg, HEADER *cur)
       done = 1;
     else
     {
-      strcat (tmp, "\n");
+      strncat (tmp, "\n", sizeof(tmp)); tmp[sizeof(tmp) - 1] = '\0';
       if (buflen == bufmax)
 	safe_realloc ((void **)&buf, sizeof (char *) * (bufmax += 25));
       buf[buflen++] = safe_strdup (tmp[1] == '~' ? tmp + 1 : tmp);

