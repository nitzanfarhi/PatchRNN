commit 556a53109c8fe1a1612c8cf279722997365f8fd2
Author: Love Hörnquist Åstrand <lha@kth.se>
Date:   Fri Oct 6 12:08:20 2006 +0000

    (parse_rsa_private_key): free type after use
    
    
    git-svn-id: svn://svn.h5l.se/heimdal/trunk/heimdal@18261 ec53bebd-3082-4978-b11e-865c3cabbd6b

diff --git a/lib/hx509/ks_file.c b/lib/hx509/ks_file.c
index 34fa71a3b..52f47b788 100644
--- a/lib/hx509/ks_file.c
+++ b/lib/hx509/ks_file.c
@@ -198,12 +198,12 @@ parse_rsa_private_key(hx509_context context, struct hx509_collector *c,
 
 	cipher = EVP_get_cipherbyname(type);
 	if (cipher == NULL) {
-	    free(type);
 	    free(ivdata);
 	    hx509_set_error_string(context, 0, EINVAL,
 				   "RSA key encrypted with "
 				   "unsupported cipher: %s",
 				   type);
+	    free(type);
 	    return EINVAL;
 	}
 

