commit ac360ed0a825392e2546f149ffbacddff363c98c
Author: aland <aland>
Date:   Sat Apr 7 21:59:18 2007 +0000

            If we've run out of memory, free(challenge), too.
            Just to be pedantic.
    
            This fixes Coverity bug #29

diff --git a/src/modules/rlm_eap/types/rlm_eap_mschapv2/rlm_eap_mschapv2.c b/src/modules/rlm_eap/types/rlm_eap_mschapv2/rlm_eap_mschapv2.c
index 09cb3aa80..5d98b15f3 100644
--- a/src/modules/rlm_eap/types/rlm_eap_mschapv2/rlm_eap_mschapv2.c
+++ b/src/modules/rlm_eap/types/rlm_eap_mschapv2/rlm_eap_mschapv2.c
@@ -491,6 +491,7 @@ static int mschapv2_authenticate(void *arg, EAP_HANDLER *handler)
 
 	response = pairmake("MS-CHAP2-Response", "0x00", T_OP_EQ);
 	if (!response) {
+		pairfree(&challenge);
 		radlog(L_ERR, "rlm_eap_mschapv2: out of memory");
 		return 0;
 	}

