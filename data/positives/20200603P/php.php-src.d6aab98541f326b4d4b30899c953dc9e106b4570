commit d6aab98541f326b4d4b30899c953dc9e106b4570
Author: Thies C. Arntzen <thies@php.net>
Date:   Sun Feb 18 18:31:31 2001 +0000

    fixed buffer-overwrite

diff --git a/ext/standard/string.c b/ext/standard/string.c
index 2cdd40d51d..5cf17d9aef 100644
--- a/ext/standard/string.c
+++ b/ext/standard/string.c
@@ -412,7 +412,7 @@ PHP_FUNCTION(wordwrap)
 	}
 	else {
 		/* Multiple character line break */
-		newtext = emalloc((*ptext)->value.str.len * (breakcharlen+1));
+		newtext = emalloc((*ptext)->value.str.len * (breakcharlen+1)+1);
 		newtext[0] = '\0';
 
 		i = 0;

