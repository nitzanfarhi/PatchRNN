commit 1a073a20db78bb0d0250bda27def4f03ac2b6001
Author: Dan Fandrich <dan@coneharvesters.com>
Date:   Fri Aug 22 21:40:05 2014 +0200

    sasl: Fixed a memory leak on OOM

diff --git a/lib/curl_sasl.c b/lib/curl_sasl.c
index 8f6aab2e8..7e2b8afaf 100644
--- a/lib/curl_sasl.c
+++ b/lib/curl_sasl.c
@@ -569,6 +569,7 @@ CURLcode Curl_sasl_create_digest_md5_message(struct SessionHandle *data,
                      "qop=%s",
                      userp, realm, nonce,
                      cnonce, nonceCount, spn, resp_hash_hex, qop);
+  Curl_safefree(spn);
   if(!response)
     return CURLE_OUT_OF_MEMORY;
 
@@ -576,7 +577,6 @@ CURLcode Curl_sasl_create_digest_md5_message(struct SessionHandle *data,
   result = Curl_base64_encode(data, response, 0, outptr, outlen);
 
   Curl_safefree(response);
-  Curl_safefree(spn);
 
   return result;
 }

