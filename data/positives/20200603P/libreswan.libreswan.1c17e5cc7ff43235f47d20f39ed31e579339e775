commit 1c17e5cc7ff43235f47d20f39ed31e579339e775
Author: Paul Wouters <pwouters@redhat.com>
Date:   Mon Jun 20 08:45:01 2016 -0400

    pluto: prevent infinite loop on delete_bare_shunt() failure using passert()

diff --git a/programs/pluto/kernel.c b/programs/pluto/kernel.c
index fbb0478b2..d40664ee2 100644
--- a/programs/pluto/kernel.c
+++ b/programs/pluto/kernel.c
@@ -3499,6 +3499,7 @@ void expire_bare_shunts()
 			delete_bare_shunt(&bsp->ours.addr, &bsp->his.addr,
 				bsp->transport_proto, ntohl(bsp->said.spi),
 				"expire_bare_shunt");
+			passert(bsp != *bspp);
 		} else {
 			DBG(DBG_OPPO, DBG_bare_shunt("keeping recent", bsp));
 			bspp = &bsp->next;

