commit b294a4beec24d07903c4aefb8ca26cc154fdd5ac
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Sun Oct 20 16:38:20 2013 +0200

    avformat/oggparsecelt/celt_header: fix memleak
    
    Fixes: CID1108605
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavformat/oggparsecelt.c b/libavformat/oggparsecelt.c
index 4b6233e0c7..f3c2c1a632 100644
--- a/libavformat/oggparsecelt.c
+++ b/libavformat/oggparsecelt.c
@@ -46,7 +46,9 @@ static int celt_header(AVFormatContext *s, int idx)
         uint32_t overlap, extra_headers;
 
         priv = av_malloc(sizeof(struct oggcelt_private));
-        if (!priv || ff_alloc_extradata(st->codec, 2 * sizeof(uint32_t)))
+        if (!priv)
+            return AVERROR(ENOMEM);
+        if (ff_alloc_extradata(st->codec, 2 * sizeof(uint32_t)) < 0)
             return AVERROR(ENOMEM);
         version          = AV_RL32(p + 28);
         /* unused header size field skipped */

