commit 3797cf255b78aba797db1566e52289f8d16b8238
Author: Sami Kerola <kerolasa@iki.fi>
Date:   Sun Jul 7 20:54:44 2013 +0100

    agetty: fix memory leak [clang-analyzer]
    
    Signed-off-by: Sami Kerola <kerolasa@iki.fi>

diff --git a/term-utils/agetty.c b/term-utils/agetty.c
index 487389102..b7de618f1 100644
--- a/term-utils/agetty.c
+++ b/term-utils/agetty.c
@@ -463,9 +463,11 @@ static char *replace_u(char *str, char *username)
 		}
 		sz = strlen(str);
 
-		if (p == str && sz == 2)
+		if (p == str && sz == 2) {
 			/* 'str' contains only '\u' */
+			free(old);
 			return username;
+		}
 
 		tp = entry = malloc(sz + usz);
 		if (!tp)

