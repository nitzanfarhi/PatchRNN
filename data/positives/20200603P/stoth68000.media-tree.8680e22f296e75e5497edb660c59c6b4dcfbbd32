commit 8680e22f296e75e5497edb660c59c6b4dcfbbd32
Author: Gerald Schaefer <geraldsc@de.ibm.com>
Date:   Tue Jun 21 17:15:16 2005 -0700

    [PATCH] VFS: memory leak in do_kern_mount()
    
    There is a memory leak during mount when CONFIG_SECURITY is enabled and
    mount options are specified.
    
    Signed-off-by: Gerald Schaefer <geraldsc@de.ibm.com>
    Acked-by: James Morris <jmorris@redhat.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

diff --git a/fs/super.c b/fs/super.c
index 3a1b8ca04ba6..573bcc81bb82 100644
--- a/fs/super.c
+++ b/fs/super.c
@@ -835,6 +835,7 @@ do_kern_mount(const char *fstype, int flags, const char *name, void *data)
 	mnt->mnt_parent = mnt;
 	mnt->mnt_namespace = current->namespace;
 	up_write(&sb->s_umount);
+	free_secdata(secdata);
 	put_filesystem(type);
 	return mnt;
 out_sb:

