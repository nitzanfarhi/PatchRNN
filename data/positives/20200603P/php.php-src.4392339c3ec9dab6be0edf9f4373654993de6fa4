commit 4392339c3ec9dab6be0edf9f4373654993de6fa4
Author: Stanislav Malyshev <stas@php.net>
Date:   Thu May 8 01:59:39 2014 -0700

    oops, 5.4 and 5.5 use malloc in TSRM

diff --git a/ext/bz2/bz2.c b/ext/bz2/bz2.c
index 908a78df0e..84fcc002aa 100644
--- a/ext/bz2/bz2.c
+++ b/ext/bz2/bz2.c
@@ -230,7 +230,7 @@ PHP_BZ2_API php_stream *_php_stream_bz2open(php_stream_wrapper *wrapper,
 
 	if (php_check_open_basedir(path_copy TSRMLS_CC)) {
 #ifdef VIRTUAL_DIR
-        efree(path_copy);
+		free(path_copy);
 #endif
 		return NULL;
 	}
@@ -242,7 +242,7 @@ PHP_BZ2_API php_stream *_php_stream_bz2open(php_stream_wrapper *wrapper,
 		*opened_path = estrdup(path_copy);
 	}
 #ifdef VIRTUAL_DIR
-    efree(path_copy);
+	free(path_copy);
 #endif
 	path_copy = NULL;
 	

