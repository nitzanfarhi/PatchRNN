commit c9342c81d68543d3d4ae6bb3c60d7e3cba267559
Author: Rasmus Lerdorf <rasmus@php.net>
Date:   Fri Aug 5 22:39:40 2011 +0000

    efree match_sets on an error here - found by Coverity

diff --git a/ext/pcre/php_pcre.c b/ext/pcre/php_pcre.c
index 27bea79922..41fdb32a7b 100644
--- a/ext/pcre/php_pcre.c
+++ b/ext/pcre/php_pcre.c
@@ -644,6 +644,7 @@ PHPAPI void php_pcre_match_impl(pcre_cache_entry *pce, char *subject, int subjec
 				if (pcre_get_substring_list(subject, offsets, count, &stringlist) < 0) {
 					efree(subpat_names);
 					efree(offsets);
+					if (match_sets) efree(match_sets);
 					php_error_docref(NULL TSRMLS_CC, E_WARNING, "Get subpatterns list failed");
 					RETURN_FALSE;
 				}

