commit 6d255f86330289ca58d4cd394d61773725ac08d8
Author: Jeff Morriss <jeff.morriss.ws@gmail.com>
Date:   Tue Sep 24 00:31:49 2013 +0000

    From Peter Wu via https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=6596 :
    
    Allow reading SSL keylog files with carriage returns.
    
    svn path=/trunk/; revision=52197

diff --git a/epan/dissectors/packet-ssl-utils.c b/epan/dissectors/packet-ssl-utils.c
index da3ee6683a..11a0fc80b6 100644
--- a/epan/dissectors/packet-ssl-utils.c
+++ b/epan/dissectors/packet-ssl-utils.c
@@ -4194,6 +4194,10 @@ ssl_keylog_lookup(SslDecryptSession* ssl_session,
             line[bytes_read - 1] = 0;
             bytes_read--;
         }
+        if (bytes_read > 0 && line[bytes_read - 1] == '\r') {
+            line[bytes_read - 1] = 0;
+            bytes_read--;
+        }
 
         ssl_debug_printf("  checking keylog line: %s\n", line);
 

