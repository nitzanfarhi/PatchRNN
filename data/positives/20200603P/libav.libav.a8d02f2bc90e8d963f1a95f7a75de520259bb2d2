commit a8d02f2bc90e8d963f1a95f7a75de520259bb2d2
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Sun Feb 13 23:36:04 2005 +0000

    buffer overflow
    
    Originally committed as revision 3954 to svn://svn.ffmpeg.org/ffmpeg/trunk

diff --git a/libavcodec/pcm.c b/libavcodec/pcm.c
index 13a16e747..8e57d11a1 100644
--- a/libavcodec/pcm.c
+++ b/libavcodec/pcm.c
@@ -299,6 +299,9 @@ static int pcm_decode_frame(AVCodecContext *avctx,
     samples = data;
     src = buf;
 
+    if(buf_size > AVCODEC_MAX_AUDIO_FRAME_SIZE/2)
+        buf_size = AVCODEC_MAX_AUDIO_FRAME_SIZE/2;
+
     switch(avctx->codec->id) {
     case CODEC_ID_PCM_S16LE:
         n = buf_size >> 1;

