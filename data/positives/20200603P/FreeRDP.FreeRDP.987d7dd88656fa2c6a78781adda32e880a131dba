commit 987d7dd88656fa2c6a78781adda32e880a131dba
Author: ilammy <a.lozovsky@gmail.com>
Date:   Wed May 24 23:19:39 2017 +0300

    winpr/file: add missing NULL check
    
    ValidFileNameComponent() has been missing a NULL check for its argument.
    It's pretty obvious that NULL is not a valid file name component.

diff --git a/winpr/libwinpr/file/file.c b/winpr/libwinpr/file/file.c
index a187d74fc..c8e95977f 100644
--- a/winpr/libwinpr/file/file.c
+++ b/winpr/libwinpr/file/file.c
@@ -824,6 +824,9 @@ BOOL ValidFileNameComponent(LPCWSTR lpFileName)
 {
 	LPCWSTR c = NULL;
 
+	if (!lpFileName)
+		return FALSE;
+
 	/* CON */
 	if ((lpFileName[0] != L'\0' && (lpFileName[0] == L'C' || lpFileName[0] == L'c')) &&
 	    (lpFileName[1] != L'\0' && (lpFileName[1] == L'O' || lpFileName[1] == L'o')) &&

