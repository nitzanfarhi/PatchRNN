commit aa9f8a30fd7dc7aa3aa2575b75b3f9a0ab3f02db
Author: Andreas Henriksson <andreas@fatal.se>
Date:   Tue Sep 16 21:11:02 2014 +0200

    core: fix resource leak in manager_environment_add
    
    Second error path must free the (potentially) allocated memory in the
    first code chunk before returning.
    
    Found by coverity. Fixes: CID#1237750

diff --git a/src/core/manager.c b/src/core/manager.c
index 0770727cd..e0c1cd187 100644
--- a/src/core/manager.c
+++ b/src/core/manager.c
@@ -2751,8 +2751,10 @@ int manager_environment_add(Manager *m, char **minus, char **plus) {
 
         if (!strv_isempty(plus)) {
                 b = strv_env_merge(2, l, plus);
-                if (!b)
+                if (!b) {
+                        strv_free(a);
                         return -ENOMEM;
+                }
 
                 l = b;
         }

