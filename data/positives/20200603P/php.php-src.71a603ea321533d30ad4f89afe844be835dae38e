commit 71a603ea321533d30ad4f89afe844be835dae38e
Author: Sascha Schumann <sas@php.net>
Date:   Sat Jun 29 18:46:49 2002 +0000

    Fix some 8bit issues with IRCG nickname encoding and
    Change the underlying interface of smart_str to accept unsigned char.

diff --git a/ext/standard/php_smart_str.h b/ext/standard/php_smart_str.h
index d05e615fe7..63a0b1b527 100644
--- a/ext/standard/php_smart_str.h
+++ b/ext/standard/php_smart_str.h
@@ -49,13 +49,13 @@
 #define smart_str_append_long(dest, val) smart_str_append_long_ex(dest, val, 0)
 #define smart_str_append_unsigned(dest, val) smart_str_append_unsigned_ex(dest, val, 0)
 
-static inline void smart_str_appendc_ex(smart_str *dest, char c, int what)
+static inline void smart_str_appendc_ex(smart_str *dest, unsigned char c, int what)
 {
 	size_t newlen;
 
 	smart_str_alloc(dest, 1, what);
 	dest->len = newlen;
-	dest->c[dest->len - 1] = c;
+	((unsigned char *) dest->c)[dest->len - 1] = c;
 }
 
 

