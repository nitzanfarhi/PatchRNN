commit caba1a19dc3f9e31612d8439cfa7fbf60d05bbb0
Author: ksss <co000ri@gmail.com>
Date:   Tue Dec 27 15:48:53 2016 +0900

    Check array max size
    
    Fix #3354

diff --git a/src/array.c b/src/array.c
index 056d7292..2ce4e5dc 100644
--- a/src/array.c
+++ b/src/array.c
@@ -619,6 +619,10 @@ mrb_ary_splice(mrb_state *mrb, mrb_value ary, mrb_int head, mrb_int len, mrb_val
   size = head + argc;
 
   if (tail < a->len) size += a->len - tail;
+
+  if (size < 0 || size > ARY_MAX_SIZE)
+    mrb_raise(mrb, E_ARGUMENT_ERROR, "array size too big");
+
   if (size > a->aux.capa)
     ary_expand_capa(mrb, a, size);
 

