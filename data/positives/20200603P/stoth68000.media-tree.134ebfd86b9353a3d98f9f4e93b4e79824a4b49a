commit 134ebfd86b9353a3d98f9f4e93b4e79824a4b49a
Author: Benjamin Tissoires <benjamin.tissoires@gmail.com>
Date:   Tue Dec 4 16:27:54 2012 +0100

    HID: i2c-hid: also call i2c_hid_free_buffers in i2c_hid_remove
    
    In the case where the hid driver in charge of handling the hid part
    of the device (hid-generic for instance) fails at probe, neither
    i2c_hid_start nor i2c_hid_stop are called.
    Thus, the buffers allocated in i2c_hid_probe are never freed.
    
    Signed-off-by: Benjamin Tissoires <benjamin.tissoires@gmail.com>
    Signed-off-by: Jiri Kosina <jkosina@suse.cz>

diff --git a/drivers/hid/i2c-hid/i2c-hid.c b/drivers/hid/i2c-hid/i2c-hid.c
index 035a0cdd129e..aab3357626c7 100644
--- a/drivers/hid/i2c-hid/i2c-hid.c
+++ b/drivers/hid/i2c-hid/i2c-hid.c
@@ -908,6 +908,9 @@ static int __devexit i2c_hid_remove(struct i2c_client *client)
 
 	free_irq(client->irq, ihid);
 
+	if (ihid->bufsize)
+		i2c_hid_free_buffers(ihid);
+
 	kfree(ihid);
 
 	return 0;

