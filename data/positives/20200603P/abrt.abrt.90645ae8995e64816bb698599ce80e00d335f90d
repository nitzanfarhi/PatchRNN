commit 90645ae8995e64816bb698599ce80e00d335f90d
Author: Nikola Pajkovsky <npajkovs@redhat.com>
Date:   Tue Feb 14 14:14:20 2012 +0100

    rhbz#789526 - abrt hashing on kernel backtraces needs improving
    
    Signed-off-by: Nikola Pajkovsky <npajkovs@redhat.com>

diff --git a/src/plugins/abrt-action-analyze-oops.c b/src/plugins/abrt-action-analyze-oops.c
index 85c44ab5..cd4855b9 100644
--- a/src/plugins/abrt-action-analyze-oops.c
+++ b/src/plugins/abrt-action-analyze-oops.c
@@ -48,10 +48,15 @@ static void hash_oops_str(char hash_str[SHA1_RESULT_LEN*2 + 1], char *oops_buf,
 
             end_mem_block = skip_whitespace(end_mem_block);
 
-            /* +1 for '?' and +1 for space after '?' == +2*/
+            /* skip symbols prefixed with ? */
             if (end_mem_block && *end_mem_block == '?')
-                end_mem_block += 2;
+            {
+                call_trace += end_line - call_trace + 1;
+                end_line = strchr(call_trace, '\n');
 
+                free(line);
+                continue;
+            }
             /* strip out offset +off/len */
             char *begin_off_len = strchr(end_mem_block, '+');
             if (!begin_off_len)

