commit 9f9440bd8122cc8798139c9370db0873a24ae14b
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Thu Nov 27 02:31:46 2014 +0100

    avcodec/hevc_ps: Check return code from pps_range_extensions()
    
    Fixes out of array read
    Fixes: asan_heap-oob_177e222_885_cov_1532528832_MERGE_D_TI_3.bit
    Found-by: Mateusz "j00ru" Jurczyk and Gynvael Coldwind
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavcodec/hevc_ps.c b/libavcodec/hevc_ps.c
index 4e1c56163d..0d6ede2384 100644
--- a/libavcodec/hevc_ps.c
+++ b/libavcodec/hevc_ps.c
@@ -1375,7 +1375,8 @@ int ff_hevc_decode_nal_pps(HEVCContext *s)
         int pps_range_extensions_flag = get_bits1(gb);
         /* int pps_extension_7bits = */ get_bits(gb, 7);
         if (sps->ptl.general_ptl.profile_idc == FF_PROFILE_HEVC_REXT && pps_range_extensions_flag) {
-            pps_range_extensions(s, pps, sps);
+            if ((ret = pps_range_extensions(s, pps, sps)) < 0)
+                goto err;
         }
     }
 

