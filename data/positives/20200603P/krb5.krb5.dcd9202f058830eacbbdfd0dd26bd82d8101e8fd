commit dcd9202f058830eacbbdfd0dd26bd82d8101e8fd
Author: Kevin Wasserman <kevin.wasserman@painless-security.com>
Date:   Tue May 29 13:29:14 2012 -0400

    fix leak in cc_mslsa.c
    
    cc_name needs to be freed in krb5_lcc_close().
    
    Signed-off-by: Kevin Wasserman <kevin.wasserman@painless-security.com>
    
    ticket: 7213

diff --git a/src/lib/krb5/ccache/cc_mslsa.c b/src/lib/krb5/ccache/cc_mslsa.c
index e1a2f70e3..de1dcb3b0 100644
--- a/src/lib/krb5/ccache/cc_mslsa.c
+++ b/src/lib/krb5/ccache/cc_mslsa.c
@@ -2162,6 +2162,8 @@ krb5_lcc_close(krb5_context context, krb5_ccache id)
 
         if (data) {
             LsaDeregisterLogonProcess(data->LogonHandle);
+            if (data->cc_name)
+                free(data->cc_name);
             free(data);
         }
         free(id);

