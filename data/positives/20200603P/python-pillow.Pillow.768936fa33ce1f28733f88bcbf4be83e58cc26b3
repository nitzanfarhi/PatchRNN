commit 768936fa33ce1f28733f88bcbf4be83e58cc26b3
Author: wiredfool <eric-github@soroos.net>
Date:   Sat May 21 07:23:54 2016 -0700

    overflow check for im->linesize

diff --git a/libImaging/Storage.c b/libImaging/Storage.c
index 04d6dd23..096717ce 100644
--- a/libImaging/Storage.c
+++ b/libImaging/Storage.c
@@ -56,6 +56,11 @@ ImagingNewPrologueSubtype(const char *mode, int xsize, int ysize,
     if (!im)
         return (Imaging) ImagingError_MemoryError();
 
+    /* linesize overflow check, roughly the current largest space req'd */
+    if (xsize > (INT_MAX / 4) - 1) {
+        return (Imaging) ImagingError_MemoryError();
+    }
+
     /* Setup image descriptor */
     im->xsize = xsize;
     im->ysize = ysize;
@@ -306,8 +311,8 @@ ImagingNewArray(const char *mode, int xsize, int ysize)
 
     /* Allocate image as an array of lines */
     for (y = 0; y < im->ysize; y++) {
-        /* malloc check UNDONE - where is linesize set? */
-        p = (char *) malloc(im->linesize);
+        /* malloc check linesize checked in prologue */
+        p = (char *) calloc(1, im->linesize);
         if (!p) {
             ImagingDestroyArray(im);
             break;

