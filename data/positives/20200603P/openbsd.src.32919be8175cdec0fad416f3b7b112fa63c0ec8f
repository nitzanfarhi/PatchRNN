commit 32919be8175cdec0fad416f3b7b112fa63c0ec8f
Author: doug <doug@openbsd.org>
Date:   Wed Oct 8 03:59:56 2014 +0000

    userland reallocarray audit.
    
    Replace malloc() and realloc() calls that may have integer overflow in the
    multiplication of the arguments with reallocarray().
    
    ok deraadt@

diff --git a/usr.bin/dc/bcode.c b/usr.bin/dc/bcode.c
index c7c28ee3ff8..c38b83f73b4 100644
--- a/usr.bin/dc/bcode.c
+++ b/usr.bin/dc/bcode.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: bcode.c,v 1.45 2012/11/07 11:06:14 otto Exp $	*/
+/*	$OpenBSD: bcode.c,v 1.46 2014/10/08 03:59:56 doug Exp $	*/
 
 /*
  * Copyright (c) 2003, Otto Moerbeek <otto@drijf.net>
@@ -1691,7 +1691,7 @@ eval_string(char *p)
 	if (bmachine.readsp == bmachine.readstack_sz - 1) {
 		size_t newsz = bmachine.readstack_sz * 2;
 		struct source *stack;
-		stack = realloc(bmachine.readstack, newsz *
+		stack = reallocarray(bmachine.readstack, newsz,
 		    sizeof(struct source));
 		if (stack == NULL)
 			err(1, "recursion too deep");

