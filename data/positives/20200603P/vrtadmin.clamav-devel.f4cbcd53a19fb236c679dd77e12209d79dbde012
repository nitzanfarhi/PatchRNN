commit f4cbcd53a19fb236c679dd77e12209d79dbde012
Author: Kevin Lin <klin@sourcefire.com>
Date:   Tue Aug 18 14:52:55 2015 -0400

    cid 12123 - fix error state in allocating memory in pdf finalize

diff --git a/libclamav/pdfng.c b/libclamav/pdfng.c
index e9313de24..87f62bef6 100644
--- a/libclamav/pdfng.c
+++ b/libclamav/pdfng.c
@@ -260,8 +260,10 @@ char *pdf_finalize_string(struct pdf_struct *pdf, struct pdf_obj *obj, const cha
     /* TODO: replace the escape sequences directly in the wrkstr   */
     if (strchr(wrkstr, '\\')) {
         output = cli_calloc(wrklen+1, sizeof(char));
-        if (!output)
+        if (!output) {
+            free(wrkstr);
             return NULL;
+        }
 
         outlen = 0;
         for (i = 0; i < wrklen; ++i) {

