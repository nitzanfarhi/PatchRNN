commit a6353fadcd00ddb0922346d0351051cda1753154
Author: ray <ray@openbsd.org>
Date:   Wed Sep 20 21:26:20 2006 +0000

    Recommit memory leak fix.

diff --git a/usr.bin/top/machine.c b/usr.bin/top/machine.c
index 697de570ee4..20e3b39eac0 100644
--- a/usr.bin/top/machine.c
+++ b/usr.bin/top/machine.c
@@ -1,4 +1,4 @@
-/* $OpenBSD: machine.c,v 1.52 2006/04/29 14:40:44 otto Exp $	 */
+/* $OpenBSD: machine.c,v 1.53 2006/09/20 21:26:20 ray Exp $	 */
 
 /*-
  * Copyright (c) 1994 Thorsten Lockert <tholo@sigmasoft.com>
@@ -725,8 +725,10 @@ swapmode(int *used, int *total)
 		return 0;
 
 	rnswap = swapctl(SWAP_STATS, swdev, nswap);
-	if (rnswap == -1)
+	if (rnswap == -1) {
+		free(swdev);
 		return 0;
+	}
 
 	/* if rnswap != nswap, then what? */
 

