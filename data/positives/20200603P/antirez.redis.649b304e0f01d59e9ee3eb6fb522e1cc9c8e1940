commit 649b304e0f01d59e9ee3eb6fb522e1cc9c8e1940
Author: Michel Martens <michel@soveran.com>
Date:   Thu Apr 25 11:06:10 2013 -0300

    Reset masterauth if an empty string is configured.

diff --git a/src/config.c b/src/config.c
index 6d2b6829..ec51766e 100644
--- a/src/config.c
+++ b/src/config.c
@@ -532,7 +532,11 @@ void configSetCommand(redisClient *c) {
         server.requirepass = ((char*)o->ptr)[0] ? zstrdup(o->ptr) : NULL;
     } else if (!strcasecmp(c->argv[2]->ptr,"masterauth")) {
         zfree(server.masterauth);
-        server.masterauth = zstrdup(o->ptr);
+        if (sdslen(o->ptr)) {
+          server.masterauth = zstrdup(o->ptr);
+        } else {
+          server.masterauth = NULL;
+        }
     } else if (!strcasecmp(c->argv[2]->ptr,"maxmemory")) {
         if (getLongLongFromObject(o,&ll) == REDIS_ERR ||
             ll < 0) goto badfmt;

