commit 92d30446251591a6805168f51a4b07ff65b3cc24
Author: Wilmer van der Gaast <wilmer@gaast.net>
Date:   Tue Dec 18 01:24:33 2012 +0000

    Improved failure handling in jabber_si_handle_request(). If the imcb
    callback fails, we shouldn't try to continue the ft and dereference the NULL
    ptr it returned.

diff --git a/protocols/jabber/si.c b/protocols/jabber/si.c
index 4b0e57c4..f5f3b2fe 100644
--- a/protocols/jabber/si.c
+++ b/protocols/jabber/si.c
@@ -292,9 +292,11 @@ int jabber_si_handle_request( struct im_connection *ic, struct xt_node *node, st
 			requestok = FALSE;
 		}
 
-		*s = '/';
+		if( s )
+			*s = '/';
 	}
-	else
+	
+	if( !requestok )
 	{ 
 		reply = jabber_make_error_packet( node, "item-not-found", "cancel", NULL );
 		if (!jabber_write_packet( ic, reply ))

