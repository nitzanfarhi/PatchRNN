commit 2a7f06843814d3216e4f623c58e80ef4d19638c6
Author: Victor Julien <victor@inliniac.net>
Date:   Fri Mar 11 07:01:06 2016 +0100

    ioctl: fix NULL check after dereference (CID 1204326)

diff --git a/src/util-ioctl.c b/src/util-ioctl.c
index 99a84a7e..e0b5ef82 100644
--- a/src/util-ioctl.c
+++ b/src/util-ioctl.c
@@ -117,18 +117,16 @@ int GetIfaceMTU(const char *pcap_dev)
  */
 int GetIfaceMaxPacketSize(const char *pcap_dev)
 {
-    int ll_header = GetIfaceMaxHWHeaderLength(pcap_dev);
-    int mtu = 0;
-
     if ((pcap_dev == NULL) || strlen(pcap_dev) == 0)
         return 0;
 
-    mtu = GetIfaceMTU(pcap_dev);
+    int mtu = GetIfaceMTU(pcap_dev);
     switch (mtu) {
         case 0:
         case -1:
             return 0;
     }
+    int ll_header = GetIfaceMaxHWHeaderLength(pcap_dev);
     if (ll_header == -1) {
         /* be conservative, choose a big one */
         ll_header = 16;

