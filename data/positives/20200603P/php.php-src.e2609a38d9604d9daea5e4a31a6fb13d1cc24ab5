commit e2609a38d9604d9daea5e4a31a6fb13d1cc24ab5
Author: Anatol Belski <ab@php.net>
Date:   Mon Aug 29 18:01:21 2016 +0200

    fix leak

diff --git a/ext/ldap/ldap.c b/ext/ldap/ldap.c
index 5ffc17b96f..e709e592fa 100644
--- a/ext/ldap/ldap.c
+++ b/ext/ldap/ldap.c
@@ -367,6 +367,7 @@ PHP_FUNCTION(ldap_connect)
 			int	urllen = hostlen + sizeof( "ldap://:65535" );
 
 			if (port <= 0 || port > 65535) {
+				efree(ld);
 				php_error_docref(NULL TSRMLS_CC, E_WARNING, "invalid port number: %ld", port);
 				RETURN_FALSE;
 			}

