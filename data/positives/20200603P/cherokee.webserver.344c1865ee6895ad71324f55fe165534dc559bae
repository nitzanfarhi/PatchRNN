commit 344c1865ee6895ad71324f55fe165534dc559bae
Author: alobbs <alvaro@alobbs.com>
Date:   Sun May 22 10:59:36 2011 +0000

    "Memory leak. Dynamic memory stored in 'file_content.buf' allocated
    through function 'cherokee_buffer_read_file' at line 317 is lost at
    line 319" (Klocwork.com Issue #47)
    
    git-svn-id: svn://cherokee-project.com/cherokee/trunk@6682 5dc97367-97f1-0310-9951-d761b3857238

diff --git a/cherokee/handler_ssi.c b/cherokee/handler_ssi.c
index 58ede529..ad992a79 100644
--- a/cherokee/handler_ssi.c
+++ b/cherokee/handler_ssi.c
@@ -325,6 +325,7 @@ parse (cherokee_handler_ssi_t *hdl,
 
 					ret = parse (hdl, &file_content, out);
 					if (unlikely (ret != ret_ok)) {
+						cherokee_buffer_mrproper (&file_content);
 						return ret_error;
 					}
 

