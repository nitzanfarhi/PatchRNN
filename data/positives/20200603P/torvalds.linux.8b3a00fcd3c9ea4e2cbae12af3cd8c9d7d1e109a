commit 8b3a00fcd3c9ea4e2cbae12af3cd8c9d7d1e109a
Author: Alexander Graf <agraf@suse.de>
Date:   Thu Feb 16 14:12:46 2012 +0000

    KVM: PPC: booke: BOOKE_IRQPRIO_MAX is n+1
    
    The semantics of BOOKE_IRQPRIO_MAX changed to denote the highest available
    irqprio + 1, so let's reflect that in the code too.
    
    Signed-off-by: Alexander Graf <agraf@suse.de>
    Signed-off-by: Avi Kivity <avi@redhat.com>

diff --git a/arch/powerpc/kvm/booke.c b/arch/powerpc/kvm/booke.c
index 3da0e4273389..11b06251e42e 100644
--- a/arch/powerpc/kvm/booke.c
+++ b/arch/powerpc/kvm/booke.c
@@ -425,7 +425,7 @@ static void kvmppc_core_check_exceptions(struct kvm_vcpu *vcpu)
 	}
 
 	priority = __ffs(*pending);
-	while (priority <= BOOKE_IRQPRIO_MAX) {
+	while (priority < BOOKE_IRQPRIO_MAX) {
 		if (kvmppc_booke_irqprio_deliver(vcpu, priority))
 			break;
 

