commit a55eb05a57a981f16325d035ee3a3ad10485ea0d
Author: Jens Osterkamp <jens@de.ibm.com>
Date:   Thu Feb 1 12:07:47 2007 +0100

    spidernet : fix memory leak in spider_net_stop
    
    We forget to call spider_net_free_rx_chain_contents which does the
    actual dev_kfree_skb. New skbs are allocated from skbuff_head_cache
    on each "ifconfig up" letting the cache grow infinitely.
    
    This patch fixes it.
    
    Signed-off-by: Jens Osterkamp <jens@de.ibm.com>
    Signed-off-by: Jeff Garzik <jeff@garzik.org>

diff --git a/drivers/net/spider_net.c b/drivers/net/spider_net.c
index ebb6aa39f9c7..8ea2fc1b96cb 100644
--- a/drivers/net/spider_net.c
+++ b/drivers/net/spider_net.c
@@ -1925,6 +1925,8 @@ spider_net_stop(struct net_device *netdev)
 	/* release chains */
 	spider_net_release_tx_chain(card, 1);
 
+	spider_net_free_rx_chain_contents(card);
+
 	spider_net_free_chain(card, &card->tx_chain);
 	spider_net_free_chain(card, &card->rx_chain);
 

