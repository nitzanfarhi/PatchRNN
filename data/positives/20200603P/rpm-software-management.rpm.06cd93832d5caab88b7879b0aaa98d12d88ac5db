commit 06cd93832d5caab88b7879b0aaa98d12d88ac5db
Author: Panu Matilainen <pmatilai@redhat.com>
Date:   Mon May 28 12:02:47 2012 +0300

    Fix spec parsing memleak from source header on buildarch recursion

diff --git a/build/parseSpec.c b/build/parseSpec.c
index 491bfa526..d1a0788db 100644
--- a/build/parseSpec.c
+++ b/build/parseSpec.c
@@ -453,6 +453,9 @@ static void initSourceHeader(rpmSpec spec)
 {
     struct Source *srcPtr;
 
+    if (spec->sourceHeader)
+	return;
+
     spec->sourceHeader = headerNew();
     /* Only specific tags are added to the source package header */
     headerCopyTags(spec->packages->header, spec->sourceHeader, sourceTags);

