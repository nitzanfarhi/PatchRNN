commit 449929fc356e07f66675e0fc987eb6a6501221c3
Author: Armin Novak <armin.novak@thincast.com>
Date:   Wed Apr 15 10:37:28 2015 +0200

    Fixed NULL dereference.

diff --git a/channels/cliprdr/server/cliprdr_main.c b/channels/cliprdr/server/cliprdr_main.c
index f0f4bebb5..dd8db3813 100644
--- a/channels/cliprdr/server/cliprdr_main.c
+++ b/channels/cliprdr/server/cliprdr_main.c
@@ -629,11 +629,11 @@ static int cliprdr_server_receive_format_list(CliprdrServerContext* context, wSt
 
 	for (index = 0; index < formatList.numFormats; index++)
 	{
-		if (formats[index].formatName)
-			free(formats[index].formatName);
+		if (formatList.formats[index].formatName)
+			free(formatList.formats[index].formatName);
 	}
 
-	free(formats);
+	free(formatList.formats);
 
 	return 1;
 }

