commit c2f0f82bb4aadf5eaf7bc72f4c990dd875d91731
Author: Mats Klepsland <mats.klepsland@gmail.com>
Date:   Sun Apr 10 14:57:19 2016 +0200

    util-decode-der: fix hang detected by AFL
    
    Fix hang that occurs when child->length is zero, resulting in an
    endless loop.

diff --git a/src/util-decode-der.c b/src/util-decode-der.c
index f9749766..be56b5e5 100644
--- a/src/util-decode-der.c
+++ b/src/util-decode-der.c
@@ -270,6 +270,12 @@ static Asn1Generic * DecodeAsn1DerGeneric(const unsigned char *buffer,
     if (child == NULL)
         return NULL;
 
+    /* child length should never be zero */
+    if (child->length == 0) {
+        SCFree(child);
+        return NULL;
+    }
+
     child->header = el;
     return child;
 }

