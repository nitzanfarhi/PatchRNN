commit 0e79d0c9a7ca3ee04f7d10a3be21aed1e1afcf35
Author: Timo Sirainen <tss@iki.fi>
Date:   Wed Feb 20 15:56:56 2013 +0200

    acl: Skip ACLs if admin user flag is set (especially dsync).

diff --git a/src/plugins/acl/acl-api.c b/src/plugins/acl/acl-api.c
index 062211aa7..1a60b4d4c 100644
--- a/src/plugins/acl/acl-api.c
+++ b/src/plugins/acl/acl-api.c
@@ -3,6 +3,8 @@
 #include "lib.h"
 #include "str.h"
 #include "hash.h"
+#include "mail-user.h"
+#include "mailbox-list.h"
 #include "acl-cache.h"
 #include "acl-api-private.h"
 
@@ -31,6 +33,12 @@ int acl_object_have_right(struct acl_object *aclobj, unsigned int right_idx)
 	struct acl_backend *backend = aclobj->backend;
 	const struct acl_mask *have_mask;
 
+	if (mailbox_list_get_user(aclobj->backend->list)->admin) {
+		/* admin user (especially dsync) can do anything regardless
+		   of ACLs */
+		return 1;
+	}
+
 	if (backend->v.object_refresh_cache(aclobj) < 0)
 		return -1;
 

