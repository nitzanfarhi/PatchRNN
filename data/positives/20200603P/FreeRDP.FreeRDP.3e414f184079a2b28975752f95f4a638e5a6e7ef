commit 3e414f184079a2b28975752f95f4a638e5a6e7ef
Author: Marc-Andr√© Moreau <marcandre.moreau@gmail.com>
Date:   Fri Feb 13 08:41:47 2015 -0500

    libfreerdp-core: fix server-side transport_attach crash

diff --git a/libfreerdp/core/transport.c b/libfreerdp/core/transport.c
index b5a517de1..06a5f9dd2 100644
--- a/libfreerdp/core/transport.c
+++ b/libfreerdp/core/transport.c
@@ -69,7 +69,11 @@ wStream* transport_send_stream_init(rdpTransport* transport, int size)
 
 void transport_attach(rdpTransport* transport, int sockfd)
 {
+	if (!transport->TcpIn)
+		transport->TcpIn = freerdp_tcp_new(transport->settings);
+
 	freerdp_tcp_attach(transport->TcpIn, sockfd);
+
 	transport->SplitInputOutput = FALSE;
 	transport->frontBio = transport->TcpIn->bufferedBio;
 }

