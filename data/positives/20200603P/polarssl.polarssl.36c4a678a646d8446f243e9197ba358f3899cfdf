commit 36c4a678a646d8446f243e9197ba358f3899cfdf
Author: Paul Bakker <p.j.bakker@polarssl.org>
Date:   Fri Nov 9 15:30:07 2012 +0000

     - Fixed off-by-one loop

diff --git a/library/ctr_drbg.c b/library/ctr_drbg.c
index 1de7f05e9..8cf03712e 100644
--- a/library/ctr_drbg.c
+++ b/library/ctr_drbg.c
@@ -194,7 +194,7 @@ int ctr_drbg_update_internal( ctr_drbg_context *ctx,
         /*
          * Increase counter
          */
-        for( i = CTR_DRBG_BLOCKSIZE; i >= 0; i-- )
+        for( i = CTR_DRBG_BLOCKSIZE; i > 0; i-- )
             if( ++ctx->counter[i - 1] != 0 )
                 break;
 

