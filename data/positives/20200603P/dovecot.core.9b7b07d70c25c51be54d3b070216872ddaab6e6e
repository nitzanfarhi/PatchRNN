commit 9b7b07d70c25c51be54d3b070216872ddaab6e6e
Author: Aki Tuomi <aki.tuomi@dovecot.fi>
Date:   Wed Oct 19 16:31:01 2016 +0300

    lib-program-client: Fix memory access problem

diff --git a/src/lib-program-client/program-client.c b/src/lib-program-client/program-client.c
index 4faf733f4..6778d14a7 100644
--- a/src/lib-program-client/program-client.c
+++ b/src/lib-program-client/program-client.c
@@ -397,7 +397,7 @@ void program_client_program_input(struct program_client *pclient)
 		}
 		if (program_client_input_pending(pclient))
 			return;
-		if (!input->eof) {
+		if (pclient->program_input != NULL && !input->eof) {
 			program_client_fail(pclient,
 					    PROGRAM_CLIENT_ERROR_IO);
 			return;

