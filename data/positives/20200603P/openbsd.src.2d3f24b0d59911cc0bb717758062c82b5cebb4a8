commit 2d3f24b0d59911cc0bb717758062c82b5cebb4a8
Author: hshoexer <hshoexer@openbsd.org>
Date:   Mon Jun 14 10:04:22 2004 +0000

    added a missing message_free().
    
    ok ho@

diff --git a/sbin/isakmpd/message.c b/sbin/isakmpd/message.c
index 08c1503445f..71e0004af35 100644
--- a/sbin/isakmpd/message.c
+++ b/sbin/isakmpd/message.c
@@ -1,4 +1,4 @@
-/* $OpenBSD: message.c,v 1.78 2004/06/14 09:55:41 ho Exp $	 */
+/* $OpenBSD: message.c,v 1.79 2004/06/14 10:04:22 hshoexer Exp $	 */
 /* $EOM: message.c,v 1.156 2000/10/10 12:36:39 provos Exp $	 */
 
 /*
@@ -515,6 +515,7 @@ message_validate_delete(struct message *msg, struct payload *p)
 	/* Only accept authenticated DELETEs. */
 	if ((msg->flags & MSG_AUTHENTICATED) == 0) {
 		log_print("message_validate_delete: got unauthenticated DELETE");
+		message_free(msg);
 		return -1;
 	}
 

