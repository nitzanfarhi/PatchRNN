commit 905f15c4456aa6ab7697054043d0e94eb67147f2
Author: Barry Perlman <barry@tokutek.com>
Date:   Wed Nov 18 14:27:02 2009 +0000

    Closes #2121 closes[t:2121] Free memory for last remaining ydbtime struct when shutting down.
    
    
    git-svn-id: file:///svn/toku/tokudb@15975 c7de825b-a66e-492c-adef-691d508d4ae1

diff --git a/src/elocks.c b/src/elocks.c
index 35370ac0862..3721ba00824 100644
--- a/src/elocks.c
+++ b/src/elocks.c
@@ -107,6 +107,8 @@ toku_ydb_lock_destroy(void) {
     int r;
     r = toku_pthread_mutex_destroy(&ydb_big_lock.lock); assert(r == 0);
 #if YDB_LOCK_MISS_TIME
+    void * last_ydbtime = toku_pthread_getspecific(ydb_big_lock.time_key);
+    if (last_ydbtime) toku_free(last_ydbtime);
     r = toku_pthread_key_delete(ydb_big_lock.time_key); assert(r == 0);
 #endif
     return r;

