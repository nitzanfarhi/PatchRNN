commit 61543432c0d9f31ff65d8c6793bd8208cc64440f
Author: Tsuda Kageyu <tsuda.kageyu@gmail.com>
Date:   Tue Dec 23 20:58:36 2014 +0900

    Fix an excessive loop when parsing an APE file.

diff --git a/taglib/ape/apetag.cpp b/taglib/ape/apetag.cpp
index e1252193..22471d40 100644
--- a/taglib/ape/apetag.cpp
+++ b/taglib/ape/apetag.cpp
@@ -368,10 +368,13 @@ ByteVector APE::Tag::render() const
 
 void APE::Tag::parse(const ByteVector &data)
 {
-  uint pos = 0;
-
   // 11 bytes is the minimum size for an APE item
 
+  if(data.size() < 11)
+    return;
+
+  uint pos = 0;
+
   for(uint i = 0; i < d->footer.itemCount() && pos <= data.size() - 11; i++) {
     APE::Item item;
     item.parse(data.mid(pos));

