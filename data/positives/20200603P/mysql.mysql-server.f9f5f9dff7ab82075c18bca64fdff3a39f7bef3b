commit f9f5f9dff7ab82075c18bca64fdff3a39f7bef3b
Author: stewart@mysql.com <>
Date:   Mon Apr 24 15:59:34 2006 -0700

    BUG#19318 valgrind: memory leak in ndb_mgmd
    
    2nd part of the patch
    
    fix functions called by ndbd to deal with memory allocation properly.

diff --git a/ndb/src/mgmapi/mgmapi.cpp b/ndb/src/mgmapi/mgmapi.cpp
index b02367a8870..631b401263c 100644
--- a/ndb/src/mgmapi/mgmapi.cpp
+++ b/ndb/src/mgmapi/mgmapi.cpp
@@ -1808,7 +1808,7 @@ ndb_mgm_get_configuration(NdbMgmHandle handle, unsigned int version) {
     }
 
     delete prop;
-    return (ndb_mgm_configuration*)cvf.m_cfg;
+    return (ndb_mgm_configuration*)cvf.getConfigValues();
   } while(0);
 
   delete prop;
diff --git a/ndb/src/mgmsrv/ConfigInfo.cpp b/ndb/src/mgmsrv/ConfigInfo.cpp
index 817943f5e51..668a0ed3529 100644
--- a/ndb/src/mgmsrv/ConfigInfo.cpp
+++ b/ndb/src/mgmsrv/ConfigInfo.cpp
@@ -2344,6 +2344,7 @@ ConfigInfo::ConfigInfo()
       ndbout << "Edit file " << __FILE__ << "." << endl;
       require(false);
     }
+    delete section;
   }
 }
 

