commit 001a3f5abfd2d1da4597510b5f75fcf7ec97ed33
Author: ths <ths@c046a42c-6fe2-441c-8c8c-71466251a162>
Date:   Mon Dec 3 02:17:39 2007 +0000

    Fix floppy initialization, by Laurent Vivier.
    
    
    git-svn-id: svn://svn.savannah.nongnu.org/qemu/trunk@3768 c046a42c-6fe2-441c-8c8c-71466251a162

diff --git a/hw/mips_pica61.c b/hw/mips_pica61.c
index ced0e55671..dfbc2f0d49 100644
--- a/hw/mips_pica61.c
+++ b/hw/mips_pica61.c
@@ -172,8 +172,9 @@ void mips_pica61_init (int ram_size, int vga_ram_size,
     for (i = 0; i < MAX_FD; i++) {
         index = drive_get_index(IF_FLOPPY, 0, i);
         if (index == -1)
-            continue;
-        fd[i] = drives_table[index].bdrv;
+            fd[i] = NULL;
+        else
+            fd[i] = drives_table[index].bdrv;
     }
     fdctrl_init(i8259[1], 1, 1, 0x80003000, fd);
     for(i = 0; i < MAX_SERIAL_PORTS; i++) {

