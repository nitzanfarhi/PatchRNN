commit c0664893050cc6b2d8b02d3e035f82fbfd0cd4cf
Author: Colin Ian King <colin.king@canonical.com>
Date:   Sun Apr 24 19:56:43 2016 +0100

    perf intel-pt: Fix off-by-one comparison on maximum code
    
    The check for the maximum code is off-by-one; the current comparison of
    a code that is INTEL_PT_ERR_MAX will cause the strlcpy to perform an out
    of bounds array access on the intel_pt_err_msgs array.
    
    Fix this with a >= comparison.
    
    Signed-off-by: Colin Ian King <colin.king@canonical.com>
    Cc: Adrian Hunter <adrian.hunter@intel.com>
    Cc: Alexander Shishkin <alexander.shishkin@linux.intel.com>
    Cc: Peter Zijlstra <peterz@infradead.org>
    Link: http://lkml.kernel.org/r/1461524203-10224-1-git-send-email-colin.king@canonical.com
    Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>

diff --git a/tools/perf/util/intel-pt-decoder/intel-pt-decoder.c b/tools/perf/util/intel-pt-decoder/intel-pt-decoder.c
index 9409d014b46c..9c8f15da86ce 100644
--- a/tools/perf/util/intel-pt-decoder/intel-pt-decoder.c
+++ b/tools/perf/util/intel-pt-decoder/intel-pt-decoder.c
@@ -356,7 +356,7 @@ static const char *intel_pt_err_msgs[] = {
 
 int intel_pt__strerror(int code, char *buf, size_t buflen)
 {
-	if (code < 1 || code > INTEL_PT_ERR_MAX)
+	if (code < 1 || code >= INTEL_PT_ERR_MAX)
 		code = INTEL_PT_ERR_UNK;
 	strlcpy(buf, intel_pt_err_msgs[code], buflen);
 	return 0;

