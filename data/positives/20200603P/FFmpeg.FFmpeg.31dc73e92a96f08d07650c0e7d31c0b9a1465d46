commit 31dc73e92a96f08d07650c0e7d31c0b9a1465d46
Author: Vittorio Giovara <vittorio.giovara@gmail.com>
Date:   Mon Feb 2 01:57:15 2015 +0100

    vorbisdec: Check memory allocations

diff --git a/libavcodec/vorbisdec.c b/libavcodec/vorbisdec.c
index dbcc1cd911..d52bfd5d61 100644
--- a/libavcodec/vorbisdec.c
+++ b/libavcodec/vorbisdec.c
@@ -369,10 +369,15 @@ static int vorbis_parse_setup_hdr_codebooks(vorbis_context *vc)
             }
 
 // Weed out unused vlcs and build codevector vector
-            codebook_setup->codevectors = used_entries ? av_mallocz(used_entries *
-                                                                    codebook_setup->dimensions *
-                                                                    sizeof(*codebook_setup->codevectors))
-                                                       : NULL;
+            if (used_entries) {
+                codebook_setup->codevectors =
+                    av_mallocz(used_entries * codebook_setup->dimensions *
+                               sizeof(*codebook_setup->codevectors));
+                if (!codebook_setup->codevectors)
+                    return AVERROR(ENOMEM);
+            } else
+                codebook_setup->codevectors = NULL;
+
             for (j = 0, i = 0; i < entries; ++i) {
                 unsigned dim = codebook_setup->dimensions;
 

