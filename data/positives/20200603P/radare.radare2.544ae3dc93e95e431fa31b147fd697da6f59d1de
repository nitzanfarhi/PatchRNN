commit 544ae3dc93e95e431fa31b147fd697da6f59d1de
Author: pancake <pancake@nopcode.org>
Date:   Mon Nov 27 12:44:11 2017 +0100

    Fix tmpstring memleak in tab

diff --git a/libr/core/core.c b/libr/core/core.c
index d291c3abc..4db340319 100644
--- a/libr/core/core.c
+++ b/libr/core/core.c
@@ -771,24 +771,25 @@ static int autocompleteProcessPath(RLine *line, const char *path, int argv_idx)
 
 	list= r_sys_dir (dirname);
 	n = strlen (basename);
-	char *tmpstring;
 	bool chgdir = !strncmp (line->buffer.data, "cd ", 3);
 	if (list) {
 		r_list_foreach (list, iter, filename) {
 			if (*filename == '.') {
 				continue;
 			}
-
 			if (!basename[0] || !strncmp (filename, basename, n))  {
-				tmpstring = r_str_newf ("%s%s", dirname, filename);
-				if (r_file_is_directory (tmpstring ) && chgdir) {
+				char *tmpstring = r_str_newf ("%s%s", dirname, filename);
+				if (r_file_is_directory (tmpstring) && chgdir) {
 					tmp_argv[i++] = r_str_newf ("%s/", tmpstring);
+					free (tmpstring);
 				} else if (r_file_is_directory (tmpstring) && !chgdir) {
 					tmp_argv[i++] = r_str_newf ("%s/", tmpstring);
+					free (tmpstring);
 				} else if (!chgdir) {
 					tmp_argv[i++] = tmpstring;
+				} else {
+					free (tmpstring);
 				}
-
 				if (i == TMP_ARGV_SZ - 1) {
 					i--;
 					break;

