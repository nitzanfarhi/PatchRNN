commit 5c9db64888ecabfb170081335f30e3d7192fbcf4
Author: Axel Lin <axel.lin@gmail.com>
Date:   Wed Apr 27 21:41:19 2011 -0700

    Input: twl4030-pwrbutton - fix a leak of the IRQ during init failure
    
    In twl4030_pwrbutton_probe error path, free_irq() was using NULL rather than
    the driver data as the data pointer so free_irq() wouldn't have matched.
    
    Signed-off-by: Axel Lin <axel.lin@gmail.com>
    Signed-off-by: Dmitry Torokhov <dtor@mail.ru>

diff --git a/drivers/input/misc/twl4030-pwrbutton.c b/drivers/input/misc/twl4030-pwrbutton.c
index f16972bddca4..38e4b507b94c 100644
--- a/drivers/input/misc/twl4030-pwrbutton.c
+++ b/drivers/input/misc/twl4030-pwrbutton.c
@@ -89,7 +89,7 @@ static int __init twl4030_pwrbutton_probe(struct platform_device *pdev)
 	return 0;
 
 free_irq:
-	free_irq(irq, NULL);
+	free_irq(irq, pwr);
 free_input_dev:
 	input_free_device(pwr);
 	return err;

