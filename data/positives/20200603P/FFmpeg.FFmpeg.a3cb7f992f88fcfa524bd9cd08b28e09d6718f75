commit a3cb7f992f88fcfa524bd9cd08b28e09d6718f75
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Thu Nov 15 00:56:33 2012 +0100

    xwma: check bytes_per_sample, fix division by 0.
    
    Found-by: Mateusz "j00ru" Jurczyk and Gynvael Coldwind
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavformat/xwma.c b/libavformat/xwma.c
index 04c36296d1..db7d9716ca 100644
--- a/libavformat/xwma.c
+++ b/libavformat/xwma.c
@@ -200,6 +200,12 @@ static int xwma_read_header(AVFormatContext *s)
 
         /* Estimate the duration from the total number of output bytes. */
         const uint64_t total_decoded_bytes = dpds_table[dpds_table_size - 1];
+
+        if(!bytes_per_sample) {
+            av_log(s, AV_LOG_ERROR, "bytes_per_sample is 0\n");
+            return AVERROR_INVALIDDATA;
+        }
+
         st->duration = total_decoded_bytes / bytes_per_sample;
 
         /* Use the dpds data to build a seek table.  We can only do this after

