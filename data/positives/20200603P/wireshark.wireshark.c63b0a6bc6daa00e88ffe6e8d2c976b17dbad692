commit c63b0a6bc6daa00e88ffe6e8d2c976b17dbad692
Author: Luis Ontanon <luis.ontanon@gmail.com>
Date:   Wed Feb 14 19:21:37 2007 +0000

    From Peter Johansson:
    
    I have provided a patch for a crash that occurs in uat_gui.c if from the
    "Edit preferences..." button when you choose Protocols -> DLT_USER ->
    the "Edit..." button -> the "New" button -> the "Cancel" button.
    The crash happens because dd gets freed prior to traversing its internal
    structure, hence I moved the call to g_free for dd beneath the traversal
    of the dd internals.
    
    
    
    svn path=/trunk/; revision=20813

diff --git a/gtk/uat_gui.c b/gtk/uat_gui.c
index 930fa7caa0..663b70e710 100644
--- a/gtk/uat_gui.c
+++ b/gtk/uat_gui.c
@@ -371,10 +371,11 @@ static gboolean uat_cancel_dlg_cb(GtkWidget *win _U_, gpointer user_data) {
 	if (dd->is_new) g_free(dd->rec);
     g_ptr_array_free(dd->entries,TRUE);
     window_destroy(GTK_WIDGET(dd->win));
-	g_free(dd);
 
 	while (dd->tobe_freed->len) g_free( g_ptr_array_remove_index_fast(dd->tobe_freed, dd->tobe_freed->len - 1 ) );
 	
+	g_free(dd);
+
     return TRUE;
 }
 

