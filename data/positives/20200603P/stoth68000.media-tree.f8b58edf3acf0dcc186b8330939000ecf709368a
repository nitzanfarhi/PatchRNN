commit f8b58edf3acf0dcc186b8330939000ecf709368a
Author: Neil Brown <neilb@cse.unsw.edu.au>
Date:   Mon Jun 27 22:29:34 2005 -0700

    [PATCH] md: bio leak fix
    
    insert a missing bio_put when writting the md superblock.
    
    Without this we have a steady growth in the "bio" slab.
    
    Signed-off-by: Neil Brown <neilb@cse.unsw.edu.au>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

diff --git a/drivers/md/md.c b/drivers/md/md.c
index 3802f7a17f16..4a0c57db2b67 100644
--- a/drivers/md/md.c
+++ b/drivers/md/md.c
@@ -338,6 +338,7 @@ static int super_written(struct bio *bio, unsigned int bytes_done, int error)
 
 	if (atomic_dec_and_test(&rdev->mddev->pending_writes))
 		wake_up(&rdev->mddev->sb_wait);
+	bio_put(bio);
 	return 0;
 }
 

