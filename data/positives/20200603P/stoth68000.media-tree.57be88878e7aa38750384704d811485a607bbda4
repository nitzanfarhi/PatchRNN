commit 57be88878e7aa38750384704d811485a607bbda4
Author: Li Zefan <lizf@cn.fujitsu.com>
Date:   Tue Jun 16 16:39:12 2009 +0800

    tracing/filters: free filter_string in destroy_preds()
    
    filter->filter_string is not freed when unloading a module:
    
     # insmod trace-events-sample.ko
     # echo "bar < 100" > /mnt/tracing/events/sample/foo_bar/filter
     # rmmod trace-events-sample.ko
    
    [ Impact: fix memory leak when unloading module ]
    
    Signed-off-by: Li Zefan <lizf@cn.fujitsu.com>
    LKML-Reference: <4A375A30.9060802@cn.fujitsu.com>
    Signed-off-by: Steven Rostedt <rostedt@goodmis.org>

diff --git a/kernel/trace/trace_events_filter.c b/kernel/trace/trace_events_filter.c
index b24ab0e6ea74..d9f01c1a042b 100644
--- a/kernel/trace/trace_events_filter.c
+++ b/kernel/trace/trace_events_filter.c
@@ -381,6 +381,7 @@ void destroy_preds(struct ftrace_event_call *call)
 			filter_free_pred(filter->preds[i]);
 	}
 	kfree(filter->preds);
+	kfree(filter->filter_string);
 	kfree(filter);
 	call->filter = NULL;
 }

