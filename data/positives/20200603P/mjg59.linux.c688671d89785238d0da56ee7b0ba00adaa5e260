commit c688671d89785238d0da56ee7b0ba00adaa5e260
Author: Dan Carpenter <dan.carpenter@oracle.com>
Date:   Mon Feb 22 22:30:46 2016 +0300

    staging: gdm72xx: underflow in netlink_rcv_cb()
    
    If nlh->nlmsg_len is less than ND_IFINDEX_LEN we end up trying to memcpy
    a negative size.  I also re-ordered slighty the condition to make it
    more uniform.
    
    Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

diff --git a/drivers/staging/gdm72xx/netlink_k.c b/drivers/staging/gdm72xx/netlink_k.c
index 783770b106b3..984ca40f2bd3 100644
--- a/drivers/staging/gdm72xx/netlink_k.c
+++ b/drivers/staging/gdm72xx/netlink_k.c
@@ -55,7 +55,8 @@ static void netlink_rcv_cb(struct sk_buff *skb)
 	if (skb->len >= NLMSG_HDRLEN) {
 		nlh = (struct nlmsghdr *)skb->data;
 
-		if (skb->len < nlh->nlmsg_len ||
+		if (nlh->nlmsg_len < ND_IFINDEX_LEN ||
+		    nlh->nlmsg_len > skb->len ||
 		    nlh->nlmsg_len > ND_MAX_MSG_LEN) {
 			netdev_err(skb->dev, "Invalid length (%d,%d)\n",
 				   skb->len, nlh->nlmsg_len);

