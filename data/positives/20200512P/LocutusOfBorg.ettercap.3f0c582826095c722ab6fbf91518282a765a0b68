commit 3f0c582826095c722ab6fbf91518282a765a0b68
Author: NickSampanis <nicksampanis@gmail.com>
Date:   Fri Oct 17 17:32:44 2014 +0300

    Fix nbns arbitary length heap overflow

diff --git a/plug-ins/nbns_spoof/nbns_spoof.c b/plug-ins/nbns_spoof/nbns_spoof.c
index d08dc1bb..f4aa3f07 100644
--- a/plug-ins/nbns_spoof/nbns_spoof.c
+++ b/plug-ins/nbns_spoof/nbns_spoof.c
@@ -390,6 +390,10 @@ static void nbns_spoof(struct packet_object *po)
 
 	SAFE_CALLOC(response, NBNS_MSGLEN_QUERY_RESPONSE, sizeof(u_char));
 
+   if (po->DATA.len > 70) {
+       SAFE_FREE(response);
+       return;
+   }
 	memset(response, 0, NBNS_MSGLEN_QUERY_RESPONSE);
 
 	memcpy(response, po->DATA.data, po->DATA.len);

