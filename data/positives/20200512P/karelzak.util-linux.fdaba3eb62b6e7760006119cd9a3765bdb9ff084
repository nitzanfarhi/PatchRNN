commit fdaba3eb62b6e7760006119cd9a3765bdb9ff084
Author: Karel Zak <kzak@redhat.com>
Date:   Wed May 17 12:38:16 2017 +0200

    libmount: fix memory leak [coverity scan]
    
    Signed-off-by: Karel Zak <kzak@redhat.com>

diff --git a/libmount/src/context_umount.c b/libmount/src/context_umount.c
index a2bba8060..e663a703c 100644
--- a/libmount/src/context_umount.c
+++ b/libmount/src/context_umount.c
@@ -337,6 +337,7 @@ static int prepare_helper_from_options(struct libmnt_context *cxt,
 	char *suffix = NULL;
 	const char *opts;
 	size_t valsz;
+	int rc;
 
 	if (mnt_context_is_nohelpers(cxt))
 		return 0;
@@ -354,7 +355,10 @@ static int prepare_helper_from_options(struct libmnt_context *cxt,
 
 	DBG(CXT, ul_debugobj(cxt, "umount: umount.%s %s requested", suffix, name));
 
-	return mnt_context_prepare_helper(cxt, "umount", suffix);
+	rc = mnt_context_prepare_helper(cxt, "umount", suffix);
+	free(suffix);
+
+	return rc;
 }
 
 /*

