commit b34e5d8ab8e3bd06e63763f340f04cb935a1f20d
Author: Timo Sirainen <tss@iki.fi>
Date:   Mon Jul 2 17:35:31 2007 +0300

    Memory leak fix
    
    --HG--
    branch : HEAD

diff --git a/src/auth/passdb-ldap.c b/src/auth/passdb-ldap.c
index d8da9aebb..907b28937 100644
--- a/src/auth/passdb-ldap.c
+++ b/src/auth/passdb-ldap.c
@@ -123,6 +123,7 @@ ldap_query_save_result(struct ldap_connection *conn, LDAPMessage *entry,
 
 		attr = ldap_next_attribute(conn->ld, entry, ber);
 	}
+	ber_free(ber, 0);
 
 	if (ctx.add_userdb_uid && conn->set.uid != (uid_t)-1) {
 		auth_request_set_field(auth_request, "userdb_uid",
diff --git a/src/auth/userdb-ldap.c b/src/auth/userdb-ldap.c
index f834b8d41..ba84b650a 100644
--- a/src/auth/userdb-ldap.c
+++ b/src/auth/userdb-ldap.c
@@ -106,6 +106,7 @@ ldap_query_get_result(struct ldap_connection *conn, LDAPMessage *entry,
 
 		attr = ldap_next_attribute(conn->ld, entry, ber);
 	}
+	ber_free(ber, 0);
 
 	if (!seen_uid) {
 		if (conn->set.uid == (uid_t)-1) {

