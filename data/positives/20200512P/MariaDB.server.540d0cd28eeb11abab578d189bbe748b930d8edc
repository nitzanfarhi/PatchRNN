commit 540d0cd28eeb11abab578d189bbe748b930d8edc
Author: Tor Didriksen <tor.didriksen@oracle.com>
Date:   Mon Oct 1 13:12:38 2012 +0200

    Bug#14683676 ENDLESS MEMORY CONSUMPTION IN SETUP_REF_ARRAY WITH MAX IN SUBQUERY
    
    n_child_sum_items kept increasing.
    Since it is used for calculating the size of ref_pointer_array,
    we will allocate larger and larger chunks of memory, until we hit some
    operating system limit.
    The memory is free()d at disconnect, but is most likely *not*
    returned to the operating system.

diff --git a/sql/sql_lex.cc b/sql/sql_lex.cc
index fd9367b99f2..e171cf1c06d 100644
--- a/sql/sql_lex.cc
+++ b/sql/sql_lex.cc
@@ -1616,6 +1616,7 @@ void st_select_lex::init_query()
   ref_pointer_array= 0;
   select_n_where_fields= 0;
   select_n_having_items= 0;
+  n_child_sum_items= 0;
   subquery_in_having= explicit_limit= 0;
   is_item_list_lookup= 0;
   first_execution= 1;

