commit 6510b8917948283005a125c8337d3312a8a0561c
Author: Stanislaw Gruszka <sgruszka@redhat.com>
Date:   Fri Feb 26 15:10:28 2010 +0100

    airo: return from set_wep_key() when key length is zero
    
    Even if keylen == 0 is a bug and should not really happen, better avoid
    possibility of passing bad value to firmware.
    
    Signed-off-by: Stanislaw Gruszka <sgruszka@redhat.com>
    Signed-off-by: John W. Linville <linville@tuxdriver.com>

diff --git a/drivers/net/wireless/airo.c b/drivers/net/wireless/airo.c
index 698d5672a070..dc5018a6d9ed 100644
--- a/drivers/net/wireless/airo.c
+++ b/drivers/net/wireless/airo.c
@@ -5255,7 +5255,8 @@ static int set_wep_key(struct airo_info *ai, u16 index, const char *key,
 	WepKeyRid wkr;
 	int rc;
 
-	WARN_ON(keylen == 0);
+	if (WARN_ON(keylen == 0))
+		return -1;
 
 	memset(&wkr, 0, sizeof(wkr));
 	wkr.len = cpu_to_le16(sizeof(wkr));

