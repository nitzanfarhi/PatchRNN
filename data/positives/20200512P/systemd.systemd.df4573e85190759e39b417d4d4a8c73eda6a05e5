commit df4573e85190759e39b417d4d4a8c73eda6a05e5
Author: Lennart Poettering <lennart@poettering.net>
Date:   Mon Mar 9 18:58:05 2015 +0100

    fsck: don't read invalid data

diff --git a/src/fsckd/fsckd.c b/src/fsckd/fsckd.c
index 0fac1531e..77808608a 100644
--- a/src/fsckd/fsckd.c
+++ b/src/fsckd/fsckd.c
@@ -171,11 +171,11 @@ static int plymouth_feedback_handler(sd_event_source *s, int fd, uint32_t revent
                 return 0;
         }
 
-        if (buffer[0] == '\15')
+        if (l > 1 && buffer[0] == '\15')
                 log_error("Message update to plymouth wasn't delivered successfully");
 
         /* the only answer support type we requested is a key interruption */
-        if (buffer[0] == '\2' && buffer[5] == '\3') {
+        if (l > 2 && buffer[0] == '\2' && buffer[5] == '\3') {
                 m->cancel_requested = true;
 
                 /* cancel all connected clients */

