commit 80fb69fdb729968db42d24bf35cbdfb334e8bfe8
Author: Bjorn Munch <bjorn.munch@oracle.com>
Date:   Tue Sep 9 15:28:46 2014 +0200

    Bug #19553266 MAIN.WL6219-UPGRADE ON PB2
    
      Merge of cset 8778 from trunk

diff --git a/sql/sql_base.cc b/sql/sql_base.cc
index 54ac3d76901..11c9d83421b 100644
--- a/sql/sql_base.cc
+++ b/sql/sql_base.cc
@@ -3437,6 +3437,8 @@ share_found:
     case SQLCOM_SHOW_CREATE:
       break;
     default:
+      closefrm(table, 0);
+      my_free(table);
       my_error(ER_CRASHED_ON_USAGE, MYF(0), share->table_name.str);
       goto err_lock;
     }

