commit 478c6f73a4a95165cb5529e008bbf10e87ff905c
Author: Sebastien Helleu <flashcode@flashtux.org>
Date:   Tue Jun 14 14:34:45 2011 +0200

    irc, relay: check that prefix and message are not NULL before adding a message to raw buffer

diff --git a/src/plugins/irc/irc-raw.c b/src/plugins/irc/irc-raw.c
index 31af8efbd..01cb97d93 100644
--- a/src/plugins/irc/irc-raw.c
+++ b/src/plugins/irc/irc-raw.c
@@ -182,6 +182,9 @@ irc_raw_message_add_to_list (time_t date, const char *prefix,
 {
     struct t_irc_raw_message *new_raw_message;
     
+    if (!prefix || !message)
+        return NULL;
+    
     irc_raw_message_remove_old ();
     
     new_raw_message = malloc (sizeof (*new_raw_message));
diff --git a/src/plugins/relay/relay-raw.c b/src/plugins/relay/relay-raw.c
index 872819495..e096b66c5 100644
--- a/src/plugins/relay/relay-raw.c
+++ b/src/plugins/relay/relay-raw.c
@@ -182,6 +182,9 @@ relay_raw_message_add_to_list (time_t date, const char *prefix,
 {
     struct t_relay_raw_message *new_raw_message;
     
+    if (!prefix || !message)
+        return NULL;
+    
     relay_raw_message_remove_old ();
     
     new_raw_message = malloc (sizeof (*new_raw_message));

