commit a1b94355ea3fde5e13db7ff37c0272fcde4e29b2
Author: Colin Ian King <colin.king@canonical.com>
Date:   Fri Jan 20 13:25:06 2017 +0000

    power: supply: bq2415x: check for NULL acpi_id to avoid null pointer dereference
    
    acpi_match_device can potentially return NULL, so it is prudent to
    check if acpi_id is null before it is dereferenced.  Add a check
    and an error message to indicate the failure.
    
    Signed-off-by: Colin Ian King <colin.king@canonical.com>
    Reviewed-by: Pali Roh√°r <pali.rohar@gmail.com>
    Signed-off-by: Sebastian Reichel <sre@kernel.org>

diff --git a/drivers/power/supply/bq2415x_charger.c b/drivers/power/supply/bq2415x_charger.c
index 73e2f0b79dd4..c4770a94cc8e 100644
--- a/drivers/power/supply/bq2415x_charger.c
+++ b/drivers/power/supply/bq2415x_charger.c
@@ -1569,6 +1569,11 @@ static int bq2415x_probe(struct i2c_client *client,
 		acpi_id =
 			acpi_match_device(client->dev.driver->acpi_match_table,
 					  &client->dev);
+		if (!acpi_id) {
+			dev_err(&client->dev, "failed to match device name\n");
+			ret = -ENODEV;
+			goto error_1;
+		}
 		name = kasprintf(GFP_KERNEL, "%s-%d", acpi_id->id, num);
 	}
 	if (!name) {

