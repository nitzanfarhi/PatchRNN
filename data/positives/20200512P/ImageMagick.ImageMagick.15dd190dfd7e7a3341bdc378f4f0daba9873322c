commit 15dd190dfd7e7a3341bdc378f4f0daba9873322c
Author: Cristy <urban-warrior@imagemagick.org>
Date:   Fri May 6 10:03:01 2016 -0400

    Avoid overflow when parsing PSD resource blocks

diff --git a/coders/psd.c b/coders/psd.c
index b26513c0f..eb107f47e 100644
--- a/coders/psd.c
+++ b/coders/psd.c
@@ -643,7 +643,7 @@ static void ParseImageResourceBlocks(Image *image,
     p=PushShortPixel(MSBEndian,p,&id);
     p=PushShortPixel(MSBEndian,p,&short_sans);
     p=PushLongPixel(MSBEndian,p,&count);
-    if (p+count > blocks+length)
+    if ((p+count) > (blocks+length-16))
       return;
     switch (id)
     {

