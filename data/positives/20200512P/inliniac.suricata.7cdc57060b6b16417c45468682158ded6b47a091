commit 7cdc57060b6b16417c45468682158ded6b47a091
Author: Victor Julien <victor@inliniac.net>
Date:   Mon Sep 22 17:33:40 2014 +0200

    af-packet: check pointers before use

diff --git a/src/runmode-af-packet.c b/src/runmode-af-packet.c
index 0388aafa..9d38d306 100644
--- a/src/runmode-af-packet.c
+++ b/src/runmode-af-packet.c
@@ -353,6 +353,10 @@ int AFPRunModeIsIPS()
 
     for (ldev = 0; ldev < nlive; ldev++) {
         char *live_dev = LiveGetDeviceName(ldev);
+        if (live_dev == NULL) {
+            SCLogError(SC_ERR_INVALID_VALUE, "Problem with config file");
+            return 0;
+        }
         char *copymodestr = NULL;
         if_root = ConfNodeLookupKeyValue(af_packet_node, "interface", live_dev);
 
@@ -379,6 +383,10 @@ int AFPRunModeIsIPS()
         SCLogInfo("AF_PACKET mode using IPS and IDS mode");
         for (ldev = 0; ldev < nlive; ldev++) {
             char *live_dev = LiveGetDeviceName(ldev);
+            if (live_dev == NULL) {
+                SCLogError(SC_ERR_INVALID_VALUE, "Problem with config file");
+                return 0;
+            }
             if_root = ConfNodeLookupKeyValue(af_packet_node, "interface", live_dev);
             char *copymodestr = NULL;
 

