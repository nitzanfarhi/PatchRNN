commit 47fbe53bef3b219a365ebf3eca949d6cd4c5291c
Author: David Ahern <dsahern@gmail.com>
Date:   Sun Nov 13 10:45:27 2011 -0700

    perf session: Fix crash with invalid CPU list
    
    commit 5d67be9 added the option to specify a range of CPUs of interest,
    but does not catch an invalid CPU list:
    
    $ perf script -c foo
    Segmentation fault (core dumped)
    
    Cc: Anton Blanchard <anton@samba.org>
    Link: http://lkml.kernel.org/r/1321206327-5881-1-git-send-email-dsahern@gmail.com
    Signed-off-by: David Ahern <dsahern@gmail.com>
    Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>

diff --git a/tools/perf/util/session.c b/tools/perf/util/session.c
index 85c1e6b76f0a..0f4555ce9063 100644
--- a/tools/perf/util/session.c
+++ b/tools/perf/util/session.c
@@ -1333,6 +1333,10 @@ int perf_session__cpu_bitmap(struct perf_session *session,
 	}
 
 	map = cpu_map__new(cpu_list);
+	if (map == NULL) {
+		pr_err("Invalid cpu_list\n");
+		return -1;
+	}
 
 	for (i = 0; i < map->nr; i++) {
 		int cpu = map->map[i];

