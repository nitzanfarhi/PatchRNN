commit f418f8c17c5649eb5551e151a5da4e3d1f787947
Author: Bodo MÃ¶ller <bodo@openssl.org>
Date:   Wed Mar 7 01:37:54 2001 +0000

    In clear_free, clear the complete structure just in case
    the method misses something.

diff --git a/crypto/ec/ec_lib.c b/crypto/ec/ec_lib.c
index 990eab51aa..7b02a36539 100644
--- a/crypto/ec/ec_lib.c
+++ b/crypto/ec/ec_lib.c
@@ -120,6 +120,7 @@ void EC_GROUP_clear_free(EC_GROUP *group)
 		group->meth->group_clear_finish(group);
 	else if (group->meth != NULL && group->meth->group_finish != 0)
 		group->meth->group_finish(group);
+	memset(point, 0, sizeof *group);
 	OPENSSL_free(group);
 	}
 
@@ -206,6 +207,7 @@ void EC_POINT_clear_free(EC_POINT *point)
 		point->meth->point_clear_finish(point);
 	else if (point->meth != NULL && point->meth->point_finish != 0)
 		point->meth->point_finish(point);
+	memset(point, 0, sizeof *point);
 	OPENSSL_free(point);
 	}
 

