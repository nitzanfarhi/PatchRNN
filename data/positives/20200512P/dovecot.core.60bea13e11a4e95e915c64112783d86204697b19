commit 60bea13e11a4e95e915c64112783d86204697b19
Author: Aki Tuomi <aki.tuomi@dovecot.fi>
Date:   Mon Dec 12 09:39:34 2016 +0200

    doveadm-save: Set exit code to EX_TEMPFAIL on open error
    
    Prevents potential crash on doveadm_mail_next_user

diff --git a/src/doveadm/doveadm-mail-save.c b/src/doveadm/doveadm-mail-save.c
index 66f3a5071..b7f312700 100644
--- a/src/doveadm/doveadm-mail-save.c
+++ b/src/doveadm/doveadm-mail-save.c
@@ -24,6 +24,7 @@ cmd_save_to_mailbox(struct save_cmd_context *ctx, struct mailbox *box,
 		i_error("open(%s) failed: %s",
 			i_stream_get_name(input),
 			i_stream_get_error(input));
+		ctx->ctx.exit_code = EX_TEMPFAIL;
 		return -1;
 	}
 

