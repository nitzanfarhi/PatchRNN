commit 817636eb7768b8dd65503bbb7583109e9be2382b
Author: Kevin Lin <klin@sourcefire.com>
Date:   Mon Aug 17 12:30:07 2015 -0400

    cid 12207 - fix error state for allocating altstr container

diff --git a/libclamav/matcher-ac.c b/libclamav/matcher-ac.c
index 1d76c5287..47c0292b6 100644
--- a/libclamav/matcher-ac.c
+++ b/libclamav/matcher-ac.c
@@ -2372,6 +2372,7 @@ inline static int ac_special_altstr(const char *hexpr, uint8_t sigopts, struct c
         /* allocate reusable subexpr */
         if (!(subexpr = cli_calloc(slen+1, sizeof(char)))) {
             cli_errmsg("ac_special_altstr: Can't allocate subexpr container\n");
+            free(hexprcpy);
             return CL_EMEM;
         }
 

