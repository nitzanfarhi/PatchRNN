commit c0a99eae296177b22387fab8921d079088d8a54b
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Fri Mar 23 04:18:10 2012 +0100

    indeo4: check band->scan
    
    Fixes null ptr exception
    
    Found-by: Mateusz "j00ru" Jurczyk and Gynvael Coldwind
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavcodec/indeo4.c b/libavcodec/indeo4.c
index 8ba8e25d15..df80b1139e 100644
--- a/libavcodec/indeo4.c
+++ b/libavcodec/indeo4.c
@@ -444,6 +444,11 @@ static int decode_band_hdr(IVI4DecContext *ctx, IVIBandDesc *band,
 
     align_get_bits(&ctx->gb);
 
+    if (!band->scan) {
+        av_log(avctx, AV_LOG_ERROR, "band->scan not set\n");
+        return AVERROR_INVALIDDATA;
+    }
+
     return 0;
 }
 

