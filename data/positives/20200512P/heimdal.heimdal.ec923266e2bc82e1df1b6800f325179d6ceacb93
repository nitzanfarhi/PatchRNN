commit ec923266e2bc82e1df1b6800f325179d6ceacb93
Author: Love Hörnquist Åstrand <lha@kth.se>
Date:   Tue Oct 17 04:00:14 2006 +0000

    set ret, remember to free ivdata
    
    
    git-svn-id: svn://svn.h5l.se/heimdal/trunk/heimdal@18499 ec53bebd-3082-4978-b11e-865c3cabbd6b

diff --git a/lib/hx509/ks_file.c b/lib/hx509/ks_file.c
index b58bd0d8c..c92f9a086 100644
--- a/lib/hx509/ks_file.c
+++ b/lib/hx509/ks_file.c
@@ -191,7 +191,7 @@ parse_rsa_private_key(hx509_context context, struct hx509_collector *c,
 		      const struct header *headers,
 		      const void *data, size_t len)
 {
-    int ret;
+    int ret = 0;
     const char *enc;
 
     enc = find_header(headers, "Proc-Type");
@@ -308,6 +308,8 @@ parse_rsa_private_key(hx509_context context, struct hx509_collector *c,
 	    /* XXX add password to lock password collection ? */
 	    memset(password, 0, sizeof(password));
 	}
+	free(ivdata);
+
     } else {
 	heim_octet_string keydata;
 

