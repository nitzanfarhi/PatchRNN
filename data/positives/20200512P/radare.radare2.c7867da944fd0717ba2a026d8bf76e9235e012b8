commit c7867da944fd0717ba2a026d8bf76e9235e012b8
Author: Aneesh Dogra <lionaneesh@gmail.com>
Date:   Thu Mar 10 20:50:15 2016 +0530

    versioninfo: Fix SEGV on files with no info (.txt, ...)

diff --git a/libr/core/bin.c b/libr/core/bin.c
index ec22ae606..e33cd79bc 100644
--- a/libr/core/bin.c
+++ b/libr/core/bin.c
@@ -1907,6 +1907,8 @@ static void bin_mach0_versioninfo(RCore *r) {
 static int bin_versioninfo(RCore *r, int mode) {
 	const RBinInfo *info = r_bin_get_info (r->bin);
 
+	if (!(info && info->rclass)) return false;
+
 	if (!strncmp ("pe", info->rclass, 2)) {
 		bin_pe_versioninfo (r);
 	} else if (!strncmp ("elf", info->rclass, 3)) {

