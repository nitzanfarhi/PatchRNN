commit 6f3ec9952c13f0adf632e89456df43946cec6525
Author: Jaegeuk Kim <jaegeuk@kernel.org>
Date:   Tue Jul 19 19:30:06 2016 -0700

    f2fs: handle error case with f2fs_bug_on
    
    It's enough to show BUG or WARN by f2fs_bug_on for error case.
    Then, we don't need to remain corrupted filesystem.
    
    Signed-off-by: Jaegeuk Kim <jaegeuk@kernel.org>

diff --git a/fs/f2fs/recovery.c b/fs/f2fs/recovery.c
index 5d4461f2c266..9e652d5a659b 100644
--- a/fs/f2fs/recovery.c
+++ b/fs/f2fs/recovery.c
@@ -482,6 +482,8 @@ static int do_recover_data(struct f2fs_sb_info *sbi, struct inode *inode,
 #endif
 				/* We should not get -ENOSPC */
 				f2fs_bug_on(sbi, err);
+				if (err)
+					goto err;
 			}
 
 			/* Check the previous node page having this index */

