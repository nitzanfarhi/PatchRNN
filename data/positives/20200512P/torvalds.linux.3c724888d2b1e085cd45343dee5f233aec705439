commit 3c724888d2b1e085cd45343dee5f233aec705439
Author: Alan <gnomes@lxorguk.ukuu.org.uk>
Date:   Mon Feb 15 19:09:46 2016 +0000

    chipidea: error on overflow for port_test_write
    
    The write value is 8bit, but currently writing a larger number (eg a doubled
    digit) is not errored but instead gets cast and sets off an action probably
    undesired.
    
    Signed-off-by: Alan Cox <alan@linux.intel.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

diff --git a/drivers/usb/chipidea/debug.c b/drivers/usb/chipidea/debug.c
index de5c5092d078..6d23eede4d8c 100644
--- a/drivers/usb/chipidea/debug.c
+++ b/drivers/usb/chipidea/debug.c
@@ -100,6 +100,9 @@ static ssize_t ci_port_test_write(struct file *file, const char __user *ubuf,
 	if (sscanf(buf, "%u", &mode) != 1)
 		return -EINVAL;
 
+	if (mode > 255)
+		return -EBADRQC;
+
 	pm_runtime_get_sync(ci->dev);
 	spin_lock_irqsave(&ci->lock, flags);
 	ret = hw_port_test_set(ci, mode);

