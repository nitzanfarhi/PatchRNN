commit eafa258bd159f404ad13fbc8c2255d55396e9c8e
Author: Alexander <homm86@gmail.com>
Date:   Sun Aug 6 00:50:56 2017 +0300

    destroy image and set MemoryError on overflow check failure

diff --git a/libImaging/Storage.c b/libImaging/Storage.c
index 6acda2af..7ab5ae1f 100644
--- a/libImaging/Storage.c
+++ b/libImaging/Storage.c
@@ -344,7 +344,8 @@ ImagingNewBlock(const char *mode, int xsize, int ysize)
     if (im->linesize &&
         im->ysize > INT_MAX / im->linesize) {
         /* punt if we're going to overflow */
-        return NULL;
+        ImagingDelete(im);
+        return (Imaging) ImagingError_MemoryError();
     }
 
     if (im->ysize * im->linesize <= 0) {

