commit a1a8cbcb35ef2759a66b4f0875785e4b3f277057
Author: Michael Niedermayer <michael@niedermayer.cc>
Date:   Sun Nov 15 20:49:17 2015 +0100

    avcodec/jpeg2000: Check comp coords to be within the supported size
    
    Fixes assertion failure
    Fixes: 03e0abe721b1174856d41a1eb5d6a896/signal_sigabrt_7ffff6ae7cc9_3813_e71bf3541abed3ccba031cd5ba0269a4.avi
    
    This fix is choosen to be simple to backport, better solution
    for master is planed
    
    Found-by: Mateusz "j00ru" Jurczyk and Gynvael Coldwind
    Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>

diff --git a/libavcodec/jpeg2000.c b/libavcodec/jpeg2000.c
index a1ef396c95..7cf337bf10 100644
--- a/libavcodec/jpeg2000.c
+++ b/libavcodec/jpeg2000.c
@@ -468,6 +468,11 @@ int ff_jpeg2000_init_component(Jpeg2000Component *comp,
         return AVERROR_INVALIDDATA;
     csize = (comp->coord[0][1] - comp->coord[0][0]) *
             (comp->coord[1][1] - comp->coord[1][0]);
+    if (comp->coord[0][1] > 32768 ||
+        comp->coord[1][1] > 32768) {
+        av_log(avctx, AV_LOG_ERROR, "component size too large\n");
+        return AVERROR_PATCHWELCOME;
+    }
 
     if (codsty->transform == FF_DWT97) {
         csize += AV_INPUT_BUFFER_PADDING_SIZE / sizeof(*comp->f_data);

