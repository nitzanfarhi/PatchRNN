commit 809eb35045097bc7da56fa8bba1f6b4cd1b721ba
Author: Wei Yongjun <weiyj.lk@gmail.com>
Date:   Sat Jul 30 06:32:37 2016 +0000

    thermal: qcom: tsens: Fix return value check in init_common()
    
    In case of error, the function of_iomap() returns NULL pointer
    not ERR_PTR(). The IS_ERR() test in the return value check
    should be replaced with NULL test.
    And the function devm_regmap_init_mmio() returns ERR_PTR()
    and never returns NULL. The NULL test in the return value
    check should be replaced with IS_ERR().
    
    Signed-off-by: Wei Yongjun <weiyj.lk@gmail.com>
    Acked-by: Rajendra Nayak <rnayak@codeaurora.org>
    Signed-off-by: Zhang Rui <rui.zhang@intel.com>

diff --git a/drivers/thermal/qcom/tsens-common.c b/drivers/thermal/qcom/tsens-common.c
index 4a1af151bd53..b1449ad67fc0 100644
--- a/drivers/thermal/qcom/tsens-common.c
+++ b/drivers/thermal/qcom/tsens-common.c
@@ -128,13 +128,13 @@ int __init init_common(struct tsens_device *tmdev)
 	void __iomem *base;
 
 	base = of_iomap(tmdev->dev->of_node, 0);
-	if (IS_ERR(base))
+	if (!base)
 		return -EINVAL;
 
 	tmdev->map = devm_regmap_init_mmio(tmdev->dev, base, &tsens_config);
-	if (!tmdev->map) {
+	if (IS_ERR(tmdev->map)) {
 		iounmap(base);
-		return -ENODEV;
+		return PTR_ERR(tmdev->map);
 	}
 
 	return 0;

