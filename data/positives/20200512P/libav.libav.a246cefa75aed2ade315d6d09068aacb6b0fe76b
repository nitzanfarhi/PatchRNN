commit a246cefa75aed2ade315d6d09068aacb6b0fe76b
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Sat Sep 24 18:57:31 2011 +0300

    flvdec: Check for overflow before allocating arrays
    
    On allocation, the array length is multiplied by sizeof(int64_t),
    this prevents the multiplication from overflowing.
    
    Signed-off-by: Martin Storsj√∂ <martin@martin.st>

diff --git a/libavformat/flvdec.c b/libavformat/flvdec.c
index 474c4d865..ad00c65e2 100644
--- a/libavformat/flvdec.c
+++ b/libavformat/flvdec.c
@@ -161,6 +161,9 @@ static int parse_keyframes_index(AVFormatContext *s, AVIOContext *ioc, AVStream
             break;
 
         arraylen = avio_rb32(ioc);
+        if (arraylen >> 28)
+            break;
+
         /*
          * Expect only 'times' or 'filepositions' sub-arrays in other case refuse to use such metadata
          * for indexing

