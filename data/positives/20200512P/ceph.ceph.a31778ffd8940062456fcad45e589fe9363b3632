commit a31778ffd8940062456fcad45e589fe9363b3632
Author: Yehuda Sadeh <yehuda@hq.newdream.net>
Date:   Tue Dec 2 13:37:02 2008 -0800

    kclient: initialize some protocol fields

diff --git a/src/kernel/mds_client.c b/src/kernel/mds_client.c
index f27156b277..66265d6ba1 100644
--- a/src/kernel/mds_client.c
+++ b/src/kernel/mds_client.c
@@ -1173,6 +1173,7 @@ ceph_mdsc_create_request(struct ceph_mds_client *mdsc, int op,
 	head->op = cpu_to_le32(op);
 	head->caller_uid = cpu_to_le32(current->fsuid);
 	head->caller_gid = cpu_to_le32(current->fsgid);
+	memset(&head->args, 0, sizeof(head->args));
 
 	/* encode paths */
 	if (op == CEPH_MDS_OP_FINDINODE) {
diff --git a/src/kernel/messenger.c b/src/kernel/messenger.c
index a48eeea3f8..d1aed235cf 100644
--- a/src/kernel/messenger.c
+++ b/src/kernel/messenger.c
@@ -2297,6 +2297,10 @@ struct ceph_msg *ceph_msg_new(int type, int front_len,
 	m->hdr.front_len = cpu_to_le32(front_len);
 	m->hdr.data_len = cpu_to_le32(page_len);
 	m->hdr.data_off = cpu_to_le32(page_off);
+	m->hdr.priority = 0;
+	m->hdr.mon_protocol = 0;
+	m->hdr.osd_protocol = 0;
+	m->hdr.mds_protocol = 0;
 	m->footer.front_crc = 0;
 	m->footer.data_crc = 0;
 	m->front_is_vmalloc = false;

