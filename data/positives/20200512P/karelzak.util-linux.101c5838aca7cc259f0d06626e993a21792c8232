commit 101c5838aca7cc259f0d06626e993a21792c8232
Author: Karel Zak <kzak@redhat.com>
Date:   Thu Jan 29 11:26:09 2015 +0100

    su: fix mem leak in modify_environ() [coverity scan]
    
    Signed-off-by: Karel Zak <kzak@redhat.com>

diff --git a/login-utils/su-common.c b/login-utils/su-common.c
index 57038ce37..2d4707330 100644
--- a/login-utils/su-common.c
+++ b/login-utils/su-common.c
@@ -533,13 +533,15 @@ modify_environment (const struct passwd *pw, const char *shell)
     {
       /* Leave TERM unchanged.  Set HOME, SHELL, USER, LOGNAME, PATH.
          Unset all other environment variables.  */
-      char const *term = getenv ("TERM");
+      char *term = getenv ("TERM");
       if (term)
 	term = xstrdup (term);
       environ = xmalloc ((6 + !!term) * sizeof (char *));
       environ[0] = NULL;
-      if (term)
+      if (term) {
 	xsetenv ("TERM", term, 1);
+	free(term);
+      }
       xsetenv ("HOME", pw->pw_dir, 1);
       if (shell)
 	xsetenv ("SHELL", shell, 1);

