commit 5df164157f9f501a292699e52ed55363f271b3a5
Author: j123123 <j123123@users.noreply.github.com>
Date:   Wed Jul 5 04:40:14 2017 +0300

    added NULL check and memory leak fixed in libr/util/w32-sys.c

diff --git a/libr/util/w32-sys.c b/libr/util/w32-sys.c
index c50d3a1db..463f3a60e 100644
--- a/libr/util/w32-sys.c
+++ b/libr/util/w32-sys.c
@@ -128,15 +128,20 @@ char *ReadFromPipe(HANDLE fh) {
 	int strsz = BUFSIZE+1;
 
 	str = malloc (strsz);
+	if (!str) {
+		return NULL;
+	}
 	for (;;) {
 		bSuccess = ReadFile (fh, chBuf, BUFSIZE, &dwRead, NULL);
 		if (!bSuccess || dwRead == 0) {
 			break;
 		}
 		if (strl+dwRead>strsz) {
+			char *str_tmp = str;
 			strsz += 4096;
 			str = realloc (str, strsz);
 			if (!str) {
+				free (str_tmp);
 				return NULL;
 			}
 		}

