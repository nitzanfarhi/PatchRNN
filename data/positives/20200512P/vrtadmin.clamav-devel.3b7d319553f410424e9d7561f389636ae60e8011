commit 3b7d319553f410424e9d7561f389636ae60e8011
Author: Tomasz Kojm <tkojm@clamav.net>
Date:   Mon Aug 11 19:00:52 2008 +0000

    fix NULL dereference when running with a limited db
    
    
    git-svn: trunk@4103

diff --git a/libclamav/phishcheck.c b/libclamav/phishcheck.c
index 53151f0f8..7a1beff29 100644
--- a/libclamav/phishcheck.c
+++ b/libclamav/phishcheck.c
@@ -1214,7 +1214,7 @@ static int url_hash_match(const struct regex_matcher *rlist, const char *inurl,
 	size_t j, k, ji, ki;
 	int rc;
 
-	if(!rlist->md5_hashes.bm_patterns) {
+	if(!rlist || !rlist->md5_hashes.bm_patterns) {
 		return CL_SUCCESS;
 	}
 	if(!inurl)

