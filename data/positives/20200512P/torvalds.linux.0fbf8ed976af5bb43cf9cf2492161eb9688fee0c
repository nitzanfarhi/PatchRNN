commit 0fbf8ed976af5bb43cf9cf2492161eb9688fee0c
Author: Jesper Juhl <jj@chaosbits.net>
Date:   Sun Jan 2 22:17:00 2011 +0100

    HID: hid-picolcd: Fix memory leak in picolcd_debug_out_report()
    
    We have a memory leak in drivers/hid/hid-picolcd.c::picolcd_debug_out_report()
    in an error path..  We are not always freeing the memory allocated to
    'buff' - this patch makes sure we always kfree() what we allocate with
    kmalloc() when it is no longer needed.
    
    Signed-off-by: Jesper Juhl <jj@chaosbits.net>
    Signed-off-by: Jiri Kosina <jkosina@suse.cz>

diff --git a/drivers/hid/hid-picolcd.c b/drivers/hid/hid-picolcd.c
index 0aff3cdddd83..abd0bdc84624 100644
--- a/drivers/hid/hid-picolcd.c
+++ b/drivers/hid/hid-picolcd.c
@@ -1867,6 +1867,7 @@ static void picolcd_debug_out_report(struct picolcd_data *data,
 			report->id, raw_size);
 	hid_debug_event(hdev, buff);
 	if (raw_size + 5 > sizeof(raw_data)) {
+		kfree(buff);
 		hid_debug_event(hdev, " TOO BIG\n");
 		return;
 	} else {

