commit f1b4700dafdbdae4ab298bac8dfd44ebfa01fb5d
Author: aCaB <acab@clamav.net>
Date:   Thu Nov 1 21:53:50 2007 +0000

    correct utf16le check
    
    git-svn: trunk@3353

diff --git a/libclamav/autoit.c b/libclamav/autoit.c
index 57bb79161..c4bcd39fb 100644
--- a/libclamav/autoit.c
+++ b/libclamav/autoit.c
@@ -60,7 +60,7 @@ static unsigned int u2a(uint8_t *dest, unsigned int len) {
     for (i=0; i<j; i+=2)
       cnt+=(src[i]!=0 && src[i+1]==0);
 
-    if (cnt*2 < j)
+    if (cnt*4 < j)
       return len;
   }
 
@@ -72,6 +72,7 @@ static unsigned int u2a(uint8_t *dest, unsigned int len) {
   return len;
 }
 
+
 /*********************
    MT realted stuff 
 *********************/

