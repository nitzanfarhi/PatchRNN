commit 921bee521d201dc5d916faf482420eccd21ed3c9
Author: aland <aland>
Date:   Fri May 5 17:31:28 2006 +0000

            Don't de-reference request->username if it's NULL

diff --git a/src/modules/rlm_preprocess/rlm_preprocess.c b/src/modules/rlm_preprocess/rlm_preprocess.c
index e92fcc54b..d8fa45d2a 100644
--- a/src/modules/rlm_preprocess/rlm_preprocess.c
+++ b/src/modules/rlm_preprocess/rlm_preprocess.c
@@ -552,8 +552,8 @@ static int preprocess_authorize(void *instance, REQUEST *request)
 			     request->packet->vps)) != RLM_MODULE_OK) {
 		char buf[1024];
 		radlog(L_AUTH, "No huntgroup access: [%s] (%s)",
-		    request->username->vp_strvalue,
-		    auth_name(buf, sizeof(buf), request, 1));
+		       request->username ? request->username->vp_strvalue : "<NO User-Name>",
+		       auth_name(buf, sizeof(buf), request, 1));
 		return r;
 	}
 

