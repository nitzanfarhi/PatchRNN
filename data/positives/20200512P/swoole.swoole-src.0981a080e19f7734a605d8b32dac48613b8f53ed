commit 0981a080e19f7734a605d8b32dac48613b8f53ed
Author: matyhtf <mikan.tenny@gmail.com>
Date:   Fri May 6 18:50:20 2016 +0800

    fix websocket_server memory leak.

diff --git a/src/network/ReactorThread.c b/src/network/ReactorThread.c
index 267f6555..2bbdc88d 100644
--- a/src/network/ReactorThread.c
+++ b/src/network/ReactorThread.c
@@ -308,13 +308,15 @@ int swReactorThread_close(swReactor *reactor, int fd)
     {
         if (conn->object)
         {
-            swHttpRequest_free(conn);
-        }
-        if (conn->http_upgrade)
-        {
-            swServer_free_buffer(serv, fd);
-            conn->websocket_status = 0;
-            conn->object = NULL;
+            if (conn->http_upgrade)
+            {
+                swServer_free_buffer(serv, fd);
+                conn->websocket_status = 0;
+            }
+            else
+            {
+                swHttpRequest_free(conn);
+            }
         }
     }
 

