commit 0352f4c1c4439a8813b8ec15d8de099ad0ea8408
Author: Tomasz Kojm <tkojm@clamav.net>
Date:   Sun Oct 29 14:53:56 2006 +0000

    fix fname leaks
    
    
    git-svn: trunk@2457

diff --git a/clamav-devel/clamd/session.c b/clamav-devel/clamd/session.c
index 4c889cc8f..cc466d346 100644
--- a/clamav-devel/clamd/session.c
+++ b/clamav-devel/clamd/session.c
@@ -172,6 +172,7 @@ static int multiscan(const char *dirname, const struct cl_node *root, const stru
 				closedir(dd);
 				return -1;
 			    }
+			    free(fname);
 			} else {
 			    if(S_ISREG(statbuf.st_mode) || (S_ISLNK(statbuf.st_mode) && (checksymlink(fname) == 2) && cfgopt(copt, "FollowFileSymlinks")->enabled)) {
 
@@ -212,6 +213,8 @@ static int multiscan(const char *dirname, const struct cl_node *root, const stru
 				}
 			    }
 			}
+		    } else {
+			free(fname);
 		    }
 		}
 	    }

