commit 8ca8b43d7108b9d7e6887fd553d13a71afa670c6
Author: Paul B Mahol <onemda@gmail.com>
Date:   Fri Dec 7 13:05:43 2012 +0000

    lavf/pcm: check size, do not produce invalid packets
    
    Inspired by 92b8c9d89e7ae86bffa05393bb230d5a165b0148.
    
    Signed-off-by: Paul B Mahol <onemda@gmail.com>

diff --git a/libavformat/pcm.c b/libavformat/pcm.c
index 71f6a4f653..2fe44dcb40 100644
--- a/libavformat/pcm.c
+++ b/libavformat/pcm.c
@@ -30,6 +30,8 @@ int ff_pcm_read_packet(AVFormatContext *s, AVPacket *pkt)
     int ret, size;
 
     size= RAW_SAMPLES*s->streams[0]->codec->block_align;
+    if (size <= 0)
+        return AVERROR(EINVAL);
 
     ret= av_get_packet(s->pb, pkt, size);
 

