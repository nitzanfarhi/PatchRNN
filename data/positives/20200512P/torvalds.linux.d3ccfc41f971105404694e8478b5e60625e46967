commit d3ccfc41f971105404694e8478b5e60625e46967
Author: Hartmut Knaack <knaack.h@gmx.de>
Date:   Sun May 31 14:39:42 2015 +0200

    tools:iio:generic_buffer: free dev_dir_name on exit
    
    Make sure to free dev_dir_name in case of an error or regular exit.
    
    Signed-off-by: Hartmut Knaack <knaack.h@gmx.de>
    Signed-off-by: Jonathan Cameron <jic23@kernel.org>

diff --git a/tools/iio/generic_buffer.c b/tools/iio/generic_buffer.c
index 15f2a40c9bf7..7859ee9a46b2 100644
--- a/tools/iio/generic_buffer.c
+++ b/tools/iio/generic_buffer.c
@@ -220,7 +220,7 @@ int main(int argc, char **argv)
 				       "%s-dev%d", device_name, dev_num);
 			if (ret < 0) {
 				ret = -ENOMEM;
-				goto error_ret;
+				goto error_free_dev_dir_name;
 			}
 		}
 
@@ -354,6 +354,8 @@ int main(int argc, char **argv)
 error_free_triggername:
 	if (datardytrigger)
 		free(trigger_name);
+error_free_dev_dir_name:
+	free(dev_dir_name);
 error_ret:
 	return ret;
 }

