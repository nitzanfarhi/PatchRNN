commit 576f1638fdcbe137970db83c989d1b346a387a57
Author: Bernie Hackett <bernie@10gen.com>
Date:   Thu Oct 11 06:21:16 2012 -0700

    Don't leak when BSON decoding fails.

diff --git a/bson/_cbsonmodule.c b/bson/_cbsonmodule.c
index a3631f35..d25a9089 100644
--- a/bson/_cbsonmodule.c
+++ b/bson/_cbsonmodule.c
@@ -1615,16 +1615,20 @@ static PyObject* elements_to_dict(PyObject* self, const char* string, int max,
             PyObject* InvalidBSON = _error("InvalidBSON");
             PyErr_SetNone(InvalidBSON);
             Py_DECREF(InvalidBSON);
+            Py_DECREF(dict);
             return NULL;
         }
         name = PyUnicode_DecodeUTF8(string + position, name_length, "strict");
         if (!name) {
+            Py_DECREF(dict);
             return NULL;
         }
         position += name_length + 1;
         value = get_value(self, string, &position, type,
                           max - position, as_class, tz_aware, uuid_subtype);
         if (!value) {
+            Py_DECREF(name);
+            Py_DECREF(dict);
             return NULL;
         }
 

