commit 5d421c433f6b9bf6543e368aeaa4b98fa426c701
Author: brain <brain@e03df62e-2008-0410-955e-edbf42e46eb7>
Date:   Fri Sep 8 19:27:57 2006 +0000

    Fix small memory leak if non-cidr string passed to MatchCIDR
    
    
    git-svn-id: http://svn.inspircd.org/repository/trunk/inspircd@5173 e03df62e-2008-0410-955e-edbf42e46eb7

diff --git a/src/socket.cpp b/src/socket.cpp
index eaa8e0d8c..4bf9dc30b 100644
--- a/src/socket.cpp
+++ b/src/socket.cpp
@@ -215,6 +215,7 @@ bool irc::sockets::MatchCIDR(const char* address, const char* cidr_mask, bool ma
 	else
 	{
 		/* No 'number of bits' field! */
+		free(mask);
 		return false;
 	}
 

