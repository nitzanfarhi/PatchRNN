commit 20ea22ff735097a02721fcb5cd44433973af6190
Author: Daniel Stenberg <daniel@haxx.se>
Date:   Fri Sep 29 08:50:15 2017 +0200

    cookie: fix memory leak on oversized rejection
    
    Regression brought by 2bc230de63b
    
    Detected by OSS-fuzz: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=3513
    Assisted-by: Max Dymond
    
    Closes #1930

diff --git a/lib/cookie.c b/lib/cookie.c
index 0374f94c1..1d7defd84 100644
--- a/lib/cookie.c
+++ b/lib/cookie.c
@@ -438,7 +438,7 @@ Curl_cookie_add(struct Curl_easy *data,
           /* too long individual name or contents, or too long combination of
              name + contents. Chrome and Firefox support 4095 or 4096 bytes
              combo. */
-          free(co);
+          freecookie(co);
           infof(data, "oversized cookie dropped, name/val %d + %d bytes\n",
                 nlen, len);
           return NULL;

