commit 560e33968de93250377606782949f5004affca83
Author: Ilia Alshanetsky <iliaa@php.net>
Date:   Thu Feb 27 16:41:23 2003 +0000

    Fixed bug #21410 (fixed handling of NULL or "" files on Win32)

diff --git a/ext/standard/filestat.c b/ext/standard/filestat.c
index f7ab3af0d3..8321ceb41a 100644
--- a/ext/standard/filestat.c
+++ b/ext/standard/filestat.c
@@ -564,6 +564,10 @@ static void php_stat(const char *filename, php_stat_len filename_length, int typ
 	char *stat_sb_names[13]={"dev", "ino", "mode", "nlink", "uid", "gid", "rdev",
 			      "size", "atime", "mtime", "ctime", "blksize", "blocks"};
 
+	if (!filename_length) {
+		RETURN_FALSE;
+	}
+
 	if (PG(safe_mode) &&(!php_checkuid_ex(filename, NULL, CHECKUID_CHECK_FILE_AND_DIR, IS_EXISTS_CHECK(type) ? CHECKUID_NO_ERRORS : 0))) {
 		RETURN_FALSE;
 	}

