commit 2b61034b0b2b1a2009dab47c72438a73c5c2d9e6
Author: Bodo MÃ¶ller <bodo@openssl.org>
Date:   Fri Mar 11 09:01:24 2005 +0000

    fix potential memory leak when allocation fails
    
    PR: 801
    Submitted by: Nils Larsch

diff --git a/crypto/pem/pem_lib.c b/crypto/pem/pem_lib.c
index 81c4aba235..ae0a87e978 100644
--- a/crypto/pem/pem_lib.c
+++ b/crypto/pem/pem_lib.c
@@ -627,6 +627,9 @@ int PEM_read_bio(BIO *bp, char **name, char **header, unsigned char **data,
 	dataB=BUF_MEM_new();
 	if ((nameB == NULL) || (headerB == NULL) || (dataB == NULL))
 		{
+		BUF_MEM_free(nameB);
+		BUF_MEM_free(headerB);
+		BUF_MEM_free(dataB);
 		PEMerr(PEM_F_PEM_READ_BIO,ERR_R_MALLOC_FAILURE);
 		return(0);
 		}

