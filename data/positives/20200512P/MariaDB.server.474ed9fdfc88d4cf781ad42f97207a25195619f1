commit 474ed9fdfc88d4cf781ad42f97207a25195619f1
Author: unknown <heikki@donna.mysql.fi>
Date:   Sat Dec 22 02:29:23 2001 +0200

    ha_innobase.cc:
      Make sure no memory overrun of key buffer in range estimation
    
    
    sql/ha_innobase.cc:
      Make sure no memory overrun of key buffer in range estimation

diff --git a/sql/ha_innobase.cc b/sql/ha_innobase.cc
index 50c2a2aef5c..dc030dde39a 100644
--- a/sql/ha_innobase.cc
+++ b/sql/ha_innobase.cc
@@ -2956,7 +2956,8 @@ ha_innobase::records_in_range(
 	KEY*		key;
 	dict_index_t*	index;
 	mysql_byte*	key_val_buff2 	= (mysql_byte*) my_malloc(
-							table->reclength,
+						  table->reclength
+      						+ table->max_key_length + 100,
 								MYF(MY_WME));
 	dtuple_t*	range_start;
 	dtuple_t*	range_end;

