commit 466f9576c096ffe9f358e7017e874df1c302d666
Author: miod <miod@openbsd.org>
Date:   Sun Jul 6 11:52:02 2014 +0000

    Apply ld.so's sod.c 1.25 (do not divide by zero in _dl_findhit if there is a
    valid hints file but no buckets in it) here too, in order to keep both instances
    of this code in sync.

diff --git a/libexec/ld.so/ldconfig/sod.c b/libexec/ld.so/ldconfig/sod.c
index 1e52144814c..90e4fa3efbf 100644
--- a/libexec/ld.so/ldconfig/sod.c
+++ b/libexec/ld.so/ldconfig/sod.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: sod.c,v 1.3 2013/12/03 01:47:06 deraadt Exp $	*/
+/*	$OpenBSD: sod.c,v 1.4 2014/07/06 11:52:02 miod Exp $	*/
 
 /*
  * Copyright (c) 1993 Paul Kranenburg
@@ -206,6 +206,9 @@ _dl_findhint(char *name, int major, int minor, char *preferred_path)
 	if (!(HINTS_VALID))
 		return NULL;
 
+	if (hheader->hh_nbucket == 0)
+		return NULL;
+
 	bp = hbuckets + (_dl_hinthash(name, major, minor) % hheader->hh_nbucket);
 
 	while (1) {

