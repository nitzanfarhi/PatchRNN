commit cd44d282f0b0ff2670af1fb99b783034e2973426
Author: Eduardo Silva <edsiper@gmail.com>
Date:   Mon Dec 7 09:23:43 2009 -0300

    Do not allow backward directory requests '..'

diff --git a/src/http.c b/src/http.c
index 12ef3600..94310cde 100644
--- a/src/http.c
+++ b/src/http.c
@@ -164,6 +164,14 @@ int mk_http_init(struct client_request *cr, struct request *sr)
                 debug_error=1;
         }
 
+        if(mk_string_search_n(sr->uri.data, HTTP_DIRECTORY_BACKWARD, 
+                              sr->uri.len) >= 0){
+                sr->log->final_response=M_CLIENT_FORBIDDEN;
+                mk_request_error(M_CLIENT_FORBIDDEN, cr, sr, 
+                                 debug_error, sr->log);
+                return -1;
+        }
+
         /* Plugin Stage 30: look for handlers for this request */
         if(mk_plugin_stage_run(MK_PLUGIN_STAGE_30, 0, NULL, cr, sr) == 
            MK_PLUGIN_RET_CLOSE_CONX){
diff --git a/src/include/http.h b/src/include/http.h
index ff25fd38..383db4e3 100644
--- a/src/include/http.h
+++ b/src/include/http.h
@@ -20,6 +20,9 @@
 #ifndef MK_HTTP_H
 #define MK_HTTP_H
 
+/* Hard coded restrictions */
+#define HTTP_DIRECTORY_BACKWARD ".."
+
 /* Methods */
 #define HTTP_METHOD_UNKNOWN (-1)
 #define HTTP_METHOD_GET (0)

