commit 46329522b54aad458a11fbcb9e463d873d00e0ad
Author: brain <brain@e03df62e-2008-0410-955e-edbf42e46eb7>
Date:   Fri Aug 4 20:02:53 2006 +0000

    Sanity checks
    
    
    git-svn-id: http://svn.inspircd.org/repository/trunk/inspircd@4717 e03df62e-2008-0410-955e-edbf42e46eb7

diff --git a/src/modules/m_spanningtree.cpp b/src/modules/m_spanningtree.cpp
index ec3af1780..dad289d8e 100644
--- a/src/modules/m_spanningtree.cpp
+++ b/src/modules/m_spanningtree.cpp
@@ -1475,7 +1475,7 @@ class TreeSocket : public InspSocket
 		/* there werent enough modes built up to flush it during FJOIN,
 		 * or, there are a number left over. flush them out.
 		 */
-		if ((modectr > 2) && (who))
+		if ((modectr > 2) && (who) && (us))
 		{
 			if (ourTS >= TS)
 			{

