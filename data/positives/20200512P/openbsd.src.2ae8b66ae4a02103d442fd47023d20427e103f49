commit 2ae8b66ae4a02103d442fd47023d20427e103f49
Author: deraadt <deraadt@openbsd.org>
Date:   Fri Nov 20 16:04:01 1998 +0000

    oops

diff --git a/sys/dev/isa/isadma.c b/sys/dev/isa/isadma.c
index 3fab93036c8..c823c58acf7 100644
--- a/sys/dev/isa/isadma.c
+++ b/sys/dev/isa/isadma.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: isadma.c,v 1.20 1998/11/20 15:57:20 deraadt Exp $	*/
+/*	$OpenBSD: isadma.c,v 1.21 1998/11/20 16:04:01 deraadt Exp $	*/
 /*	$NetBSD: isadma.c,v 1.32 1997/09/05 01:48:33 thorpej Exp $	*/
 
 /*-
@@ -584,9 +584,6 @@ isa_dmamem_free(isadev, chan, addr, size)
 		panic("isa_dmamem_free");
 	}
 
-	if (off < 0)
-		return (-1);
-
 	seg.ds_addr = addr;
 	seg.ds_len = size;
 
@@ -649,6 +646,9 @@ isa_dmamem_mmap(isadev, chan, addr, size, off, prot, flags)
 		panic("isa_dmamem_mmap");
 	}
 
+	if (off < 0)
+		return (-1);
+
 	seg.ds_addr = addr;
 	seg.ds_len = size;
 

