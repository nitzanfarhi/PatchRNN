commit e38c7d5e85d6ee1b20550f3eecc82fd5e6aec5fa
Author: Assefa Yewondwossen <assefa@dmsolutions.ca>
Date:   Tue Sep 22 15:12:03 2009 +0000

    avoid crash when symbol is not found
    
    git-svn-id: http://svn.osgeo.org/mapserver/trunk@9330 7532c77e-422f-0410-93f4-f0b67bdd69e2

diff --git a/mapfile.c b/mapfile.c
index c9c63695..f0c5cca8 100644
--- a/mapfile.c
+++ b/mapfile.c
@@ -4879,22 +4879,25 @@ static int loadMapInternal(mapObj *map)
             styleObj *style = class->styles[k];
             if(style->symbol != 0) {
               symbolObj *symbol = map->symbolset.symbol[style->symbol];
-              if(style->gap == 0)
-                style->gap = symbol->gap;
-              if(style->patternlength == 0) {
-                int idx;
-                style->patternlength = symbol->patternlength;
-                for(idx=0;idx<style->patternlength;idx++)
-                  style->pattern[idx] = (double)(symbol->pattern[idx]);
+              if (symbol)
+              {
+                  if(style->gap == 0)
+                    style->gap = symbol->gap;
+                  if(style->patternlength == 0) {
+                      int idx;
+                      style->patternlength = symbol->patternlength;
+                      for(idx=0;idx<style->patternlength;idx++)
+                        style->pattern[idx] = (double)(symbol->pattern[idx]);
+                  }
+                  if(style->position == MS_CC)
+                    style->position = symbol->position;
+                  if(style->linecap == MS_CJC_ROUND)
+                    style->linecap = symbol->linecap;
+                  if(style->linejoin == MS_CJC_NONE)
+                    style->linejoin = symbol->linejoin;
+                  if(style->linejoinmaxsize == 3)
+                    style->linejoinmaxsize = symbol->linejoinmaxsize;
               }
-              if(style->position == MS_CC)
-                style->position = symbol->position;
-              if(style->linecap == MS_CJC_ROUND)
-                style->linecap = symbol->linecap;
-              if(style->linejoin == MS_CJC_NONE)
-                style->linejoin = symbol->linejoin;
-              if(style->linejoinmaxsize == 3)
-                style->linejoinmaxsize = symbol->linejoinmaxsize;
             }
           }
         }

