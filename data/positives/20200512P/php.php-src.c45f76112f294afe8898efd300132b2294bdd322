commit c45f76112f294afe8898efd300132b2294bdd322
Author: Andrei Zmievski <andrei@php.net>
Date:   Fri Dec 20 16:45:34 2002 +0000

    At least this problem exposed some leaks..

diff --git a/ext/dba/dba.c b/ext/dba/dba.c
index c110d73229..de6072540d 100644
--- a/ext/dba/dba.c
+++ b/ext/dba/dba.c
@@ -508,9 +508,9 @@ static void php_dba_open(INTERNAL_FUNCTION_PARAMETERS, int persistent)
 		RETURN_FALSE;
 	}
 			
-	info = emalloc(sizeof(dba_info));
+	info = pemalloc(sizeof(dba_info), persistent);
 	memset(info, 0, sizeof(dba_info));
-	info->path = estrdup(Z_STRVAL_PP(args[0]));
+	info->path = pestrdup(Z_STRVAL_PP(args[0]), persistent);
 	info->mode = modenr;
 	info->argc = ac - 3;
 	info->argv = args + 3;
@@ -533,7 +533,7 @@ static void php_dba_open(INTERNAL_FUNCTION_PARAMETERS, int persistent)
 
 	if (!error && lock_mode) {
 		if (lock_dbf) {
-			info->lock.name = estrdup(info->path);
+			info->lock.name = pestrdup(info->path, persistent);
 			lock_file_mode = file_mode;
 		} else {
 			spprintf(&info->lock.name, 0, "%s.lck", info->path);

