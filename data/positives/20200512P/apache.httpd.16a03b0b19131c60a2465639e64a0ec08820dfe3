commit 16a03b0b19131c60a2465639e64a0ec08820dfe3
Author: Paul Querna <pquerna@apache.org>
Date:   Tue Sep 1 09:30:36 2009 +0000

    Check return value from ap_pass_brigade incase we are buffering and a client disconnects.
    
    
    git-svn-id: https://svn.apache.org/repos/asf/httpd/httpd/trunk@809928 13f79535-47bb-0310-9956-ffa450edef68

diff --git a/modules/filters/mod_buffer.c b/modules/filters/mod_buffer.c
index f7e15a52e8..c7c471c939 100644
--- a/modules/filters/mod_buffer.c
+++ b/modules/filters/mod_buffer.c
@@ -140,6 +140,11 @@ static apr_status_t buffer_out_filter(ap_filter_t *f, apr_bucket_brigade *bb) {
 
             /* pass what we have down the chain */
             rv = ap_pass_brigade(f->next, ctx->bb);
+            if (rv) {
+                /* should break out of the loop, since our write to the client 
+                 * failed in some way. */
+                continue;
+            }
         }
 
         /* at this point we are ready to buffer.

