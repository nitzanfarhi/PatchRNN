commit 1786582c9bfbbabcac37ce4ab442315e096c4e96
Author: tobias <tobias@openbsd.org>
Date:   Tue Jan 29 11:55:30 2008 +0000

    Properly check if an argument has been supplied for "Removed"
    
    > Diff from Igor Zinovik

diff --git a/usr.bin/cvs/client.c b/usr.bin/cvs/client.c
index 484bd8b9f8f..280557b11b4 100644
--- a/usr.bin/cvs/client.c
+++ b/usr.bin/cvs/client.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: client.c,v 1.90 2008/01/21 16:36:46 tobias Exp $	*/
+/*	$OpenBSD: client.c,v 1.91 2008/01/29 11:55:30 tobias Exp $	*/
 /*
  * Copyright (c) 2006 Joris Vink <joris@openbsd.org>
  *
@@ -829,6 +829,9 @@ cvs_client_removed(char *data)
 	CVSENTRIES *entlist;
 	char *rpath, *filename, fpath[MAXPATHLEN];
 
+	if (data == NULL)
+		fatal("Missing argument for Removed");
+
 	rpath = cvs_remote_input();
 	if ((filename = strrchr(rpath, '/')) == NULL)
 		fatal("bad rpath in cvs_client_removed: %s", rpath);

