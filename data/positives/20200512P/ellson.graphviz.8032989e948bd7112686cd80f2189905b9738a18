commit 8032989e948bd7112686cd80f2189905b9738a18
Author: ellson <devnull@localhost>
Date:   Thu May 24 14:33:59 2007 +0000

    Fix bug with listing of available plugins when last plugin of previous type was in the same
    library as the first plugin of a new type.   Would cause some plugins to be unlisted.

diff --git a/lib/gvc/gvplugin.c b/lib/gvc/gvplugin.c
index eb9e78036..6c34acdca 100644
--- a/lib/gvc/gvplugin.c
+++ b/lib/gvc/gvplugin.c
@@ -310,8 +310,10 @@ const char *gvplugin_list(GVC_t * gvc, api_t api, char *str)
 	pprev = NULL;
 	while (*pnext) {
 	    /* list only the matching type, and only once*/
-	    if ((strcasecmp(s, (*pnext)->typestr) == 0)
-		    && ! (pprev && strcasecmp((*pnext)->packagename, (*pprev)->packagename) == 0)) {
+	    if (strcasecmp(s, (*pnext)->typestr) == 0
+		&& !(pprev
+		    && strcasecmp(s, (*pprev)->typestr) == 0
+		    && strcasecmp((*pprev)->packagename, (*pnext)->packagename) == 0)) {
 		/* list each member of the matching type as "type:path" */
 		append_buf(' ', (*pnext)->typestr, new);
 		buf = append_buf(':', (*pnext)->packagename, FALSE);

