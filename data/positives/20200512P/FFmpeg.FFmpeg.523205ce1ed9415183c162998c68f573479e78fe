commit 523205ce1ed9415183c162998c68f573479e78fe
Author: Michael Niedermayer <michael@niedermayer.cc>
Date:   Sat May 6 01:08:54 2017 +0200

    avcodec/snowdec: Check qbias
    
    Fixes: signed integer overflow: -1094995529 * 131 cannot be represented in type 'int'
    Fixes: 1353/clusterfuzz-testcase-minimized-5208180449607680
    
    Found-by: continuous fuzzing process https://github.com/google/oss-fuzz/tree/master/targets/ffmpeg
    Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>

diff --git a/libavcodec/snowdec.c b/libavcodec/snowdec.c
index 042aecbbeb..97f55288c1 100644
--- a/libavcodec/snowdec.c
+++ b/libavcodec/snowdec.c
@@ -395,6 +395,11 @@ static int decode_header(SnowContext *s){
         s->block_max_depth= 0;
         return AVERROR_INVALIDDATA;
     }
+    if (FFABS(s->qbias) > 127) {
+        av_log(s->avctx, AV_LOG_ERROR, "qbias %d is too large\n", s->qbias);
+        s->qbias = 0;
+        return AVERROR_INVALIDDATA;
+    }
 
     return 0;
 }

