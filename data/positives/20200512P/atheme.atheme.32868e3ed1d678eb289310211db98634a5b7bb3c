commit 32868e3ed1d678eb289310211db98634a5b7bb3c
Author: William Pitcock <nenolod@dereferenced.org>
Date:   Mon Dec 3 17:15:04 2012 -0600

    libathemecore: try to catch blank vhosts being handed to user_sethost().

diff --git a/libathemecore/users.c b/libathemecore/users.c
index ea2a18b97..2320e97c7 100644
--- a/libathemecore/users.c
+++ b/libathemecore/users.c
@@ -608,6 +608,12 @@ void user_sethost(user_t *source, user_t *target, stringref host)
 	return_if_fail(target != NULL);
 	return_if_fail(host != NULL);
 
+	if (*host != '\0')
+	{
+		slog(LG_INFO, "user_sethost(): eh?  trying to set a blank vhost on %s", target->nick);
+		return;
+	}
+
 	strshare_unref(target->vhost);
 	target->vhost = strshare_get(host);
 

