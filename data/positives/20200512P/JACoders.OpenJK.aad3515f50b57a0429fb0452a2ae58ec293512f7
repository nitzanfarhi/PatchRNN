commit aad3515f50b57a0429fb0452a2ae58ec293512f7
Author: eezstreet <eezstreet@live.com>
Date:   Sun Apr 28 00:03:53 2013 -0400

    Corrected a few potential buffer overruns that might be caused by some nefarious server mods...

diff --git a/codemp/cgame/cg_draw.c b/codemp/cgame/cg_draw.c
index 4c931b4e..79dd9ff8 100644
--- a/codemp/cgame/cg_draw.c
+++ b/codemp/cgame/cg_draw.c
@@ -3310,7 +3310,7 @@ float CG_DrawRadar ( float y )
 						{
 						
 							// generic enemy index specifies a shader to use for the radar entity.
-							if ( cent->currentState.genericenemyindex )
+							if ( cent->currentState.genericenemyindex && cent->currentState.genericenemyindex < MAX_ICONS )
 							{
 								color[0] = color[1] = color[2] = color[3] = 1.0f;
 								shader = cgs.gameIcons[cent->currentState.genericenemyindex];
@@ -5418,6 +5418,7 @@ void CG_BracketEntity( centity_t *cent, float radius )
 
 	local = &cgs.clientinfo[cg.snap->ps.clientNum];
 	if ( cent->currentState.m_iVehicleNum //vehicle has a driver
+		&& (cent->currentState.m_iVehicleNum-1) < MAX_CLIENTS
 		&& cgs.clientinfo[ cent->currentState.m_iVehicleNum-1 ].infoValid )
 	{
 		if ( cgs.gametype < GT_TEAM )
diff --git a/codemp/cgame/cg_ents.c b/codemp/cgame/cg_ents.c
index e7033eb6..e237b646 100644
--- a/codemp/cgame/cg_ents.c
+++ b/codemp/cgame/cg_ents.c
@@ -2913,7 +2913,7 @@ Ghoul2 Insert End
 	trap_R_AddRefEntityToScene(&ent);
 
 	// add the secondary model
-	if ( s1->modelindex2 ) 
+	if ( s1->modelindex2 && s1->modelindex2 < MAX_MODELS ) 
 	{
 		ent.skinNum = 0;
 		ent.hModel = cgs.gameModels[s1->modelindex2];

