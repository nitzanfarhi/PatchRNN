commit 2ba6d7cb8278970bb9971448706c1e44ba043a81
Author: Pan Bian <bianpan2016@163.com>
Date:   Mon Nov 27 09:12:54 2017 +0800

    ffmpeg: Check read_ffserver_streams() return value
    
    The function avformat_alloc_context() will return a NULL pointer on
    failure. However, in function read_ffserver_streams(), its return value
    is not validated and the subsequent dereference may result in a bad
    memory access bug. Check its return value against NULL and avoid
    potential NULL dereference.
    
    Signed-off-by: Pan Bian <bianpan2016@163.com>
    Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>

diff --git a/fftools/ffmpeg_opt.c b/fftools/ffmpeg_opt.c
index 9445a2dd11..672054223a 100644
--- a/fftools/ffmpeg_opt.c
+++ b/fftools/ffmpeg_opt.c
@@ -2000,6 +2000,8 @@ static int read_ffserver_streams(OptionsContext *o, AVFormatContext *s, const ch
 {
     int i, err;
     AVFormatContext *ic = avformat_alloc_context();
+    if (!ic)
+        return AVERROR(ENOMEM);
 
     ic->interrupt_callback = int_cb;
     err = avformat_open_input(&ic, filename, NULL, NULL);

