commit 759a612992035559811fa7a6b09818874c7c6ffc
Author: William Pitcock <nenolod@dereferenced.org>
Date:   Fri Aug 8 21:50:51 2014 -0500

    libathemecore: ensure we do not pass NULL to strchr() which is disallowed by POSIX.

diff --git a/libathemecore/help.c b/libathemecore/help.c
index 9e8022831..4cb66691c 100644
--- a/libathemecore/help.c
+++ b/libathemecore/help.c
@@ -95,15 +95,13 @@ static bool evaluate_condition(sourceinfo_t *si, const char *s)
 		return has_any_privs(si);
 	else if (!strcmp(word, "priv"))
 	{
-		q = strchr(p, ' ');
-		if (q != NULL)
+		if (p != NULL && (q = strchr(p, ' ')) != NULL)
 			*q = '\0';
 		return has_priv(si, p);
 	}
 	else if (!strcmp(word, "module"))
 	{
-		q = strchr(p, ' ');
-		if (q != NULL)
+		if (p != NULL && (q = strchr(p, ' ')) != NULL)
 			*q = '\0';
 		return module_find_published(p) != NULL;
 	}

