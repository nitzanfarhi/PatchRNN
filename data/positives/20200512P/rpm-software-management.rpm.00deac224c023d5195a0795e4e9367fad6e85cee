commit 00deac224c023d5195a0795e4e9367fad6e85cee
Author: Panu Matilainen <pmatilai@redhat.com>
Date:   Tue Sep 11 09:01:49 2012 +0300

    Make rpmstrPoolUnfreeze() safe to call on unfrozen pool

diff --git a/rpmio/rpmstrpool.c b/rpmio/rpmstrpool.c
index 14a646653..87e025ec7 100644
--- a/rpmio/rpmstrpool.c
+++ b/rpmio/rpmstrpool.c
@@ -72,7 +72,7 @@ void rpmstrPoolFreeze(rpmstrPool pool)
 
 void rpmstrPoolUnfreeze(rpmstrPool pool)
 {
-    if (pool) {
+    if (pool && pool->hash == NULL) {
 	int sizehint = (pool->offs_size / 2) - 1;
 	if (sizehint < STRHASH_INITSIZE)
 	    sizehint = STRHASH_INITSIZE;

