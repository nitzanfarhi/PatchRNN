commit 23d6ba2c44540eb39c6880e4cbd527d297d264a9
Author: Martin Storsjö <martin@martin.st>
Date:   Sun Sep 22 14:50:48 2013 +0300

    vc1dec: Check the error handling flags on slice/field header decode errors
    
    Signed-off-by: Martin Storsjö <martin@martin.st>

diff --git a/libavcodec/vc1dec.c b/libavcodec/vc1dec.c
index 602b155ecb..803c8be4b9 100644
--- a/libavcodec/vc1dec.c
+++ b/libavcodec/vc1dec.c
@@ -6013,12 +6013,16 @@ static int vc1_decode_frame(AVCodecContext *avctx, void *data,
                 if (v->field_mode && i == n_slices1 + 2) {
                     if ((header_ret = ff_vc1_parse_frame_header_adv(v, &s->gb)) < 0) {
                         av_log(v->s.avctx, AV_LOG_ERROR, "Field header damaged\n");
+                        if (avctx->err_recognition & AV_EF_EXPLODE)
+                            goto err;
                         continue;
                     }
                 } else if (get_bits1(&s->gb)) {
                     v->pic_header_flag = 1;
                     if ((header_ret = ff_vc1_parse_frame_header_adv(v, &s->gb)) < 0) {
                         av_log(v->s.avctx, AV_LOG_ERROR, "Slice header damaged\n");
+                        if (avctx->err_recognition & AV_EF_EXPLODE)
+                            goto err;
                         continue;
                     }
                 }

