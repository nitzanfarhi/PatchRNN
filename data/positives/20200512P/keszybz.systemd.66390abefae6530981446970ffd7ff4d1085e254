commit 66390abefae6530981446970ffd7ff4d1085e254
Author: Lukas Nykryn <lnykryn@redhat.com>
Date:   Mon Feb 24 17:06:21 2014 +0100

    udev: properly detect reference to unexisting part of PROGRAM's result

diff --git a/src/udev/udev-event.c b/src/udev/udev-event.c
index 0b3ade082..5998be2f7 100644
--- a/src/udev/udev-event.c
+++ b/src/udev/udev-event.c
@@ -254,6 +254,8 @@ subst:
                                                 cpos++;
                                         while (isspace(cpos[0]))
                                                 cpos++;
+                                        if (cpos[0] == '\0')
+                                                break;
                                 }
                                 if (i > 0) {
                                         log_error("requested part of result string not found");

