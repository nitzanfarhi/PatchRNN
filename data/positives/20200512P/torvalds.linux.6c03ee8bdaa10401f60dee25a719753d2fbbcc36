commit 6c03ee8bdaa10401f60dee25a719753d2fbbcc36
Author: Linus Lüssing <linus.luessing@web.de>
Date:   Thu Jun 12 01:41:23 2014 +0200

    bridge: fix smatch warning / potential null pointer dereference
    
    "New smatch warnings:
      net/bridge/br_multicast.c:1368 br_ip6_multicast_query() error:
        we previously assumed 'group' could be null (see line 1349)"
    
    In the rare (sort of broken) case of a query having a Maximum
    Response Delay of zero, we could create a potential null pointer
    dereference.
    
    Fixing this by skipping the multicast specific MLD Query parsing again
    if no multicast group address is available.
    
    Introduced by dc4eb53a996a78bfb8ea07b47423ff5a3aadc362
    ("bridge: adhere to querier election mechanism specified by RFCs")
    
    Reported-by: Dan Carpenter <dan.carpenter@oracle.com>
    Signed-off-by: Linus Lüssing <linus.luessing@web.de>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/net/bridge/br_multicast.c b/net/bridge/br_multicast.c
index cd3cf394c477..876e5fb2a786 100644
--- a/net/bridge/br_multicast.c
+++ b/net/bridge/br_multicast.c
@@ -1373,6 +1373,8 @@ static int br_ip6_multicast_query(struct net_bridge *br,
 		br_multicast_query_received(br, port, &br->ip6_other_query,
 					    &saddr, max_delay);
 		goto out;
+	} else if (!group) {
+		goto out;
 	}
 
 	mp = br_mdb_ip6_get(mlock_dereference(br->mdb, br), group, vid);

