commit 5eb00375844da08ac2b00770f04a06e5c7a4c9b7
Author: Hannes Magnusson <bjori@php.net>
Date:   Mon Apr 23 16:37:28 2007 +0000

    MFH: Plug leak when trying to write via the http wrapper

diff --git a/ext/standard/http_fopen_wrapper.c b/ext/standard/http_fopen_wrapper.c
index 5ca17c9ed7..25aabab7be 100644
--- a/ext/standard/http_fopen_wrapper.c
+++ b/ext/standard/http_fopen_wrapper.c
@@ -138,6 +138,7 @@ php_stream *php_stream_url_wrap_http_ex(php_stream_wrapper *wrapper, char *path,
 	
 		if (strpbrk(mode, "awx+")) {
 			php_stream_wrapper_log_error(wrapper, options TSRMLS_CC, "HTTP wrapper does not support writeable connections.");
+			php_url_free(resource);
 			return NULL;
 		}
 

