commit 1cb2079d6c54cb383937880f1eae78975e1a757d
Author: Anatol Belski <ab@php.net>
Date:   Mon Oct 23 15:26:08 2017 +0200

    Fix memory leak

diff --git a/ext/gd/libgd/wbmp.c b/ext/gd/libgd/wbmp.c
index 605d0b5735..4c3eeee7df 100644
--- a/ext/gd/libgd/wbmp.c
+++ b/ext/gd/libgd/wbmp.c
@@ -164,7 +164,10 @@ readwbmp (int (*getin) (void *in), void *in, Wbmp ** return_wbmp)
     }
 
   if (skipheader (getin, in))
-    return (-1);
+    {
+      gdFree (wbmp);
+      return (-1);
+    }
 
 
   wbmp->width = getmbi (getin, in);

