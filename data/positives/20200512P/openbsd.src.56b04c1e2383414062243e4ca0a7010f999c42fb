commit 56b04c1e2383414062243e4ca0a7010f999c42fb
Author: millert <millert@openbsd.org>
Date:   Sun Jun 9 22:12:57 2002 +0000

    When checking for valid login names, check length against MaxUserNameLen.
    Noticed by Brian Poole who supplied a different patch.

diff --git a/usr.sbin/user/user.c b/usr.sbin/user/user.c
index 47cddacbaea..1a390f66e06 100644
--- a/usr.sbin/user/user.c
+++ b/usr.sbin/user/user.c
@@ -1,4 +1,4 @@
-/* $OpenBSD: user.c,v 1.34 2002/05/17 04:07:50 millert Exp $ */
+/* $OpenBSD: user.c,v 1.35 2002/06/09 22:12:57 millert Exp $ */
 /* $NetBSD: user.c,v 1.45 2001/08/17 08:29:00 joda Exp $ */
 
 /*
@@ -555,6 +555,8 @@ valid_login(char *login)
 			return 0;
 		}
 	}
+	if (cp - login > MaxUserNameLen)
+		return 0;
 	return 1;
 }
 

