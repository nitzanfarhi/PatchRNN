commit 8f654f29de0329214fac09c043c03100bfd3f96f
Author: ehlertjd@gmail.com <ehlertjd@gmail.com>
Date:   Fri Apr 1 09:13:39 2016 -0500

    IMAP: check pointer before dereferencing it
    
    may be null in the CURLOPT_CONNECT_ONLY case
    
    Fixes #747

diff --git a/lib/imap.c b/lib/imap.c
index 934532de3..c509f115c 100644
--- a/lib/imap.c
+++ b/lib/imap.c
@@ -364,7 +364,7 @@ static bool imap_endofresp(struct connectdata *conn, char *line, size_t len,
      a space and optionally some text as per RFC-3501 for the AUTHENTICATE and
      APPEND commands and as outlined in Section 4. Examples of RFC-4959 but
      some e-mail servers ignore this and only send a single + instead. */
-  if(!imap->custom && ((len == 3 && !memcmp("+", line, 1)) ||
+  if(imap && !imap->custom && ((len == 3 && !memcmp("+", line, 1)) ||
      (len >= 2 && !memcmp("+ ", line, 2)))) {
     switch(imapc->state) {
       /* States which are interested in continuation responses */

