commit 2d07370ddd15384912337a14a38bf06f6e904553
Author: Daniel Gustafsson <dgustafsson@pivotal.io>
Date:   Thu Jun 7 22:59:53 2018 +0200

    Avoid double-free in parse_filename
    
    If the fopen() call fails parse_namefile() frees the filename buffer
    fn, and the caller does the same. Avoid freeing in parse_namefile()
    and leave the cleanup to the caller.

diff --git a/src/hba.c b/src/hba.c
index 5cc3d08..ca29ea3 100644
--- a/src/hba.c
+++ b/src/hba.c
@@ -359,7 +359,6 @@ static bool parse_namefile(struct HBAName *hname, const char *fn, bool is_db)
 
 	f = fopen(fn, "r");
 	if (!f) {
-		free(fn);
 		return false;
 	}
 	for (linenr = 1; ; linenr++) {

