commit 0af9a6a03bc2e0771bc7c2444c87382d95df354d
Author: Greg Beaver <cellog@php.net>
Date:   Fri Jul 24 16:21:40 2009 +0000

    fix minor memory leak

diff --git a/ext/phar/zip.c b/ext/phar/zip.c
index ad1e8b1791..d7c24ae989 100644
--- a/ext/phar/zip.c
+++ b/ext/phar/zip.c
@@ -310,6 +310,9 @@ foundit:
 			if (mydata->metadata) { \
 				zval_dtor(mydata->metadata); \
 			} \
+			if (mydata->signature) { \
+				efree(mydata->signature); \
+			} \
 			if (error) { \
 				spprintf(error, 4096, "phar error: %s in zip-based phar \"%s\"", errmsg, mydata->fname); \
 			} \
@@ -331,6 +334,9 @@ foundit:
 			if (mydata->metadata) { \
 				zval_dtor(mydata->metadata); \
 			} \
+			if (mydata->signature) { \
+				efree(mydata->signature); \
+			} \
 			if (error) { \
 				spprintf(error, 4096, "phar error: %s in zip-based phar \"%s\"", errmsg, mydata->fname); \
 			} \
@@ -766,7 +772,6 @@ static int phar_zip_changed_apply(void *data, void *arg TSRMLS_DC) /* {{{ */
 	php_uint32 newcrc32;
 	off_t offset;
 	int not_really_modified = 0;
-
 	entry = (phar_entry_info *)data;
 	p = (struct _phar_zip_pass*) arg;
 

