commit 825f50b1a498f6e3532c8fcbc093322bb386f9e1
Author: Ville Syrj채l채 <ville.syrjala@nokia.com>
Date:   Tue Mar 2 21:30:52 2010 +0200

    OMAP: DSS2: Check if display supports update mode changes
    
    Check whether the display actually has the set_update_mode() function
    before calling it. Only the sysfs codepath was broken, the omapfb ioctl
    had the necessary protection.
    
    Signed-off-by: Ville Syrj채l채 <ville.syrjala@nokia.com>
    Signed-off-by: Tomi Valkeinen <tomi.valkeinen@nokia.com>

diff --git a/drivers/video/omap2/dss/display.c b/drivers/video/omap2/dss/display.c
index ef8c8529dda2..480aeaa5f39c 100644
--- a/drivers/video/omap2/dss/display.c
+++ b/drivers/video/omap2/dss/display.c
@@ -82,6 +82,9 @@ static ssize_t display_upd_mode_store(struct device *dev,
 	int val, r;
 	enum omap_dss_update_mode mode;
 
+	if (!dssdev->driver->set_update_mode)
+		return -EINVAL;
+
 	val = simple_strtoul(buf, NULL, 10);
 
 	switch (val) {

