commit 26cb5355e05a98150cd6204aa7f79fc4ceab2c71
Author: Sascha Schumann <sas@php.net>
Date:   Mon Aug 2 08:27:24 2004 +0000

    don't read empty files
    
    0 malloc noticed by Antony Dovgal <tony2001@phpclub.net>

diff --git a/ext/session/mod_files.c b/ext/session/mod_files.c
index 15cd5d7747..adcb476f6e 100644
--- a/ext/session/mod_files.c
+++ b/ext/session/mod_files.c
@@ -320,6 +320,12 @@ PS_READ_FUNC(files)
 		return FAILURE;
 	
 	data->st_size = *vallen = sbuf.st_size;
+	
+	if (sbuf.st_size == 0) {
+		*val = STR_EMPTY_ALLOC();
+		return SUCCESS;
+	}
+	
 	*val = emalloc(sbuf.st_size);
 
 #if defined(HAVE_PREAD)

