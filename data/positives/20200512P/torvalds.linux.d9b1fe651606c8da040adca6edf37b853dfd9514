commit d9b1fe651606c8da040adca6edf37b853dfd9514
Author: Sudip Mukherjee <sudipm.mukherjee@gmail.com>
Date:   Thu Nov 9 18:09:31 2017 +0100

    sm501fb: deallocate colormap only if allocated
    
    There are cases when panel and crt both are not defined and only one of
    them is defined and initialized. In such cases, while removing the
    device deallocate the colormap only if that particular fb is defined.
    
    Signed-off-by: Sudip Mukherjee <sudipm.mukherjee@gmail.com>
    Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>

diff --git a/drivers/video/fbdev/sm501fb.c b/drivers/video/fbdev/sm501fb.c
index 076dd2711630..381475fa137b 100644
--- a/drivers/video/fbdev/sm501fb.c
+++ b/drivers/video/fbdev/sm501fb.c
@@ -1889,6 +1889,9 @@ static void sm501_free_init_fb(struct sm501fb_info *info,
 {
 	struct fb_info *fbi = info->fb[head];
 
+	if (!fbi)
+		return;
+
 	fb_dealloc_cmap(&fbi->cmap);
 }
 

