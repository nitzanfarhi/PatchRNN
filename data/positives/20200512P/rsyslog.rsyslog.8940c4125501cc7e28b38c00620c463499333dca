commit 8940c4125501cc7e28b38c00620c463499333dca
Author: Rainer Gerhards <rgerhards@adiscon.com>
Date:   Thu Aug 9 13:23:17 2007 +0000

    fixed a potential memory leak in modules.c, again, this could not happen in
        current code

diff --git a/modules.c b/modules.c
index 6e4d0395e..18a7cdd92 100644
--- a/modules.c
+++ b/modules.c
@@ -67,6 +67,8 @@ static rsRetVal moduleConstruct(modInfo_t **pThis)
  */
 static void moduleDestruct(modInfo_t *pThis)
 {
+	if(pThis->pszName != NULL)
+		free(pThis->pszName);
 	free(pThis);
 }
 
@@ -163,7 +165,7 @@ modInfo_t *omodGetNxt(modInfo_t *pThis)
 
 
 /* Add an already-loaded module to the module linked list. This function does
- * anything that is needed to fully initialize the module.
+ * everything needed to fully initialize the module.
  */
 rsRetVal doModInit(rsRetVal (*modInit)(int, int*, rsRetVal(**)(), rsRetVal(*)()), uchar *name)
 {

