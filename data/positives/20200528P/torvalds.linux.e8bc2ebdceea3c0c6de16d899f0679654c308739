commit e8bc2ebdceea3c0c6de16d899f0679654c308739
Author: Jon Mason <jon.mason@intel.com>
Date:   Fri Nov 22 16:50:57 2013 -0700

    ntb_netdev: Fix skb free issue in open
    
    In ntb_netdev_open, when ntb_transport_rx_enqueue fails the skb that was
    attempting to be enqueued is not freed.  Free this skb on the
    ntb_transport_rx_enqueue error.
    
    Signed-off-by: Jon Mason <jon.mason@intel.com>

diff --git a/drivers/net/ntb_netdev.c b/drivers/net/ntb_netdev.c
index 8298880bfdd8..8e6752fd89ac 100644
--- a/drivers/net/ntb_netdev.c
+++ b/drivers/net/ntb_netdev.c
@@ -182,8 +182,10 @@ static int ntb_netdev_open(struct net_device *ndev)
 
 		rc = ntb_transport_rx_enqueue(dev->qp, skb, skb->data,
 					      ndev->mtu + ETH_HLEN);
-		if (rc == -EINVAL)
+		if (rc == -EINVAL) {
+			dev_kfree_skb(skb);
 			goto err;
+		}
 	}
 
 	netif_carrier_off(ndev);

