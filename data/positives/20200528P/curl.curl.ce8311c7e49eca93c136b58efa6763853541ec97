commit ce8311c7e49eca93c136b58efa6763853541ec97
Author: Joe Mason <jmason@rim.com>
Date:   Fri Jul 27 17:25:45 2012 -0400

    Zero out auth structs before transfer

diff --git a/lib/transfer.c b/lib/transfer.c
index 20b3d048e..d6fc93445 100644
--- a/lib/transfer.c
+++ b/lib/transfer.c
@@ -1433,6 +1433,10 @@ CURLcode Curl_pretransfer(struct SessionHandle *data)
 
   data->state.ssl_connect_retry = FALSE;
 
+  /* zero out auth state */
+  memset(&data->state.authhost, 0, sizeof(struct auth));
+  memset(&data->state.authproxy, 0, sizeof(struct auth));
+
   data->state.authproblem = FALSE;
   data->state.authhost.want = data->set.httpauth;
   data->state.authproxy.want = data->set.proxyauth;

