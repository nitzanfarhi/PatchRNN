commit bda3ddd39446dc9739146dfc2b647d53d5f4f04a
Author: Ignacio R. Morelle <shadowm@wesnoth.org>
Date:   Mon Feb 9 04:08:37 2009 +0000

    Added an additional check in some code to avoid dividing by zero...
    
    ...and killing Wesnoth with a SIGFPE. Noticed while playing UtBS,
    attacking a Revenant with a female Fire Mage on desert hills.

diff --git a/src/unit_display.cpp b/src/unit_display.cpp
index 31bdf6231d..2097dea544 100644
--- a/src/unit_display.cpp
+++ b/src/unit_display.cpp
@@ -286,7 +286,7 @@ void unit_attack(
 	int damage_left = damage;
 	while(damage_left > 0 && !animator.would_end()) {
 		int step_left = (animator.get_end_time() - animator.get_animation_time() )/50;
-		int removed_hp = damage_left/step_left;
+		int removed_hp = step_left ? damage_left/step_left : 1;
 		if(removed_hp < 1) removed_hp = 1;
 		if(step_left < 1) step_left = 1;
 		defender.take_hit(removed_hp);

