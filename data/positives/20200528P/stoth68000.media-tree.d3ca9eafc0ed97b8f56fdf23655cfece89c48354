commit d3ca9eafc0ed97b8f56fdf23655cfece89c48354
Author: Jesse Gross <jesse@nicira.com>
Date:   Mon Nov 3 19:38:38 2014 -0800

    geneve: Unregister pernet subsys on module unload.
    
    The pernet ops aren't ever unregistered, which causes a memory
    leak and an OOPs if the module is ever reinserted.
    
    Fixes: 0b5e8b8eeae4 ("net: Add Geneve tunneling protocol driver")
    CC: Andy Zhou <azhou@nicira.com>
    Signed-off-by: Jesse Gross <jesse@nicira.com>
    Acked-by: Nicolas Dichtel <nicolas.dichtel@6wind.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/net/ipv4/geneve.c b/net/ipv4/geneve.c
index 6e5266cf403d..dedb21e99914 100644
--- a/net/ipv4/geneve.c
+++ b/net/ipv4/geneve.c
@@ -366,6 +366,7 @@ late_initcall(geneve_init_module);
 static void __exit geneve_cleanup_module(void)
 {
 	destroy_workqueue(geneve_wq);
+	unregister_pernet_subsys(&geneve_net_ops);
 }
 module_exit(geneve_cleanup_module);
 

