commit 3f016d023759ab8b823c64201163dc8d312e6094
Author: Kevin Lin <klin@sourcefire.com>
Date:   Thu Jun 4 17:21:16 2015 -0400

    ldb: fixed an issue with ':' within pcres incorrectly treated as offsets

diff --git a/libclamav/readdb.c b/libclamav/readdb.c
index e7d6a4966..e7bb53532 100644
--- a/libclamav/readdb.c
+++ b/libclamav/readdb.c
@@ -1618,7 +1618,7 @@ static int load_oneldb(char *buffer, int chkpua, struct cl_engine *engine, unsig
 {
     const char *sig, *virname, *offset, *logic;
     struct cli_ac_lsig **newtable, *lsig;
-    char *tokens[LDB_TOKENS+1], *pt;
+    char *tokens[LDB_TOKENS+1], *pt, *pt2;
     int i, subsigs, tokens_count;
     unsigned short target = 0;
     struct cli_matcher *root;
@@ -1740,7 +1740,8 @@ static int load_oneldb(char *buffer, int chkpua, struct cl_engine *engine, unsig
         lsigid[1] = i;
         sig = tokens[3 + i];
 
-        if((pt = strchr(tokens[3 + i], ':'))) {
+        pt2 = strchr(tokens[3 + i], '/');
+        if((pt = strchr(tokens[3 + i], ':')) && (pt < pt2)) {
             *pt = 0;
             sig = ++pt;
             offset = tokens[3 + i];

