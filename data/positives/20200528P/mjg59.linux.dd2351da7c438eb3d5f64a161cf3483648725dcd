commit dd2351da7c438eb3d5f64a161cf3483648725dcd
Author: Rob Clark <rob@ti.com>
Date:   Sun Sep 18 14:38:15 2011 -0500

    drm: drm_ioctl() should zero-init extra data
    
    If an older userspace passes in a smaller arg than the current kernel
    ioctl arg struct, then extra fields should be initialized to zero
    rather than passing random data to the DRM driver.
    
    Signed-off-by: Rob Clark <rob@ti.com>
    Signed-off-by: Dave Airlie <airlied@redhat.com>

diff --git a/drivers/gpu/drm/drm_drv.c b/drivers/gpu/drm/drm_drv.c
index 93a112d45c1a..7a87e0878f30 100644
--- a/drivers/gpu/drm/drm_drv.c
+++ b/drivers/gpu/drm/drm_drv.c
@@ -438,6 +438,8 @@ long drm_ioctl(struct file *filp,
 					goto err_i1;
 				}
 			}
+			if (asize > usize)
+				memset(kdata + usize, 0, asize - usize);
 		}
 
 		if (cmd & IOC_IN) {

