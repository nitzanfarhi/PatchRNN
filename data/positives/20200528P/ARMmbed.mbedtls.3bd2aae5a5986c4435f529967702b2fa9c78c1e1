commit 3bd2aae5a5986c4435f529967702b2fa9c78c1e1
Author: Manuel Pégourié-Gonnard <mpg@elzevir.fr>
Date:   Fri Sep 20 13:10:13 2013 +0200

    Add forgotten initializations

diff --git a/programs/ssl/ssl_mail_client.c b/programs/ssl/ssl_mail_client.c
index e4ab1f113..19e4d9035 100644
--- a/programs/ssl/ssl_mail_client.c
+++ b/programs/ssl/ssl_mail_client.c
@@ -360,9 +360,10 @@ int main( int argc, char *argv[] )
     const int *list;
 
     /*
-     * Make sure memory references are valid.
+     * Make sure memory references are valid in case we exit early.
      */
     server_fd = 0;
+    memset( &ssl, 0, sizeof( ssl_context ) );
     x509_crt_init( &cacert );
     x509_crt_init( &clicert );
     pk_init( &pkey );
diff --git a/programs/ssl/ssl_server2.c b/programs/ssl/ssl_server2.c
index 595880c86..dff45e5db 100644
--- a/programs/ssl/ssl_server2.c
+++ b/programs/ssl/ssl_server2.c
@@ -233,9 +233,10 @@ int main( int argc, char *argv[] )
 #endif
 
     /*
-     * Make sure memory references are valid.
+     * Make sure memory references are valid in case we exit early.
      */
     listen_fd = 0;
+    memset( &ssl, 0, sizeof( ssl_context ) );
 #if defined(POLARSSL_X509_CRT_PARSE_C)
     x509_crt_init( &cacert );
     x509_crt_init( &srvcert );

