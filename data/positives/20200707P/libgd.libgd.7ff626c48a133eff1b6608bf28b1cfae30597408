commit 7ff626c48a133eff1b6608bf28b1cfae30597408
Author: Christoph M. Becker <cmbecker69@gmx.de>
Date:   Mon Jan 29 13:30:01 2018 +0100

    Fix integer-overflow in gdImageCreateFromGd2Ctx
    
    oss-fuzz pointed out:
    gd_gd2.c:456:10: runtime error: signed integer overflow: 2147483647 + 1 cannot be represented in type 'int'
    
    We must not allow chunk sizes (aka. lengths) of INT_MAX, since we need
    to alloc size+1 bytes.

diff --git a/src/gd_gd2.c b/src/gd_gd2.c
index 1be97a1..405bdf9 100644
--- a/src/gd_gd2.c
+++ b/src/gd_gd2.c
@@ -238,7 +238,7 @@ _gd2GetHeader (gdIOCtxPtr in, int *sx, int *sy,
 			if (gdGetInt (&cidx[i].size, in) != 1) {
 				goto fail2;
 			};
-			if (cidx[i].offset < 0 || cidx[i].size < 0)
+			if (cidx[i].offset < 0 || cidx[i].size < 0 || cidx[i].size == INT_MAX)
 				goto fail2;
 		};
 		*chunkIdx = cidx;

