commit 14c13cf53b643465797cfc37763296e3a04300ce
Author: Pierre Joye <pajoye@php.net>
Date:   Wed Mar 14 11:25:20 2007 +0000

    - MFB: free buffer when zip_entry_read returns an empty entry

diff --git a/ext/zip/php_zip.c b/ext/zip/php_zip.c
index c49e169c01..a07ed6b32b 100644
--- a/ext/zip/php_zip.c
+++ b/ext/zip/php_zip.c
@@ -788,6 +788,7 @@ static PHP_FUNCTION(zip_entry_read)
 			buffer[n] = 0;
 			RETURN_STRINGL(buffer, n, 0);
 		} else {
+			efree(buffer);
 			RETURN_EMPTY_STRING()
 		}
 	} else {

