commit 0a2b1d27cac02f57e17b310f8baeb1dda082c83a
Author: Louis Tsien <Louis.Tsien@Sun.COM>
Date:   Fri Nov 7 13:56:36 2008 -0500

    6765631 sun4v mem enumerator initialization leaks memory

diff --git a/usr/src/lib/fm/topo/modules/sun4v/platform-mem/mem_mdesc.c b/usr/src/lib/fm/topo/modules/sun4v/platform-mem/mem_mdesc.c
index 4639fa44d9..4e91c74277 100644
--- a/usr/src/lib/fm/topo/modules/sun4v/platform-mem/mem_mdesc.c
+++ b/usr/src/lib/fm/topo/modules/sun4v/platform-mem/mem_mdesc.c
@@ -477,6 +477,7 @@ mem_mdesc_fini(topo_mod_t *mod, md_mem_info_t *mem)
 		next = dm->dm_next;
 		topo_mod_strfree(mod, dm->dm_label);
 		topo_mod_strfree(mod, dm->dm_serid);
+		topo_mod_strfree(mod, dm->dm_part);
 		topo_mod_free(mod, dm, sizeof (mem_dimm_map_t));
 	}
 	for (bm = mem->mem_bank; bm != NULL; bm = cm) {
@@ -487,7 +488,7 @@ mem_mdesc_fini(topo_mod_t *mod, md_mem_info_t *mem)
 		hm = gm->mg_next;
 		topo_mod_free(mod, gm, sizeof (mem_grp_t));
 	}
-	for (sm = mem->mem_seg; dm != NULL; sm = snext) {
+	for (sm = mem->mem_seg; sm != NULL; sm = snext) {
 		snext = sm->sm_next;
 		topo_mod_free(mod, sm, sizeof (mem_seg_map_t));
 	}

