commit f3eef37f2d2ab6358b58c7c2b5ef615da46a1716
Author: Steinar Midtskogen <stemidts@cisco.com>
Date:   Tue May 22 13:53:30 2018 +0200

    Fix possible buffer overrun in cdef_frame

diff --git a/common/common_frame.c b/common/common_frame.c
index 7504443..e0f86ef 100644
--- a/common/common_frame.c
+++ b/common/common_frame.c
@@ -859,7 +859,7 @@ void TEMPLATE(cdef_frame)(cdef_strengths *cdef_strengths, const yuv_frame_t *fra
   int hpadding = 16 - padding;
   int stride16 = (bs + 2 * padding + 15) & ~15;
   int offset16 = padding * stride16 + padding + hpadding;
-  uint16_t *src16 = thor_alloc((bs + 2 * padding) * stride16 * sizeof(uint16_t) + hpadding, 32);
+  uint16_t *src16 = thor_alloc(((bs + 2 * padding) * stride16 + hpadding) * sizeof(uint16_t), 32);
   cdef_init(stride16, cdef_directions_copy);
   cdef_init(sstride, cdef_directions);
 

