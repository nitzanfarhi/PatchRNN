commit 62006b539ddda23594febf0fcb2f21c03de60457
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Thu Nov 15 02:43:38 2012 +0100

    ituh263dec: more complete w/h check.
    
    Fixes a division by 0
    
    Found-by: Mateusz "j00ru" Jurczyk and Gynvael Coldwind
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavcodec/ituh263dec.c b/libavcodec/ituh263dec.c
index 86c5c0638a..6c95636ab8 100644
--- a/libavcodec/ituh263dec.c
+++ b/libavcodec/ituh263dec.c
@@ -1075,6 +1075,10 @@ int ff_h263_decode_picture_header(MpegEncContext *s)
         s->qscale = get_bits(&s->gb, 5);
     }
 
+    if (s->width == 0 || s->height == 0) {
+        av_log(s->avctx, AV_LOG_ERROR, "dimensions 0\n");
+        return -1;
+    }
     s->mb_width = (s->width  + 15) / 16;
     s->mb_height = (s->height  + 15) / 16;
     s->mb_num = s->mb_width * s->mb_height;

