commit aebe495895f5542213dd17a644647b0aae8353f0
Author: Mark Brown <broonie@opensource.wolfsonmicro.com>
Date:   Wed Nov 2 11:38:45 2011 +0000

    regulator: Don't report zero volts for the fixed voltage regulator
    
    If we don't know what voltage the regulator is set to return an error
    rather than reporting zero volts.
    
    Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com>

diff --git a/drivers/regulator/fixed.c b/drivers/regulator/fixed.c
index 21ecf212a522..ccbead06c8f3 100644
--- a/drivers/regulator/fixed.c
+++ b/drivers/regulator/fixed.c
@@ -80,7 +80,10 @@ static int fixed_voltage_get_voltage(struct regulator_dev *dev)
 {
 	struct fixed_voltage_data *data = rdev_get_drvdata(dev);
 
-	return data->microvolts;
+	if (data->microvolts)
+		return data->microvolts;
+	else
+		return -EINVAL;
 }
 
 static int fixed_voltage_list_voltage(struct regulator_dev *dev,

