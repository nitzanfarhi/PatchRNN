commit 30988fc33385c4ae9974c8d01489a907b7fe6e04
Author: Alan T. DeKok <aland@freeradius.org>
Date:   Mon Nov 22 09:58:26 2010 +0100

    Handle zero-length attributes

diff --git a/src/main/radattr.c b/src/main/radattr.c
index 31b06c25c..5eefa3374 100644
--- a/src/main/radattr.c
+++ b/src/main/radattr.c
@@ -535,6 +535,11 @@ static void process_file(const char *filename)
 			}
 
 		print_hex:
+			if (outlen == 0) {
+				output[0] = 0;
+				continue;
+			}
+
 			data_len = outlen;
 			for (i = 0; i < outlen; i++) {
 				snprintf(output + 3*i, sizeof(output),
@@ -580,6 +585,7 @@ static void process_file(const char *filename)
 				}
 
 				attr += len;
+				if (len == 0) break;
 			}
 			
 			pairfree(&head);

