commit 38cef584048b90d2405fdbb8b79a731535948d27
Author: Alex Converse <alex.converse@gmail.com>
Date:   Tue Jan 20 08:00:39 2009 +0000

    Fix a read past end of buffer crash in the mp3 probe
    
    Originally committed as revision 16693 to svn://svn.ffmpeg.org/ffmpeg/trunk

diff --git a/libavformat/mp3.c b/libavformat/mp3.c
index ec8c0bb99..eca9ad424 100644
--- a/libavformat/mp3.c
+++ b/libavformat/mp3.c
@@ -364,7 +364,7 @@ static int mp3_read_probe(AVProbeData *p)
 
     max_frames = 0;
     buf = buf0;
-    end = buf + p->buf_size - sizeof(uint32_t);
+    end = p->buf + p->buf_size - sizeof(uint32_t);
 
     for(; buf < end; buf= buf2+1) {
         buf2 = buf;

