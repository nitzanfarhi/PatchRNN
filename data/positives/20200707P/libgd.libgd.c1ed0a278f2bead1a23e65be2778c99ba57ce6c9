commit c1ed0a278f2bead1a23e65be2778c99ba57ce6c9
Author: pajoye <none@none>
Date:   Thu Jan 4 01:24:00 2007 +0000

    - #14, some more sanitiy check

diff --git a/src/gdxpm.c b/src/gdxpm.c
index 1438877..7c7ba53 100644
--- a/src/gdxpm.c
+++ b/src/gdxpm.c
@@ -47,6 +47,9 @@ BGD_DECLARE(gdImagePtr) gdImageCreateFromXpm (char *filename)
     return 0;
 
   number = image.ncolors;
+	if (overflow2(sizeof (int), number)) {
+		return 0;
+	}
   colors = (int *) gdMalloc (sizeof (int) * number);
   if (colors == NULL)
     return (0);

