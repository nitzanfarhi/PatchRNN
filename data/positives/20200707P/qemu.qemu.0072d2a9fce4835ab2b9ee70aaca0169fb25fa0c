commit 0072d2a9fce4835ab2b9ee70aaca0169fb25fa0c
Author: Li Qiang <liqiang6-s@360.cn>
Date:   Tue Jan 3 20:31:34 2017 -0800

    crypto: fix leak in ivgen essiv init
    
    On error path, the 'salt' doesn't been freed thus leading
    a memory leak. This patch avoid this.
    
    Signed-off-by: Li Qiang <liqiang6-s@360.cn>
    Signed-off-by: Daniel P. Berrange <berrange@redhat.com>

diff --git a/crypto/ivgen-essiv.c b/crypto/ivgen-essiv.c
index 634de63338..cba20bde6c 100644
--- a/crypto/ivgen-essiv.c
+++ b/crypto/ivgen-essiv.c
@@ -48,6 +48,7 @@ static int qcrypto_ivgen_essiv_init(QCryptoIVGen *ivgen,
                            &salt, &nhash,
                            errp) < 0) {
         g_free(essiv);
+        g_free(salt);
         return -1;
     }
 

