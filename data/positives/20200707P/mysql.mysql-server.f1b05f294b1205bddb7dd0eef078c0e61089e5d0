commit f1b05f294b1205bddb7dd0eef078c0e61089e5d0
Author: gni/root@dev3-221.dev.cn.tlan <>
Date:   Thu Mar 8 17:47:13 2007 +0800

    BUG#25743 If undo_buffer_size (for LG) greater than the inital shared memory (default 20M),
              ndbd nodes are crashed

diff --git a/storage/ndb/src/kernel/vm/Pool.hpp b/storage/ndb/src/kernel/vm/Pool.hpp
index b585af57684..a4e062078fb 100644
--- a/storage/ndb/src/kernel/vm/Pool.hpp
+++ b/storage/ndb/src/kernel/vm/Pool.hpp
@@ -307,8 +307,11 @@ RecordPool<T, P>::seize(Ptr<T> & ptr)
 {
   Ptr<void> tmp;
   bool ret = m_pool.seize(tmp);
-  ptr.i = tmp.i;
-  ptr.p = static_cast<T*>(tmp.p);
+  if(likely(ret))
+  {
+    ptr.i = tmp.i;
+    ptr.p = static_cast<T*>(tmp.p);
+  }
   return ret;
 }
 

