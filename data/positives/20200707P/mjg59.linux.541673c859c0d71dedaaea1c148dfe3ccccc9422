commit 541673c859c0d71dedaaea1c148dfe3ccccc9422
Author: Patrick McHardy <kaber@trash.net>
Date:   Sun Jan 8 22:17:27 2006 -0800

    [PKT_SCHED]: Fix memory leak when dumping in pedit action
    
    Signed-off-by: Patrick McHardy <kaber@trash.net>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/net/sched/pedit.c b/net/sched/pedit.c
index b5167afec2dc..1742a68e0122 100644
--- a/net/sched/pedit.c
+++ b/net/sched/pedit.c
@@ -245,10 +245,12 @@ tcf_pedit_dump(struct sk_buff *skb, struct tc_action *a,int bind, int ref)
 	t.lastuse = jiffies_to_clock_t(jiffies - p->tm.lastuse);
 	t.expires = jiffies_to_clock_t(p->tm.expires);
 	RTA_PUT(skb, TCA_PEDIT_TM, sizeof(t), &t);
+	kfree(opt);
 	return skb->len;
 
 rtattr_failure:
 	skb_trim(skb, b - skb->data);
+	kfree(opt);
 	return -1;
 }
 

