commit 3ff9260dac3dcb575d27a8239b64ef082c2a0f88
Author: Jan Janak <jan@iptel.org>
Date:   Tue Aug 27 11:15:49 2002 +0000

    *** empty log message ***

diff --git a/modules_s/usrloc/dlist.c b/modules_s/usrloc/dlist.c
index cb3eee6ff..2daf6da38 100644
--- a/modules_s/usrloc/dlist.c
+++ b/modules_s/usrloc/dlist.c
@@ -175,7 +175,6 @@ int timer_handler(void)
 		ptr = ptr->next;
 	}
 	
-	print_all_udomains();
 	return res;
 }
 
diff --git a/modules_s/usrloc/udomain.c b/modules_s/usrloc/udomain.c
index 668a1518d..f39f7d255 100644
--- a/modules_s/usrloc/udomain.c
+++ b/modules_s/usrloc/udomain.c
@@ -123,12 +123,14 @@ void free_udomain(udomain_t* _d)
 {
 	int i;
 	
+	lock_udomain(_d);
 	if (_d->table) {
 		for(i = 0; i < _d->size; i++) {
 			deinit_slot(_d->table + i);
 		}
 		shm_free(_d->table);
 	}
+	unlock_udomain(_d);
 
         shm_free(_d);
 }

