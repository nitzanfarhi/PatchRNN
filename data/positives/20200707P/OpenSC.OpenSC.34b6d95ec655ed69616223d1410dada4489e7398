commit 34b6d95ec655ed69616223d1410dada4489e7398
Author: Frank Morgner <morgner@informatik.hu-berlin.de>
Date:   Fri Oct 9 17:37:21 2015 +0200

    card-westcos.c: fixed potential resource leak

diff --git a/src/libopensc/card-westcos.c b/src/libopensc/card-westcos.c
index 5c2e2cf0..00e9940d 100644
--- a/src/libopensc/card-westcos.c
+++ b/src/libopensc/card-westcos.c
@@ -1108,8 +1108,11 @@ static int westcos_sign_decipher(int mode, sc_card_t *card,
 	BIO *mem = BIO_new(BIO_s_mem());
 #endif
 
-	if (card == NULL)
+	if (card == NULL) {
+		if (keyfile)
+			sc_file_free(keyfile);
 		return SC_ERROR_INVALID_ARGUMENTS;
+	}
 	sc_debug(card->ctx, SC_LOG_DEBUG_NORMAL,
 		"westcos_sign_decipher outlen=%d\n", outlen);
 	

