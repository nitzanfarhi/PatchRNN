commit fceb2aee67418c12f497fecb67356cef4341fc47
Author: deraadt <deraadt@openbsd.org>
Date:   Fri Nov 20 16:43:07 1998 +0000

    careful with mmap off

diff --git a/sys/dev/ksyms.c b/sys/dev/ksyms.c
index 61792499b2a..f9e3fcaf4a5 100644
--- a/sys/dev/ksyms.c
+++ b/sys/dev/ksyms.c
@@ -176,6 +176,8 @@ ksymsmmap(dev, off, prot)
 	int off, prot;
 {
 #define ksyms_btop(x)	((vm_offset_t)(x) >> PGSHIFT
+	if (off < 0)
+		return (-1);
 	if ((unsigned)off >= (unsigned)(esym - symtab) + k1->a_text)
 		return (-1);
 

