commit e66df58c88b4f953198826f444b7dbe1c8acdf6b
Author: Bill Parker <wp02855@gmail.com>
Date:   Tue Sep 4 10:02:21 2012 -0700

    Sanity Checking added to addrtoname
    
    Added return value checking for tp->e_bs against NULL to see if memory
    was actually allocated :)

diff --git a/addrtoname.c b/addrtoname.c
index d77f27b0..c92870dc 100644
--- a/addrtoname.c
+++ b/addrtoname.c
@@ -381,6 +381,9 @@ lookup_bytestring(register const u_char *bs, const unsigned int nlen)
 	tp->e_addr2 = k;
 
 	tp->e_bs = (u_char *) calloc(1, nlen + 1);
+	if (tp->e_bs == NULL)
+		error("lookup_bytestring: calloc");
+
 	memcpy(tp->e_bs, bs, nlen);
 	tp->e_nxt = (struct enamemem *)calloc(1, sizeof(*tp));
 	if (tp->e_nxt == NULL)

