commit e215b7b4fb5d51d72dc44bb7ac9dbc6fb5348426
Author: Frank Morgner <morgner@informatik.hu-berlin.de>
Date:   Wed Apr 29 23:22:28 2015 +0200

    sm-common: fixed resource leak

diff --git a/src/libsm/sm-common.c b/src/libsm/sm-common.c
index cb500b4e..87d5907f 100644
--- a/src/libsm/sm-common.c
+++ b/src/libsm/sm-common.c
@@ -332,8 +332,10 @@ sm_encrypt_des_cbc3(struct sc_context *ctx, unsigned char *key,
 
 	*out_len = data_len;
 	*out = malloc(data_len + 8);
-	if (*out == NULL)
+	if (*out == NULL) {
+		free(data);
 		LOG_TEST_RET(ctx, SC_ERROR_OUT_OF_MEMORY, "SM encrypt_des_cbc3: failure");
+	}
 
 	memcpy(&kk, key, 8);
 	memcpy(&k2, key + 8, 8);

