commit 6f5c0992a39c8728d82e6b8cb7ba0e65b7e88d9a
Author: Wez Furlong <wez@php.net>
Date:   Wed May 26 22:19:44 2004 +0000

    Fix leak on systems where alloca isn't really alloca.

diff --git a/Zend/zend_object_handlers.c b/Zend/zend_object_handlers.c
index 7d2a1036ce..d7f57a8d96 100644
--- a/Zend/zend_object_handlers.c
+++ b/Zend/zend_object_handlers.c
@@ -671,6 +671,7 @@ static union _zend_function *zend_std_get_method(zval *object, char *method_name
 		
 	zobj = Z_OBJ_P(object);
 	if (zend_hash_find(&zobj->ce->function_table, lc_method_name, method_len+1, (void **)&fbc) == FAILURE) {
+		free_alloca(lc_method_name);
 		if (zobj->ce->__call) {
 			zend_internal_function *call_user_call = emalloc(sizeof(zend_internal_function));
 			call_user_call->type = ZEND_INTERNAL_FUNCTION;
@@ -681,7 +682,6 @@ static union _zend_function *zend_std_get_method(zval *object, char *method_name
 			call_user_call->fn_flags = 0;
 			call_user_call->function_name = estrndup(method_name, method_len);
 
-			free_alloca(lc_method_name);
 			return (union _zend_function *)call_user_call;
 		} else {
 			return NULL;

