commit c971768955f826fb965d8ffbb13dac93c9bbead8
Author: Phil Carmody <phil@dovecot.fi>
Date:   Tue Sep 16 20:29:04 2014 +0300

    lib: hash-format - fix leak on _init() failure path
    If any of the analysis/parse helpers return failure, then the whole pool
    will leak.
    
    Signed-off-by: Phil Carmody <phil@dovecot.fi>

diff --git a/src/lib/hash-format.c b/src/lib/hash-format.c
index 9abc02205..9ad477c1d 100644
--- a/src/lib/hash-format.c
+++ b/src/lib/hash-format.c
@@ -134,6 +134,7 @@ int hash_format_init(const char *format_string, struct hash_format **format_r,
 	} T_END;
 	if (ret < 0) {
 		*error_r = t_strdup(*error_r);
+		pool_unref(&pool);
 		return -1;
 	}
 	*format_r = format;

