commit 8d606cd3f6bce304874b1d7745d40d11f64ea17d
Author: Guido Vranken <guidovranken@gmail.com>
Date:   Thu Jun 8 16:36:54 2017 +0200

    Fix 2 memory leaks in proxy authentication routine
    
    Signed-off-by: Guido Vranken <guidovranken@gmail.com>
    Acked-by: Gert Doering <gert@greenie.muc.de>
    Message-Id: <CAO5O-EL11jDxO+c1Gu0FvunqwUTW2uxjy910+A-s63Nr5O3NWw@mail.gmail.com>
    URL: https://www.mail-archive.com/openvpn-devel@lists.sourceforge.net/msg14758.html
    Signed-off-by: Gert Doering <gert@greenie.muc.de>

diff --git a/src/openvpn/proxy.c b/src/openvpn/proxy.c
index b0ed3279..8ff09ba9 100644
--- a/src/openvpn/proxy.c
+++ b/src/openvpn/proxy.c
@@ -318,6 +318,7 @@ get_proxy_authenticate(socket_descriptor_t sd,
     {
         if (!recv_line(sd, buf, sizeof(buf), timeout, true, NULL, signal_received))
         {
+            free(*data);
             *data = NULL;
             return HTTP_AUTH_NONE;
         }
@@ -991,6 +992,7 @@ establish_http_proxy_passthru(struct http_proxy_info *p,
                 if (p->options.auth_retry == PAR_NCT && method == HTTP_AUTH_BASIC)
                 {
                     msg(D_PROXY, "HTTP proxy: support for basic auth and other cleartext proxy auth methods is disabled");
+                    free(pa);
                     goto error;
                 }
                 p->auth_method = method;

