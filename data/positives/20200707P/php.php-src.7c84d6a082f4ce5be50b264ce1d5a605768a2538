commit 7c84d6a082f4ce5be50b264ce1d5a605768a2538
Author: foobar <sniper@php.net>
Date:   Fri Jul 28 22:39:22 2000 +0000

    Fixes bug which caused crash, if result_entry wasn't valid.

diff --git a/ext/ldap/ldap.c b/ext/ldap/ldap.c
index ca28c193f1..c25d19cce3 100644
--- a/ext/ldap/ldap.c
+++ b/ext/ldap/ldap.c
@@ -978,11 +978,12 @@ PHP_FUNCTION(ldap_get_values_len)
 		WRONG_PARAM_COUNT;
 	}
 	
-	if ((ldap = _get_ldap_link(link)) == NULL) {
-		RETURN_FALSE;
-	}
-	
+	ldap = _get_ldap_link(link);
+	if (ldap == NULL) RETURN_FALSE;
+
 	ldap_result_entry = _get_ldap_result_entry(result_entry);
+	if (ldap_result_entry == NULL) RETURN_FALSE;
+
 	convert_to_string_ex(attr);
 	attribute = (*attr)->value.str.val;
 	

