commit 99212e8b8773d7ec015102979298328fa30bb8a5
Author: Love Hörnquist Åstrand <lha@kth.se>
Date:   Tue Apr 24 16:14:30 2007 +0000

    Handle the case of resize to 0 and realloc that returns NULL.
    
    
    git-svn-id: svn://svn.h5l.se/heimdal/trunk/heimdal@20561 ec53bebd-3082-4978-b11e-865c3cabbd6b

diff --git a/lib/asn1/gen_seq.c b/lib/asn1/gen_seq.c
index d22a62e1a..d7d4fa5d7 100644
--- a/lib/asn1/gen_seq.c
+++ b/lib/asn1/gen_seq.c
@@ -111,7 +111,7 @@ generate_type_seq (const Symbol *s)
 	     "\t\tsizeof(data->val[0]) * data->len);\n"
 	     /* resize but don't care about failures since it doesn't matter */
 	     "ptr = realloc(data->val, data->len * sizeof(data->val[0]));\n"
-	     "if (ptr) data->val = ptr;\n"
+	     "if (ptr != NULL || data->len == 0) data->val = ptr;\n"
 	     "return 0;\n",
 	     subname);
 

