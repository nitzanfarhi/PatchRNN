commit 2757495c906113896b378bf084708846273c87b2
Author: Chris Mason <chris.mason@oracle.com>
Date:   Thu May 14 13:10:02 2009 -0400

    Btrfs: init inode ordered_data_close flag properly
    
    This flag is used to decide when we need to send a given file through
    the ordered code to make sure it is fully written before a transaction
    commits.  It was not being properly set to zero when the inode was
    being setup.
    
    Signed-off-by: Chris Mason <chris.mason@oracle.com>

diff --git a/fs/btrfs/inode.c b/fs/btrfs/inode.c
index 90c23eb28829..22450bd972df 100644
--- a/fs/btrfs/inode.c
+++ b/fs/btrfs/inode.c
@@ -3122,6 +3122,7 @@ static noinline void init_btrfs_i(struct inode *inode)
 	bi->flags = 0;
 	bi->index_cnt = (u64)-1;
 	bi->last_unlink_trans = 0;
+	bi->ordered_data_close = 0;
 	extent_map_tree_init(&BTRFS_I(inode)->extent_tree, GFP_NOFS);
 	extent_io_tree_init(&BTRFS_I(inode)->io_tree,
 			     inode->i_mapping, GFP_NOFS);

