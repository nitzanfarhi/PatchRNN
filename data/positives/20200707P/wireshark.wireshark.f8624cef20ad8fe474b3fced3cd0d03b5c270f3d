commit f8624cef20ad8fe474b3fced3cd0d03b5c270f3d
Author: Stig Bj√∏rlykke <stig@bjorlykke.org>
Date:   Mon Sep 9 21:20:26 2013 +0000

    Initialize all tvb values in FieldInfo_get_range.
    
    This fixes bug 5200.
    
    svn path=/trunk/; revision=51899

diff --git a/epan/wslua/wslua_field.c b/epan/wslua/wslua_field.c
index f5fd6e9675..b8753c51cf 100644
--- a/epan/wslua/wslua_field.c
+++ b/epan/wslua/wslua_field.c
@@ -225,6 +225,8 @@ static int FieldInfo_get_range(lua_State* L) {
     r->tvb = ep_new(struct _wslua_tvb);
 
     r->tvb->ws_tvb = fi->ds_tvb;
+    r->tvb->expired = FALSE;
+    r->tvb->need_free = FALSE;
     r->offset = fi->start;
     r->len = fi->length;
 

