commit fab6247393d1d2bcf724bc488f3d4f637e1980b9
Author: nicodvb <nicodvb@b3059339-0415-0410-9bf9-f77b7e298cf2>
Date:   Thu May 18 18:05:10 2006 +0000

    psm longer than 1018 bytes is not allowed, thus invalid
    
    
    git-svn-id: svn://svn.mplayerhq.hu/mplayer/trunk@18550 b3059339-0415-0410-9bf9-f77b7e298cf2

diff --git a/libmpdemux/demux_mpg.c b/libmpdemux/demux_mpg.c
index f330a4971b..b5a23046fa 100644
--- a/libmpdemux/demux_mpg.c
+++ b/libmpdemux/demux_mpg.c
@@ -45,7 +45,7 @@ static int parse_psm(demuxer_t *demux, int len) {
   mpg_demuxer_t *priv = (mpg_demuxer_t *) demux->priv;
   
   mp_dbg(MSGT_DEMUX,MSGL_V, "PARSE_PSM, len=%d\n", len);
-  if(! len)
+  if(! len || len > 1018)
     return 0;
   
   c = stream_read_char(demux->stream);

