commit 4b6271a64463f4fcbaf8b2e1d84704b7eb8c407c
Author: Valentin Ilie <valentin.ilie@gmail.com>
Date:   Thu Oct 24 16:14:22 2013 +0300

    dma: edma: Fix memory leak
    
    When it fails to allocate a slot, edesc should be free'd before return;
    
    Signed-off-by: Valentin Ilie <valentin.ilie@gmail.com>
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

diff --git a/drivers/dma/edma.c b/drivers/dma/edma.c
index 3519111c566b..134fa96de1b3 100644
--- a/drivers/dma/edma.c
+++ b/drivers/dma/edma.c
@@ -305,6 +305,7 @@ static struct dma_async_tx_descriptor *edma_prep_slave_sg(
 				edma_alloc_slot(EDMA_CTLR(echan->ch_num),
 						EDMA_SLOT_ANY);
 			if (echan->slot[i] < 0) {
+				kfree(edesc);
 				dev_err(dev, "Failed to allocate slot\n");
 				kfree(edesc);
 				return NULL;

