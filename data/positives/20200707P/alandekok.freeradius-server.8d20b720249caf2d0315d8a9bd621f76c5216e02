commit 8d20b720249caf2d0315d8a9bd621f76c5216e02
Author: aland <aland>
Date:   Thu Jun 10 16:57:02 2004 +0000

            Don't leak memory if pairmove doesn't move

diff --git a/src/modules/rlm_passwd/rlm_passwd.c b/src/modules/rlm_passwd/rlm_passwd.c
index 701aed7a6..d5ab7cd28 100644
--- a/src/modules/rlm_passwd/rlm_passwd.c
+++ b/src/modules/rlm_passwd/rlm_passwd.c
@@ -553,6 +553,7 @@ static int passwd_authorize(void *instance, REQUEST *request)
 		 *	over-write existing attributes.
 		 */
 		pairmove(&request->config_items, &key);
+		pairfree(&key);	/* pairmove may have NOT moved it */
 	}
 	return RLM_MODULE_OK;
 

