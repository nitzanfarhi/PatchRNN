commit 6cbf7512cb29222070225229866952a1accf74bd
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Nov 19 20:56:17 2000 +0000

    Add an overflow check to process_data().
    
    svn path=/trunk/; revision=2675

diff --git a/wiretap/pppdump.c b/wiretap/pppdump.c
index e6ea7e8075..c97d63280c 100644
--- a/wiretap/pppdump.c
+++ b/wiretap/pppdump.c
@@ -1,6 +1,6 @@
 /* pppdump.c
  *
- * $Id: pppdump.c,v 1.5 2000/11/19 03:47:36 guy Exp $
+ * $Id: pppdump.c,v 1.6 2000/11/19 20:56:17 gerald Exp $
  *
  * Copyright (c) 2000 by Gilbert Ramirez <gram@xiexie.org>
  * 
@@ -334,6 +334,11 @@ process_data(pppdump_t *state, FILE_T fh, pkt_t *pkt, int n, guint8 *pd, int *er
 						return 0;
 					}
 
+					if (num_written > sizeof(pd)) {
+						*err = WTAP_ERR_UNC_OVERFLOW;
+						return -1;
+					}
+
 					memcpy(pd, pkt->buf, num_written);
 
 					num_bytes--;

