commit 79964745b3ed5a700f4f0dda56c7360497328c88
Author: Laurent Aimar <fenrir@videolan.org>
Date:   Sun Oct 2 00:48:11 2011 +0000

    4xmdemux: prevent use of uninitialized memory
    
    Signed-off-by: Janne Grunau <janne-libav@jannau.net>

diff --git a/libavformat/4xm.c b/libavformat/4xm.c
index 622413494..1557c5b5a 100644
--- a/libavformat/4xm.c
+++ b/libavformat/4xm.c
@@ -173,13 +173,15 @@ static int fourxm_read_header(AVFormatContext *s,
                 goto fail;
             }
             if (current_track + 1 > fourxm->track_count) {
-                fourxm->track_count = current_track + 1;
                 fourxm->tracks = av_realloc(fourxm->tracks,
-                    fourxm->track_count * sizeof(AudioTrack));
+                    (current_track + 1) * sizeof(AudioTrack));
                 if (!fourxm->tracks) {
-                    ret=  AVERROR(ENOMEM);
+                    ret = AVERROR(ENOMEM);
                     goto fail;
                 }
+                memset(&fourxm->tracks[fourxm->track_count], 0,
+                       sizeof(AudioTrack) * (current_track + 1 - fourxm->track_count));
+                fourxm->track_count = current_track + 1;
             }
             fourxm->tracks[current_track].adpcm       = AV_RL32(&header[i + 12]);
             fourxm->tracks[current_track].channels    = AV_RL32(&header[i + 36]);

