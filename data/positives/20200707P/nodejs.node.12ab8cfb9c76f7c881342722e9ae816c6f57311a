commit 12ab8cfb9c76f7c881342722e9ae816c6f57311a
Author: Karl Skomski <karl@skomski.com>
Date:   Fri Aug 14 14:30:52 2015 +0200

    crypto: fix memory leak in ECDH::SetPrivateKey
    
    PR-URL: https://github.com/nodejs/node/pull/2375
    Reviewed-By: Ben Noordhuis <info@bnoordhuis.nl>

diff --git a/src/node_crypto.cc b/src/node_crypto.cc
index 04f5b0f8be..10223dfcfb 100644
--- a/src/node_crypto.cc
+++ b/src/node_crypto.cc
@@ -4570,8 +4570,12 @@ void ECDH::SetPrivateKey(const FunctionCallbackInfo<Value>& args) {
   if (priv == nullptr)
     return env->ThrowError("Failed to convert Buffer to BN");
 
-  if (!EC_KEY_set_private_key(ecdh->key_, priv))
+  int result = EC_KEY_set_private_key(ecdh->key_, priv);
+  BN_free(priv);
+
+  if (!result) {
     return env->ThrowError("Failed to convert BN to a private key");
+  }
 }
 
 

