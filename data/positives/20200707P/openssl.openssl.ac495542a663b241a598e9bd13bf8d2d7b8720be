commit ac495542a663b241a598e9bd13bf8d2d7b8720be
Author: Dr. Stephen Henson <steve@openssl.org>
Date:   Sat Mar 27 18:28:02 2010 +0000

    PR: 1813
    Submitted by: Torsten Hilbrich <torsten.hilbrich@secunet.com>
    
    Fix memory leak when engine name cannot be loaded.

diff --git a/crypto/engine/eng_list.c b/crypto/engine/eng_list.c
index 66a52b89e0..27846edb1e 100644
--- a/crypto/engine/eng_list.c
+++ b/crypto/engine/eng_list.c
@@ -413,6 +413,7 @@ ENGINE *ENGINE_by_id(const char *id)
 		return iterator;
 		}
 notfound:
+	ENGINE_free(iterator);
 	ENGINEerr(ENGINE_F_ENGINE_BY_ID,ENGINE_R_NO_SUCH_ENGINE);
 	ERR_add_error_data(2, "id=", id);
 	return NULL;

