commit 8a548868db62422113104ebc658065e3fe976951
Author: Patrick McHardy <kaber@trash.net>
Date:   Tue Jun 17 15:52:07 2008 -0700

    netfilter: nf_conntrack_h323: fix memory leak in module initialization error path
    
    Properly free h323_buffer when helper registration fails.
    
    Signed-off-by: Patrick McHardy <kaber@trash.net>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/net/netfilter/nf_conntrack_h323_main.c b/net/netfilter/nf_conntrack_h323_main.c
index 95da1a24aab7..99e385d5b707 100644
--- a/net/netfilter/nf_conntrack_h323_main.c
+++ b/net/netfilter/nf_conntrack_h323_main.c
@@ -1799,6 +1799,7 @@ err3:
 err2:
 	nf_conntrack_helper_unregister(&nf_conntrack_helper_q931[0]);
 err1:
+	kfree(h323_buffer);
 	return ret;
 }
 

