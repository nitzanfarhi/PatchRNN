commit 00cbe9e4053fd562b6f21e76aca6636ff926b637
Author: Laurent Aimar <fenrir@videolan.org>
Date:   Sat Sep 24 23:16:17 2011 +0200

    Fix potential overread in vmd audio decoder.
    
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavcodec/vmdav.c b/libavcodec/vmdav.c
index 919789168e..77e0432610 100644
--- a/libavcodec/vmdav.c
+++ b/libavcodec/vmdav.c
@@ -523,7 +523,10 @@ static int vmdaudio_decode_frame(AVCodecContext *avctx,
 
     silent_chunks = 0;
     if (block_type == BLOCK_TYPE_INITIAL) {
-        uint32_t flags = AV_RB32(buf);
+        uint32_t flags;
+        if (buf_size < 4)
+            return -1;
+        flags = AV_RB32(buf);
         silent_chunks  = av_popcount(flags);
         buf      += 4;
         buf_size -= 4;

