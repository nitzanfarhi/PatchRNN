commit 8a4ea9644833d43fdfe8579c0cb569f8a0930206
Author: Andreas Cadhalpun <Andreas.Cadhalpun@googlemail.com>
Date:   Fri Nov 4 18:59:31 2016 +0100

    diracdec: use correct buffer for slice_params_buf realloc
    
    This fixes a double-free detected by AddressSanitizer.
    
    The problem was introduced in commit
    dcad4677d637cd2f701917e38361fa96b8c9a418.
    
    Reviewed-by: Rostislav Pehlivanov <atomnuker@gmail.com>
    Signed-off-by: Andreas Cadhalpun <Andreas.Cadhalpun@googlemail.com>

diff --git a/libavcodec/diracdec.c b/libavcodec/diracdec.c
index b183fad584..5c669ffdee 100644
--- a/libavcodec/diracdec.c
+++ b/libavcodec/diracdec.c
@@ -907,7 +907,7 @@ static int decode_lowdelay(DiracContext *s)
     int slice_num = 0;
 
     if (s->slice_params_num_buf != (s->num_x * s->num_y)) {
-        s->slice_params_buf = av_realloc_f(s->thread_buf, s->num_x * s->num_y, sizeof(DiracSlice));
+        s->slice_params_buf = av_realloc_f(s->slice_params_buf, s->num_x * s->num_y, sizeof(DiracSlice));
         if (!s->slice_params_buf) {
             av_log(s->avctx, AV_LOG_ERROR, "slice params buffer allocation failure\n");
             return AVERROR(ENOMEM);

