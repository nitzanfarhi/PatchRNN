commit ab0997e0afdcb272fd04784a280b2df46b0c759f
Author: Frediano Ziglio <freddy77@gmail.com>
Date:   Tue Aug 23 15:21:20 2011 +0200

    qcow2: remove memory leak
    
    Signed-off-by: Frediano Ziglio <freddy77@gmail.com>
    Signed-off-by: Kevin Wolf <kwolf@redhat.com>

diff --git a/block/qcow2.c b/block/qcow2.c
index 37dab656ab..b725d68b1d 100644
--- a/block/qcow2.c
+++ b/block/qcow2.c
@@ -496,6 +496,7 @@ fail:
     qemu_co_mutex_unlock(&s->lock);
 
     qemu_iovec_destroy(&hd_qiov);
+    g_free(cluster_data);
 
     return ret;
 }
@@ -608,6 +609,7 @@ fail:
     qemu_co_mutex_unlock(&s->lock);
 
     qemu_iovec_destroy(&hd_qiov);
+    g_free(cluster_data);
 
     return ret;
 }

