commit fc31e3406dbbdae7f5ffd65c2f190e2d97f6e319
Author: cloder <cloder>
Date:   Wed Oct 1 05:52:45 2003 +0000

    Correct some off-by-ones.  They currently don't matter, but this
    is for future safety and consistency.
    OK krw@, markus@

diff --git a/src/ssl/ssl_ciph.c b/src/ssl/ssl_ciph.c
index 438d9eac..532fb4e8 100644
--- a/src/ssl/ssl_ciph.c
+++ b/src/ssl/ssl_ciph.c
@@ -73,7 +73,7 @@
 #define SSL_ENC_NUM_IDX		9
 
 static const EVP_CIPHER *ssl_cipher_methods[SSL_ENC_NUM_IDX]={
-	NULL,NULL,NULL,NULL,NULL,NULL,
+	NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL
 	};
 
 static STACK_OF(SSL_COMP) *ssl_comp_methods=NULL;
@@ -251,7 +251,7 @@ int ssl_cipher_get_evp(SSL_SESSION *s, const EVP_CIPHER **enc,
 		break;
 		}
 
-	if ((i < 0) || (i > SSL_ENC_NUM_IDX))
+	if ((i < 0) || (i >= SSL_ENC_NUM_IDX))
 		*enc=NULL;
 	else
 		{
@@ -273,7 +273,7 @@ int ssl_cipher_get_evp(SSL_SESSION *s, const EVP_CIPHER **enc,
 		i= -1;
 		break;
 		}
-	if ((i < 0) || (i > SSL_MD_NUM_IDX))
+	if ((i < 0) || (i >= SSL_MD_NUM_IDX))
 		*md=NULL;
 	else
 		*md=ssl_digest_methods[i];

