commit c968ca0f8528b86bc7c5526246dc7f1f0caf7523
Author: Gerardo Iglesias Galvan <iglesiasg@gmail.com>
Date:   Tue May 31 20:22:22 2011 -0500

    Fix potential small issue with ftell and fseek

diff --git a/src/util-threshold-config.c b/src/util-threshold-config.c
index 39be1b0f..a4c1d5c6 100644
--- a/src/util-threshold-config.c
+++ b/src/util-threshold-config.c
@@ -606,13 +606,16 @@ int SCThresholdConfLineIsMultiline(char *line)
  * \retval int of the line length
  */
 int SCThresholdConfLineLength(FILE *fd) {
-    int pos = ftell(fd);
+    long pos = ftell(fd);
     int len = 0;
     char c;
 
     while ( (c = fgetc(fd)) && c != '\n' && !feof(fd))
         len++;
 
+    if (pos < 0)
+        pos = 0;
+
     fseek(fd, pos, SEEK_SET);
     return len;
 }

