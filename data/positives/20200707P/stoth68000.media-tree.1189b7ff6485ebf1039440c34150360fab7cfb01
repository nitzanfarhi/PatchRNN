commit 1189b7ff6485ebf1039440c34150360fab7cfb01
Author: Tomi Valkeinen <tomi.valkeinen@nokia.com>
Date:   Mon Mar 1 13:52:10 2010 +0200

    OMAP: DSS2: Taal: Fix ESD check
    
    Using taal_enable_te() when DSI bus was locked caused a deadlock.
    
    Signed-off-by: Tomi Valkeinen <tomi.valkeinen@nokia.com>

diff --git a/drivers/video/omap2/displays/panel-taal.c b/drivers/video/omap2/displays/panel-taal.c
index a722733106b1..2b5777621779 100644
--- a/drivers/video/omap2/displays/panel-taal.c
+++ b/drivers/video/omap2/displays/panel-taal.c
@@ -1055,8 +1055,11 @@ static void taal_esd_work(struct work_struct *work)
 	}
 	/* Self-diagnostics result is also shown on TE GPIO line. We need
 	 * to re-enable TE after self diagnostics */
-	if (td->use_ext_te && td->te_enabled)
-		taal_enable_te(dssdev, true);
+	if (td->use_ext_te && td->te_enabled) {
+		r = taal_dcs_write_1(DCS_TEAR_ON, 0);
+		if (r)
+			goto err;
+	}
 
 	dsi_bus_unlock();
 

