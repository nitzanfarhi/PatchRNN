commit 88b968f658bf9b3688d7e684274dcf90a6bb22ab
Author: hshoexer <hshoexer@openbsd.org>
Date:   Wed Mar 10 16:10:57 2004 +0000

    Plug up memory leak.
    
    ok ho@

diff --git a/sbin/isakmpd/message.c b/sbin/isakmpd/message.c
index 5925d2f7cd0..1d814a5467b 100644
--- a/sbin/isakmpd/message.c
+++ b/sbin/isakmpd/message.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: message.c,v 1.67 2004/03/10 11:17:38 hshoexer Exp $	*/
+/*	$OpenBSD: message.c,v 1.68 2004/03/10 16:10:57 hshoexer Exp $	*/
 /*	$EOM: message.c,v 1.156 2000/10/10 12:36:39 provos Exp $	*/
 
 /*
@@ -1719,6 +1719,9 @@ message_drop (struct message *msg, int notify, struct proto *proto,
              address ? address : "<unknown>", htons (port),
 	     constant_name (isakmp_notify_cst, notify));
 
+  if (address)
+    free (address);
+
   /* If specified, return a notification.  */
   if (notify)
     message_send_notification (msg, msg->isakmp_sa, notify, proto, incoming);

