commit c4dff38dff6e6c79236367809c576cb845d865d8
Author: alobbs <alvaro@alobbs.com>
Date:   Sun May 22 21:59:46 2011 +0000

    "Buffer overflow of 'interpreter' due to non null terminated string
    'interpreter'" (klocwork.com Issue #68)
    
    git-svn-id: svn://cherokee-project.com/cherokee/trunk@6688 5dc97367-97f1-0310-9951-d761b3857238

diff --git a/cherokee/main.c b/cherokee/main.c
index 4203e7ac..0f414795 100644
--- a/cherokee/main.c
+++ b/cherokee/main.c
@@ -437,8 +437,8 @@ do_spawn (void)
 	}
 
 	interpreter = malloc (sizeof("exec ") + size);
-	memcpy (interpreter, "exec ", 5);
-	memcpy (interpreter + 5, p, size + 1);
+	strncpy (interpreter, "exec ", 5);
+	strncpy (interpreter + 5, p, size + 1);
 	p += size + 1;
 	ALIGN4 (p);
 

