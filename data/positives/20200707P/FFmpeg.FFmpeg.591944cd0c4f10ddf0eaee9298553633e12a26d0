commit 591944cd0c4f10ddf0eaee9298553633e12a26d0
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Wed May 28 20:30:42 2008 +0000

    Do a little more checking.
    
    Originally committed as revision 13502 to svn://svn.ffmpeg.org/ffmpeg/trunk

diff --git a/libavformat/tiertexseq.c b/libavformat/tiertexseq.c
index bcce6749ea..60ac5ecd7e 100644
--- a/libavformat/tiertexseq.c
+++ b/libavformat/tiertexseq.c
@@ -110,7 +110,7 @@ static int seq_fill_buffer(SeqDemuxContext *seq, ByteIOContext *pb, int buffer_n
         return AVERROR_INVALIDDATA;
 
     seq_buffer = &seq->frame_buffers[buffer_num];
-    if (seq_buffer->fill_size + data_size > seq_buffer->data_size)
+    if (seq_buffer->fill_size + data_size > seq_buffer->data_size || data_size <= 0)
         return AVERROR_INVALIDDATA;
 
     url_fseek(pb, seq->current_frame_offs + data_offs, SEEK_SET);

