commit 0e8b38094179488c96c150246bb912b28dde3fcd
Author: Andrey Hristov <andrey@php.net>
Date:   Wed May 26 13:47:43 2010 +0000

    Don't use conn->net without checking if it is NULL, because
    it can be NULL in OOM conditions. This would cause a crash.

diff --git a/ext/mysqlnd/mysqlnd.c b/ext/mysqlnd/mysqlnd.c
index 37b7c1bf42..567570a3ab 100644
--- a/ext/mysqlnd/mysqlnd.c
+++ b/ext/mysqlnd/mysqlnd.c
@@ -125,7 +125,9 @@ MYSQLND_METHOD(mysqlnd_conn, free_contents)(MYSQLND * conn TSRMLS_DC)
 		conn->current_result = NULL;
 	}
 
-	conn->net->m.free_contents(conn->net TSRMLS_CC);
+	if (conn->net) {
+		conn->net->m.free_contents(conn->net TSRMLS_CC);
+	}
 
 	DBG_INF("Freeing memory of members");
 

