commit d1a409268d45642fa78a7143ff41a75507e52693
Author: pancake <pancake@nopcode.org>
Date:   Fri Apr 22 23:47:22 2016 +0200

    Fix #4686 - Segfault in ELF parser

diff --git a/libr/bin/format/elf/elf.c b/libr/bin/format/elf/elf.c
index 781019ff0..953d014ab 100644
--- a/libr/bin/format/elf/elf.c
+++ b/libr/bin/format/elf/elf.c
@@ -700,6 +700,10 @@ static Sdb *store_versioninfo_gnu_verneed(struct Elf_(r_bin_elf_obj_t) *bin, Elf
 			snprintf (key, sizeof (key), "vernaux%d", j);
 			sdb_ns_set (sdb_version, key, sdb_vernaux);
 		}
+		if ((int)entry->vn_next < 0) {
+			eprintf ("Invalid vn_next\n");
+			break;
+		}
 		i += entry->vn_next;
 		snprintf (key, sizeof (key), "version%d", cnt );
 		sdb_ns_set (sdb, key, sdb_version);

