commit 8367b0ef12dd10f85b102d0c55be84d653c07989
Author: jsg <jsg@openbsd.org>
Date:   Sun Apr 15 03:25:27 2012 +0000

    fix a leak
    ok krw@

diff --git a/usr.sbin/sasyncd/net.c b/usr.sbin/sasyncd/net.c
index dbaf369f0ff..911b7cd1e3d 100644
--- a/usr.sbin/sasyncd/net.c
+++ b/usr.sbin/sasyncd/net.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: net.c,v 1.18 2012/04/14 12:10:04 haesbaert Exp $	*/
+/*	$OpenBSD: net.c,v 1.19 2012/04/15 03:25:27 jsg Exp $	*/
 
 /*
  * Copyright (c) 2005 Håkan Olsson.  All rights reserved.
@@ -746,6 +746,7 @@ net_read(struct syncpeer *p, u_int32_t *msgtype, u_int32_t *msglen)
 
 	if (memcmp(hash, rhash, sizeof hash) != 0) {
 		free(blob);
+		free(msg);
 		log_msg(0, "net_read: got bad message (typo in shared key?)");
 		return NULL;
 	}

