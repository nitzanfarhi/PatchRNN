commit 79c5bb9896ba5c8d9a6ff6dd9ef2d6d1d178ea43
Author: Rainer Gerhards <rgerhards@adiscon.com>
Date:   Thu Jan 18 11:34:12 2018 +0100

    core bugfix: small memory leak in external command parser
    
    This parser is used whenever a module (e.g. omprog) needs to process
    command lines. On each action definitions for actions that use the
    parser a small amount of memory was leakd. It is an uncritical leak
    as it only occurs during config parsing. So it leaks a couple of
    KiB during startup but does not grow during actual message processing.
    
    This is a regression in 8.32.0.

diff --git a/runtime/srutils.c b/runtime/srutils.c
index 83195eaa9..e0898e84f 100644
--- a/runtime/srutils.c
+++ b/runtime/srutils.c
@@ -838,5 +838,11 @@ split_binary_parameters(uchar **const szBinary, char ***const __restrict__ aPara
 	(*aParams)[iPrm] = NULL; /* NULL per argv[] convention */
 
 finalize_it:
+	if(estrBinary != param_binary) {
+		es_deleteStr(estrBinary);
+	}
+	if(estrParams != NULL) {
+		es_deleteStr(estrParams);
+	}
 	RETiRet;
 }

