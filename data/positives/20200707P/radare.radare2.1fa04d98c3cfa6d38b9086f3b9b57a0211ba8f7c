commit 1fa04d98c3cfa6d38b9086f3b9b57a0211ba8f7c
Author: pancake <pancake@nopcode.org>
Date:   Wed Aug 3 14:07:03 2016 +0200

    Fix for crypto.cps2

diff --git a/libr/crypto/p/crypto_cps2.c b/libr/crypto/p/crypto_cps2.c
index 6d1ed2f16..c95fbec69 100644
--- a/libr/crypto/p/crypto_cps2.c
+++ b/libr/crypto/p/crypto_cps2.c
@@ -722,7 +722,10 @@ static bool cps2_use(const char *algo) {
 
 static int update(RCrypto *cry, const ut8 *buf, int len) {
 	ut8 *output = calloc (1, len);
+	/* TODO : control decryption errors */
 	cps2_decrypt ((const ut16 *)buf, (ut16*)output, len, cps2key, UPPER_LIMIT);
+	r_crypto_append (cry, output, len);
+	free (output);
 	return true;
 }
 

