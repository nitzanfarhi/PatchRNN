commit 628c2bbb1995adcbbb51e6200a9e6be433570bf6
Author: Kevin Lin <klin@sourcefire.com>
Date:   Mon Aug 17 17:44:10 2015 -0400

    cid 12188 - fix error state for parsing yara hex strings

diff --git a/libclamav/readdb.c b/libclamav/readdb.c
index bbaf20579..c521ca1f7 100644
--- a/libclamav/readdb.c
+++ b/libclamav/readdb.c
@@ -3077,6 +3077,7 @@ static char *parse_yara_hex_string(YR_STRING *string, int *ret)
         if ((ovr = strchr(ovr, '}')))
             *ovr = ']';
         else {
+            free(res);
             if (ret) *ret = CL_EMALFDB;
             return NULL;
         }
@@ -3087,6 +3088,7 @@ static char *parse_yara_hex_string(YR_STRING *string, int *ret)
         if ((ovr = strrchr(res, '{')))
             *ovr = '[';
         else {
+            free(res);
             if (ret) *ret = CL_EMALFDB;
             return NULL;
         }

