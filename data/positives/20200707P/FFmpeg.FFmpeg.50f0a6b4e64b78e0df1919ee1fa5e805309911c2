commit 50f0a6b4e64b78e0df1919ee1fa5e805309911c2
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Wed Nov 14 21:14:40 2012 +0100

    wmaprodec: check num_sfb for validity. Fix out of array accesses
    
    Found-by: Mateusz "j00ru" Jurczyk and Gynvael Coldwind
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavcodec/wmaprodec.c b/libavcodec/wmaprodec.c
index e071eb1f95..c5cc46b5ce 100644
--- a/libavcodec/wmaprodec.c
+++ b/libavcodec/wmaprodec.c
@@ -412,6 +412,10 @@ static av_cold int decode_init(AVCodecContext *avctx)
         }
         s->sfb_offsets[i][band - 1] = subframe_len;
         s->num_sfb[i]               = band - 1;
+        if (s->num_sfb[i] <= 0) {
+            av_log(avctx, AV_LOG_ERROR, "num_sfb invalid\n");
+            return AVERROR_INVALIDDATA;
+        }
     }
 
 

