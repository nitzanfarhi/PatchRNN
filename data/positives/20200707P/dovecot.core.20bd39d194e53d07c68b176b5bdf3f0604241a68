commit 20bd39d194e53d07c68b176b5bdf3f0604241a68
Author: Timo Sirainen <tss@iki.fi>
Date:   Wed Apr 25 02:48:36 2012 +0300

    lib-ssl-iostream: Fixed a memory leak when verifying certificate name.
    This mainly mattered when proxying with SSL to remote server.

diff --git a/src/lib-ssl-iostream/iostream-openssl.c b/src/lib-ssl-iostream/iostream-openssl.c
index 662c7ec9f..7f09c2c29 100644
--- a/src/lib-ssl-iostream/iostream-openssl.c
+++ b/src/lib-ssl-iostream/iostream-openssl.c
@@ -517,6 +517,8 @@ int openssl_cert_match_name(SSL *ssl, const char *verify_name)
 		}
 	}
 	sk_GENERAL_NAME_pop_free(gnames, GENERAL_NAME_free);
+	X509_free(cert);
+
 	/* verify against CommonName only when there wasn't any DNS
 	   SubjectAltNames */
 	if (dns_names)

