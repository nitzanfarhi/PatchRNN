commit 484b04170d8f48fc42b71e14c9168067a1374dcc
Author: Bron Gondwana <brong@opera.com>
Date:   Mon Feb 18 15:54:21 2013 +1100

    message: don't leak msgids

diff --git a/imap/message.c b/imap/message.c
index fdbc74e3c..6b5024169 100644
--- a/imap/message.c
+++ b/imap/message.c
@@ -3123,10 +3123,12 @@ EXPORTED int message_update_conversations(struct conversations_state *state,
 	    msgid = lcase(msgid);
 
 	    /* already seen this one? */
-	    if (strarray_find(&msgidlist, msgid, 0) >= 0)
+	    if (strarray_find(&msgidlist, msgid, 0) >= 0) {
+		free(msgid);
 		continue;
+	    }
 
-	    strarray_append(&msgidlist, msgid);
+	    strarray_appendm(&msgidlist, msgid);
 
 	    /* Lookup the conversations database to work out which
 	     * conversation ids that message belongs to. */

