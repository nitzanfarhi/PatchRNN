commit df6ba947752d58a519afcb9f5846b9e9f47c892a
Author: Graham Percival <gperciva@tarsnap.com>
Date:   Mon Sep 7 14:31:49 2015 -0700

    Check for strdup() allocation failure
    
    Sponsored by:   Tarsnap Backup Inc.

diff --git a/libarchive/archive_entry_xattr.c b/libarchive/archive_entry_xattr.c
index a3efe7ca..05eb90f1 100644
--- a/libarchive/archive_entry_xattr.c
+++ b/libarchive/archive_entry_xattr.c
@@ -98,7 +98,10 @@ archive_entry_xattr_add_entry(struct archive_entry *entry,
 		/* XXX Error XXX */
 		return;
 
-	xp->name = strdup(name);
+	if ((xp->name = strdup(name)) == NULL)
+		/* XXX Error XXX */
+		return;
+
 	if ((xp->value = malloc(size)) != NULL) {
 		memcpy(xp->value, value, size);
 		xp->size = size;

