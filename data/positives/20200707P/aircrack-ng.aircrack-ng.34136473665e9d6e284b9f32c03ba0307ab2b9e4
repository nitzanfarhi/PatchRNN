commit 34136473665e9d6e284b9f32c03ba0307ab2b9e4
Author: Thomas d'Otreppe <tdotreppe@aircrack-ng.org>
Date:   Sat Jul 4 22:41:25 2015 +0000

    osdep: Fix possible infinite loop (Closes: #1582).
    
    git-svn-id: http://svn.aircrack-ng.org/trunk@2582 28c6078b-6c39-48e3-add9-af49d547ecab

diff --git a/src/osdep/network.c b/src/osdep/network.c
index 61610ff1..fd8f26dd 100644
--- a/src/osdep/network.c
+++ b/src/osdep/network.c
@@ -211,6 +211,8 @@ static int net_get_nopacket(struct priv_net *pn, void *arg, int *len)
 	while (1) {
 		l = sizeof(buf);
 		c = net_get(pn->pn_s, buf, &l);
+		if (c < 0)
+			return c;
 
 		if (c != NET_PACKET && c > 0)
 			break;

