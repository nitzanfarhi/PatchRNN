commit 9321db8c2991a4e96f705b1e290d361021c0c229
Author: Nick Mathewson <nickm@torproject.org>
Date:   Mon Aug 22 00:34:23 2005 +0000

    Fix bug with tor_memmem finding a match at the end of the string.
    
    
    svn:r4803

diff --git a/src/common/compat.c b/src/common/compat.c
index abe671471..b3c1b1723 100644
--- a/src/common/compat.c
+++ b/src/common/compat.c
@@ -161,7 +161,7 @@ tor_memmem(const void *_haystack, size_t hlen, const void *_needle, size_t nlen)
   end = haystack + hlen;
   first = *(const char*)needle;
   while ((p = memchr(p, first, end-p))) {
-    if (p+nlen >= end)
+    if (p+nlen > end)
       return NULL;
     if (!memcmp(p, needle, nlen))
       return p;

