commit f7a1c358e51c21b80336413fb824e1a82df648b9
Author: Jan Kara <jack@suse.cz>
Date:   Tue Aug 9 10:07:52 2016 +0200

    ext2: Check return value from ext2_get_group_desc()
    
    ext2_get_group_desc() can return NULL if there is some error. This
    usually means there is some programming error in the ext2 driver itself
    but let's be defensive and handle that case.
    
    Coverity-id: 115628
    Signed-off-by: Jan Kara <jack@suse.cz>

diff --git a/fs/ext2/ialloc.c b/fs/ext2/ialloc.c
index efe5fb21c533..04e73a99902b 100644
--- a/fs/ext2/ialloc.c
+++ b/fs/ext2/ialloc.c
@@ -465,6 +465,11 @@ struct inode *ext2_new_inode(struct inode *dir, umode_t mode,
 
 	for (i = 0; i < sbi->s_groups_count; i++) {
 		gdp = ext2_get_group_desc(sb, group, &bh2);
+		if (!gdp) {
+			if (++group == sbi->s_groups_count)
+				group = 0;
+			continue;
+		}
 		brelse(bitmap_bh);
 		bitmap_bh = read_inode_bitmap(sb, group);
 		if (!bitmap_bh) {

