commit a025a367b901868188857793079c8a13d5d8ac5f
Author: Nils Ohlmeier <nils@iptel.org>
Date:   Fri Jun 7 15:03:38 2002 +0000

    Fixed access on not checked return of resolvehost in check_address.

diff --git a/msg_translator.c b/msg_translator.c
index d205afe60..63dae3bfb 100644
--- a/msg_translator.c
+++ b/msg_translator.c
@@ -63,7 +63,7 @@ int check_address(struct ip_addr* ip, char *name, int resolver)
 		DBG("check_address: doing dns lookup\n");
 		/* try all names ips */
 		he=resolvehost(name);
-		if (ip->af==he->h_addrtype){
+		if (he && ip->af==he->h_addrtype){
 			for(i=0;he && he->h_addr_list[i];i++){
 				if ( memcmp(&he->h_addr_list[i], ip->u.addr, ip->len)==0)
 					return 0;

