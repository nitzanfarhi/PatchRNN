commit 4cfa4ae820c24462c916a43d36d5daaeaf85345e
Author: Richard Levitte <levitte@openssl.org>
Date:   Mon Mar 1 14:58:22 2004 +0000

    Avoid a memory leak in OCSP_parse_url().
    Notified by Paul Siegel <psiegel@corestreet.com>

diff --git a/crypto/ocsp/ocsp_lib.c b/crypto/ocsp/ocsp_lib.c
index 3875af165c..9e87fc7895 100644
--- a/crypto/ocsp/ocsp_lib.c
+++ b/crypto/ocsp/ocsp_lib.c
@@ -253,6 +253,7 @@ int OCSP_parse_url(char *url, char **phost, char **pport, char **ppath, int *pss
 
 
 	err:
+	if (buf) OPENSSL_free(buf);
 	if (*ppath) OPENSSL_free(*ppath);
 	if (*pport) OPENSSL_free(*pport);
 	if (*phost) OPENSSL_free(*phost);

