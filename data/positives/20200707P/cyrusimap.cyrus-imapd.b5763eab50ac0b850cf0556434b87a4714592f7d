commit b5763eab50ac0b850cf0556434b87a4714592f7d
Author: Greg Banks <gnb@fastmail.fm>
Date:   Mon Feb 18 15:55:53 2013 +1100

    quotalegacy: don't pass NULL to qsort
    
    just in case qsort() stupidly de-references 'base' when 'nmemb'=0.
    Whatever.  Coverity CID 981652.

diff --git a/lib/cyrusdb_quotalegacy.c b/lib/cyrusdb_quotalegacy.c
index 481500fb0..3b44ea1ad 100644
--- a/lib/cyrusdb_quotalegacy.c
+++ b/lib/cyrusdb_quotalegacy.c
@@ -634,7 +634,8 @@ static int foreach(struct dbengine *db,
     if (tid && !*tid) *tid = &db->txn;
 
     /* sort the quotaroots (ignoring paths) */
-    qsort(pathbuf.data, pathbuf.count, sizeof(char *), db->compar);
+    if (pathbuf.data)
+	qsort(pathbuf.data, pathbuf.count, sizeof(char *), db->compar);
 
     for (i = 0; i < pathbuf.count; i++) {
 	const char *data, *key;

