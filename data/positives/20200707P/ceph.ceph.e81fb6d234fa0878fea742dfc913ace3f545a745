commit e81fb6d234fa0878fea742dfc913ace3f545a745
Author: Sage Weil <sage@newdream.net>
Date:   Tue Nov 25 12:21:20 2008 -0800

    osd: fix rare memory leak

diff --git a/src/osd/ReplicatedPG.cc b/src/osd/ReplicatedPG.cc
index 5d5da02340..4c217d66a7 100644
--- a/src/osd/ReplicatedPG.cc
+++ b/src/osd/ReplicatedPG.cc
@@ -1730,8 +1730,9 @@ void ReplicatedPG::sub_op_modify_ondisk(MOSDSubOp *op, int ackerosd, eversion_t
     commit->set_pg_complete_thru(last_complete);
     commit->set_peer_stat(osd->get_my_stat_for(g_clock.now(), ackerosd));
     osd->messenger->send_message(commit, osd->osdmap->get_inst(ackerosd));
-    delete op;
   }
+  
+  delete op;
 }
 
 void ReplicatedPG::sub_op_modify_reply(MOSDSubOpReply *r)

