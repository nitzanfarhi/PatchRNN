commit 7b358f0652dc09069ee19c4cda52fb20a1fa582a
Author: Emmanuel Grumbach <emmanuel.grumbach@intel.com>
Date:   Thu Oct 23 14:42:33 2014 +0300

    iwlwifi: mvm: initialize the cur_ucode upon boot
    
    mvm->cur_ucode wasn't set before we actually load the
    firmware. This caused issues when we boot in RFKILL since
    we get an RFKILL interrupt upon boot even before we load
    any firmware.
    This leads to issues since iwl_mvm_set_hw_rfkill_state
    (the RFKILL interrupts handler in mvm) relies on this
    variable.
    
    Fix this.
    
    Signed-off-by: Emmanuel Grumbach <emmanuel.grumbach@intel.com>

diff --git a/drivers/net/wireless/iwlwifi/mvm/ops.c b/drivers/net/wireless/iwlwifi/mvm/ops.c
index 48cb25a93591..27fb0a1ef274 100644
--- a/drivers/net/wireless/iwlwifi/mvm/ops.c
+++ b/drivers/net/wireless/iwlwifi/mvm/ops.c
@@ -424,6 +424,7 @@ iwl_op_mode_mvm_start(struct iwl_trans *trans, const struct iwl_cfg *cfg,
 	}
 	mvm->sf_state = SF_UNINIT;
 	mvm->low_latency_agg_frame_limit = 6;
+	mvm->cur_ucode = IWL_UCODE_INIT;
 
 	mutex_init(&mvm->mutex);
 	mutex_init(&mvm->d0i3_suspend_mutex);

