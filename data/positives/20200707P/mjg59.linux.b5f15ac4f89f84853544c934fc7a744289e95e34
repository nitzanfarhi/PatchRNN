commit b5f15ac4f89f84853544c934fc7a744289e95e34
Author: Vasiliy Kulikov <segooon@gmail.com>
Date:   Wed Nov 3 08:45:06 2010 +0100

    ipv4: netfilter: ip_tables: fix information leak to userland
    
    Structure ipt_getinfo is copied to userland with the field "name"
    that has the last elements unitialized.  It leads to leaking of
    contents of kernel stack memory.
    
    Signed-off-by: Vasiliy Kulikov <segooon@gmail.com>
    Signed-off-by: Patrick McHardy <kaber@trash.net>

diff --git a/net/ipv4/netfilter/ip_tables.c b/net/ipv4/netfilter/ip_tables.c
index d31b007a6d80..a846d633b3b6 100644
--- a/net/ipv4/netfilter/ip_tables.c
+++ b/net/ipv4/netfilter/ip_tables.c
@@ -1124,6 +1124,7 @@ static int get_info(struct net *net, void __user *user,
 			private = &tmp;
 		}
 #endif
+		memset(&info, 0, sizeof(info));
 		info.valid_hooks = t->valid_hooks;
 		memcpy(info.hook_entry, private->hook_entry,
 		       sizeof(info.hook_entry));

