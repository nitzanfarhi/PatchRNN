commit bcc44873d949bd817fa19fad368604cf73ccee78
Author: Martin Storsjö <martin@martin.st>
Date:   Thu Aug 30 23:10:07 2012 +0300

    pktdumper: Use av_strlcpy instead of strncpy
    
    This takes care of null-terminating the buffer if it is too small,
    which wasn't handled properly before.
    
    Signed-off-by: Martin Storsjö <martin@martin.st>

diff --git a/tools/pktdumper.c b/tools/pktdumper.c
index fffeeeb70..f21a8e01e 100644
--- a/tools/pktdumper.c
+++ b/tools/pktdumper.c
@@ -31,6 +31,7 @@
 #include <io.h>
 #endif
 
+#include "libavutil/avstring.h"
 #include "libavutil/time.h"
 #include "libavformat/avformat.h"
 
@@ -70,9 +71,9 @@ int main(int argc, char **argv)
         return usage(1);
     if (argc > 2)
         maxpkts = atoi(argv[2]);
-    strncpy(fntemplate, argv[1], sizeof(fntemplate) - 1);
+    av_strlcpy(fntemplate, argv[1], sizeof(fntemplate));
     if (strrchr(argv[1], '/'))
-        strncpy(fntemplate, strrchr(argv[1], '/') + 1, sizeof(fntemplate) - 1);
+        av_strlcpy(fntemplate, strrchr(argv[1], '/') + 1, sizeof(fntemplate));
     if (strrchr(fntemplate, '.'))
         *strrchr(fntemplate, '.') = '\0';
     if (strchr(fntemplate, '%')) {

