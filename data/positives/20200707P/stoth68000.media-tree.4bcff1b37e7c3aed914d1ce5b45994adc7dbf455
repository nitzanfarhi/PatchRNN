commit 4bcff1b37e7c3aed914d1ce5b45994adc7dbf455
Author: David Woodhouse <dwmw2@shinybook.infradead.org>
Date:   Thu Jun 2 12:13:21 2005 +0100

    AUDIT: Fix user pointer deref thinko in sys_socketcall().
    
    I cunningly put the audit call immediately after the
    copy_from_user().... but used the _userspace_ copy of the args still.
    Let's not do that.
    
    Signed-off-by: David Woodhouse <dwmw2@infradead.org>

diff --git a/net/socket.c b/net/socket.c
index 6b7c3b51a7c1..38729af09461 100644
--- a/net/socket.c
+++ b/net/socket.c
@@ -1908,7 +1908,7 @@ asmlinkage long sys_socketcall(int call, unsigned long __user *args)
 	if (copy_from_user(a, args, nargs[call]))
 		return -EFAULT;
 
-	err = audit_socketcall(nargs[call]/sizeof(unsigned long), args);
+	err = audit_socketcall(nargs[call]/sizeof(unsigned long), a);
 	if (err)
 		return err;
 

