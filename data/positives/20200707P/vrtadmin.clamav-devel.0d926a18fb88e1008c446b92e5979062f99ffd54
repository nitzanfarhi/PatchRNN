commit 0d926a18fb88e1008c446b92e5979062f99ffd54
Author: Tomasz Kojm <tkojm@clamav.net>
Date:   Fri Mar 5 21:35:44 2010 +0100

    fix previous commit

diff --git a/libclamav/matcher-bm.c b/libclamav/matcher-bm.c
index 4faa4492b..a4ae60adb 100644
--- a/libclamav/matcher-bm.c
+++ b/libclamav/matcher-bm.c
@@ -269,6 +269,8 @@ int cli_bm_scanbuff(const unsigned char *buffer, uint32_t length, const char **v
     memset(&info, 0, sizeof(info));
     i = BM_MIN_LENGTH - BM_BLOCK_SIZE;
     if(offdata) {
+	if(!offdata->cnt)
+	    return CL_CLEAN;
 	for(; offdata->pos && offdata->offtab[offdata->pos] > offset; offdata->pos--);
 	if(offdata->offtab[offdata->pos] < offset)
 	    offdata->pos++;

