commit b470fcb998536e2fb620f24cc462c8342bb4baf4
Author: Micah Snyder <micasnyd@cisco.com>
Date:   Tue Oct 10 21:50:48 2017 -0400

    fixing small memory leak.

diff --git a/libclamav/libmspack-0.5alpha/mspack/cabd.c b/libclamav/libmspack-0.5alpha/mspack/cabd.c
index a549c0acf..5e9636ac4 100644
--- a/libclamav/libmspack-0.5alpha/mspack/cabd.c
+++ b/libclamav/libmspack-0.5alpha/mspack/cabd.c
@@ -524,6 +524,10 @@ static int cabd_read_headers(struct mspack_system *sys,
     }
     else {
         /* ignore invalid file and continue parsing */
+        if (file->filename) {
+          sys->free(file->filename);
+          file->filename = NULL;
+        }
         sys->free(file);
         sys->message(fh, "WARNING; omitting file %d of %d from file list", i, num_files);
     }

