commit 50122084a6b3be06781a2b3d8ec036f2d67c32e3
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Mon May 28 17:17:49 2012 +0200

    motionpixels: check extradata size
    
    Fixes null ptr derefernce
    Fixes Ticket1363
    
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavcodec/motionpixels.c b/libavcodec/motionpixels.c
index 0ff8f3a54f..fc8d440973 100644
--- a/libavcodec/motionpixels.c
+++ b/libavcodec/motionpixels.c
@@ -55,6 +55,11 @@ static av_cold int mp_decode_init(AVCodecContext *avctx)
     int w4 = (avctx->width  + 3) & ~3;
     int h4 = (avctx->height + 3) & ~3;
 
+    if(avctx->extradata_size < 2){
+        av_log(avctx, AV_LOG_ERROR, "extradata too small\n");
+        return AVERROR_INVALIDDATA;
+    }
+
     motionpixels_tableinit();
     mp->avctx = avctx;
     ff_dsputil_init(&mp->dsp, avctx);

