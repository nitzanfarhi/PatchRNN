commit b7304f16b85fad07656c304c0a9aa9637f34a598
Author: Armin Novak <armin.novak@gmail.com>
Date:   Sun Nov 16 15:47:57 2014 +0100

    Fixed memory leak.

diff --git a/winpr/libwinpr/utils/wlog/wlog.c b/winpr/libwinpr/utils/wlog/wlog.c
index 34dc579a0..ca7d52be1 100644
--- a/winpr/libwinpr/utils/wlog/wlog.c
+++ b/winpr/libwinpr/utils/wlog/wlog.c
@@ -402,14 +402,20 @@ int WLog_ParseFilters()
 	g_Filters = calloc(g_FilterCount, sizeof(wLogFilter));
 
 	if (!g_Filters)
+	{
+		free(strs);
 		return -1;
+	}
 
 	for (count = 0; count < g_FilterCount; count++)
 	{
 		status = WLog_ParseFilter(&g_Filters[count], strs[count]);
 
 		if (status < 0)
+		{
+			free(strs);
 			return -1;
+		}
 	}
 
 	free(strs);

