commit 8b6e0aec9fb07b0d1286e3ff5d858e22d09dc83c
Author: Martin Storsj√∂ <martin@martin.st>
Date:   Tue Jul 20 05:23:28 2010 +0000

    movenc: Free the buffer returned by url_close_dyn_buffer, regardless of the size
    
    This fixes a leak introduced in rev 23942, since we write padding to the
    buffer unconditionally.
    
    Originally committed as revision 24342 to svn://svn.ffmpeg.org/ffmpeg/trunk

diff --git a/libavformat/movenc.c b/libavformat/movenc.c
index c0efa3a96..aed748b37 100644
--- a/libavformat/movenc.c
+++ b/libavformat/movenc.c
@@ -1630,8 +1630,8 @@ static int mov_write_udta_tag(ByteIOContext *pb, MOVMuxContext *mov,
         put_be32(pb, size+8);
         put_tag(pb, "udta");
         put_buffer(pb, buf, size);
-        av_free(buf);
     }
+    av_free(buf);
 
     return 0;
 }

