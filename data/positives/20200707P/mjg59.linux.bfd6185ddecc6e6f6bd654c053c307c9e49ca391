commit bfd6185ddecc6e6f6bd654c053c307c9e49ca391
Author: Mark Brown <broonie@opensource.wolfsonmicro.com>
Date:   Tue Jun 5 14:29:36 2012 +0100

    regmap: Don't try to map non-existant IRQs
    
    If the driver supplied an empty entry in the array of IRQs then return
    an error rather than trying to do the mapping. This is intended for use
    with handling chip variants and similar situations.
    
    Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com>

diff --git a/drivers/base/regmap/regmap-irq.c b/drivers/base/regmap/regmap-irq.c
index 4fac4b9be88f..b74e14c4dff4 100644
--- a/drivers/base/regmap/regmap-irq.c
+++ b/drivers/base/regmap/regmap-irq.c
@@ -346,6 +346,10 @@ EXPORT_SYMBOL_GPL(regmap_irq_chip_get_base);
  */
 int regmap_irq_get_virq(struct regmap_irq_chip_data *data, int irq)
 {
+	/* Handle holes in the IRQ list */
+	if (!data->chip->irqs[irq].mask)
+		return -EINVAL;
+
 	return irq_create_mapping(data->domain, irq);
 }
 EXPORT_SYMBOL_GPL(regmap_irq_get_virq);

