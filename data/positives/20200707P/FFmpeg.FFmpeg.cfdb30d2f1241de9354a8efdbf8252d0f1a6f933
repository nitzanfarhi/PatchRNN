commit cfdb30d2f1241de9354a8efdbf8252d0f1a6f933
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Sat Aug 2 00:27:23 2014 +0200

    avcodec/dvdsub_parser: never return 0 when the input isnt 0
    
    Fixes a infinite loop
    Fixes Ticket3804
    
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavcodec/dvdsub_parser.c b/libavcodec/dvdsub_parser.c
index e50c3396e4..9a6457e8b4 100644
--- a/libavcodec/dvdsub_parser.c
+++ b/libavcodec/dvdsub_parser.c
@@ -46,7 +46,7 @@ static int dvdsub_parse(AVCodecParserContext *s,
 
     if (pc->packet_index == 0) {
         if (buf_size < 2)
-            return 0;
+            return buf_size;
         pc->packet_len = AV_RB16(buf);
         if (pc->packet_len == 0) /* HD-DVD subpicture packet */
             pc->packet_len = AV_RB32(buf+2);

