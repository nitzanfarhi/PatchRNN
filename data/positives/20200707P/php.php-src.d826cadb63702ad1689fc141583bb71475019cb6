commit d826cadb63702ad1689fc141583bb71475019cb6
Author: Marcus Boerger <helly@php.net>
Date:   Tue Mar 6 01:21:36 2007 +0000

    - Add missing return value check

diff --git a/ext/mbstring/oniguruma/regerror.c b/ext/mbstring/oniguruma/regerror.c
index 560b5e12c5..413b985c35 100644
--- a/ext/mbstring/oniguruma/regerror.c
+++ b/ext/mbstring/oniguruma/regerror.c
@@ -276,6 +276,9 @@ onig_snprintf_with_pattern(buf, bufsize, enc, pat, pat_end, fmt, va_alist)
 
   va_init_list(args, fmt);
   n = vsnprintf(buf, bufsize, fmt, args);
+  if (n < 0 || n >= bufsize) {
+    n = bufsize - 1;
+  }
   va_end(args);
 
   need = (pat_end - pat) * 4 + 4;

