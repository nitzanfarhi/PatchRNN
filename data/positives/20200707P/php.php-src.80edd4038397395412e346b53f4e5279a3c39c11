commit 80edd4038397395412e346b53f4e5279a3c39c11
Author: Remi Collet <remi@php.net>
Date:   Mon Jul 27 16:56:53 2015 +0200

    fix memleak

diff --git a/ext/standard/string.c b/ext/standard/string.c
index 27b9de94b4..a39105e20b 100644
--- a/ext/standard/string.c
+++ b/ext/standard/string.c
@@ -1668,6 +1668,7 @@ PHP_FUNCTION(dirname)
 		ZSTR_LEN(ret) = zend_dirname(ZSTR_VAL(ret), str_len);
 	} else if (levels < 1) {
 		php_error_docref(NULL, E_WARNING, "Invalid argument, levels must be >= 1");
+		zend_string_free(ret);
 		return;
 	} else {
 		/* Some levels up */

