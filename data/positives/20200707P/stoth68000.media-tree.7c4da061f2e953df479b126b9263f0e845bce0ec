commit 7c4da061f2e953df479b126b9263f0e845bce0ec
Author: Vaishali Thakkar <vthakkar1994@gmail.com>
Date:   Tue Feb 10 14:09:40 2015 -0800

    mm/slab_common.c: use kmem_cache_free()
    
    Here, free memory is allocated using kmem_cache_zalloc.  So, use
    kmem_cache_free instead of kfree.
    
    This is done using Coccinelle and semantic patch used
    is as follows:
    
    @@
    expression x,E,c;
    @@
    
     x = \(kmem_cache_alloc\|kmem_cache_zalloc\|kmem_cache_alloc_node\)(c,...)
     ... when != x = E
         when != &x
    ?-kfree(x)
    +kmem_cache_free(c,x)
    
    Signed-off-by: Vaishali Thakkar <vthakkar1994@gmail.com>
    Acked-by: Christoph Lameter <cl@linux.com>
    Cc: Pekka Enberg <penberg@kernel.org>
    Acked-by: David Rientjes <rientjes@google.com>
    Cc: Joonsoo Kim <iamjoonsoo.kim@lge.com>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

diff --git a/mm/slab_common.c b/mm/slab_common.c
index e03dd6f2a272..67f182c10f24 100644
--- a/mm/slab_common.c
+++ b/mm/slab_common.c
@@ -331,7 +331,7 @@ do_kmem_cache_create(char *name, size_t object_size, size_t size, size_t align,
 
 out_free_cache:
 	memcg_free_cache_params(s);
-	kfree(s);
+	kmem_cache_free(kmem_cache, s);
 	goto out;
 }
 

