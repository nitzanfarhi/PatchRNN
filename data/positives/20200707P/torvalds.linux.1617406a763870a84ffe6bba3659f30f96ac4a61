commit 1617406a763870a84ffe6bba3659f30f96ac4a61
Author: Florin Malita <fmalita@gmail.com>
Date:   Wed May 24 21:21:31 2006 -0400

    [PATCH] pcmcia: missing pcmcia_get_socket() result check
    
    The result of pcmcia_get_socket() may be NULL but ds_event() uses it
    without checking.
    
    Coverity CID: 436.
    
    Signed-off-by: Florin Malita <fmalita@gmail.com>
    Signed-off-by: Dominik Brodowski <linux@dominikbrodowski.net>

diff --git a/drivers/pcmcia/ds.c b/drivers/pcmcia/ds.c
index 48d3b3d30c21..74b3124e8247 100644
--- a/drivers/pcmcia/ds.c
+++ b/drivers/pcmcia/ds.c
@@ -1143,6 +1143,12 @@ static int ds_event(struct pcmcia_socket *skt, event_t event, int priority)
 {
 	struct pcmcia_socket *s = pcmcia_get_socket(skt);
 
+	if (!s) {
+		printk(KERN_ERR "PCMCIA obtaining reference to socket %p " \
+			"failed, event 0x%x lost!\n", skt, event);
+		return -ENODEV;
+	}
+
 	ds_dbg(1, "ds_event(0x%06x, %d, 0x%p)\n",
 	       event, priority, skt);
 

