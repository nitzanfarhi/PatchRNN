commit 4539c498b477679f06ffc2881898d51f4777dfe5
Author: Artem Naluzhnyy <Artem.Naluzhnyy@gmail.com>
Date:   Tue Jan 31 13:05:39 2017 +0200

    Fix: fd leak
    
    Reference: Coverity CID #1397903

diff --git a/swoole_async.c b/swoole_async.c
index ef80cb1f..437137c6 100644
--- a/swoole_async.c
+++ b/swoole_async.c
@@ -583,17 +583,20 @@ PHP_FUNCTION(swoole_async_readfile)
     if (fstat(fd, &file_stat) < 0)
     {
         swoole_php_fatal_error(E_WARNING, "fstat failed. Error: %s[%d]", strerror(errno), errno);
+        close(fd);
         RETURN_FALSE;
     }
     if (file_stat.st_size <= 0)
     {
         swoole_php_fatal_error(E_WARNING, "file is empty.");
+        close(fd);
         RETURN_FALSE;
     }
     if (file_stat.st_size > SW_AIO_MAX_FILESIZE)
     {
         swoole_php_fatal_error(E_WARNING, "file_size[size=%ld|max_size=%d] is too big. Please use swoole_async_read.",
                 (long int) file_stat.st_size, SW_AIO_MAX_FILESIZE);
+        close(fd);
         RETURN_FALSE;
     }
 

