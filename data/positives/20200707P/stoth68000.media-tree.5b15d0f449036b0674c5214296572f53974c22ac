commit 5b15d0f449036b0674c5214296572f53974c22ac
Author: John W. Linville <linville@tuxdriver.com>
Date:   Mon Nov 19 10:53:32 2012 -0500

    brcmfmac: check return from kzalloc in brcmf_fweh_process_event
    
    Signed-off-by: John W. Linville <linville@tuxdriver.com>
    Reported-by: Fengguang Wu <fengguang.wu@intel.com>
    Acked-by: Arend van Spriel <arend@broadcom.com>

diff --git a/drivers/net/wireless/brcm80211/brcmfmac/fweh.c b/drivers/net/wireless/brcm80211/brcmfmac/fweh.c
index 1e4188cc1b5a..fa8fc4433417 100644
--- a/drivers/net/wireless/brcm80211/brcmfmac/fweh.c
+++ b/drivers/net/wireless/brcm80211/brcmfmac/fweh.c
@@ -494,6 +494,9 @@ void brcmf_fweh_process_event(struct brcmf_pub *drvr,
 		alloc_flag = GFP_ATOMIC;
 
 	event = kzalloc(sizeof(*event) + datalen, alloc_flag);
+	if (!event)
+		return;
+
 	event->code = code;
 	event->ifidx = *ifidx;
 

