commit 8080337102a223f19abc6579eed377057c62ff7f
Author: cwu <cwu@sourcefire.com>
Date:   Wed Feb 13 11:33:40 2013 -0800

    fix CID# 10540

diff --git a/sigtool/sigtool.c b/sigtool/sigtool.c
index a1aad44b3..a5c267e6c 100644
--- a/sigtool/sigtool.c
+++ b/sigtool/sigtool.c
@@ -411,9 +411,14 @@ static char *sha256file(const char *file, unsigned int *size)
     sha256_final(&ctx, digest);
     sha = (char *) malloc(65);
     if(!sha)
+    {
+        fclose(fh);
 	return NULL;
+    }	
     for(i = 0; i < 32; i++)
 	sprintf(sha + i * 2, "%02x", digest[i]);
+
+    fclose(fh);	
     return sha;
 }
 

