commit c29e87ad55a2be29cc8ac5c0e047512c1f5d34d4
Author: Andreas Cadhalpun <Andreas.Cadhalpun@googlemail.com>
Date:   Wed Jan 6 19:21:49 2016 +0100

    asfdec_o: check for too small size in asf_read_unknown
    
    This fixes infinite loops due to seeking back.
    
    Reviewed-by: Alexandra Hájková <alexandra.khirnova@gmail.com>
    Signed-off-by: Andreas Cadhalpun <Andreas.Cadhalpun@googlemail.com>

diff --git a/libavformat/asfdec_o.c b/libavformat/asfdec_o.c
index ca4a06652e..bc79f1016e 100644
--- a/libavformat/asfdec_o.c
+++ b/libavformat/asfdec_o.c
@@ -190,8 +190,13 @@ static int asf_read_unknown(AVFormatContext *s, const GUIDParseTable *g)
         if ((ret = detect_unknown_subobject(s, asf->unknown_offset,
                                             asf->unknown_size)) < 0)
             return ret;
-    } else
+    } else {
+        if (size < 24) {
+            av_log(s, AV_LOG_ERROR, "Too small size %"PRIu64" (< 24).\n", size);
+            return AVERROR_INVALIDDATA;
+        }
         avio_skip(pb, size - 24);
+    }
 
     return 0;
 }

