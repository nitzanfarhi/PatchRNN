commit e67a41ca43ecdfe13fa3b98735da12c1a4a22846
Author: clslgrnc <clslgrnc@users.noreply.github.com>
Date:   Mon May 7 03:42:01 2018 +0200

    Prevent buffer overflow in cs_regs_access on ud0 (#1122)
    
    By setting instr->Opcode, ud0 is correctly found in insns, and insn->detail is correctly initialized by X86_get_insn_id.

diff --git a/arch/X86/X86Disassembler.c b/arch/X86/X86Disassembler.c
index b6eca366..95ed9784 100644
--- a/arch/X86/X86Disassembler.c
+++ b/arch/X86/X86Disassembler.c
@@ -959,6 +959,7 @@ bool X86_getInstruction(csh ud, const uint8_t *code, size_t code_len,
 			reader(&info, &b1, address);
 			reader(&info, &b2, address + 1);
 			if (b1 == 0x0f && b2 == 0xff) {
+				instr->Opcode = X86_UD0;
 				instr->OpcodePub = X86_INS_UD0;
 				strncpy(instr->assembly, "ud0", 4);
 				if (instr->flat_insn->detail) {

