commit b7b0d8664d0c607c479b4af4781c272de943e6a4
Author: uau <uau@b3059339-0415-0410-9bf9-f77b7e298cf2>
Date:   Sat Feb 10 19:47:22 2007 +0000

    Fix memory leak when changing playback speed
    
    
    git-svn-id: svn://svn.mplayerhq.hu/mplayer/trunk@22198 b3059339-0415-0410-9bf9-f77b7e298cf2

diff --git a/libmpcodecs/dec_audio.c b/libmpcodecs/dec_audio.c
index 335c01831a..adb4d848a6 100644
--- a/libmpcodecs/dec_audio.c
+++ b/libmpcodecs/dec_audio.c
@@ -333,6 +333,8 @@ int init_audio_filters(sh_audio_t *sh_audio,
   if(out_maxsize<8192) out_maxsize=MAX_OUTBURST; // not sure this is ok
 
   sh_audio->a_out_buffer_size=out_maxsize;
+  if (sh_audio->a_out_buffer != sh_audio->a_buffer)
+      free(sh_audio->a_out_buffer);
   sh_audio->a_out_buffer=memalign(16,sh_audio->a_out_buffer_size);
   memset(sh_audio->a_out_buffer,0,sh_audio->a_out_buffer_size);
   sh_audio->a_out_buffer_len=0;

