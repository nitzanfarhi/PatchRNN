commit a7f93084d0ed2c932cf4e7e30baa433719bbe722
Author: Alexander Batischev <eual.jp@gmail.com>
Date:   Wed Jan 4 20:36:38 2017 +0300

    Free custom headers list in remote APIs

diff --git a/src/feedhq_api.cpp b/src/feedhq_api.cpp
index 04f2650..9f14d4e 100644
--- a/src/feedhq_api.cpp
+++ b/src/feedhq_api.cpp
@@ -130,6 +130,7 @@ std::vector<tagged_feedurl> feedhq_api::get_subscribed_urls() {
 	curl_easy_setopt(handle, CURLOPT_URL, (cfg->get_configvalue("feedhq-url") + FEEDHQ_SUBSCRIPTION_LIST).c_str());
 	curl_easy_perform(handle);
 	curl_easy_cleanup(handle);
+	curl_slist_free_all(custom_headers);
 
 	LOG(level::DEBUG, "feedhq_api::get_subscribed_urls: document = %s", result);
 
@@ -238,6 +239,7 @@ std::string feedhq_api::get_new_token() {
 	curl_easy_setopt(handle, CURLOPT_URL, (cfg->get_configvalue("feedhq-url") + FEEDHQ_API_TOKEN_URL).c_str());
 	curl_easy_perform(handle);
 	curl_easy_cleanup(handle);
+	curl_slist_free_all(custom_headers);
 
 	LOG(level::DEBUG, "feedhq_api::get_new_token: token = %s", result);
 
@@ -312,6 +314,7 @@ std::string feedhq_api::post_content(const std::string& url, const std::string&
 	curl_easy_setopt(handle, CURLOPT_URL, url.c_str());
 	curl_easy_perform(handle);
 	curl_easy_cleanup(handle);
+	curl_slist_free_all(custom_headers);
 
 	LOG(level::DEBUG, "feedhq_api::post_content: url = %s postdata = %s result = %s", url, postdata, result);
 
diff --git a/src/oldreader_api.cpp b/src/oldreader_api.cpp
index 689e71e..ddd817a 100644
--- a/src/oldreader_api.cpp
+++ b/src/oldreader_api.cpp
@@ -133,6 +133,7 @@ std::vector<tagged_feedurl> oldreader_api::get_subscribed_urls() {
 	curl_easy_setopt(handle, CURLOPT_URL, OLDREADER_SUBSCRIPTION_LIST);
 	curl_easy_perform(handle);
 	curl_easy_cleanup(handle);
+	curl_slist_free_all(custom_headers);
 
 	LOG(level::DEBUG, "oldreader_api::get_subscribed_urls: document = %s", result);
 
@@ -246,6 +247,7 @@ std::string oldreader_api::get_new_token() {
 	curl_easy_setopt(handle, CURLOPT_URL, OLDREADER_API_TOKEN_URL);
 	curl_easy_perform(handle);
 	curl_easy_cleanup(handle);
+	curl_slist_free_all(custom_headers);
 
 	LOG(level::DEBUG, "oldreader_api::get_new_token: token = %s", result);
 
@@ -320,6 +322,7 @@ std::string oldreader_api::post_content(const std::string& url, const std::strin
 	curl_easy_setopt(handle, CURLOPT_URL, url.c_str());
 	curl_easy_perform(handle);
 	curl_easy_cleanup(handle);
+	curl_slist_free_all(custom_headers);
 
 	LOG(level::DEBUG, "oldreader_api::post_content: url = %s postdata = %s result = %s", url, postdata, result);
 

