commit 8f0bf68d606f5f553442a530f90b38c81a70dde2
Author: joshd <joshd@openbsd.org>
Date:   Sat Jul 27 06:16:28 1996 +0000

    bounds check on argv and gargv

diff --git a/libexec/ftpd/popen.c b/libexec/ftpd/popen.c
index 08ae3d13fb1..eee16837ea0 100644
--- a/libexec/ftpd/popen.c
+++ b/libexec/ftpd/popen.c
@@ -89,7 +89,7 @@ ftpd_popen(program, type)
 		return (NULL);
 
 	/* break up string into pieces */
-	for (argc = 0, cp = program;; cp = NULL)
+	for (argc = 0, cp = program;argc < 100; cp = NULL)
 		if (!(argv[argc++] = strtok(cp, " \t\n")))
 			break;
 
@@ -103,7 +103,7 @@ ftpd_popen(program, type)
 		if (glob(argv[argc], flags, NULL, &gl))
 			gargv[gargc++] = strdup(argv[argc]);
 		else
-			for (pop = gl.gl_pathv; *pop; pop++)
+			for (pop = gl.gl_pathv; *pop && gargc < 1000; pop++)
 				gargv[gargc++] = strdup(*pop);
 		globfree(&gl);
 	}

