commit c1ef21e04d4479a90bc86be2727f823d5f440d46
Author: Greg Banks <gnb@fastmail.fm>
Date:   Fri Mar 22 15:18:54 2013 +1100

    Fix memory leak in SIEVE header ascii-casemap

diff --git a/sieve/tree.c b/sieve/tree.c
index 92783399d..e83326c21 100644
--- a/sieve/tree.c
+++ b/sieve/tree.c
@@ -140,9 +140,9 @@ void free_test(test_t *t)
 	break;
 
     case HEADER:
+	free(t->u.h.comparator);
 	strarray_free(t->u.h.sl);
 	strarray_free(t->u.h.pl);
-	
 	break;
 
     case ADDRESS:
@@ -153,6 +153,7 @@ void free_test(test_t *t)
 	break;
 
     case BODY:
+	free(t->u.b.comparator);
 	strarray_free(t->u.b.content_types);
 	strarray_free(t->u.b.pl);
 	break;

