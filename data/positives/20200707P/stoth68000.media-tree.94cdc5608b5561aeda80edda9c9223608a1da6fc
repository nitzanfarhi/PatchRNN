commit 94cdc5608b5561aeda80edda9c9223608a1da6fc
Author: Dan Carpenter <dan.carpenter@oracle.com>
Date:   Wed Oct 12 09:24:52 2016 +0300

    hwmon: (max31790) potential ERR_PTR dereference
    
    We should only dereference "data" after we check if it is an error
    pointer.
    
    Fixes: 54187ff9d766 ('hwmon: (max31790) Convert to use new hwmon registration API')
    Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>

diff --git a/drivers/hwmon/max31790.c b/drivers/hwmon/max31790.c
index bef84e085973..c1b9275978f9 100644
--- a/drivers/hwmon/max31790.c
+++ b/drivers/hwmon/max31790.c
@@ -268,11 +268,13 @@ static int max31790_read_pwm(struct device *dev, u32 attr, int channel,
 			     long *val)
 {
 	struct max31790_data *data = max31790_update_device(dev);
-	u8 fan_config = data->fan_config[channel];
+	u8 fan_config;
 
 	if (IS_ERR(data))
 		return PTR_ERR(data);
 
+	fan_config = data->fan_config[channel];
+
 	switch (attr) {
 	case hwmon_pwm_input:
 		*val = data->pwm[channel] >> 8;

