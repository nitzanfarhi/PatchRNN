commit bb4a7ad5a08400384428a8981165f72a6764c57f
Author: unknown <guilhem@gbichot3.local>
Date:   Thu Jun 7 21:51:11 2007 +0200

    Maria: fix for "use of uninitialized value" Valgrind error.
    
    
    storage/maria/ha_maria.cc:
      initialize ha_maria::data_file_type when opening the table
      (it was not initialized, causing a Valgrind error)
    storage/maria/ma_locking.c:
      if it's impossible, let's test it

diff --git a/storage/maria/ha_maria.cc b/storage/maria/ha_maria.cc
index 812fc69c2c2..c2f4d621305 100644
--- a/storage/maria/ha_maria.cc
+++ b/storage/maria/ha_maria.cc
@@ -1806,6 +1806,7 @@ int ha_maria::info(uint flag)
               MY_APPEND_EXT | MY_UNPACK_FILENAME);
     if (strcmp(name_buff, maria_info.index_file_name))
       index_file_name=maria_info.index_file_name;
+    data_file_type= maria_info.data_file_type;
   }
   if (flag & HA_STATUS_ERRKEY)
   {
diff --git a/storage/maria/ma_locking.c b/storage/maria/ma_locking.c
index 6865c653d7e..abb095d47c2 100644
--- a/storage/maria/ma_locking.c
+++ b/storage/maria/ma_locking.c
@@ -190,6 +190,7 @@ int maria_lock_database(MARIA_HA *info, int lock_type)
       share->tot_locks++;
       break;
     default:
+      DBUG_ASSERT(0);
       break;				/* Impossible */
     }
   }

