commit 5309809129ca3ab14f8bd5e5ef66c1b7686eb639
Author: Linus Torvalds <torvalds@woody.linux-foundation.org>
Date:   Wed Sep 26 09:16:21 2007 -0700

    Add explicit zeroing to "envp" array in device 'show' method
    
    As Stephen Hemminger says, this is a "belt and suspenders" patch that
    zeroes the envp array at allocation time, even though all the users
    should NULL-terminate it anyway (and we've hopefully fixed everybody
    that doesn't do that).
    
    And we'll apparently clean the whole envp thing up for 2.6.24 anyway.
    
    But let's just be robust, and do both this *and* make sure that all
    users are doing the right thing.
    
    Acked-by: Stephen Hemminger <shemminger@linux-foundation.org>
    Acked-by: Greg Kroah-Hartman <gregkh@suse.de>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

diff --git a/drivers/base/core.c b/drivers/base/core.c
index 6de33d7a29ba..67c92582d6ef 100644
--- a/drivers/base/core.c
+++ b/drivers/base/core.c
@@ -284,6 +284,7 @@ static ssize_t show_uevent(struct device *dev, struct device_attribute *attr,
 
 	/* let the kset specific function add its keys */
 	pos = data;
+	memset(envp, 0, sizeof(envp));
 	retval = kset->uevent_ops->uevent(kset, &dev->kobj,
 					  envp, ARRAY_SIZE(envp),
 					  pos, PAGE_SIZE);

