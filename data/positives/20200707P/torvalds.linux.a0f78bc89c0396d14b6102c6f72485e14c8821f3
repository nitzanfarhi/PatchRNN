commit a0f78bc89c0396d14b6102c6f72485e14c8821f3
Author: Keerthy <j-keerthy@ti.com>
Date:   Mon Jun 20 14:13:31 2016 +0530

    regulator: of: setup initial suspend state
    
    Setup initial suspend state to mem, if suspend state is defined for
    mem state. This makes sure that the regulators are in proper mode
    already from boot.
    
    Signed-off-by: Tero Kristo <t-kristo@ti.com>
    Signed-off-by: Dave Gerlach <d-gerlach@ti.com>
    Signed-off-by: Keerthy <j-keerthy@ti.com>
    Signed-off-by: Mark Brown <broonie@kernel.org>

diff --git a/drivers/regulator/of_regulator.c b/drivers/regulator/of_regulator.c
index cd828dbf9d52..4f613ec99500 100644
--- a/drivers/regulator/of_regulator.c
+++ b/drivers/regulator/of_regulator.c
@@ -163,6 +163,9 @@ static void of_get_regulation_constraints(struct device_node *np,
 					"regulator-suspend-microvolt", &pval))
 			suspend_state->uV = pval;
 
+		if (i == PM_SUSPEND_MEM)
+			constraints->initial_state = PM_SUSPEND_MEM;
+
 		of_node_put(suspend_np);
 		suspend_state = NULL;
 		suspend_np = NULL;

