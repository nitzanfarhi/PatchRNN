commit 9fcb663be42e4727c1beabc7c80e2d839199e6b1
Author: Anton Ivanov <antivano@cisco.com>
Date:   Fri Mar 7 18:37:46 2014 +0000

    um: Missing pipe handling
    
    UML does not handle sigpipe. As a result when running it under
    expect or redirecting the IO from the console to an external program
    it will crash if the program stops or exits.
    
    Signed-off-by: Anton Ivanov <antivano@cisco.com>
    Signed-off-by: Richard Weinberger <richard@nod.at>

diff --git a/arch/um/os-Linux/main.c b/arch/um/os-Linux/main.c
index e1704ff600ff..df9191acd926 100644
--- a/arch/um/os-Linux/main.c
+++ b/arch/um/os-Linux/main.c
@@ -151,6 +151,7 @@ int __init main(int argc, char **argv, char **envp)
 #endif
 
 	do_uml_initcalls();
+	change_sig(SIGPIPE, 0);
 	ret = linux_main(argc, argv);
 
 	/*

