commit 292d6878fa3e7fd2ab0f7275a78190639ad116d4
Author: Steven Morgan <stevmorg@cisco.com>
Date:   Fri Oct 27 16:03:29 2017 -0400

    bb11946 - check that tar checksum is within bounds. Patch supplied by Suleman Ali.

diff --git a/libclamav/untar.c b/libclamav/untar.c
index 3f72cec89..dcdf966fe 100644
--- a/libclamav/untar.c
+++ b/libclamav/untar.c
@@ -182,6 +182,9 @@ cli_untar(const char *dir, unsigned int posix, cli_ctx *ctx)
 			if((ret=cli_checklimits("cli_untar", ctx, 0, 0, 0))!=CL_CLEAN)
 				return ret;
 
+                        if (nread < TARCHECKSUMOFFSET + TARCHECKSUMLEN)
+                            return ret;
+
 			checksum = getchecksum(block);
 			cli_dbgmsg("cli_untar: Candidate checksum = %d, [%o in octal]\n", checksum, checksum);
 			if(testchecksum(block, checksum) != 0) {

