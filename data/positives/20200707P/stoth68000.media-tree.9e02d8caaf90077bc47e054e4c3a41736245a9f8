commit 9e02d8caaf90077bc47e054e4c3a41736245a9f8
Author: Dan Carpenter <dan.carpenter@oracle.com>
Date:   Wed Jan 6 12:59:10 2016 +0300

    fsl/fman: double free on probe failure
    
    "priv" is allocated with devm_kzalloc() so freeing it here with kfree()
    will lead to a double free.
    
    Fixes: 3933961682a3 ('fsl/fman: Add FMan MAC driver')
    Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/drivers/net/ethernet/freescale/fman/mac.c b/drivers/net/ethernet/freescale/fman/mac.c
index 743a393ba657..e33d9d24c1db 100644
--- a/drivers/net/ethernet/freescale/fman/mac.c
+++ b/drivers/net/ethernet/freescale/fman/mac.c
@@ -961,7 +961,6 @@ static int mac_probe(struct platform_device *_of_dev)
 	of_node_put(dev_node);
 _return_dev_set_drvdata:
 	kfree(priv->fixed_link);
-	kfree(priv);
 	dev_set_drvdata(dev, NULL);
 _return:
 	return err;

