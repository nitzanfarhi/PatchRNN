commit 566c8e6b4b71b8b88a819e1274ed458c1751df10
Author: Danny Al-Gaaf <danny.al-gaaf@bisect.de>
Date:   Mon Feb 22 17:23:12 2016 +0100

    common/ConfUtils.cc: fix potential integer overflow
    
    Fix for:
    
    CID 1128394 (#1 of 1): Integer overflowed argument (INTEGER_OVERFLOW)
     overflow: Add operation overflows on operands line_len and 1UL.
     overflow_assign: Assigning overflowed or truncated value (or a value
      computed from an overflowed or a truncated value) to rem.
     overflow_sink: Overflowed or truncated value (or a value computed from an
      overflowed or truncated value) rem used as critical argument to function.
    
    Signed-off-by: Danny Al-Gaaf <danny.al-gaaf@bisect.de>

diff --git a/src/common/ConfUtils.cc b/src/common/ConfUtils.cc
index 1ae5df5408..84ff626c37 100644
--- a/src/common/ConfUtils.cc
+++ b/src/common/ConfUtils.cc
@@ -297,6 +297,8 @@ load_from_buffer(const char *buf, size_t sz, std::deque<std::string> *errors,
   size_t rem = sz;
   while (1) {
     b += line_len + 1;
+    if ((line_len + 1) > rem)
+      break;
     rem -= line_len + 1;
     if (rem == 0)
       break;

