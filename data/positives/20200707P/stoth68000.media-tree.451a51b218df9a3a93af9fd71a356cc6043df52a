commit 451a51b218df9a3a93af9fd71a356cc6043df52a
Author: Jesper Juhl <jj@chaosbits.net>
Date:   Thu Apr 7 16:34:30 2011 -0300

    [media] DVB, DiB9000: Fix leak in dib9000_attach()
    
    If the second memory allocation in dib9000_attach() fails, we'll leak the
    memory allocated by the first.
    
    Signed-off-by: Jesper Juhl <jj@chaosbits.net>
    Cc: Patrick Boettcher <patrick.boettcher@dibcom.fr>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>

diff --git a/drivers/media/dvb/frontends/dib9000.c b/drivers/media/dvb/frontends/dib9000.c
index 91518761a2da..b25ef2bb5078 100644
--- a/drivers/media/dvb/frontends/dib9000.c
+++ b/drivers/media/dvb/frontends/dib9000.c
@@ -2255,8 +2255,10 @@ struct dvb_frontend *dib9000_attach(struct i2c_adapter *i2c_adap, u8 i2c_addr, c
 	if (st == NULL)
 		return NULL;
 	fe = kzalloc(sizeof(struct dvb_frontend), GFP_KERNEL);
-	if (fe == NULL)
+	if (fe == NULL) {
+		kfree(st);
 		return NULL;
+	}
 
 	memcpy(&st->chip.d9.cfg, cfg, sizeof(struct dib9000_config));
 	st->i2c.i2c_adap = i2c_adap;

