commit 043717f9d3c75e0ac2621f76362f6025443f0de9
Author: Ronny Chevalier <chevalier.ronny@gmail.com>
Date:   Thu Mar 3 18:15:24 2016 +0100

    systemctl: add missing OOM check

diff --git a/src/systemctl/systemctl.c b/src/systemctl/systemctl.c
index c741baf58..a62f4bf2f 100644
--- a/src/systemctl/systemctl.c
+++ b/src/systemctl/systemctl.c
@@ -6167,7 +6167,12 @@ end:
 
                 /* Removing empty dropin dirs */
                 if (!arg_full) {
-                        _cleanup_free_ char *dir = dirname_malloc(*original);
+                        _cleanup_free_ char *dir;
+
+                        dir = dirname_malloc(*original);
+                        if (!dir)
+                                return log_oom();
+
                         /* no need to check if the dir is empty, rmdir
                          * does nothing if it is not the case.
                          */

