commit bf1cb87b34af41e8877b8c24e5fc37fc07a0394e
Author: Yukihiro "Matz" Matsumoto <matz@ruby-lang.org>
Date:   Tue Jun 20 20:19:37 2017 +0900

    Array size can be cause integer overflow; fix #3710

diff --git a/src/array.c b/src/array.c
index 86fb50e5..8b6b9fa1 100644
--- a/src/array.c
+++ b/src/array.c
@@ -169,7 +169,7 @@ ary_expand_capa(mrb_state *mrb, struct RArray *a, mrb_int len)
 {
   mrb_int capa = a->aux.capa;
 
-  if (len > ARY_MAX_SIZE) {
+  if (len > ARY_MAX_SIZE || len < 0) {
   size_error:
     mrb_raise(mrb, E_ARGUMENT_ERROR, "array size too big");
   }

