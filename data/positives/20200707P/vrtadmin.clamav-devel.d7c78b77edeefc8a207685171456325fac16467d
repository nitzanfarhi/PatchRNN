commit d7c78b77edeefc8a207685171456325fac16467d
Author: Kevin Lin <klin@sourcefire.com>
Date:   Mon Mar 7 16:25:10 2016 -0500

    bb#11514 - check packSizes prior to dereference

diff --git a/libclamav/7z/7zDec.c b/libclamav/7z/7zDec.c
index e78a2b94d..12f8002b9 100644
--- a/libclamav/7z/7zDec.c
+++ b/libclamav/7z/7zDec.c
@@ -391,6 +391,8 @@ static SRes SzFolder_Decode2(const CSzFolder *folder, const UInt64 *packSizes,
         else
           return SZ_ERROR_UNSUPPORTED;
       }
+      if (!packSizes)
+        return SZ_ERROR_FAIL;
       offset = GetSum(packSizes, si);
       inSize = packSizes[si];
       RINOK(LookInStream_SeekTo(inStream, startPos + offset));

