commit 1ce6d3b18339d70f9ad8e95cd21b538cf94b80bf
Author: Johan Danielsson <joda@pdc.kth.se>
Date:   Tue Aug 19 18:41:24 1997 +0000

    Fix memory leak in v4 protocol handler.
    
    
    git-svn-id: svn://svn.h5l.se/heimdal/trunk/heimdal@3057 ec53bebd-3082-4978-b11e-865c3cabbd6b

diff --git a/kdc/kerberos4.c b/kdc/kerberos4.c
index 3706898db..a051ca8df 100644
--- a/kdc/kerberos4.c
+++ b/kdc/kerberos4.c
@@ -401,8 +401,10 @@ do_version4(unsigned char *buf,
     out2:
 	if(tgt_princ)
 	    krb5_free_principal(context, tgt_princ);
-	if(tgt)
+	if(tgt){
 	    hdb_free_entry(context, tgt);
+	    free(tgt);
+	}
 
 	break;
     }
@@ -430,10 +432,14 @@ out:
 	krb5_free_principal(context, client_princ);
     if(server_princ)
 	krb5_free_principal(context, server_princ);
-    if(client)
+    if(client){
 	hdb_free_entry(context, client);
-    if(server)
+	free(client);
+    }
+    if(server){
 	hdb_free_entry(context, server);
+	free(server);
+    }
     krb5_storage_free(sp);
     return 0;
 }

