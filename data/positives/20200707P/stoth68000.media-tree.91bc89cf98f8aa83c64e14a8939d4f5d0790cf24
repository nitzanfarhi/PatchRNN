commit 91bc89cf98f8aa83c64e14a8939d4f5d0790cf24
Author: Antonino A. Daplas <adaplas@gmail.com>
Date:   Sat Mar 11 03:27:24 2006 -0800

    [PATCH] imsttfb: Fix resource leak
    
    The struct info and device resource may not be released in the driver's error
    path.  Fix.
    
    Coverity Bug 671
    
    Signed-off-by: Antonino Daplas <adaplas@pol.net>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

diff --git a/drivers/video/imsttfb.c b/drivers/video/imsttfb.c
index ad416ae47596..7db42542eb19 100644
--- a/drivers/video/imsttfb.c
+++ b/drivers/video/imsttfb.c
@@ -1510,6 +1510,8 @@ imsttfb_probe(struct pci_dev *pdev, const struct pci_device_id *ent)
 		default:
 			printk(KERN_INFO "imsttfb: Device 0x%x unknown, "
 					 "contact maintainer.\n", pdev->device);
+			release_mem_region(addr, size);
+			framebuffer_release(info);
 			return -ENODEV;
 	}
 

