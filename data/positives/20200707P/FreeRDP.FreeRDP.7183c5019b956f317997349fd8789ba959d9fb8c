commit 7183c5019b956f317997349fd8789ba959d9fb8c
Author: Armin Novak <armin.novak@thincast.com>
Date:   Thu Feb 1 09:34:07 2018 +0100

    Check length of string returned by ClipboardGetData

diff --git a/client/Android/android_cliprdr.c b/client/Android/android_cliprdr.c
index 9c3587c84..94d37910e 100644
--- a/client/Android/android_cliprdr.c
+++ b/client/Android/android_cliprdr.c
@@ -435,6 +435,7 @@ static UINT android_cliprdr_server_format_data_response(
 		formatId = ClipboardRegisterFormat(afc->clipboard, "UTF8_STRING");
 		data = (void*) ClipboardGetData(afc->clipboard, formatId, &size);
 		attached = jni_attach_thread(&env);
+		size = strnlen(data, size);
 		jdata = jniNewStringUTF(env, data, size);
 		freerdp_callback("OnRemoteClipboardChanged", "(JLjava/lang/String;)V", (jlong)instance,
 		                 jdata);

