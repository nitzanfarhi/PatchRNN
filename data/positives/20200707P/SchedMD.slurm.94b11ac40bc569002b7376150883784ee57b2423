commit 94b11ac40bc569002b7376150883784ee57b2423
Author: Morris Jette <jette@schedmd.com>
Date:   Tue Aug 18 08:53:28 2015 -0700

    Prevent zero divide
    
    This is a correction to 78c0bf9a5803659ac98563ac6216fb25e32f486b
    which could result in divide by zero and slurmstepd abort.
    bug 1748

diff --git a/src/plugins/jobacct_gather/common/common_jag.c b/src/plugins/jobacct_gather/common/common_jag.c
index 81d6c8dce2..eca7aa3116 100644
--- a/src/plugins/jobacct_gather/common/common_jag.c
+++ b/src/plugins/jobacct_gather/common/common_jag.c
@@ -88,7 +88,7 @@ static uint32_t _update_weighted_freq(struct jobacctinfo *jobacct,
 	jobacct->current_weighted_freq =
 		jobacct->current_weighted_freq +
 		(uint32_t)jobacct->this_sampled_cputime * thisfreq;
-	if (jobacct->tot_cpu) {
+	if (jobacct->tot_cpu >= 1) {
 		return (jobacct->current_weighted_freq /
 			(uint32_t)jobacct->tot_cpu);
 	} else

