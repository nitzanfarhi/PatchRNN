commit e68b1130dfbb834a4a028df01133591aeb59d241
Author: Cong Ding <dinggnu@gmail.com>
Date:   Thu Feb 14 11:16:10 2013 +0100

    dma: of-dma.c: fix memory leakage
    
    The memory allocated to ofdma might be a leakage when error occurs.
    
    Signed-off-by: Cong Ding <dinggnu@gmail.com>
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

diff --git a/drivers/dma/of-dma.c b/drivers/dma/of-dma.c
index 59631b2c4666..583e50e3d47c 100644
--- a/drivers/dma/of-dma.c
+++ b/drivers/dma/of-dma.c
@@ -107,6 +107,7 @@ int of_dma_controller_register(struct device_node *np,
 	if (!nbcells) {
 		pr_err("%s: #dma-cells property is missing or invalid\n",
 		       __func__);
+		kfree(ofdma);
 		return -EINVAL;
 	}
 

