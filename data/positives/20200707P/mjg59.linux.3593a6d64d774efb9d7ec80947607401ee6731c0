commit 3593a6d64d774efb9d7ec80947607401ee6731c0
Author: Richard Purdie <rpurdie@rpsys.net>
Date:   Thu May 10 23:46:30 2007 +0100

    leds: Fix trigger unregister_simple if register_simple fails
    
    Fix led_trigger_unregister_simple to handle the case where
    led_trigger_register_simple fails, avoiding a NULL pointer
    dereference.
    
    Signed-off-by: Richard Purdie <rpurdie@rpsys.net>

diff --git a/drivers/leds/led-triggers.c b/drivers/leds/led-triggers.c
index 454fb0901f82..129733f2379b 100644
--- a/drivers/leds/led-triggers.c
+++ b/drivers/leds/led-triggers.c
@@ -215,7 +215,8 @@ void led_trigger_unregister(struct led_trigger *trigger)
 
 void led_trigger_unregister_simple(struct led_trigger *trigger)
 {
-	led_trigger_unregister(trigger);
+	if (trigger)
+		led_trigger_unregister(trigger);
 	kfree(trigger);
 }
 

