commit 47882fa4975bf0b58dd74474329fdd7154e8f04c
Author: Li Qiang <liqiang6-s@360.cn>
Date:   Tue Aug 16 16:58:01 2016 +0530

    net: vmxnet: use g_new for pkt initialisation
    
    When network transport abstraction layer initialises pkt, the maximum
    fragmentation count is not checked. This could lead to an integer
    overflow causing a NULL pointer dereference. Replace g_malloc() with
    g_new() to catch the multiplication overflow.
    
    Reported-by: Li Qiang <liqiang6-s@360.cn>
    Signed-off-by: Prasad J Pandit <pjp@fedoraproject.org>
    Acked-by: Dmitry Fleytman <dmitry@daynix.com>
    Signed-off-by: Jason Wang <jasowang@redhat.com>

diff --git a/hw/net/net_tx_pkt.c b/hw/net/net_tx_pkt.c
index 53dfaa292c..20b25496e5 100644
--- a/hw/net/net_tx_pkt.c
+++ b/hw/net/net_tx_pkt.c
@@ -65,10 +65,9 @@ void net_tx_pkt_init(struct NetTxPkt **pkt, PCIDevice *pci_dev,
 
     p->pci_dev = pci_dev;
 
-    p->vec = g_malloc((sizeof *p->vec) *
-        (max_frags + NET_TX_PKT_PL_START_FRAG));
+    p->vec = g_new(struct iovec, max_frags + NET_TX_PKT_PL_START_FRAG);
 
-    p->raw = g_malloc((sizeof *p->raw) * max_frags);
+    p->raw = g_new(struct iovec, max_frags);
 
     p->max_payload_frags = max_frags;
     p->max_raw_frags = max_frags;

