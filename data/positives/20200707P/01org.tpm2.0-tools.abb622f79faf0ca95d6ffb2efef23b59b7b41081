commit abb622f79faf0ca95d6ffb2efef23b59b7b41081
Author: Javier Martinez Canillas <javierm@redhat.com>
Date:   Tue Oct 17 02:37:14 2017 +0200

    tpm2_import: free exponent BIGNUM after RSA_generate_key_ex() call
    
    The RSA_generate_key_ex() creates a duplicate of the exponent component
    passed as an argument, so it can be freed just after the function call.
    
    Signed-off-by: Javier Martinez Canillas <javierm@redhat.com>

diff --git a/tools/tpm2_import.c b/tools/tpm2_import.c
index 2f039ea..a49f5f1 100644
--- a/tools/tpm2_import.c
+++ b/tools/tpm2_import.c
@@ -161,6 +161,7 @@ static bool encrypt_seed_with_tpm2_rsa_public_key(void) {
         return false;
     }
     return_code = RSA_generate_key_ex(rsa, 2048, bne, NULL);
+    BN_free(bne);
     if (return_code != 1) {
         LOG_ERR("RSA_generate_key_ex failed\n");
         return false;
@@ -178,7 +179,6 @@ static bool encrypt_seed_with_tpm2_rsa_public_key(void) {
         LOG_ERR("Failed RSA_public_encrypt\n");
     }
     RSA_free(rsa);
-    BN_free(bne);
     return true;
 }
 

