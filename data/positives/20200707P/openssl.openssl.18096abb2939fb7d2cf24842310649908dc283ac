commit 18096abb2939fb7d2cf24842310649908dc283ac
Author: Dr. Stephen Henson <steve@openssl.org>
Date:   Thu May 31 12:39:21 2007 +0000

    Handle NULL parameter in some EVP utility functions.

diff --git a/crypto/evp/evp_lib.c b/crypto/evp/evp_lib.c
index e4d5b682f3..daccb66820 100644
--- a/crypto/evp/evp_lib.c
+++ b/crypto/evp/evp_lib.c
@@ -255,11 +255,15 @@ int EVP_MD_pkey_type(const EVP_MD *md)
 
 int EVP_MD_size(const EVP_MD *md)
 	{
+	if (!md)
+		return -1;
 	return md->md_size;
 	}
 
 const EVP_MD *EVP_MD_CTX_md(const EVP_MD_CTX *ctx)
 	{
+	if (!ctx)
+		return NULL;
 	return ctx->digest;
 	}
 

