commit 9289021a512906412de2236521ebde516adbb849
Author: attilamolnar <attilamolnar@hush.com>
Date:   Fri Jun 1 04:35:52 2012 +0200

    m_ssl_gnutls Only generate DH params when dh_params is inited

diff --git a/src/modules/extra/m_ssl_gnutls.cpp b/src/modules/extra/m_ssl_gnutls.cpp
index 689d69580..6ca876d4c 100644
--- a/src/modules/extra/m_ssl_gnutls.cpp
+++ b/src/modules/extra/m_ssl_gnutls.cpp
@@ -323,6 +323,9 @@ class ModuleSSLGnuTLS : public Module
 		// once a day, once a week or once a month. Depending on the
 		// security requirements.
 
+		if (!dh_alloc)
+			return;
+
 		int ret;
 
 		if((ret = gnutls_dh_params_generate2(dh_params, dh_bits)) < 0)

