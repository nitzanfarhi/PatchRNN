commit 2bb33a88881eacb94e2af54d564cdffc00478cea
Author: Daniel-Constantin Mierla <miconda@gmail.com>
Date:   Wed Jan 10 12:52:04 2018 +0100

    pua: safety check on tuple_id len

diff --git a/src/modules/pua/add_events.c b/src/modules/pua/add_events.c
index ce94d5a84..79d3aeaed 100644
--- a/src/modules/pua/add_events.c
+++ b/src/modules/pua/add_events.c
@@ -183,6 +183,10 @@ int pres_process_body(publ_info_t* publ, str** fin_body, int ver, str** tuple_pa
 	{
 		if(tuple== NULL)
 		{
+			if(strlen(tuple_id)>=50) {
+				LM_ERR("tuple id is too long: %s\n", tuple_id);
+				goto error;
+			}
 			strcpy(buf, tuple_id);
 			xmlFree(tuple_id);
 			tuple_id= buf;

