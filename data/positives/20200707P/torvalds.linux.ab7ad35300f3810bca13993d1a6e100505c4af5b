commit ab7ad35300f3810bca13993d1a6e100505c4af5b
Author: Colin Ian King <colin.king@canonical.com>
Date:   Sat Apr 12 18:59:14 2014 +0100

    clk: versatile: free icst on error return
    
    commit a183da63 introduced a new error return path that does
    not kfree icst if the kmemdup of desc->params fails.
    
    Signed-off-by: Colin Ian King <colin.king@canonical.com>
    Acked-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Mike Turquette <mturquette@linaro.org>

diff --git a/drivers/clk/versatile/clk-icst.c b/drivers/clk/versatile/clk-icst.c
index 7f3868a227c8..bc96f103bd7c 100644
--- a/drivers/clk/versatile/clk-icst.c
+++ b/drivers/clk/versatile/clk-icst.c
@@ -140,6 +140,7 @@ struct clk *icst_clk_register(struct device *dev,
 
 	pclone = kmemdup(desc->params, sizeof(*pclone), GFP_KERNEL);
 	if (!pclone) {
+		kfree(icst);
 		pr_err("could not clone ICST params\n");
 		return ERR_PTR(-ENOMEM);
 	}

