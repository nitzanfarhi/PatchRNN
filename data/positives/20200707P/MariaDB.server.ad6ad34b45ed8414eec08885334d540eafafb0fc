commit ad6ad34b45ed8414eec08885334d540eafafb0fc
Author: bell@sanja.is.com.ua <>
Date:   Sun Sep 5 10:57:26 2004 +0300

    memory leak fixed

diff --git a/sql/sql_derived.cc b/sql/sql_derived.cc
index 30b06e91082..05ad2094372 100644
--- a/sql/sql_derived.cc
+++ b/sql/sql_derived.cc
@@ -222,10 +222,12 @@ static int mysql_derived(THD *thd, LEX *lex, SELECT_LEX_UNIT *unit,
       table->next= thd->derived_tables;
       thd->derived_tables= table;
     }
+  }
+  else
+    free_tmp_table(thd, table);
 
 exit:
-    delete derived_result;
-    lex->current_select= save_current_select;
-  }
+  delete derived_result;
+  lex->current_select= save_current_select;
   DBUG_RETURN(res);
 }

