commit 87c31cfd7a2cd7893c589b4f25d6d45b196e20c1
Author: Anton Khirnov <anton@khirnov.net>
Date:   Mon Mar 18 21:31:54 2013 +0100

    vf_gradfun: make config_props work properly when called multiple times.

diff --git a/libavfilter/vf_gradfun.c b/libavfilter/vf_gradfun.c
index 402e3b5af3..8ed706d149 100644
--- a/libavfilter/vf_gradfun.c
+++ b/libavfilter/vf_gradfun.c
@@ -166,6 +166,7 @@ static int config_input(AVFilterLink *inlink)
     int hsub = desc->log2_chroma_w;
     int vsub = desc->log2_chroma_h;
 
+    av_freep(&s->buf);
     s->buf = av_mallocz((FFALIGN(inlink->w, 16) * (s->radius + 1) / 2 + 32) * sizeof(uint16_t));
     if (!s->buf)
         return AVERROR(ENOMEM);

