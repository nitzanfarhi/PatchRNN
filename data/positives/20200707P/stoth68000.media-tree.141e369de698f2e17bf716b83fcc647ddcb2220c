commit 141e369de698f2e17bf716b83fcc647ddcb2220c
Author: Steffen Klassert <steffen.klassert@secunet.com>
Date:   Thu Jul 5 23:39:34 2012 +0000

    xfrm: Initialize the struct xfrm_dst behind the dst_enty field
    
    We start initializing the struct xfrm_dst at the first field
    behind the struct dst_enty. This is error prone because it
    might leave a new field uninitialized. So start initializing
    the struct xfrm_dst right behind the dst_entry.
    
    Suggested-by: Eric Dumazet <eric.dumazet@gmail.com>
    Signed-off-by: Steffen Klassert <steffen.klassert@secunet.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/net/xfrm/xfrm_policy.c b/net/xfrm/xfrm_policy.c
index 6e97855b5842..65bd1ca51517 100644
--- a/net/xfrm/xfrm_policy.c
+++ b/net/xfrm/xfrm_policy.c
@@ -1353,8 +1353,9 @@ static inline struct xfrm_dst *xfrm_alloc_dst(struct net *net, int family)
 	xdst = dst_alloc(dst_ops, NULL, 0, 0, 0);
 
 	if (likely(xdst)) {
-		memset(&xdst->u.rt6.rt6i_table, 0,
-			sizeof(*xdst) - sizeof(struct dst_entry));
+		struct dst_entry *dst = &xdst->u.dst;
+
+		memset(dst + 1, 0, sizeof(*xdst) - sizeof(*dst));
 		xdst->flo.ops = &xfrm_bundle_fc_ops;
 	} else
 		xdst = ERR_PTR(-ENOBUFS);

