commit c1594a5fd6b31506feac3771127296b59c1ea61b
Author: William Roberts <william.c.roberts@intel.com>
Date:   Tue Mar 14 13:35:12 2017 -0700

    tpm2_verifysignature: ensure msg is not null
    
    Some tools complain about msg being null, so add a check
    to silence them.
    
    Signed-off-by: William Roberts <william.c.roberts@intel.com>

diff --git a/tools/tpm2_verifysignature.c b/tools/tpm2_verifysignature.c
index 7873d20..d9a2143 100644
--- a/tools/tpm2_verifysignature.c
+++ b/tools/tpm2_verifysignature.c
@@ -194,6 +194,14 @@ static bool init(tpm2_verifysig_ctx *ctx) {
 
     /* If no digest is specified, compute it */
     if (!ctx->flags.digest) {
+        if (!ctx->flags.msg) {
+            /*
+             * This is a redundant check since main() checks this case, but we'll add it here to silence any
+             * complainers.
+             */
+            LOG_ERR("No digest set and no message file to compute from, cannot compute message hash!");
+            goto err;
+        }
         int rc = tpm_hash_compute_data(ctx->sapi_context, msg->buffer, msg->size,
                 ctx->halg, &ctx->msgHash);
         if (rc) {

