commit f953c9353f5fe6e98fa7f32f51060a74d845b5f8
Author: Daniel J Blueman <daniel.blueman@gmail.com>
Date:   Mon May 17 14:23:52 2010 +0100

    i915: fix lock imbalance on error path...
    
    While investigating Intel i5 Arrandale GPU lockups with -rc4, I
    noticed a lock imbalance.
    
    Signed-off-by: Daniel J Blueman <daniel.blueman@gmail.com>
    Signed-off-by: Eric Anholt <eric@anholt.net>

diff --git a/drivers/gpu/drm/i915/i915_drv.c b/drivers/gpu/drm/i915/i915_drv.c
index d40f62d36453..c072b212979c 100644
--- a/drivers/gpu/drm/i915/i915_drv.c
+++ b/drivers/gpu/drm/i915/i915_drv.c
@@ -370,6 +370,7 @@ int i965_reset(struct drm_device *dev, u8 flags)
 		}
 	} else {
 		DRM_ERROR("Error occurred. Don't know how to reset this chip.\n");
+		mutex_unlock(&dev->struct_mutex);
 		return -ENODEV;
 	}
 

