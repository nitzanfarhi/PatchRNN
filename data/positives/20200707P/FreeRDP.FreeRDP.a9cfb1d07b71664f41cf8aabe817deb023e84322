commit a9cfb1d07b71664f41cf8aabe817deb023e84322
Author: Armin Novak <armin.novak@gmail.com>
Date:   Mon Nov 17 00:37:29 2014 +0100

    Fixed memory leak.

diff --git a/libfreerdp/codec/clear.c b/libfreerdp/codec/clear.c
index ddbe19efc..e52c9b357 100644
--- a/libfreerdp/codec/clear.c
+++ b/libfreerdp/codec/clear.c
@@ -59,7 +59,7 @@ int clear_decompress(CLEAR_CONTEXT* clear, BYTE* pSrcData, UINT32 SrcSize,
 	UINT32 i;
 	BOOL invert;
 	UINT32 x, y;
-	UINT32 count;
+	UINT32 count = 0;
 	UINT32 color;
 	int nXDstRel;
 	int nYDstRel;
@@ -848,7 +848,10 @@ CLEAR_CONTEXT* clear_context_new(BOOL Compressor)
 		clear->nsc = nsc_context_new();
 
 		if (!clear->nsc)
+		{
+			free (clear);
 			return NULL;
+		}
 
 		nsc_context_set_pixel_format(clear->nsc, RDP_PIXEL_FORMAT_R8G8B8);
 

