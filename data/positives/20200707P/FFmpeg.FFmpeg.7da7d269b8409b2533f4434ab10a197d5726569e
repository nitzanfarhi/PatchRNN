commit 7da7d269b8409b2533f4434ab10a197d5726569e
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Mon Mar 2 14:19:41 2015 +0100

    ffplay: Switch to show waves mode if allocation/init of RDFT fails
    
    Fixes null pointer dereference
    
    Found-by: Pawe≈Ç <pantrombka@gmail.com>
    Reviewed-by: Marton Balint <cus@passwd.hu>
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/ffplay.c b/ffplay.c
index 8140dd9645..94c7ed45d1 100644
--- a/ffplay.c
+++ b/ffplay.c
@@ -1247,7 +1247,10 @@ static void video_audio_display(VideoState *s)
             s->rdft_bits = rdft_bits;
             s->rdft_data = av_malloc_array(nb_freq, 4 *sizeof(*s->rdft_data));
         }
-        {
+        if (!s->rdft || !s->rdft_data){
+            av_log(NULL, AV_LOG_ERROR, "Failed to allocate buffers for RDFT, switching to waves display\n");
+            s->show_mode = SHOW_MODE_WAVES;
+        } else {
             FFTSample *data[2];
             for (ch = 0; ch < nb_display_channels; ch++) {
                 data[ch] = s->rdft_data + 2 * nb_freq * ch;

