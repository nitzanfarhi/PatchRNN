commit 8a20774a24bb1ea68b7360113746eac6e59ad8a8
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Sat Mar 24 12:29:05 2012 +0100

    indeo4: Fix global array overread.
    
    Found-by: Mateusz "j00ru" Jurczyk and Gynvael Coldwind
    
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavcodec/indeo4.c b/libavcodec/indeo4.c
index 1d280a0c53..1265201541 100644
--- a/libavcodec/indeo4.c
+++ b/libavcodec/indeo4.c
@@ -404,6 +404,10 @@ static int decode_band_hdr(IVI4DecContext *ctx, IVIBandDesc *band,
                 av_log(avctx, AV_LOG_ERROR, "Custom quant matrix encountered!\n");
                 return AVERROR_INVALIDDATA;
             }
+            if (band->quant_mat > 21) {
+                av_log(avctx, AV_LOG_ERROR, "Invalid quant matrix encountered!\n");
+                return AVERROR_INVALIDDATA;
+            }
         }
 
         /* decode block huffman codebook */

