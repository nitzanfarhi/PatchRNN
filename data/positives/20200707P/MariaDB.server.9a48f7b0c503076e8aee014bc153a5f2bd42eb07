commit 9a48f7b0c503076e8aee014bc153a5f2bd42eb07
Author: Leif Walsh <leif@tokutek.com>
Date:   Wed Mar 7 16:26:31 2012 +0000

    [t:4580] free brtnode after checking garbage stats
    
    
    git-svn-id: file:///svn/toku/tokudb@40572 c7de825b-a66e-492c-adef-691d508d4ae1

diff --git a/newbrt/brtdump.c b/newbrt/brtdump.c
index c4460ed5888..c363fdb5844 100644
--- a/newbrt/brtdump.c
+++ b/newbrt/brtdump.c
@@ -286,7 +286,7 @@ garbage_helper(BLOCKNUM b, int64_t UU(size), int64_t UU(address), void *extra) {
     fill_bfe_for_full_read(&bfe, info->h);
     int r = toku_deserialize_brtnode_from(info->f, b, 0, &n, &bfe);
     if (r != 0) {
-        goto exit;
+        goto no_node;
     }
     if (n->height > 0) {
         goto exit;
@@ -299,6 +299,8 @@ garbage_helper(BLOCKNUM b, int64_t UU(size), int64_t UU(address), void *extra) {
         }
     }
 exit:
+    toku_brtnode_free(&n);
+no_node:
     return r;
 }
 

