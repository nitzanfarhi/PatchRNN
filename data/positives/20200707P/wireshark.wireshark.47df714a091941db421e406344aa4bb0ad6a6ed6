commit 47df714a091941db421e406344aa4bb0ad6a6ed6
Author: Stig Bj√∏rlykke <stig@bjorlykke.org>
Date:   Tue Sep 29 20:48:41 2009 +0000

    Avoid a possible dereference of null pointer.
    
    svn path=/trunk/; revision=30205

diff --git a/epan/wslua/wslua_util.c b/epan/wslua/wslua_util.c
index f764e8e272..066cb548b1 100644
--- a/epan/wslua/wslua_util.c
+++ b/epan/wslua/wslua_util.c
@@ -295,8 +295,10 @@ WSLUA_METAMETHOD Dir__call(lua_State* L) {
 	const gchar* filename;
 	const char* ext;
 	
-	if (!dir) 
+	if (!dir) {
 		luaL_argerror(L,1,"must be a Dir");
+		return 0;
+	}
 
 	if (!dir->dir) {
 		return 0;

