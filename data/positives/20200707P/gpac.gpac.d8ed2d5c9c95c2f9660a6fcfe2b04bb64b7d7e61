commit d8ed2d5c9c95c2f9660a6fcfe2b04bb64b7d7e61
Author: Romain Bouqueau <romain.bouqueau.pro@gmail.com>
Date:   Mon Dec 13 15:22:02 2010 +0000

    [bouqueau] fix m2ts muxer leak
    
    
    git-svn-id: http://svn.code.sf.net/p/gpac/code/trunk/gpac@2475 63c20433-aa62-49bd-875c-5a186b69a8fb

diff --git a/src/media_tools/m2ts_mux.c b/src/media_tools/m2ts_mux.c
index 3f6dedba3..0f0c3bfdf 100644
--- a/src/media_tools/m2ts_mux.c
+++ b/src/media_tools/m2ts_mux.c
@@ -840,6 +840,7 @@ Bool gf_m2ts_stream_process_stream(GF_M2TS_Mux *muxer, GF_M2TS_Mux_Stream *strea
 		}
 		gf_bs_write_data(bs, stream->pck.data, stream->pck.data_len);
 		gf_bs_align(bs);
+		gf_free(stream->pck.data);
 		gf_bs_get_content(bs, &stream->pck.data, &stream->pck.data_len);
 		gf_bs_del(bs);
 
@@ -871,6 +872,7 @@ Bool gf_m2ts_stream_process_stream(GF_M2TS_Mux *muxer, GF_M2TS_Mux_Stream *strea
 
 			gf_bs_write_data(bs, stream->pck.data, stream->pck.data_len);
 			gf_bs_align(bs);
+			gf_free(stream->pck.data);
 			gf_bs_get_content(bs, &stream->pck.data, &stream->pck.data_len);
 			gf_bs_del(bs);
 		}

