commit 9ba89a31efc89ec5cb72326dbcb9166b098f3ea0
Author: Victor Julien <victor@inliniac.net>
Date:   Thu Apr 19 11:27:43 2018 +0200

    ssh: fix out of bounds read in banner parsing
    
    Reported-by: Henning Perl

diff --git a/src/app-layer-ssh.c b/src/app-layer-ssh.c
index f7f9abe7..3527fd33 100644
--- a/src/app-layer-ssh.c
+++ b/src/app-layer-ssh.c
@@ -69,7 +69,7 @@ static int SSHParseBanner(SshState *state, SshHeader *header, const uint8_t *inp
     uint32_t line_len = input_len;
 
     /* is it the version line? */
-    if (SCMemcmp("SSH-", line_ptr, 4) != 0) {
+    if (line_len >= 4 && SCMemcmp("SSH-", line_ptr, 4) != 0) {
         SCReturnInt(-1);
     }
 

