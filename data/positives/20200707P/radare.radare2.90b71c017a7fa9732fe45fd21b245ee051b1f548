commit 90b71c017a7fa9732fe45fd21b245ee051b1f548
Author: pancake <pancake@nopcode.org>
Date:   Mon Jun 11 03:28:35 2018 +0200

    Fix #10293 - Use-after-free in r_anal_bb_free()

diff --git a/libr/anal/bb.c b/libr/anal/bb.c
index 81c5fab14..a693c5585 100644
--- a/libr/anal/bb.c
+++ b/libr/anal/bb.c
@@ -62,7 +62,11 @@ R_API void r_anal_bb_free(RAnalBlock *bb) {
 		bb->failbb->prev = NULL;
 		bb->failbb = NULL;
 	}
-	R_FREE (bb);
+	if (bb->next) {
+		// avoid double free
+		bb->next->prev = NULL;
+	}
+	R_FREE (bb); // double free
 }
 
 R_API RList *r_anal_bb_list_new() {

