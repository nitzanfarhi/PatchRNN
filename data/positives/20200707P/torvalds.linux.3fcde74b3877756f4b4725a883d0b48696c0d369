commit 3fcde74b3877756f4b4725a883d0b48696c0d369
Author: Kirill Korotaev <dev@openvz.org>
Date:   Fri Sep 1 01:34:10 2006 -0700

    [NEIGH]: neigh_table_clear() doesn't free stats
    
    neigh_table_clear() doesn't free tbl->stats.
    Found by Alexey Kuznetsov. Though Alexey considers this
    leak minor for mainstream, I still believe that cleanup
    code should not forget to free some of the resources :)
    
    At least, this is critical for OpenVZ with virtualized
    neighbour tables.
    
    Signed-Off-By: Kirill Korotaev <dev@openvz.org>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/net/core/neighbour.c b/net/core/neighbour.c
index 5130d2efdbbe..fe2113f54e2b 100644
--- a/net/core/neighbour.c
+++ b/net/core/neighbour.c
@@ -1432,6 +1432,9 @@ int neigh_table_clear(struct neigh_table *tbl)
 	kfree(tbl->phash_buckets);
 	tbl->phash_buckets = NULL;
 
+	free_percpu(tbl->stats);
+	tbl->stats = NULL;
+
 	return 0;
 }
 

