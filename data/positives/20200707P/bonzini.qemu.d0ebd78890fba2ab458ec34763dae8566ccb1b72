commit d0ebd78890fba2ab458ec34763dae8566ccb1b72
Author: Marc-André Lureau <mlureau@redhat.com>
Date:   Wed Nov 21 14:16:08 2012 +0100

    ccid-card-emul: do not crash if backend is not provided
    
    Program received signal SIGSEGV, Segmentation fault.
    __strcmp_sse42 () at ../sysdeps/x86_64/multiarch/strcmp-sse42.S:164
    164               movdqu        (%rsi), %xmm2
    (gdb) bt
        at /home/elmarco/320g/src/qemu/hw/ccid-card-emulated.c:477
        at /home/elmarco/320g/src/qemu/hw/ccid-card-emulated.c:503
    
    Signed-off-by: Marc-André Lureau <mlureau@redhat.com>
    Reviewed-by: Alon Levy <alevy@redhat.com>

diff --git a/hw/usb/ccid-card-emulated.c b/hw/usb/ccid-card-emulated.c
index d534c94c1a..6cbb1766ab 100644
--- a/hw/usb/ccid-card-emulated.c
+++ b/hw/usb/ccid-card-emulated.c
@@ -473,6 +473,9 @@ static uint32_t parse_enumeration(char *str,
 {
     uint32_t ret = not_found_value;
 
+    if (str == NULL)
+        return 0;
+
     while (table->name != NULL) {
         if (strcmp(table->name, str) == 0) {
             ret = table->value;

