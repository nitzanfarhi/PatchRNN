commit a95df35b470136ef0dd21af37b9723ae1222eadc
Author: Hongli Lai (Phusion) <hongli@phusion.nl>
Date:   Mon Jan 25 17:34:03 2010 +0100

    Correctly set permissions on control_process.pid.

diff --git a/ext/nginx/ngx_http_passenger_module.c b/ext/nginx/ngx_http_passenger_module.c
index d19cfd97e..64614f960 100644
--- a/ext/nginx/ngx_http_passenger_module.c
+++ b/ext/nginx/ngx_http_passenger_module.c
@@ -260,6 +260,13 @@ start_helper_server(ngx_cycle_t *cycle) {
         result = NGX_ERROR;
         goto cleanup;
     }
+    do {
+        ret = chown(filename, core_conf->user, (gid_t) -1);
+    } while (ret == -1 && errno == EINTR);
+    if (ret == -1) {
+        result = NGX_ERROR;
+        goto cleanup;
+    }
 
     /* Create various other info files. */
     last = ngx_snprintf(filename, sizeof(filename) - 1,

