commit 4e6604e51a5460653cd1189c51f5935ae0cde550
Author: Sami Kerola <kerolasa@iki.fi>
Date:   Sun Jul 13 18:30:32 2014 +0100

    lscpu: avoid double free
    
    The double free was possible for architectures other than x86_64 or i386.
    
    Signed-off-by: Sami Kerola <kerolasa@iki.fi>

diff --git a/sys-utils/lscpu-dmi.c b/sys-utils/lscpu-dmi.c
index 251d4acc4..6c870a113 100644
--- a/sys-utils/lscpu-dmi.c
+++ b/sys-utils/lscpu-dmi.c
@@ -258,7 +258,7 @@ int read_hypervisor_dmi(void)
 	if (rc)
 		goto done;
 	free(buf);
-
+	buf = NULL;
 memory_scan:
 #if defined(__x86_64__) || defined(__i386__)
 	/* Fallback to memory scan (x86, x86_64) */

