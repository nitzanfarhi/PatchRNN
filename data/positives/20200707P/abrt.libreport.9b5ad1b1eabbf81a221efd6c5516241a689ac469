commit 9b5ad1b1eabbf81a221efd6c5516241a689ac469
Author: Jakub Filak <jfilak@redhat.com>
Date:   Fri Jun 29 13:13:09 2012 +0200

    add missing dd_close() to save_dump_dir_from_problem_data()
    
    - this missing dd_close() causes trac#608
    
    Signed-off-by: Jakub Filak <jfilak@redhat.com>

diff --git a/src/lib/create_dump_dir.c b/src/lib/create_dump_dir.c
index 175cb61f..2195a80a 100644
--- a/src/lib/create_dump_dir.c
+++ b/src/lib/create_dump_dir.c
@@ -171,12 +171,15 @@ LibreportError save_dump_dir_from_problem_data(problem_data_t *problem_data, cha
     VERB2 log("Renaming from'%s' to '%s'", dd->dd_dirname, new_path);
     if (dd_rename(dd, new_path) != 0)
     {
+        free(new_path);
+        dd_close(dd);
+
         free(*problem_id);
         *problem_id = NULL;
         return LR_ERROR;
     }
-    free(new_path);
 
+    free(new_path);
     dd_close(dd);
 
     return LR_OK;

