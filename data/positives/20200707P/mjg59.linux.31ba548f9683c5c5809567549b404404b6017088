commit 31ba548f9683c5c5809567549b404404b6017088
Author: Patrick McHardy <kaber@trash.net>
Date:   Fri Mar 30 13:36:23 2007 -0700

    [NET_SCHED]: cls_basic: fix memory leak in basic_destroy
    
    tp->root is not freed on destruction.
    
    Signed-off-by: Patrick McHardy <kaber@trash.net>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/net/sched/cls_basic.c b/net/sched/cls_basic.c
index 70fe36eb66a2..4a91f082a81d 100644
--- a/net/sched/cls_basic.c
+++ b/net/sched/cls_basic.c
@@ -109,6 +109,7 @@ static void basic_destroy(struct tcf_proto *tp)
 		list_del(&f->link);
 		basic_delete_filter(tp, f);
 	}
+	kfree(head);
 }
 
 static int basic_delete(struct tcf_proto *tp, unsigned long arg)

