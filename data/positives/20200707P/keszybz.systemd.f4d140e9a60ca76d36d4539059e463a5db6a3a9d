commit f4d140e9a60ca76d36d4539059e463a5db6a3a9d
Author: Lennart Poettering <lennart@poettering.net>
Date:   Wed Feb 5 23:06:13 2014 +0100

    bus: properly unset default bus pointer when destroying last reference

diff --git a/src/libsystemd/sd-bus/sd-bus.c b/src/libsystemd/sd-bus/sd-bus.c
index 4fdc246b7..118769086 100644
--- a/src/libsystemd/sd-bus/sd-bus.c
+++ b/src/libsystemd/sd-bus/sd-bus.c
@@ -132,6 +132,9 @@ static void bus_free(sd_bus *b) {
 
         sd_bus_detach_event(b);
 
+        if (b->default_bus_ptr)
+                *b->default_bus_ptr = NULL;
+
         bus_close_fds(b);
 
         if (b->kdbus_buffer)

