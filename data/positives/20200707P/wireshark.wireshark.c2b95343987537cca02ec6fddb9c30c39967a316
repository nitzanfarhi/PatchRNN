commit c2b95343987537cca02ec6fddb9c30c39967a316
Author: Gerald Combs <gerald@wireshark.org>
Date:   Wed Jun 15 21:42:30 2005 +0000

    Catch an infinite loop in smpp_handle_dlist().  Fixes bug 246.
    
    svn path=/trunk/; revision=14639

diff --git a/epan/dissectors/packet-smpp.c b/epan/dissectors/packet-smpp.c
index 5bd2643156..5ad4236e0d 100644
--- a/epan/dissectors/packet-smpp.c
+++ b/epan/dissectors/packet-smpp.c
@@ -1689,6 +1689,8 @@ dissect_smpp(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)
 	guint32 offset = 0;
 	while (tvb_reported_length_remaining(tvb, offset) > 0) {
     	    guint16 pdu_len = tvb_get_ntohl(tvb, offset);
+            if (pdu_len < 1)
+                THROW(ReportedBoundsError);
 	    gint pdu_real_len = tvb_length_remaining(tvb, offset);
     	    tvbuff_t *pdu_tvb;
 

