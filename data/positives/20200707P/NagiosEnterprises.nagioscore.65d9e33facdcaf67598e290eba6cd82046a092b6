commit 65d9e33facdcaf67598e290eba6cd82046a092b6
Author: Andreas Ericsson <ae@op5.se>
Date:   Wed Sep 5 09:37:03 2012 +0000

    common/objects: Reset object count before we read configuration
    
    Otherwise some configuration types lead to bus errors when adding
    or traversing objects.
    
    This is a rework of a patch by William Leibzon, which fixed the
    problem for the core but left it hanging for the CGI's.
    
    Signed-off-by: Andreas Ericsson <ae@op5.se>
    
    git-svn-id: https://nagios.svn.sourceforge.net/svnroot/nagios/nagioscore/trunk@2147 5f96b256-904b-4d8d-8c98-d829582c6739

diff --git a/common/objects.c b/common/objects.c
index 8a48d2d1..b39a7b8e 100644
--- a/common/objects.c
+++ b/common/objects.c
@@ -77,6 +77,9 @@ int __nagios_object_structure_version = CURRENT_OBJECT_STRUCTURE_VERSION;
 int read_object_config_data(char *main_config_file, int options, int cache, int precache) {
 	int result = OK;
 
+	/* reset object counts */
+	memset(&num_objects, 0, sizeof(num_objects));
+
 	/********* IMPLEMENTATION-SPECIFIC INPUT FUNCTION ********/
 #ifdef USE_XODTEMPLATE
 	/* read in data from all text host config files (template-based) */

