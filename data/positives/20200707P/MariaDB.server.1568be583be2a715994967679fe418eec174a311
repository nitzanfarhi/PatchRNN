commit 1568be583be2a715994967679fe418eec174a311
Author: unknown <heikki@hundin.mysql.fi>
Date:   Fri Aug 19 12:54:13 2005 +0300

    btr0sea.c:
      Add diagnostic code to track a crash in adaptive hash indexes; the crash may happen if block->index == NULL
    
    
    innobase/btr/btr0sea.c:
      Add diagnostic code to track a crash in adaptive hash indexes; the crash may happen if block->index == NULL

diff --git a/innobase/btr/btr0sea.c b/innobase/btr/btr0sea.c
index f705fee4275..7a4e92a672a 100644
--- a/innobase/btr/btr0sea.c
+++ b/innobase/btr/btr0sea.c
@@ -964,6 +964,13 @@ btr_search_drop_page_hash_index(
 	heap = NULL;
 	offsets = NULL;
 
+	if (block->index == NULL) {
+
+		mem_analyze_corruption((byte*)block);
+
+		ut_a(block->index != NULL);
+	}
+
 	while (!page_rec_is_supremum(rec)) {
 		/* FIXME: in a mixed tree, not all records may have enough
 		ordering fields: */

