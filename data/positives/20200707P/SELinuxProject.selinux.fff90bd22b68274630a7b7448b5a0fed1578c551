commit fff90bd22b68274630a7b7448b5a0fed1578c551
Author: Stephen Smalley <sds@tycho.nsa.gov>
Date:   Tue Nov 29 11:18:54 2016 -0500

    libsepol: sepol_av_to_string: clear static buffer
    
    chenxiaolong reported this via
    https://github.com/SELinuxProject/selinux/issues/23
    
    A nicer fix would be to rework the interface to be more
    like security_av_string() in libselinux, but that requires
    updating all callers.
    
    Signed-off-by: Stephen Smalley <sds@tycho.nsa.gov>

diff --git a/libsepol/src/util.c b/libsepol/src/util.c
index ff8f7f28..b00251c6 100644
--- a/libsepol/src/util.c
+++ b/libsepol/src/util.c
@@ -89,6 +89,7 @@ char *sepol_av_to_string(policydb_t * policydbp, uint32_t tclass,
 	int rc;
 	int avlen = 0, len;
 
+	memset(avbuf, 0, sizeof avbuf);
 	cladatum = policydbp->class_val_to_struct[tclass - 1];
 	p = avbuf;
 	for (i = 0; i < cladatum->permissions.nprim; i++) {

