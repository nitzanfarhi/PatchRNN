commit 4e8ae317be5a51d58d8879a99ecf632aa84c552c
Author: Wouter Verhelst <w@uter.be>
Date:   Fri Oct 21 09:50:58 2016 +0200

    Fix memory leak
    
    If we don't need the session, we need to deallocate after deiniting it.
    
    Signed-off-by: Wouter Verhelst <w@uter.be>

diff --git a/nbd-server.c b/nbd-server.c
index 25c335b..7b3f291 100644
--- a/nbd-server.c
+++ b/nbd-server.c
@@ -1427,6 +1427,7 @@ CLIENT* handle_starttls(CLIENT* client, int opt, GArray* servers, uint32_t cflag
 
 	if (ret < 0) {
 		gnutls_deinit(*session);
+		g_free(session);
 		return NULL;
 	}
 	client->tls_session = session;

