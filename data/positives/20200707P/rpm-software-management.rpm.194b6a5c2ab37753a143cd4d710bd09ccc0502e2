commit 194b6a5c2ab37753a143cd4d710bd09ccc0502e2
Author: Jindrich Novy <jnovy@redhat.com>
Date:   Tue Jun 23 10:55:54 2009 +0200

    Check arg in argvJoin() before dereferencing

diff --git a/rpmio/argv.c b/rpmio/argv.c
index c96a7bf42..7a1aa5d5a 100644
--- a/rpmio/argv.c
+++ b/rpmio/argv.c
@@ -204,7 +204,7 @@ char *argvJoin(ARGV_const_t argv, const char *sep)
     char *dest = NULL;
     char * const *arg;
 
-    for (arg = argv; *arg; arg++) {
+    for (arg = argv; arg && *arg; arg++) {
 	rstrscat(&dest, *arg, *(arg+1) ? sep : "", NULL);
     } 
     return dest;

