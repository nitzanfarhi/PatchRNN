commit 1632a576e68c27229b31f0d1203ff90220e0e024
Author: Laurent Aimar <fenrir@videolan.org>
Date:   Sun Sep 11 19:17:40 2011 +0200

    Fixed segfault on memory allocation failure in ape demuxer.
    
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavformat/ape.c b/libavformat/ape.c
index 61590bdd35..cfac93381c 100644
--- a/libavformat/ape.c
+++ b/libavformat/ape.c
@@ -273,6 +273,8 @@ static int ape_read_header(AVFormatContext * s, AVFormatParameters * ap)
 
     if (ape->seektablelength > 0) {
         ape->seektable = av_malloc(ape->seektablelength);
+        if (!ape->seektable)
+            return AVERROR(ENOMEM);
         for (i = 0; i < ape->seektablelength / sizeof(uint32_t); i++)
             ape->seektable[i] = avio_rl32(pb);
     }

