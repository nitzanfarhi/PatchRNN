commit 9267de6067c56375125271a6bc7e505ff5e73cd2
Author: Micah Snyder <micasnyd@cisco.com>
Date:   Wed May 23 17:17:28 2018 -0400

    Adding additional free() calls in error conditions for str variable that isn't cleaned up at the end of the function.

diff --git a/clamsubmit/clamsubmit.c b/clamsubmit/clamsubmit.c
index 5b55896f6..b4b48e5bb 100644
--- a/clamsubmit/clamsubmit.c
+++ b/clamsubmit/clamsubmit.c
@@ -279,6 +279,7 @@ int main(int argc, char *argv[])
     }
     if (snprintf(str, len, "%s; %s;", hd_malware.cfduid, hd_malware.session) > len) {
         fprintf(stderr, "snprintf() failed formatting GET presigned cookies\n");
+        free(str);
         goto cleanup;
     }
     curl_easy_setopt(clam_curl, CURLOPT_COOKIE, str);
@@ -434,6 +435,7 @@ int main(int argc, char *argv[])
     }
     if (snprintf(str, len, "%s; %s;", hd_malware.cfduid, hd_malware.session) > len) {
         fprintf(stderr, "snprintf() failed formatting POST submit cookies\n");
+        free(str);
         goto cleanup;
     }
     curl_easy_setopt(clam_curl, CURLOPT_COOKIE, str);

