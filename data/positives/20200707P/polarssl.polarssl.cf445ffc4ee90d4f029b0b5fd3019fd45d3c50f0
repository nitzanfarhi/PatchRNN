commit cf445ffc4ee90d4f029b0b5fd3019fd45d3c50f0
Author: Paul Bakker <p.j.bakker@polarssl.org>
Date:   Mon Jun 24 19:31:41 2013 +0200

    Added missing free()
    (cherry picked from commit ff3a4b010b24c0293c3cefc1c8582b23775e1870)

diff --git a/library/pem.c b/library/pem.c
index 813c4ec2e..e2e399801 100644
--- a/library/pem.c
+++ b/library/pem.c
@@ -330,6 +330,7 @@ int pem_read_buffer( pem_context *ctx, char *header, char *footer, const unsigne
             return( POLARSSL_ERR_PEM_PASSWORD_MISMATCH );
         }
 #else
+        free( buf );
         return( POLARSSL_ERR_PEM_FEATURE_UNAVAILABLE );
 #endif
     }

