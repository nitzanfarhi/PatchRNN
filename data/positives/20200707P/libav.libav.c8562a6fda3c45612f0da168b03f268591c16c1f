commit c8562a6fda3c45612f0da168b03f268591c16c1f
Author: Carl Eugen Hoyos <cehoyos@rainbow.studorg.tuwien.ac.at>
Date:   Wed Oct 1 21:47:49 2008 +0000

    Fix memleak for currupt input.
    
    Originally committed as revision 15507 to svn://svn.ffmpeg.org/ffmpeg/trunk

diff --git a/libavcodec/vorbis_dec.c b/libavcodec/vorbis_dec.c
index 9fc619b80..6c15cb8b6 100644
--- a/libavcodec/vorbis_dec.c
+++ b/libavcodec/vorbis_dec.c
@@ -960,6 +960,7 @@ static av_cold int vorbis_decode_init(AVCodecContext *avccontext) {
     hdr_type=get_bits(gb, 8);
     if (hdr_type!=5) {
         av_log(avccontext, AV_LOG_ERROR, "Third header is not the setup header.\n");
+        vorbis_free(vc);
         return -1;
     }
     if (vorbis_parse_setup_hdr(vc)) {

