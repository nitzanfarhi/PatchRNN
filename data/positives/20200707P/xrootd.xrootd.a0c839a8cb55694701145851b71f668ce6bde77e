commit a0c839a8cb55694701145851b71f668ce6bde77e
Author: Gerardo Ganis <Gerardo.Ganis@cern.ch>
Date:   Mon Oct 10 13:46:44 2016 +0200

    secgsi: initialize output buffers in Encrypt/Decrypt

diff --git a/src/XrdSecgsi/XrdSecProtocolgsi.cc b/src/XrdSecgsi/XrdSecProtocolgsi.cc
index 2577c7d1..1fe42b3c 100644
--- a/src/XrdSecgsi/XrdSecProtocolgsi.cc
+++ b/src/XrdSecgsi/XrdSecProtocolgsi.cc
@@ -1070,9 +1070,10 @@ int XrdSecProtocolgsi::Encrypt(const char *inbuf,  // Data to be encrypted
       return -EINVAL;
 
    // Get output buffer
-   char *buf = (char *)malloc(sessionKey->EncOutLength(inlen));
-   if (!buf)
-      return -ENOMEM;
+   int sz = sessionKey->EncOutLength(inlen);
+   char *buf = (char *)malloc(sz);
+   if (!buf) return -ENOMEM;
+   memset(buf, 0, sz);
 
    // Encrypt
    int len = sessionKey->Encrypt(inbuf, inlen, buf);
@@ -1109,9 +1110,10 @@ int XrdSecProtocolgsi::Decrypt(const char *inbuf,  // Data to be decrypted
       return -EINVAL;
 
    // Get output buffer
-   char *buf = (char *)malloc(sessionKey->DecOutLength(inlen));
-   if (!buf)
-      return -ENOMEM;
+   int sz = sessionKey->DecOutLength(inlen);
+   char *buf = (char *)malloc(sz);
+   if (!buf) return -ENOMEM;
+   memset(buf, 0, sz);
 
    // Decrypt
    int len = sessionKey->Decrypt(inbuf, inlen, buf);

