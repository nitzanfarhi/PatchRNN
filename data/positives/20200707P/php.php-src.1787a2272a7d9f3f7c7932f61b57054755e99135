commit 1787a2272a7d9f3f7c7932f61b57054755e99135
Author: Andrei Zmievski <andrei@php.net>
Date:   Thu Jun 4 18:17:43 2009 +0000

    MFB

diff --git a/ext/sockets/sockets.c b/ext/sockets/sockets.c
index 81a3f31f05..abc6438e9f 100644
--- a/ext/sockets/sockets.c
+++ b/ext/sockets/sockets.c
@@ -1611,10 +1611,11 @@ PHP_FUNCTION(socket_recvfrom)
 			zval_dtor(arg5);
 			zval_dtor(arg6);
 
+			memset(addr6, 0, INET6_ADDRSTRLEN);
 			inet_ntop(AF_INET6, &sin6.sin6_addr, addr6, INET6_ADDRSTRLEN);
 
 			ZVAL_STRINGL(arg2, recv_buf, retval, 0);
-			ZVAL_STRING(arg5, addr6 ? addr6 : "::", 1);
+			ZVAL_STRING(arg5, addr6[0] ? addr6 : "::", 1);
 			ZVAL_LONG(arg6, ntohs(sin6.sin6_port));
 			break;
 #endif

