commit 9e848ba129761c6614229ff81b0cc3aa0e8584e0
Author: Eduardo Silva <edsiper@gmail.com>
Date:   Sat Nov 14 16:56:29 2009 -0300

    Forbidden access to directories without handler

diff --git a/src/http.c b/src/http.c
index 451233e7..d01328d8 100644
--- a/src/http.c
+++ b/src/http.c
@@ -217,8 +217,9 @@ int mk_http_init(struct client_request *cr, struct request *sr)
                 }
         }
 
-        /* read permission */ 
-        if(sr->file_info->read_access == MK_FILE_FALSE){
+        /* read permissions and check file */ 
+        if(sr->file_info->read_access == MK_FILE_FALSE ||
+           sr->file_info->is_directory == MK_FILE_TRUE){
                 mk_request_error(M_CLIENT_FORBIDDEN, cr, sr, 1, sr->log);
                 return -1;      
         }

