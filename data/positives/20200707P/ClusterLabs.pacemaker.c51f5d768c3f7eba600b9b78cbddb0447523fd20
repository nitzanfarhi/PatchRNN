commit c51f5d768c3f7eba600b9b78cbddb0447523fd20
Author: Ken Gaillot <kgaillot@redhat.com>
Date:   Thu Jun 2 15:56:22 2016 -0500

    Fix: attrd: don't leak memory when returning due to malformed update request
    
    introduced by 755fb18b

diff --git a/attrd/commands.c b/attrd/commands.c
index 3583179b9..94becc94a 100644
--- a/attrd/commands.c
+++ b/attrd/commands.c
@@ -252,6 +252,9 @@ attrd_client_update(xmlNode *xml)
 
     } else if (attr == NULL) {
         crm_err("Update request did not specify attribute or regular expression");
+        free(key);
+        free(set);
+        free(host);
         return;
     }
 

