commit 708218b064e3ad3d55ac0f9d19b3c8c0fb7af3a4
Author: Pavel Roskin <proski@gnu.org>
Date:   Thu Sep 1 20:05:19 2005 -0400

    [PATCH] orinoco: Fix memory leak on error in processing hostscan frames.
    
    Signed-off-by: Pavel Roskin <proski@gnu.org>
    
    diff-tree ca955293cdfd3139e150d3b4fed3922a7eb651fb (from cb289b9f9b2a0f3ae7070a008f22e383b37526ee)
    Author: Pavel Roskin <proski@gnu.org>
    Date:   Thu Sep 1 19:08:00 2005 -0400
    
        Fix memory leak on error in processing hostscan frames.
    Signed-off-by: Jeff Garzik <jgarzik@pobox.com>

diff --git a/drivers/net/wireless/orinoco.c b/drivers/net/wireless/orinoco.c
index 223d35795350..95eb05abc44a 100644
--- a/drivers/net/wireless/orinoco.c
+++ b/drivers/net/wireless/orinoco.c
@@ -1284,8 +1284,10 @@ static void __orinoco_ev_info(struct net_device *dev, hermes_t *hw)
 		/* Read scan data */
 		err = hermes_bap_pread(hw, IRQ_BAP, (void *) buf, len,
 				       infofid, sizeof(info));
-		if (err)
+		if (err) {
+			kfree(buf);
 			break;
+		}
 
 #ifdef ORINOCO_DEBUG
 		{

