commit 0ca4414d0f3eeb39bbad504eaaae76d40b7189cc
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Mon Apr 23 10:33:55 2012 +0300

    audemux: Add a sanity check for the number of channels
    
    Fixes a division by 0.
    
    Found-by: Mateusz "j00ru" Jurczyk and Gynvael Coldwind
    Signed-off-by: Martin Storsj√∂ <martin@martin.st>

diff --git a/libavformat/au.c b/libavformat/au.c
index 3a83d283b..bb9d5d5b5 100644
--- a/libavformat/au.c
+++ b/libavformat/au.c
@@ -145,6 +145,11 @@ static int au_read_header(AVFormatContext *s)
         return AVERROR_INVALIDDATA;
     }
 
+    if (channels == 0 || channels > 64) {
+        av_log(s, AV_LOG_ERROR, "Invalid number of channels %d\n", channels);
+        return AVERROR_INVALIDDATA;
+    }
+
     if (size >= 24) {
         /* skip unused data */
         avio_skip(pb, size - 24);

