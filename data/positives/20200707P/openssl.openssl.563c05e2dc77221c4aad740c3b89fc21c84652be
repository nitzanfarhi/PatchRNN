commit 563c05e2dc77221c4aad740c3b89fc21c84652be
Author: Bodo MÃ¶ller <bodo@openssl.org>
Date:   Thu Aug 14 10:33:56 2003 +0000

    fix out-of-bounds check in lock_dbg_cb (was too lose to detect all
    invalid cases)
    
    PR: 674

diff --git a/apps/openssl.c b/apps/openssl.c
index 45af2ba7f9..e0d89d4ab4 100644
--- a/apps/openssl.c
+++ b/apps/openssl.c
@@ -163,7 +163,7 @@ static void lock_dbg_cb(int mode, int type, const char *file, int line)
 		goto err;
 		}
 
-	if (type < 0 || type > CRYPTO_NUM_LOCKS)
+	if (type < 0 || type >= CRYPTO_NUM_LOCKS)
 		{
 		errstr = "type out of bounds";
 		goto err;
diff --git a/ssl/ssltest.c b/ssl/ssltest.c
index a304398b9f..7bb4152000 100644
--- a/ssl/ssltest.c
+++ b/ssl/ssltest.c
@@ -303,7 +303,7 @@ static void lock_dbg_cb(int mode, int type, const char *file, int line)
 		goto err;
 		}
 
-	if (type < 0 || type > CRYPTO_NUM_LOCKS)
+	if (type < 0 || type >= CRYPTO_NUM_LOCKS)
 		{
 		errstr = "type out of bounds";
 		goto err;

