commit a576cd5cfbf07a1022bfbe43f541a815f183a99b
Author: Marko Mäkelä <marko.makela@oracle.com>
Date:   Mon Nov 1 10:18:33 2010 +0200

    Bug #57579 blobs cause a thread to wait for itself endlessly
    
    btr_estimate_n_rows_in_range_on_level(): Always do mtr_commit(),
    so that the page will not remain pinned indefinitely.

diff --git a/storage/innobase/btr/btr0cur.c b/storage/innobase/btr/btr0cur.c
index 73d27a787f4..ef684be8e67 100644
--- a/storage/innobase/btr/btr0cur.c
+++ b/storage/innobase/btr/btr0cur.c
@@ -3277,6 +3277,7 @@ btr_estimate_n_rows_in_range_on_level(
 		    || btr_page_get_level_low(page) != level) {
 
 			/* The page got reused for something else */
+			mtr_commit(&mtr);
 			goto inexact;
 		}
 

