commit f45a43d847c96949d22e702879e52385a1547f6b
Author: Stefan Weinhuber <wein@de.ibm.com>
Date:   Thu Jun 29 14:57:46 2006 +0200

    [S390] missing check in dasd_eer_open.
    
    Check the return value of kzalloc in dasd_eer_open.
    
    Signed-off-by: Stefan Weinhuber <wein@de.ibm.com>
    Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>

diff --git a/drivers/s390/block/dasd_eer.c b/drivers/s390/block/dasd_eer.c
index 2d8af709947f..9d574ede1b1d 100644
--- a/drivers/s390/block/dasd_eer.c
+++ b/drivers/s390/block/dasd_eer.c
@@ -521,6 +521,8 @@ static int dasd_eer_open(struct inode *inp, struct file *filp)
 	unsigned long flags;
 
 	eerb = kzalloc(sizeof(struct eerbuffer), GFP_KERNEL);
+	if (!eerb)
+		return -ENOMEM;
 	eerb->buffer_page_count = eer_pages;
 	if (eerb->buffer_page_count < 1 ||
 	    eerb->buffer_page_count > INT_MAX / PAGE_SIZE) {

