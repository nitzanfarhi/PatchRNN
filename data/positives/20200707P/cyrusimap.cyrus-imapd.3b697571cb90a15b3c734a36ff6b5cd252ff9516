commit 3b697571cb90a15b3c734a36ff6b5cd252ff9516
Author: Ken Murchison <murch@fastmail.com>
Date:   Tue Apr 17 18:07:51 2018 -0400

    http_jmap.c: fix uninitialized varible warning

diff --git a/imap/http_jmap.c b/imap/http_jmap.c
index 4fb21dcb0..d9d614c2c 100644
--- a/imap/http_jmap.c
+++ b/imap/http_jmap.c
@@ -1137,12 +1137,7 @@ EXPORTED int jmap_download(struct transaction_t *txn)
 
     const char *name = slash + 1;
 
-    /* now we're allocating memory, so don't return from here! */
-
-    char *inboxname = mboxname_user_mbox(httpd_userid, NULL);
     char *accountid = xstrndup(userid, strchr(userid, '/') - userid);
-    char *blobid = NULL;
-    char *ctype = NULL;
     int res = 0;
 
     struct conversations_state *cstate = NULL;
@@ -1150,9 +1145,16 @@ EXPORTED int jmap_download(struct transaction_t *txn)
     if (r) {
         txn->error.desc = error_message(r);
         res = (r == IMAP_MAILBOX_BADNAME) ? HTTP_NOT_FOUND : HTTP_SERVER_ERROR;
-        goto done;
+        free(accountid);
+        return res;
     }
 
+    /* now we're allocating memory, so don't return from here! */
+
+    char *inboxname = mboxname_user_mbox(httpd_userid, NULL);
+    char *blobid = NULL;
+    char *ctype = NULL;
+
     struct jmap_req req;
     req.userid = httpd_userid;
     req.accountid = accountid;

