commit ac34dd052400b1e63aa8e711a13c0670943296fd
Author: Maciej W. Rozycki <macro@linux-mips.org>
Date:   Sun Jan 8 01:04:50 2006 -0800

    [PATCH] fs/smbfs/proc.c: fix data corruption in smb_proc_setattr_unix()
    
    This patch fixes a data corruption in smb_proc_setattr_unix()
    (smb_filetype_from_mode() returns an u32, and there are only four bytes
    reserved for it in data.
    
    Signed-off-by: Adrian Bunk <bunk@stusta.de>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

diff --git a/fs/smbfs/proc.c b/fs/smbfs/proc.c
index 38ab558835c4..d6baec0f24ad 100644
--- a/fs/smbfs/proc.c
+++ b/fs/smbfs/proc.c
@@ -3113,7 +3113,7 @@ smb_proc_setattr_unix(struct dentry *d, struct iattr *attr,
 	LSET(data, 32, SMB_TIME_NO_CHANGE);
 	LSET(data, 40, SMB_UID_NO_CHANGE);
 	LSET(data, 48, SMB_GID_NO_CHANGE);
-	LSET(data, 56, smb_filetype_from_mode(attr->ia_mode));
+	DSET(data, 56, smb_filetype_from_mode(attr->ia_mode));
 	LSET(data, 60, major);
 	LSET(data, 68, minor);
 	LSET(data, 76, 0);

