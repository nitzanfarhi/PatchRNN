commit 4b14e4519031abe6c842cdb017bfa3d206ed8a99
Author: Erik de Castro Lopo <erikd@mega-nerd.com>
Date:   Sun Sep 27 20:15:31 2015 +1000

    src/wav.c: Fix exif parser bug
    
    Parsing malformed exif data could cause the parser to go into an
    infinite loop.
    
    Found using the American Fuzzy Lop fuzzer.

diff --git a/src/wav.c b/src/wav.c
index 5427d165..1d396add 100644
--- a/src/wav.c
+++ b/src/wav.c
@@ -2000,6 +2000,8 @@ exif_subchunk_parse (SF_PRIVATE *psf, uint32_t length)
 			case olym_MARKER :
 				bytesread += psf_binheader_readf (psf, "4", &dword) ;
 				psf_log_printf (psf, "%M : %u\n", marker, dword) ;
+				if (bytesread + dword > length)
+					break ;
 				dword += (dword & 1) ;
 				bytesread += psf_binheader_readf (psf, "j", dword) ;
 				break ;

