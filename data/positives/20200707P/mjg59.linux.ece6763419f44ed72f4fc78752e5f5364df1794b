commit ece6763419f44ed72f4fc78752e5f5364df1794b
Author: Julia Lawall <julia@diku.dk>
Date:   Thu May 29 15:04:38 2008 +0200

    PCI: eliminate double kfree in intel-iommu initialization
    
    The destination of goto error also does a kfree(g_iommus), so it is not
    correct to do one here.
    
    This was found using Coccinelle (http://www.emn.fr/x-info/coccinelle/).
    
    Signed-off-by: Julia Lawall <julia@diku.dk>
    Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>

diff --git a/drivers/pci/intel-iommu.c b/drivers/pci/intel-iommu.c
index 66c0fd21894b..4f05d91a0fd8 100644
--- a/drivers/pci/intel-iommu.c
+++ b/drivers/pci/intel-iommu.c
@@ -1725,7 +1725,6 @@ int __init init_dmars(void)
 	deferred_flush = kzalloc(g_num_of_iommus *
 		sizeof(struct deferred_flush_tables), GFP_KERNEL);
 	if (!deferred_flush) {
-		kfree(g_iommus);
 		ret = -ENOMEM;
 		goto error;
 	}

