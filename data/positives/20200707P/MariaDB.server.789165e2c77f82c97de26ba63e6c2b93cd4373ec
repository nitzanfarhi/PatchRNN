commit 789165e2c77f82c97de26ba63e6c2b93cd4373ec
Author: marko <>
Date:   Wed Nov 7 08:44:07 2007 +0000

    branches/zip: Deny non-superuser access to the INFORMATION_SCHEMA
    tables INNODB_ZIP and INNODB_ZIP_RESET.

diff --git a/handler/i_s.cc b/handler/i_s.cc
index f0458b0bd8f..7729a615195 100644
--- a/handler/i_s.cc
+++ b/handler/i_s.cc
@@ -957,6 +957,12 @@ i_s_zip_fill_low(
 
 	DBUG_ENTER("i_s_zip_fill_low");
 
+	/* deny access to non-superusers */
+	if (check_global_access(thd, SUPER_ACL)) {
+
+		DBUG_RETURN(0);
+	}
+
 	/* Determine log2(PAGE_ZIP_MIN_SIZE / 2 / BUF_BUDDY_LOW). */
 	for (uint r = PAGE_ZIP_MIN_SIZE / 2 / BUF_BUDDY_LOW; r >>= 1; y++);
 

