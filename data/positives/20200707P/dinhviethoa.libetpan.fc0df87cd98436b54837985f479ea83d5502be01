commit fc0df87cd98436b54837985f479ea83d5502be01
Author: DINH Viet Hoa <hoa@etpan.org>
Date:   Wed Nov 23 15:48:06 2011 +0100

    fixed memory leak

diff --git a/src/data-types/charconv.c b/src/data-types/charconv.c
index 6ffa304..161f493 100644
--- a/src/data-types/charconv.c
+++ b/src/data-types/charconv.c
@@ -275,7 +275,13 @@ int charconv_buffer(const char * tocode, const char * fromcode,
 						*result_len = result_length;
 					}
 				}
+                else {
+                    mmap_string_free(mmapstr);
+                }
 			}
+            else {
+                mmap_string_free(mmapstr);
+            }
 			return res;
 		}
 		/* else, let's try with iconv, if available */

