commit 1ed8d7b53842d825ada15dd3f295c6f9e76fc402
Author: Victor Julien <victor@inliniac.net>
Date:   Fri Jun 19 12:50:05 2015 +0200

    detect analizer: fix minor coverity warning
    
    ** CID 1298889:  Integer handling issues  (NEGATIVE_RETURNS)
    /src/detect-engine-analyzer.c: 102 in EngineAnalysisFP()

diff --git a/src/detect-engine-analyzer.c b/src/detect-engine-analyzer.c
index 291e560b..e6c69b08 100644
--- a/src/detect-engine-analyzer.c
+++ b/src/detect-engine-analyzer.c
@@ -54,6 +54,9 @@ static FpPatternStats fp_pattern_stats[DETECT_SM_LIST_MAX];
 
 static void FpPatternStatsAdd(int list, uint16_t patlen)
 {
+    if (list < 0 || list >= DETECT_SM_LIST_MAX)
+        return;
+
     FpPatternStats *f = &fp_pattern_stats[list];
 
     if (f->min == 0)

