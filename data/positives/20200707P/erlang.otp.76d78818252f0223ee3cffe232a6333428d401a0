commit 76d78818252f0223ee3cffe232a6333428d401a0
Author: DÃ¡niel Szoboszlay <daniel.szoboszlay@klarna.com>
Date:   Wed Oct 14 15:45:32 2015 +0200

    Check the result of EC_GROUP_new_curve_* calls
    
    The FIPS-enabled OpenSSL on RHEL disallows the use of < 256 bit prime
    fields (like secp128r1 or secp160k1), and the EC_GROUP_new_cuve_GFp
    call would return a NULL pointer for such fields. Not checking for
    this failure could result in a segfault in the NIF code.

diff --git a/lib/crypto/c_src/crypto.c b/lib/crypto/c_src/crypto.c
index 3c73c318ed..4966701e41 100644
--- a/lib/crypto/c_src/crypto.c
+++ b/lib/crypto/c_src/crypto.c
@@ -3569,6 +3569,9 @@ static EC_KEY* ec_key_new(ErlNifEnv* env, ERL_NIF_TERM curve_arg)
 	} else
 	    goto out_err;
 
+        if (!group)
+            goto out_err;
+
 	if (enif_inspect_binary(env, prime[2], &seed)) {
 	    EC_GROUP_set_seed(group, seed.data, seed.size);
 	}

