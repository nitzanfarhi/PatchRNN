commit 1e3e981ad576eeb47ca1ca1743ff3b3d39e576a4
Author: Kumar Amit Mehta <gmate.amit@gmail.com>
Date:   Mon Jan 26 17:52:22 2015 +0100

    staging: lustre: lustre: obdclass: obd_mount.c: Fix NULL dereference
    
    OBD_ALLOC_PTR(uuid) invokes kmalloc, which may return NULL. This fix
    adds a check before dereferencing such pointer.
    
    Signed-off-by: Kumar Amit Mehta <gmate.amit@gmail.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

diff --git a/drivers/staging/lustre/lustre/obdclass/obd_mount.c b/drivers/staging/lustre/lustre/obdclass/obd_mount.c
index 4f39cdee1b5c..3c0c9109cefd 100644
--- a/drivers/staging/lustre/lustre/obdclass/obd_mount.c
+++ b/drivers/staging/lustre/lustre/obdclass/obd_mount.c
@@ -376,6 +376,11 @@ int lustre_start_mgc(struct super_block *sb)
 
 	/* Random uuid for MGC allows easier reconnects */
 	OBD_ALLOC_PTR(uuid);
+	if (!uuid) {
+		rc = -ENOMEM;
+		goto out_free;
+	}
+
 	ll_generate_random_uuid(uuidc);
 	class_uuid_unparse(uuidc, uuid);
 

