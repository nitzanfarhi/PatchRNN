commit f9e6fac357a42cdcc1b838582825aedad7c920e4
Author: Ben Laurie <ben@openssl.org>
Date:   Sun Jan 17 14:19:31 1999 +0000

    Oops. Missing NULL frees.

diff --git a/crypto/lhash/lhash.c b/crypto/lhash/lhash.c
index c8c29a8d30..73d5fdc45e 100644
--- a/crypto/lhash/lhash.c
+++ b/crypto/lhash/lhash.c
@@ -176,6 +176,9 @@ LHASH *lh;
 	unsigned int i;
 	LHASH_NODE *n,*nn;
 
+	if(lh == NULL)
+	    return;
+
 	for (i=0; i<lh->num_nodes; i++)
 		{
 		n=lh->b[i];
diff --git a/crypto/objects/o_names.c b/crypto/objects/o_names.c
index 8995869587..a3b05d2dee 100644
--- a/crypto/objects/o_names.c
+++ b/crypto/objects/o_names.c
@@ -219,6 +219,9 @@ static int free_type;
 static void names_lh_free(onp,type)
 OBJ_NAME *onp;
 	{
+	if(onp == NULL)
+	    return;
+
 	if ((free_type < 0) || (free_type == onp->type))
 		{
 		OBJ_NAME_remove(onp->name,onp->type);

