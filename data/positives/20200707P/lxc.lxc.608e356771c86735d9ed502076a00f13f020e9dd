commit 608e356771c86735d9ed502076a00f13f020e9dd
Author: Serge Hallyn <serge.hallyn@ubuntu.com>
Date:   Fri Sep 4 13:15:13 2015 -0500

    coverity: fix mount_entry_create_dir_file
    
    First, fix use of uninitialized variable 'ret'.  Then, actually use
    the value it returned in its caller.
    
    Signed-off-by: Serge Hallyn <serge.hallyn@ubuntu.com>

diff --git a/src/lxc/conf.c b/src/lxc/conf.c
index c1236b4f..6bc9ecb4 100644
--- a/src/lxc/conf.c
+++ b/src/lxc/conf.c
@@ -1808,7 +1808,7 @@ static int mount_entry_create_dir_file(const struct mntent *mntent,
 				       const char* path)
 {
 	char *pathdirname = NULL;
-	int ret;
+	int ret = 0;
 	FILE *pathfile = NULL;
 
 	if (hasmntopt(mntent, "create=dir")) {
@@ -1846,6 +1846,12 @@ static inline int mount_entry_on_generic(struct mntent *mntent,
 
 	ret = mount_entry_create_dir_file(mntent, path);
 
+	if (ret < 0)
+		return optional ? 0 : -1;
+
+	if (ret < 0 && !optional)
+		return -1;
+
 	cull_mntent_opt(mntent);
 
 	if (parse_mntopts(mntent->mnt_opts, &mntflags, &mntdata) < 0) {

