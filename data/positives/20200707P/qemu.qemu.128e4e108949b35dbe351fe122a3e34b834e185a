commit 128e4e108949b35dbe351fe122a3e34b834e185a
Author: Marc-André Lureau <marcandre.lureau@redhat.com>
Date:   Tue Feb 21 18:14:51 2017 +0400

    migration: fix id leak regression
    
    This leak was introduced in commit
    581f08bac22bdd5e081ae07f68071a0fc3c5c2c7.
    
    (it stands out quickly with ASAN once the rest of the leaks are also
    removed from make check with this series)
    
    Cc: Dr. David Alan Gilbert <dgilbert@redhat.com>
    Cc: Juan Quintela <quintela@redhat.com>
    Signed-off-by: Marc-André Lureau <marcandre.lureau@redhat.com>
    Message-Id: <20170221141451.28305-31-marcandre.lureau@redhat.com>
    Reviewed-by: Dr. David Alan Gilbert <dgilbert@redhat.com>
    Signed-off-by: Dr. David Alan Gilbert <dgilbert@redhat.com>

diff --git a/migration/savevm.c b/migration/savevm.c
index 5ecd264134..87c7a00832 100644
--- a/migration/savevm.c
+++ b/migration/savevm.c
@@ -688,6 +688,7 @@ int vmstate_register_with_alias_id(DeviceState *dev, int instance_id,
 
                 return -1;
             }
+            g_free(id);
 
             se->compat = g_new0(CompatEntry, 1);
             pstrcpy(se->compat->idstr, sizeof(se->compat->idstr), vmsd->name);

