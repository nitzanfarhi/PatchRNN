commit 7c063c725987406d743cc7de7625ff224fab75de
Author: Jesse Barnes <jbarnes@virtuousgeek.org>
Date:   Tue Nov 26 09:13:41 2013 -0800

    drm/i915: take mode config lock around crtc disable at suspend
    
    This is just a theoretical issue, but we need to do this to prevent the
    WARN in pipe_from_connector at suspend time.
    
    This regression has been introduce in
    
    commit 7bd688cd66db93f6430f6e2b3145ee5686daa315
    Author: Jani Nikula <jani.nikula@intel.com>
    Date:   Fri Nov 8 16:48:56 2013 +0200
    
        drm/i915: handle backlight through chip specific functions
    
    https://bugs.freedesktop.org/show_bug.cgi?id=71978
    Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
    Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>

diff --git a/drivers/gpu/drm/i915/i915_drv.c b/drivers/gpu/drm/i915/i915_drv.c
index 989be12cdd6e..2e367a1c6a64 100644
--- a/drivers/gpu/drm/i915/i915_drv.c
+++ b/drivers/gpu/drm/i915/i915_drv.c
@@ -534,8 +534,10 @@ static int i915_drm_freeze(struct drm_device *dev)
 		 * Disable CRTCs directly since we want to preserve sw state
 		 * for _thaw.
 		 */
+		mutex_lock(&dev->mode_config.mutex);
 		list_for_each_entry(crtc, &dev->mode_config.crtc_list, head)
 			dev_priv->display.crtc_disable(crtc);
+		mutex_unlock(&dev->mode_config.mutex);
 
 		intel_modeset_suspend_hw(dev);
 	}

