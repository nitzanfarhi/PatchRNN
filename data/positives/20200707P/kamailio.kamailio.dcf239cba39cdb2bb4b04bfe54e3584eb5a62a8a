commit dcf239cba39cdb2bb4b04bfe54e3584eb5a62a8a
Author: Henning Westerholt <henning.westerholt@1und1.de>
Date:   Wed Sep 17 15:33:42 2008 +0000

    - fix memory leak if 'dest_avp' is set, and set AVP failed, the branch 1.3
      don't have this error
    
    
    git-svn-id: https://openser.svn.sourceforge.net/svnroot/openser/trunk@4942 689a6050-402a-0410-94f2-e92a70836424

diff --git a/modules_k/carrierroute/route_func.c b/modules_k/carrierroute/route_func.c
index 4eeb03195..deffd133f 100644
--- a/modules_k/carrierroute/route_func.c
+++ b/modules_k/carrierroute/route_func.c
@@ -426,6 +426,7 @@ static int actually_rewrite(const struct route_rule *rs, str *dest,
 		avp_val.s = rs->host;
 		if (add_avp(AVP_VAL_STR | dstavp->u.a.flags, dstavp->u.a.name, avp_val)<0) {
 			LM_ERR("set AVP failed\n");
+			pkg_free(dest->s);
 			return -1;
 		}
 	}

