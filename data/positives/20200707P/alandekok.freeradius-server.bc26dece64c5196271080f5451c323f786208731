commit bc26dece64c5196271080f5451c323f786208731
Author: Alan T. DeKok <aland@freeradius.org>
Date:   Tue May 26 15:00:41 2009 +0200

    Don't walk over empty trees

diff --git a/src/lib/rbtree.c b/src/lib/rbtree.c
index 365423c55..3a5a7ca22 100644
--- a/src/lib/rbtree.c
+++ b/src/lib/rbtree.c
@@ -587,6 +587,8 @@ static int WalkNodePostOrder(rbnode_t *X,
 int rbtree_walk(rbtree_t *tree, RBTREE_ORDER order,
 		int (*callback)(void *, void *), void *context)
 {
+	if (tree->Root == NIL) return 0;
+
 	switch (order) {
 	case PreOrder:
 		return WalkNodePreOrder(tree->Root, callback, context);

