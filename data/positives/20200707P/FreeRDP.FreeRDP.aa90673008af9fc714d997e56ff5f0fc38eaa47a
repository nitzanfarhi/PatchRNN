commit aa90673008af9fc714d997e56ff5f0fc38eaa47a
Author: Armin Novak <armin.novak@thincast.com>
Date:   Thu Jan 14 15:55:25 2016 +0100

    Fixed memory leak on cleanup.

diff --git a/channels/rdpdr/client/rdpdr_main.c b/channels/rdpdr/client/rdpdr_main.c
index 24f228e12..30bd2681d 100644
--- a/channels/rdpdr/client/rdpdr_main.c
+++ b/channels/rdpdr/client/rdpdr_main.c
@@ -413,6 +413,8 @@ static UINT handle_hotplug(rdpdrPlugin* rdpdr)
 				dev_array[size].path = word;
 				dev_array[size++].to_add = TRUE;
 			}
+			else
+				free (word);
 		}
 		free(line);
 	}
@@ -502,7 +504,7 @@ static UINT handle_hotplug(rdpdrPlugin* rdpdr)
 
 cleanup:
 	for (i = 0; i < size; i++)
-		free (dev_array[size].path);
+		free (dev_array[i].path);
 
 	return error ? error : rdpdr_send_device_list_announce_request(rdpdr, TRUE);
 }

