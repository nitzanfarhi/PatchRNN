commit 91794daed0469304ce2a023a93476da17c891e41
Author: Felipe Pena <felipe@php.net>
Date:   Sun May 10 01:00:15 2009 +0000

    - Fixed memory leak (patch by Christian Weiske)

diff --git a/ext/sockets/sockets.c b/ext/sockets/sockets.c
index cdb212f11f..5d9f661404 100644
--- a/ext/sockets/sockets.c
+++ b/ext/sockets/sockets.c
@@ -1553,6 +1553,7 @@ PHP_FUNCTION(socket_recvfrom)
 			sin.sin_family = AF_INET;
 
 			if (arg6 == NULL) {
+				efree(recv_buf);
 				WRONG_PARAM_COUNT;
 			}
 
@@ -1581,6 +1582,7 @@ PHP_FUNCTION(socket_recvfrom)
 			sin6.sin6_family = AF_INET6;
 
 			if (arg6 == NULL) {
+				efree(recv_buf);
 				WRONG_PARAM_COUNT;
 			}
 

