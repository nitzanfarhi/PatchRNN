commit 126b67b8d26f6623d199aa59279f2e3243f2144c
Author: Doug Thompson <dougthompson@xmission.com>
Date:   Mon Aug 3 12:37:06 2009 +0200

    amd64_edac: fix ECC checking
    
    On the good path of BIOS enabled ECC and no override, the value returned
    is 1 by omission and thus is deemed failing by the probe-function.
    
    Allow proper module initialization by clearing the retval explicitly.
    
    Signed-off-by: Doug Thompson <dougthompson@xmission.com>
    Signed-off-by: Borislav Petkov <borislav.petkov@amd.com>

diff --git a/drivers/edac/amd64_edac.c b/drivers/edac/amd64_edac.c
index 24964c1d0af9..5fa924d61b10 100644
--- a/drivers/edac/amd64_edac.c
+++ b/drivers/edac/amd64_edac.c
@@ -2977,6 +2977,9 @@ static int amd64_check_ecc_enabled(struct amd64_pvt *pvt)
 			"ECC is enabled by BIOS, Proceeding "
 			"with EDAC module initialization\n");
 
+		/* Signal good ECC status */
+		ret = 0;
+
 		/* CLEAR the override, since BIOS controlled it */
 		ecc_enable_override = 0;
 	}

