commit afcf447499feb1d172879f6836e3c325e6ca9c05
Author: Erik de Castro Lopo <erikd@mega-nerd.com>
Date:   Sun Apr 24 07:30:41 2016 +1000

    src/wavlike.c: Prevent infinite loop on malformed file
    
    Found using American Fuzzy Lop.

diff --git a/src/wavlike.c b/src/wavlike.c
index 2b7c2f6f..3e980b3c 100644
--- a/src/wavlike.c
+++ b/src/wavlike.c
@@ -939,7 +939,8 @@ wavlike_subchunk_parse (SF_PRIVATE *psf, int chunk, uint32_t chunk_length)
 
 			case exif_MARKER :
 					psf_log_printf (psf, "  %M\n", chunk) ;
-					bytesread += exif_subchunk_parse (psf, chunk_length - bytesread) ;
+					if (chunk_length > bytesread)
+						bytesread += exif_subchunk_parse (psf, chunk_length - bytesread) ;
 					continue ;
 
 			case data_MARKER :

