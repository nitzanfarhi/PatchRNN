commit 943a5941f5ab479803fb30e19e9fa607f0f0fe14
Author: Daniel-Constantin Mierla <miconda@gmail.com>
Date:   Wed Dec 11 09:49:52 2013 +0100

    core: safety check for double free in q_malloc as in f_malloc

diff --git a/mem/q_malloc.c b/mem/q_malloc.c
index 50acab919..8c36d03b1 100644
--- a/mem/q_malloc.c
+++ b/mem/q_malloc.c
@@ -473,6 +473,12 @@ void qm_free(struct qm_block* qm, void* p)
 	MDBG("qm_free: freeing frag. %p alloc'ed from %s: %s(%ld)\n",
 			f, f->file, f->func, f->line);
 #endif
+	if (unlikely(f->u.is_free)){
+		LM_INFO("freeing a free fragment (%p/%p) - ignore\n",
+				f, p);
+		return;
+	}
+
 	size=f->size;
 	qm->used-=size;
 	qm->real_used-=size;

