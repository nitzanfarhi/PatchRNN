commit 46c9d53fd3b8e3807a0403d3021040387f0e2728
Author: Andrew Beekhof <andrew@beekhof.net>
Date:   Thu Jul 24 13:24:07 2008 +0200

    Medium: ais: Avoid double-free in error path
    
    Mercurial revision: 2996d63797ac8884f175ef633c5bb6f5a2b4c2fb

diff --git a/lib/crm/common/ais.c b/lib/crm/common/ais.c
index 22f8c70d8..ace88870c 100644
--- a/lib/crm/common/ais.c
+++ b/lib/crm/common/ais.c
@@ -84,7 +84,7 @@ char *get_ais_data(AIS_Message *msg)
 
 #if SUPPORT_AIS
 int ais_fd_sync = -1;
-static int ais_fd_async = -1; /* never send messages via this channel */
+int ais_fd_async = -1; /* never send messages via this channel */
 GFDSource *ais_source = NULL;
 GFDSource *ais_source_sync = NULL;
 
@@ -315,7 +315,6 @@ static gboolean ais_dispatch(int sender, gpointer user_data)
 
 	if(rc != BZ_OK) {
 	    crm_err("Decompression failed: %d", rc);
-	    crm_free(uncompressed);
 	    goto badmsg;
 	}
 	

