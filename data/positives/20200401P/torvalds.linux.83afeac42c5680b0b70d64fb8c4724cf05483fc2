commit 83afeac42c5680b0b70d64fb8c4724cf05483fc2
Author: Jim Meyering <meyering@redhat.com>
Date:   Wed Oct 1 19:09:51 2008 -0400

    Btrfs: disk-io.c (open_ctree): avoid leaks upon allocation failure
    
    Signed-off-by: Chris Mason <chris.mason@oracle.com>

diff --git a/fs/btrfs/disk-io.c b/fs/btrfs/disk-io.c
index 41b7d24d07e2..0be044bb6194 100644
--- a/fs/btrfs/disk-io.c
+++ b/fs/btrfs/disk-io.c
@@ -1699,6 +1699,8 @@ struct btrfs_root *open_ctree(struct super_block *sb,
 	kfree(tree_root);
 	bdi_destroy(&fs_info->bdi);
 	kfree(fs_info);
+	kfree(chunk_root);
+	kfree(dev_root);
 	return ERR_PTR(err);
 }
 

