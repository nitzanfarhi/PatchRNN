commit cf08cff8a1c2ac698ed75077c0728d564f629e52
Author: ruslanvaliullin <r.valiullin77@gmail.com>
Date:   Wed Jun 7 21:34:44 2017 +0300

    Add mbuf_append result check
    
    PUBLISHED_FROM=967a7ff3684e548ddbfe92365f7718a99e14d098

diff --git a/mongoose/mongoose.c b/mongoose/mongoose.c
index f69d0010..9dbc4943 100644
--- a/mongoose/mongoose.c
+++ b/mongoose/mongoose.c
@@ -11618,7 +11618,7 @@ uint32_t mg_coap_compose(struct mg_coap_message *cm, struct mbuf *io) {
 
   /* saving previous lenght to handle non-empty mbuf */
   prev_io_len = io->len;
-  mbuf_append(io, NULL, packet_size);
+  if (mbuf_append(io, NULL, packet_size) == 0) return MG_COAP_ERROR;
   ptr = io->buf + prev_io_len;
 
   /*

