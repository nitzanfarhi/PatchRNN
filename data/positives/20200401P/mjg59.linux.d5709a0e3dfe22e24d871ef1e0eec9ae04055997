commit d5709a0e3dfe22e24d871ef1e0eec9ae04055997
Author: figo.zhang <figo.zhang@kolorific.com>
Date:   Thu May 7 23:31:02 2009 -0300

    V4L/DVB (11990): saa7134-video.c: fix the block bug
    
    when re-open or re-start (video_streamon), the q->curr would not be NULL in saa7134_buffer_queue(),
    and all the qbuf will add to q->queue list,no one to do activate to start DMA,and then no interrupt
    would happened,so it will be block.
    
    In VIDEOBUF_NEEDS_INIT state, initialize the curr pointer to be NULL in the buffer_prepare().
    
    Signed-off-by: Figo.zhang <figo.zhang@kolorific.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>

diff --git a/drivers/media/video/saa7134/saa7134-video.c b/drivers/media/video/saa7134/saa7134-video.c
index ceae3c88f93e..e305c1674cee 100644
--- a/drivers/media/video/saa7134/saa7134-video.c
+++ b/drivers/media/video/saa7134/saa7134-video.c
@@ -1057,6 +1057,7 @@ static int buffer_prepare(struct videobuf_queue *q,
 		buf->vb.field  = field;
 		buf->fmt       = fh->fmt;
 		buf->pt        = &fh->pt_cap;
+		dev->video_q.curr = NULL;
 
 		err = videobuf_iolock(q,&buf->vb,&dev->ovbuf);
 		if (err)

