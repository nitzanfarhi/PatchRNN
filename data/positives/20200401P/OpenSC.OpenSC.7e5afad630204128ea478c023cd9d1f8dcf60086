commit 7e5afad630204128ea478c023cd9d1f8dcf60086
Author: Frank Morgner <frankmorgner@gmail.com>
Date:   Tue Jun 6 00:41:26 2017 +0200

    fixed bad memory access

diff --git a/src/libopensc/card-entersafe.c b/src/libopensc/card-entersafe.c
index abc8008d..9db0664e 100644
--- a/src/libopensc/card-entersafe.c
+++ b/src/libopensc/card-entersafe.c
@@ -503,7 +503,7 @@ static int entersafe_select_fid(sc_card_t *card,
 	path.len=2;
 
 	r = iso_ops->select_file(card,&path,&file);
-	if (r)
+	if (r < 0)
 		sc_file_free(file);
 	SC_TEST_RET(card->ctx, SC_LOG_DEBUG_NORMAL, r, "APDU transmit failed");
 
@@ -514,7 +514,7 @@ static int entersafe_select_fid(sc_card_t *card,
 		 card->cache.current_path.value[1] = 0x00;
 		 if (id_hi == 0x3f && id_lo == 0x00){
 			  card->cache.current_path.len = 2;
-		 }else{
+		 } else {
 			  card->cache.current_path.len = 4;
 			  card->cache.current_path.value[2] = id_hi;
 			  card->cache.current_path.value[3] = id_lo;

