commit 2c9dfdacc5a9f4db941c8f80597abae4658954ac
Author: Greg Kurz <groug@kaod.org>
Date:   Tue Jun 12 19:01:26 2018 +0200

    spapr: fix leak in h_client_architecture_support()
    
    If the negotiated compat mode can't be set, but raw mode is supported,
    we decide to ignore the error. An so, we should free it to prevent a
    memory leak.
    
    Signed-off-by: Greg Kurz <groug@kaod.org>
    Reviewed-by: Philippe Mathieu-Daud√© <f4bug@amsat.org>
    Signed-off-by: David Gibson <david@gibson.dropbear.id.au>

diff --git a/hw/ppc/spapr_hcall.c b/hw/ppc/spapr_hcall.c
index 022f6d8101..8b9a4b577f 100644
--- a/hw/ppc/spapr_hcall.c
+++ b/hw/ppc/spapr_hcall.c
@@ -1547,6 +1547,7 @@ static target_ulong h_client_architecture_support(PowerPCCPU *cpu,
                 error_report_err(local_err);
                 return H_HARDWARE;
             }
+            error_free(local_err);
             local_err = NULL;
         }
     }

