commit 5e03b4e3427e1c49241f14fa51daea82aa0acb2b
Author: Dario Lombardo <lomato@gmail.com>
Date:   Wed Feb 28 18:47:48 2018 +0100

    dot11decrypt: free memory on exit (found by clang).
    
    Change-Id: I1af895accdd52fe64fc156905c549e719aaba304
    Reviewed-on: https://code.wireshark.org/review/26182
    Petri-Dish: Dario Lombardo <lomato@gmail.com>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Michael Mann <mmann78@netscape.net>

diff --git a/epan/crypt/dot11decrypt.c b/epan/crypt/dot11decrypt.c
index a9a0f81d1b..eb1444df20 100644
--- a/epan/crypt/dot11decrypt.c
+++ b/epan/crypt/dot11decrypt.c
@@ -385,10 +385,12 @@ Dot11DecryptDecryptWPABroadcastKey(const EAPOL_RSN_KEY *pEAPKey, guint8 *decrypt
         DEBUG_DUMP("FullDecrKey:", new_key, 32);
 
         if (gcry_cipher_open (&rc4_handle, GCRY_CIPHER_ARCFOUR, GCRY_CIPHER_MODE_STREAM, 0)) {
+          g_free(szEncryptedKey);
           return DOT11DECRYPT_RET_NO_VALID_HANDSHAKE;
         }
         if (gcry_cipher_setkey(rc4_handle, new_key, sizeof(new_key))) {
           gcry_cipher_close(rc4_handle);
+          g_free(szEncryptedKey);
           return DOT11DECRYPT_RET_NO_VALID_HANDSHAKE;
         }
 

