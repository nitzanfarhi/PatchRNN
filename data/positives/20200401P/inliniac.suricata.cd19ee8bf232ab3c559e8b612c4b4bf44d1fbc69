commit cd19ee8bf232ab3c559e8b612c4b4bf44d1fbc69
Author: Victor Julien <victor@inliniac.net>
Date:   Wed Aug 6 22:27:49 2008 +0200

    Fix crash when to_client traffic was scanned for uricontent when there was no uri available...

diff --git a/src/detect-uricontent.c b/src/detect-uricontent.c
index da830c16..161fa9f8 100644
--- a/src/detect-uricontent.c
+++ b/src/detect-uricontent.c
@@ -227,7 +227,11 @@ int DetectUricontentMatch (ThreadVars *t, PatternMatcherThread *pmt, Packet *p,
     u_int8_t instance = pmt->mpm_instance + MPM_INSTANCE_URIOFFSET;
     //printf("instance %u\n", instance);
 
-    //printf("scanning uricontent have %u scan %u\n", t->de_have_httpuri, t->de_scanned_httpuri);
+    //printf("scanning uricontent have %u scan %u\n", pmt->de_have_httpuri, pmt->de_scanned_httpuri);
+
+    /* if we don't have a uri, don't bother scanning */
+    if (pmt->de_have_httpuri == 0)
+        return 0;
 
     if (pmt->de_have_httpuri == 1 && pmt->de_scanned_httpuri == 0) {
         /* Scan http uri now */

