commit dc95384e2752b1f1d5301acb5717d6ea5b7f8bde
Author: Arran Cudbard-Bell <a.cudbardb@freeradius.org>
Date:   Mon Sep 17 13:42:51 2012 +0100

    Add bounds check for max_queue_size

diff --git a/src/main/threads.c b/src/main/threads.c
index 20ba6b64b..6b892b10e 100644
--- a/src/main/threads.c
+++ b/src/main/threads.c
@@ -894,6 +894,10 @@ int thread_pool_init(CONF_SECTION *cs, int *spawn_flag)
 		thread_pool.max_spare_threads = thread_pool.min_spare_threads;
 	if (thread_pool.max_threads == 0)
 		thread_pool.max_threads = 256;
+	if ((thread_pool.max_queue_size < 2) || (thread_pool.max_queue_size > 1048576)) {
+		radlog(L_ERR, "FATAL: max_queue_size value must be in range 2-1048576");
+		return -1;
+	}
 #endif	/* WITH_GCD */
 
 	/*

