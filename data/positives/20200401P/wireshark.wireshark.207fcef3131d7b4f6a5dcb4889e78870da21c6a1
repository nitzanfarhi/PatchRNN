commit 207fcef3131d7b4f6a5dcb4889e78870da21c6a1
Author: Gerald Combs <gerald@wireshark.org>
Date:   Mon Apr 18 18:57:37 2005 +0000

    From Peter Johansson: Make sure a pointer isn't NULL before we try to use it.
    
    svn path=/trunk/; revision=14129

diff --git a/epan/dissectors/packet-smb-mailslot.c b/epan/dissectors/packet-smb-mailslot.c
index 1fe72fc44e..3dc01cb582 100644
--- a/epan/dissectors/packet-smb-mailslot.c
+++ b/epan/dissectors/packet-smb-mailslot.c
@@ -116,7 +116,7 @@ dissect_mailslot_smb(tvbuff_t *mshdr_tvb, tvbuff_t *setup_tvb,
 	}
 
 	smb_info = pinfo->private_data;
-	if (smb_info->sip != NULL && smb_info->sip->extra_info_type == SMB_EI_TRI)
+	if (smb_info != NULL && smb_info->sip != NULL && smb_info->sip->extra_info_type == SMB_EI_TRI)
 		tri = smb_info->sip->extra_info;
 	else
 		tri = NULL;

