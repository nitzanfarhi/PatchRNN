commit 765ff94b5be90bc33eb8eba3fdfe3e910124450d
Author: James McCoy <jamessan@jamessan.com>
Date:   Mon Dec 18 14:56:49 2017 -0500

    vim-patch:8.0.0584: memory leak when executing quickfix tests
    
    Problem:    Memory leak when executing quickfix tests.
    Solution:   Free the list reference. (Yegappan Lakshmanan)
    
    https://github.com/vim/vim/commit/d788f6fe89c77262c474de323f5dab6d1c814e27

diff --git a/src/nvim/quickfix.c b/src/nvim/quickfix.c
index 9a4341f3a..73ad14ab2 100644
--- a/src/nvim/quickfix.c
+++ b/src/nvim/quickfix.c
@@ -4313,6 +4313,10 @@ static void qf_free_stack(win_T *wp, qf_info_T *qi)
     // If the location list window is open, then create a new empty location
     // list
     qf_info_T *new_ll = ll_new_list();
+
+    // first free the list reference in the location list window
+    ll_free_all(&orig_wp->w_llist_ref);
+
     orig_wp->w_llist_ref = new_ll;
     if (llwin != NULL) {
       llwin->w_llist = new_ll;

