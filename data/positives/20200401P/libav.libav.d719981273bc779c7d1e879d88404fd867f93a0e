commit d719981273bc779c7d1e879d88404fd867f93a0e
Author: Martin Storsjö <martin@martin.st>
Date:   Tue Sep 3 13:53:23 2013 +0300

    4xm: Check that the read track value is non-negative
    
    Reported-by: Mateusz "j00ru" Jurczyk and Gynvael Coldwind
    CC: libav-stable@libav.org
    Signed-off-by: Martin Storsjö <martin@martin.st>

diff --git a/libavformat/4xm.c b/libavformat/4xm.c
index f003c9c25..7a87c3695 100644
--- a/libavformat/4xm.c
+++ b/libavformat/4xm.c
@@ -131,6 +131,8 @@ static int parse_strk(AVFormatContext *s,
         return AVERROR_INVALIDDATA;
 
     track = AV_RL32(buf + 8);
+    if (track < 0)
+        return AVERROR_INVALIDDATA;
     if (track + 1 > fourxm->track_count) {
         if (av_reallocp_array(&fourxm->tracks, track + 1, sizeof(AudioTrack)))
             return AVERROR(ENOMEM);

