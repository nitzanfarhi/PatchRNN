commit 3eba4a0e6db9ca225bc0f3042d60fcfc86a30bc8
Author: Eyal Shapira <eyal@wizery.com>
Date:   Mon Mar 19 12:06:27 2012 +0200

    wl12xx: fix a memory leak of probereq template upon recovery
    
    wlvif->probereq is zeroed when adding an interface but
    the skb pointed to isn't freed when the interface is removed.
    This would lead to a mem leak on every recovery.
    Fix it by freeing the skb when removing the interface.
    
    Signed-off-by: Eyal Shapira <eyal@wizery.com>
    Signed-off-by: Luciano Coelho <coelho@ti.com>

diff --git a/drivers/net/wireless/wl12xx/main.c b/drivers/net/wireless/wl12xx/main.c
index e21d21d7de8e..b560f2d2837b 100644
--- a/drivers/net/wireless/wl12xx/main.c
+++ b/drivers/net/wireless/wl12xx/main.c
@@ -2358,6 +2358,8 @@ static void __wl1271_op_remove_interface(struct wl1271 *wl,
 		wl1271_free_ap_keys(wl, wlvif);
 	}
 
+	dev_kfree_skb(wlvif->probereq);
+	wlvif->probereq = NULL;
 	wl12xx_tx_reset_wlvif(wl, wlvif);
 	if (wl->last_wlvif == wlvif)
 		wl->last_wlvif = NULL;

