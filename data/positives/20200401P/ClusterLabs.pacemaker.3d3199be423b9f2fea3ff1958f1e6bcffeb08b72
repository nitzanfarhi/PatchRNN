commit 3d3199be423b9f2fea3ff1958f1e6bcffeb08b72
Author: Andrew Beekhof <andrew@beekhof.net>
Date:   Thu Feb 8 08:50:26 2007 +0100

    cib: Memory leak - Free query matches in update_attr()
    
    Mercurial revision: 8ff455a4a85c81e238c896772d83b8f3f3f128b7

diff --git a/lib/crm/cib/cib_attrs.c b/lib/crm/cib/cib_attrs.c
index f260ec3f1..0d2bba1ad 100644
--- a/lib/crm/cib/cib_attrs.c
+++ b/lib/crm/cib/cib_attrs.c
@@ -233,6 +233,7 @@ update_attr(cib_t *the_cib, int call_options,
 		CRM_CHECK(set_name != NULL, return cib_missing);
 		
 		if(attr_value == NULL) {
+			free_xml(xml_obj);
 			return cib_missing_data;
 		}
 		
@@ -267,6 +268,7 @@ update_attr(cib_t *the_cib, int call_options,
 		xml_obj = create_xml_node(xml_obj, XML_TAG_ATTRS);
 		crm_free(local_set_name);
 	} else {
+		free_xml(xml_obj);
 		xml_obj = NULL;
 	}
 

