commit 2f335a02b3c816e77e7df1d15b12e3bbb8f4c8f0
Author: Frederic Weisbecker <fweisbec@gmail.com>
Date:   Fri Jun 5 19:31:01 2009 +0200

    perf top: Fix zero or negative refresh delay
    
    If perf top is executed with a zero value for the refresh rate,
    we get a division by zero exception while computing samples_per_sec.
    
    Also a zero refresh rate is not possible, neither do we want to
    accept negative values.
    
    [ Impact: fix division by zero in perf top ]
    
    Cc: Peter Zijlstra <a.p.zijlstra@chello.nl>
    Cc: Mike Galbraith <efault@gmx.de>
    Cc: Paul Mackerras <paulus@samba.org>
    Cc: Corey Ashford <cjashfor@linux.vnet.ibm.com>
    Cc: Marcelo Tosatti <mtosatti@redhat.com>
    Cc: Arnaldo Carvalho de Melo <acme@redhat.com>
    Cc: Frederic Weisbecker <fweisbec@gmail.com>
    LKML-Reference: <1244223061-5399-1-git-send-email-fweisbec@gmail.com>
    Signed-off-by: Ingo Molnar <mingo@elte.hu>

diff --git a/Documentation/perf_counter/builtin-top.c b/Documentation/perf_counter/builtin-top.c
index ff7e13c4647c..b2f480b5a134 100644
--- a/Documentation/perf_counter/builtin-top.c
+++ b/Documentation/perf_counter/builtin-top.c
@@ -693,6 +693,9 @@ int cmd_top(int argc, const char **argv, const char *prefix)
 		event_id[0] = 0;
 	}
 
+	if (delay_secs < 1)
+		delay_secs = 1;
+
 	for (counter = 0; counter < nr_counters; counter++) {
 		if (event_count[counter])
 			continue;

