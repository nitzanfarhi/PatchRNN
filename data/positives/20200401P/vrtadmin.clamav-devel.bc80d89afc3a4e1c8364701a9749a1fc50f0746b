commit bc80d89afc3a4e1c8364701a9749a1fc50f0746b
Author: Mickey Sola <msola@sourcefire.com>
Date:   Tue Dec 15 16:12:01 2015 -0500

    bb11442 - adding explicit wwunpack oob checks

diff --git a/libclamav/wwunpack.c b/libclamav/wwunpack.c
index 26bdcbb43..8611cb604 100644
--- a/libclamav/wwunpack.c
+++ b/libclamav/wwunpack.c
@@ -221,6 +221,9 @@ int wwunpack(uint8_t *exe, uint32_t exesz, uint8_t *wwsect, struct cli_exe_secti
   }
 
   if(!error) {
+    if (pe+6 > exesz || pe+7 > exesz || pe+0x28 > exesz ||
+		pe+0x50 > exesz || pe+0x14 > exesz) 
+	return CL_EFORMAT;
     exe[pe+6]=(uint8_t)scount;
     exe[pe+7]=(uint8_t)(scount>>8);
     cli_writeint32(&exe[pe+0x28], cli_readint32(wwsect+0x295)+sects[scount].rva+0x299);

