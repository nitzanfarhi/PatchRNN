commit 92647fc4b9cd7406afb2ee240a20082ba6097177
Author: Tom Lane <tgl@sss.pgh.pa.us>
Date:   Thu Apr 21 19:28:36 2011 -0400

    Avoid possible divide-by-zero in gincostestimate.
    
    Per report from Jeff Janes.

diff --git a/src/backend/utils/adt/selfuncs.c b/src/backend/utils/adt/selfuncs.c
index 4d800f8a00..fa8cecafcb 100644
--- a/src/backend/utils/adt/selfuncs.c
+++ b/src/backend/utils/adt/selfuncs.c
@@ -6458,6 +6458,10 @@ gincostestimate(PG_FUNCTION_ARGS)
 		numDataPages = Min(numDataPages, numPages - numEntryPages);
 	}
 
+	/* In an empty index, numEntries could be zero.  Avoid divide-by-zero */
+	if (numEntries < 1)
+		numEntries = 1;
+
 	/*
 	 * Include predicate in selectivityQuals (should match
 	 * genericcostestimate)

