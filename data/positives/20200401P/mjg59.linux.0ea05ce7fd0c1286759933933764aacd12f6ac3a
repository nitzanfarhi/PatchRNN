commit 0ea05ce7fd0c1286759933933764aacd12f6ac3a
Author: David S. Miller <davem@davemloft.net>
Date:   Sun Sep 12 12:06:00 2010 -0700

    bna: Check for NULL before deref in bnad_cb_tx_cleanup
    
    Reported-by: Jiri Slaby <jirislaby@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/drivers/net/bna/bnad.c b/drivers/net/bna/bnad.c
index 8158fb93cb4c..e380c0e88f4f 100644
--- a/drivers/net/bna/bnad.c
+++ b/drivers/net/bna/bnad.c
@@ -867,11 +867,12 @@ bnad_cb_tx_resume(struct bnad *bnad, struct bna_tcb *tcb)
 static void
 bnad_cb_tx_cleanup(struct bnad *bnad, struct bna_tcb *tcb)
 {
-	struct bnad_unmap_q *unmap_q = tcb->unmap_q;
+	struct bnad_unmap_q *unmap_q;
 
 	if (!tcb || (!tcb->unmap_q))
 		return;
 
+	unmap_q = tcb->unmap_q;
 	if (!unmap_q->unmap_array)
 		return;
 

