commit 0a9734ce429cbe64b942e0052f7a5e7a376b7eac
Author: Moshe Kaplan <me@moshekaplan.com>
Date:   Mon May 12 19:43:51 2014 -0400

    Fix for Issue #333
    
    I added a second check in case `size` is ever changed to being an unsigned variable, such as a `size_t` (which is what I think it should be).

diff --git a/src/utils/cgiProgram.c b/src/utils/cgiProgram.c
index f61d6c531..80c3130ab 100644
--- a/src/utils/cgiProgram.c
+++ b/src/utils/cgiProgram.c
@@ -483,16 +483,25 @@ static int getPostData(char **bufp, size_t *lenp)
 
     if ((contentLength = getenv("CONTENT_LENGTH")) != 0) {
         size = atoi(contentLength);
+        if (size < 0){
+            error("Content-Length must be >= 0, as per RFC2616 Section 14.13");
+            return -1;
+        }
         limit = size;
     } else {
         size = 4096;
         limit = INT_MAX;
     }
-    if ((buf = malloc(size + 1)) == 0) {
+    
+    bufsize = size + 1;
+    if (bufsize == 0){
+            error("bufsize overflowed");
+            return -1;
+    }
+    if ((buf = malloc(bufsize)) == 0) {
         error("Couldn't allocate memory to read post data");
         return -1;
     }
-    bufsize = size + 1;
     len = 0;
 
     while (len < limit) {

