commit 218e0ec030f1183ed8684c9938bb2cb873d51d49
Author: Rainer Gerhards <rgerhards@adiscon.com>
Date:   Sat Feb 20 15:07:28 2016 +0100

    omkafka: fix potential NULL pointer addressing
    
    this happened when the topic cache was full and an entry
    needed to be evicted

diff --git a/plugins/omkafka/omkafka.c b/plugins/omkafka/omkafka.c
index 8666068c2..99bbb4b55 100644
--- a/plugins/omkafka/omkafka.c
+++ b/plugins/omkafka/omkafka.c
@@ -391,7 +391,10 @@ prepareDynTopic(instanceData *__restrict__ const pData, const uchar *__restrict_
 		STATSCOUNTER_INC(ctrCacheEvict, mutCtrCacheEvict);
 		iFirstFree = iOldest; /* this one *is* now free ;) */
 	} else {
-		/* we need to allocate memory for the cache structure */
+		pCache[iFirstFree] = NULL;
+	}
+	/* we need to allocate memory for the cache structure */
+	if(pCache[iFirstFree] == NULL) {
 		CHKmalloc(pCache[iFirstFree] = (dynaTopicCacheEntry*) calloc(1, sizeof(dynaTopicCacheEntry)));
 		CHKiRet(pthread_rwlock_init(&pCache[iFirstFree]->lock, NULL));
 	}

