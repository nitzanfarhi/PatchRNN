commit 55f2291142efa42acab362bf71b52e03bd275a42
Author: Phong Tran <tranmanphong@gmail.com>
Date:   Mon Jun 1 22:19:45 2015 +0700

    greybus: uart: Fix the memory leak in connection init
    
    If alloc minor is error, gb_tty should free.
    
    Signed-off-by: Phong Tran <tranmanphong@gmail.com>
    Reviewed-by: Viresh Kumar <viresh.kumar@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@google.com>

diff --git a/drivers/staging/greybus/uart.c b/drivers/staging/greybus/uart.c
index 47de9698f50c..590bc9f5d0be 100644
--- a/drivers/staging/greybus/uart.c
+++ b/drivers/staging/greybus/uart.c
@@ -618,9 +618,11 @@ static int gb_uart_connection_init(struct gb_connection *connection)
 		if (minor == -ENOSPC) {
 			dev_err(&connection->dev,
 				"no more free minor numbers\n");
-			return -ENODEV;
+			retval = -ENODEV;
+			goto error_version;
 		}
-		return minor;
+		retval = minor;
+		goto error_version;
 	}
 
 	gb_tty->minor = minor;

