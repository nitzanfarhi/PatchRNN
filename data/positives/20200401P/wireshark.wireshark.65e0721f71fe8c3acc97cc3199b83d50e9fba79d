commit 65e0721f71fe8c3acc97cc3199b83d50e9fba79d
Author: Stig Bj√∏rlykke <stig@bjorlykke.org>
Date:   Thu Sep 30 06:19:32 2010 +0000

    Constructed octet strings may contain zero encodings.
    (X.690 chapter 8.7.3)
    
    svn path=/trunk/; revision=34284

diff --git a/epan/dissectors/packet-ber.c b/epan/dissectors/packet-ber.c
index 705bf5ea66..44615e5521 100644
--- a/epan/dissectors/packet-ber.c
+++ b/epan/dissectors/packet-ber.c
@@ -1138,12 +1138,15 @@ reassemble_octet_string(asn1_ctx_t *actx, proto_tree *tree, gint hf_id, tvbuff_t
 
   /* so we need to consume octet strings for the given length */
 
-  /* not sure we need this */
-  actx->pinfo->fragmented = TRUE;
-
   if(out_tvb)
     *out_tvb=NULL;
 
+  if (con_len == 0) /* Zero encodings (8.7.3) */
+    return offset;
+
+  /* not sure we need this */
+  actx->pinfo->fragmented = TRUE;
+
   while(!fd_head) {
 
     offset = dissect_ber_octet_string(FALSE, actx, NULL, tvb, offset, hf_id, &next_tvb);

