commit f3537f91f9be2ce5fcbaa1aa6d787ad0436daec6
Author: David Howells <dhowells@redhat.com>
Date:   Mon Oct 22 15:05:55 2012 +0100

    ASN.1: Fix an indefinite length skip error
    
    Fix an error in asn1_find_indefinite_length() whereby small definite length
    elements of size 0x7f are incorrecly classified as non-small.  Without this
    fix, an error will be given as the length of the length will be perceived as
    being very much greater than the maximum supported size.
    
    Signed-off-by: David Howells <dhowells@redhat.com>
    Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>

diff --git a/lib/asn1_decoder.c b/lib/asn1_decoder.c
index de2c8b5a715b..5293d2433029 100644
--- a/lib/asn1_decoder.c
+++ b/lib/asn1_decoder.c
@@ -91,7 +91,7 @@ next_tag:
 
 	/* Extract the length */
 	len = data[dp++];
-	if (len < 0x7f) {
+	if (len <= 0x7f) {
 		dp += len;
 		goto next_tag;
 	}

