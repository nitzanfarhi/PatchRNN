commit 7928ee4d685b727619555bc1ec0aee805f6fc8c4
Author: Bernd Edlinger <bernd.edlinger@hotmail.de>
Date:   Thu Dec 22 13:51:27 2016 +0100

    Fix error handling in compute_key, BN_CTX_get can return NULL
    
    Reviewed-by: Rich Salz <rsalz@openssl.org>
    Reviewed-by: Richard Levitte <levitte@openssl.org>
    (Merged from https://github.com/openssl/openssl/pull/2132)

diff --git a/crypto/dh/dh_key.c b/crypto/dh/dh_key.c
index fe021904cc..204e5a7a42 100644
--- a/crypto/dh/dh_key.c
+++ b/crypto/dh/dh_key.c
@@ -159,6 +159,8 @@ static int compute_key(unsigned char *key, const BIGNUM *pub_key, DH *dh)
         goto err;
     BN_CTX_start(ctx);
     tmp = BN_CTX_get(ctx);
+    if (tmp == NULL)
+        goto err;
 
     if (dh->priv_key == NULL) {
         DHerr(DH_F_COMPUTE_KEY, DH_R_NO_PRIVATE_VALUE);

