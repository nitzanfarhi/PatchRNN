commit 8faebcd37ba59c7c0cf46a50bc751fbdc0522578
Author: Francois-Xavier Le Bail <fx.lebail@yahoo.com>
Date:   Tue Dec 9 19:42:31 2014 +0100

    BOOTP/DHCP: fix "Unchecked return value" found by Coverity
    
    Add a bounds check
    Fix spaces

diff --git a/print-bootp.c b/print-bootp.c
index 27438fab..fe0a070c 100644
--- a/print-bootp.c
+++ b/print-bootp.c
@@ -851,7 +851,7 @@ rfc1048_print(netdissect_options *ndo,
 
 			case TAG_CLIENT_ID:
 			    {
-			    	int type;
+				int type;
 
 				/* this option should be at least 1 byte long */
 				if (len < 1) {
@@ -907,7 +907,8 @@ rfc1048_print(netdissect_options *ndo,
 					case AGENT_SUBOPTION_CIRCUIT_ID: /* fall through */
 					case AGENT_SUBOPTION_REMOTE_ID:
 					case AGENT_SUBOPTION_SUBSCRIBER_ID:
-						fn_printn(ndo, bp, suboptlen, NULL);
+						if (fn_printn(ndo, bp, suboptlen, ndo->ndo_snapend))
+							goto trunc;
 						break;
 
 					default:

