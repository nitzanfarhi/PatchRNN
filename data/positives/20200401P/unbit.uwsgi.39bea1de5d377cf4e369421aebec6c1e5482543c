commit 39bea1de5d377cf4e369421aebec6c1e5482543c
Author: Riccardo Magliocchetti <riccardo.magliocchetti@gmail.com>
Date:   Sun Apr 5 18:48:33 2015 +0200

    logging: use fchmod instead of chmod to avoid TOCTOU race
    
    Reported by flawfinder

diff --git a/core/logging.c b/core/logging.c
index 7fe81bc2..f5b01590 100644
--- a/core/logging.c
+++ b/core/logging.c
@@ -291,8 +291,8 @@ void logto(char *logfile) {
 		uwsgi.logfile = logfile;
 
 		if (uwsgi.chmod_logfile_value) {
-			if (chmod(uwsgi.logfile, uwsgi.chmod_logfile_value)) {
-				uwsgi_error("chmod()");
+			if (fchmod(fd, uwsgi.chmod_logfile_value)) {
+				uwsgi_error("fchmod()");
 			}
 		}
 	}

