commit 48de9296c782084631b0a82e102d17e9f30060bd
Author: Timo Sirainen <tss@iki.fi>
Date:   Fri Jul 18 16:21:04 2008 +0300

    rfc822_parse_phrase(): Don't read outside data boundaries if input is empty.
    
    --HG--
    branch : HEAD

diff --git a/src/lib-mail/rfc822-parser.c b/src/lib-mail/rfc822-parser.c
index a1a5dec33..7a3b92a07 100644
--- a/src/lib-mail/rfc822-parser.c
+++ b/src/lib-mail/rfc822-parser.c
@@ -262,6 +262,8 @@ int rfc822_parse_phrase(struct rfc822_parser_context *ctx, string_t *str)
 	   obs-phrase = word *(word / "." / CFWS)
 	*/
 
+	if (ctx->data == ctx->end)
+		return 0;
 	if (*ctx->data == '.')
 		return -1;
 

