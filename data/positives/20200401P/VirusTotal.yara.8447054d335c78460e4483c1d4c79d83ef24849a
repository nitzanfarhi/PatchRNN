commit 8447054d335c78460e4483c1d4c79d83ef24849a
Author: Victor M. Alvarez <plusvic@gmail.com>
Date:   Mon Mar 21 22:37:31 2011 +0000

    Fix memory leak

diff --git a/libyara/ast.c b/libyara/ast.c
index 614c559..10b390d 100644
--- a/libyara/ast.c
+++ b/libyara/ast.c
@@ -981,6 +981,11 @@ void free_term(TERM* term)
 	
 		free_term(((TERM_STRING*)term)->offset);
 		break;
+		
+	case TERM_TYPE_STRING_OFFSET:
+
+    	free_term(((TERM_STRING*)term)->index);
+    	break;
 	
 	case TERM_TYPE_STRING_IN_RANGE:
 	

