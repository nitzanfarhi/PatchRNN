commit 8e14d52610d747977bcbe2875cbe7d93724d8143
Author: Georgi Kodinov <Georgi.Kodinov@Oracle.com>
Date:   Tue Jun 7 15:43:16 2011 +0300

    Bug #12589928: MEMORY LEAK WHEN RUNNING SYS_VARS.SECURE_FILE_PRIV
    
    This is the 5.1 version of the fix.
    
    Need to free the memory allocated by the option parsing code for empty
    strings when resetting the pointer to NULL.
    No test case needed, as the existing ones already cover this path.

diff --git a/sql/mysqld.cc b/sql/mysqld.cc
index 36f195e6232..13395cd9e07 100644
--- a/sql/mysqld.cc
+++ b/sql/mysqld.cc
@@ -9063,6 +9063,7 @@ static int fix_paths(void)
   {
     if (*opt_secure_file_priv == 0)
     {
+      my_free(opt_secure_file_priv, MYF(0));
       opt_secure_file_priv= 0;
     }
     else

