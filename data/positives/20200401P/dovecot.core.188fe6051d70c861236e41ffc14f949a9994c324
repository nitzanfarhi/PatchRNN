commit 188fe6051d70c861236e41ffc14f949a9994c324
Author: Timo Sirainen <tss@iki.fi>
Date:   Thu Aug 5 16:58:12 2010 +0100

    acl: Crashfix for handling namespaces that don't have a paths.

diff --git a/src/plugins/acl/acl-backend-vfile.c b/src/plugins/acl/acl-backend-vfile.c
index 6103d87cb..2edc21392 100644
--- a/src/plugins/acl/acl-backend-vfile.c
+++ b/src/plugins/acl/acl-backend-vfile.c
@@ -140,7 +140,7 @@ acl_backend_vfile_get_local_dir(struct acl_backend *backend, const char *name)
 		dir = mailbox_list_get_path(ns->list, name,
 					    MAILBOX_LIST_PATH_TYPE_MAILBOX);
 	}
-	if (name == NULL) {
+	if (name == NULL && dir != NULL) {
 		/* verify that the directory isn't same as INBOX's directory.
 		   this is mainly for Maildir. */
 		inbox = mailbox_list_get_path(ns->list, "INBOX",

