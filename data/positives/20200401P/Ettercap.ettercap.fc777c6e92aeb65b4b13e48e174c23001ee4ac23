commit fc777c6e92aeb65b4b13e48e174c23001ee4ac23
Author: Emilio A. Escobar <eescobar@gmail.com>
Date:   Tue Mar 26 10:40:28 2013 -0400

    Check packet length to make sure that at least 5 bytes are there.

diff --git a/src/dissectors/ec_TN3270.c b/src/dissectors/ec_TN3270.c
index 66ac797c..ac2e923f 100644
--- a/src/dissectors/ec_TN3270.c
+++ b/src/dissectors/ec_TN3270.c
@@ -86,7 +86,7 @@ FUNC_DECODER(dissector_TN3270)
 
    if (FROM_CLIENT("TN3270", PACKET)) {
 
-      if (PACKET->DATA.len > 200) /* is this always valid? */
+      if (PACKET->DATA.len > 200 || PACKET->DATA.len < 5) /* is this always valid? */
          return NULL;
 
       char output[512] = { 0 };

