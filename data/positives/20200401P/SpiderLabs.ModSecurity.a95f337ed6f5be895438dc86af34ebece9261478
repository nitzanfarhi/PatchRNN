commit a95f337ed6f5be895438dc86af34ebece9261478
Author: brenosilva <brenosilva@9017d574-64ec-4062-9424-5e00b32a252b>
Date:   Thu Aug 16 12:52:38 2012 +0000

    Fixed check if ip_strv is NULL

diff --git a/apache2/msc_util.c b/apache2/msc_util.c
index 66f6c0c7..5c9c127b 100644
--- a/apache2/msc_util.c
+++ b/apache2/msc_util.c
@@ -85,6 +85,9 @@ unsigned char is_netmask_v4(char *ip_strv4) {
     char *mask_str = NULL;
     int cidr;
 
+    if(ip_strv4 == NULL)
+        return netmask_v4;
+
     if ((mask_str = strchr(ip_strv4, '/'))) {
         *(mask_str++) = '\0';
 
@@ -114,6 +117,9 @@ unsigned char is_netmask_v6(char *ip_strv6) {
     char *mask_str = NULL;
     int cidr;
 
+    if(ip_strv6 == NULL)
+        return netmask_v6;
+
     if ((mask_str = strchr(ip_strv6, '/'))) {
         *(mask_str++) = '\0';
 

