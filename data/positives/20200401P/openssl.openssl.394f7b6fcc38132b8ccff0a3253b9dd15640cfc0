commit 394f7b6fcc38132b8ccff0a3253b9dd15640cfc0
Author: Emilia Kasper <emilia@openssl.org>
Date:   Tue Sep 1 14:56:58 2015 +0200

    RT4002: check for NULL cipher in p12_crpt.c
    
    The NULL cipher case can't actually happen because we have no
    EVP_PBE_CTL combinations where cipher_nid is -1 and keygen is
    PKCS12_PBE_keyivgen. But make the code more obviously correct.
    
    Reviewed-by: Matt Caswell <matt@openssl.org>

diff --git a/crypto/pkcs12/p12_crpt.c b/crypto/pkcs12/p12_crpt.c
index 08be40c61f..e7d5ac9f6b 100644
--- a/crypto/pkcs12/p12_crpt.c
+++ b/crypto/pkcs12/p12_crpt.c
@@ -76,6 +76,9 @@ int PKCS12_PBE_keyivgen(EVP_CIPHER_CTX *ctx, const char *pass, int passlen,
     unsigned char *salt;
     unsigned char key[EVP_MAX_KEY_LENGTH], iv[EVP_MAX_IV_LENGTH];
 
+    if (cipher == NULL)
+        return 0;
+
     /* Extract useful info from parameter */
 
     pbe = ASN1_TYPE_unpack_sequence(ASN1_ITEM_rptr(PBEPARAM), param);

