commit 6e1c3003fb08efd21dc31d62b065dd54c047c5e6
Author: remi <remi@openbsd.org>
Date:   Sun Jun 10 14:39:38 2018 +0000

    memory leak spotted by claudio@
    
    go ahead jca@
    OK claudio@

diff --git a/usr.sbin/ospf6d/rde.c b/usr.sbin/ospf6d/rde.c
index 73b6b7bfc1a..578c5d80357 100644
--- a/usr.sbin/ospf6d/rde.c
+++ b/usr.sbin/ospf6d/rde.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: rde.c,v 1.73 2018/06/10 14:31:49 remi Exp $ */
+/*	$OpenBSD: rde.c,v 1.74 2018/06/10 14:39:38 remi Exp $ */
 
 /*
  * Copyright (c) 2004, 2005 Claudio Jeker <claudio@openbsd.org>
@@ -1363,7 +1363,8 @@ prefix_tree_add(struct prefix_tree *tree, struct lsa_link *lsa)
 				old->prefix->options |= new->prefix->options;
 				free(new);
 			}
-		}
+		} else
+			free(new);
 
 		cur_prefix = cur_prefix + len;
 	}

