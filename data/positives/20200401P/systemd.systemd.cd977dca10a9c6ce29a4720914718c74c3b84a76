commit cd977dca10a9c6ce29a4720914718c74c3b84a76
Author: Ronny Chevalier <chevalier.ronny@gmail.com>
Date:   Thu Apr 9 11:00:35 2015 +0200

    util: cunescape - fix memleak in error path

diff --git a/src/shared/util.c b/src/shared/util.c
index 3a80f264c..23468b7af 100644
--- a/src/shared/util.c
+++ b/src/shared/util.c
@@ -1505,6 +1505,7 @@ int cunescape_length_with_prefix(const char *s, size_t length, const char *prefi
                                 continue;
                         }
 
+                        free(r);
                         return -EINVAL;
                 }
 
@@ -1516,6 +1517,7 @@ int cunescape_length_with_prefix(const char *s, size_t length, const char *prefi
                                 continue;
                         }
 
+                        free(r);
                         return k;
                 }
 

