commit 60fa5c7aa6860f09060a2f55ff4bf8cc5a4ee73e
Author: Andrew Hanushevsky <abh@slac.stanford.edu>
Date:   Tue Feb 20 20:26:39 2007 +0000

    Make sure that UDP messages are terminated with a null byte.

diff --git a/src/XrdNet/XrdNet.cc b/src/XrdNet/XrdNet.cc
index 0ece8028..8ef5ec4f 100644
--- a/src/XrdNet/XrdNet.cc
+++ b/src/XrdNet/XrdNet.cc
@@ -344,14 +344,14 @@ int XrdNet::do_Accept_UDP(XrdNetPeer &myPeer, int opts)
 
 // Read the message and get the host address
 //
-   do {dlen = recvfrom(iofd, (Sokdata_t)bp->data, BuffSize, 0, &addr,&addrlen);
+   do {dlen = recvfrom(iofd,(Sokdata_t)bp->data,BuffSize-1,0,&addr,&addrlen);
       } while(dlen < 0 && errno == EINTR);
 
    if (dlen < 0)
       {eDest->Emsg("Receive", errno, "perform UDP recvfrom()");
        BuffQ->Recycle(bp);
        return 0;
-      }
+      } else bp->data[dlen] = '\0';
 
 // Authorize this connection. We don't accept messages that set the
 // loopback address since this can be trivially spoofed in UDP packets.

