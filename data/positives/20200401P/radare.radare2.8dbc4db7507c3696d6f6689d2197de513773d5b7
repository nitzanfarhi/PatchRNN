commit 8dbc4db7507c3696d6f6689d2197de513773d5b7
Author: Duncan Ogilvie <mr.exodia.tpodt@gmail.com>
Date:   Sat Jun 3 18:02:30 2017 +0200

    Fixed unreleased lock in r_core_cmd

diff --git a/libr/core/cmd.c b/libr/core/cmd.c
index 12781befb..ad60b6f66 100644
--- a/libr/core/cmd.c
+++ b/libr/core/cmd.c
@@ -2740,7 +2740,7 @@ R_API int r_core_cmd(RCore *core, const char *cstr, int log) {
 
 	if (!cstr || *cstr == '|') {
 		// raw comment syntax
-		return false;
+		goto beach; // false;
 	}
 	if (!strncmp (cstr, "/*", 2)) {
 		if (r_sandbox_enable (0)) {
@@ -2793,6 +2793,8 @@ R_API int r_core_cmd(RCore *core, const char *cstr, int log) {
 		}
 		rcmd = ptr + 1;
 	}
+	r_th_lock_leave (core->lock);
+	/* run pending analysis commands */
 	if (core->anal->cmdtail) {
 		char *res = core->anal->cmdtail;
 		core->anal->cmdtail = NULL;

