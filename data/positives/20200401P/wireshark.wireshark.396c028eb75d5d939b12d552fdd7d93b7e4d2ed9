commit 396c028eb75d5d939b12d552fdd7d93b7e4d2ed9
Author: Evan Huus <eapache@gmail.com>
Date:   Fri Jan 3 06:03:28 2014 +0000

    Make sure we have a dissector table before calling dissector_try_uint_new. Fixes
    a null-ptr deref found while fuzzing.
    
    svn path=/trunk/; revision=54574

diff --git a/epan/dissectors/packet-usb.c b/epan/dissectors/packet-usb.c
index b04de98bb9..e84ab4198f 100644
--- a/epan/dissectors/packet-usb.c
+++ b/epan/dissectors/packet-usb.c
@@ -2586,7 +2586,8 @@ try_dissect_next_protocol(proto_tree *parent, tvbuff_t *next_tvb, gint offset, p
 
                 if (try_heuristics && dissector_try_heuristic(heur_subdissector_list, next_tvb, pinfo, parent, usb_conv_info)) {
                     offset += tvb_length(next_tvb);
-                } else if (dissector_try_uint_new(usb_dissector_table, usb_conv_info->interfaceClass, next_tvb, pinfo, parent, TRUE, usb_conv_info)) {
+                } else if (usb_dissector_table &&
+                        dissector_try_uint_new(usb_dissector_table, usb_conv_info->interfaceClass, next_tvb, pinfo, parent, TRUE, usb_conv_info)) {
                     offset += tvb_length(next_tvb);
                 }
             }

