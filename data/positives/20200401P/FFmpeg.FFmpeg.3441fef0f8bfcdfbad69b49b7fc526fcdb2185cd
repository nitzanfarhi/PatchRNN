commit 3441fef0f8bfcdfbad69b49b7fc526fcdb2185cd
Author: Paul B Mahol <onemda@gmail.com>
Date:   Wed Sep 23 19:07:48 2015 +0200

    avformat/brstm: fix overflow
    
    Signed-off-by: Paul B Mahol <onemda@gmail.com>

diff --git a/libavformat/brstm.c b/libavformat/brstm.c
index f2bc038840..a781163f95 100644
--- a/libavformat/brstm.c
+++ b/libavformat/brstm.c
@@ -389,6 +389,10 @@ static int read_packet(AVFormatContext *s, AVPacket *pkt)
         codec->codec_id == AV_CODEC_ID_ADPCM_THP_LE) {
         uint8_t *dst;
 
+        if (size > (INT_MAX - 32 - 4) ||
+            (32 + 4 + size) > (INT_MAX / codec->channels) ||
+            (32 + 4 + size) * codec->channels > INT_MAX - 8)
+            return AVERROR_INVALIDDATA;
         if (av_new_packet(pkt, 8 + (32 + 4 + size) * codec->channels) < 0)
             return AVERROR(ENOMEM);
         dst = pkt->data;

