commit 82bf90c62834842249c4f94535079f5cbec9014c
Author: Sergei Shtylyov <sergei.shtylyov@cogentembedded.com>
Date:   Wed Jan 21 00:09:46 2015 +0300

    dmaengine: shdmac: use SET_RUNTIME_PM_OPS()
    
    Use SET_RUNTIME_PM_OPS() to initialize the runtime PM method pointers in the
    'struct dev_pm_ops';  since that macro doesn't  do anything  if CONFIG_PM is
    not defined, we have  to move #ifdef up to also cover the runtime PM methods
    in order to avoid compilation warnings.
    
    Based on orignal patch by Mikhail Ulyanov <mikhail.ulyanov@cogentembedded.com>.
    
    Signed-off-by: Sergei Shtylyov <sergei.shtylyov@cogentembedded.com>
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

diff --git a/drivers/dma/sh/shdmac.c b/drivers/dma/sh/shdmac.c
index ce4cd6be07cf..023344f7f78e 100644
--- a/drivers/dma/sh/shdmac.c
+++ b/drivers/dma/sh/shdmac.c
@@ -588,6 +588,7 @@ static void sh_dmae_shutdown(struct platform_device *pdev)
 	sh_dmae_ctl_stop(shdev);
 }
 
+#ifdef CONFIG_PM
 static int sh_dmae_runtime_suspend(struct device *dev)
 {
 	return 0;
@@ -600,7 +601,6 @@ static int sh_dmae_runtime_resume(struct device *dev)
 	return sh_dmae_rst(shdev);
 }
 
-#ifdef CONFIG_PM
 static int sh_dmae_suspend(struct device *dev)
 {
 	return 0;
@@ -640,8 +640,8 @@ static int sh_dmae_resume(struct device *dev)
 static const struct dev_pm_ops sh_dmae_pm = {
 	.suspend		= sh_dmae_suspend,
 	.resume			= sh_dmae_resume,
-	.runtime_suspend	= sh_dmae_runtime_suspend,
-	.runtime_resume		= sh_dmae_runtime_resume,
+	SET_RUNTIME_PM_OPS(sh_dmae_runtime_suspend, sh_dmae_runtime_resume,
+			   NULL)
 };
 
 static dma_addr_t sh_dmae_slave_addr(struct shdma_chan *schan)

