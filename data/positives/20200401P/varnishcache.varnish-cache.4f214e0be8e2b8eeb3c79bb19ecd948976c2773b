commit 4f214e0be8e2b8eeb3c79bb19ecd948976c2773b
Author: Dag Erling Sm√∏rgrav <des@des.no>
Date:   Sun Jun 17 15:10:08 2007 +0000

    Don't allow len to go negative if the header is empty.
    
    
    git-svn-id: http://www.varnish-cache.org/svn/trunk/varnish-cache@1531 d4fa192b-c00b-0410-8231-f00ffab90ce4

diff --git a/bin/varnishncsa/varnishncsa.c b/bin/varnishncsa/varnishncsa.c
index 926422927..68a891fec 100644
--- a/bin/varnishncsa/varnishncsa.c
+++ b/bin/varnishncsa/varnishncsa.c
@@ -155,7 +155,7 @@ trimline(const char *str, const char *end)
 		 /* nothing */ ;
 
 	/* trim trailing space */
-	while (str[len - 1] == ' ')
+	while (len && str[len - 1] == ' ')
 		--len;
 
 	/* copy and return */

