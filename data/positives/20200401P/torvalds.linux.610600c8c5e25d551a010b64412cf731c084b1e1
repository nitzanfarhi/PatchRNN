commit 610600c8c5e25d551a010b64412cf731c084b1e1
Author: Sasha Levin <sasha.levin@oracle.com>
Date:   Mon Mar 23 15:30:00 2015 -0400

    tipc: validate length of sockaddr in connect() for dgram/rdm
    
    Commit f2f8036 ("tipc: add support for connect() on dgram/rdm sockets")
    hasn't validated user input length for the sockaddr structure which allows
    a user to overwrite kernel memory with arbitrary input.
    
    Fixes: f2f8036 ("tipc: add support for connect() on dgram/rdm sockets")
    Signed-off-by: Sasha Levin <sasha.levin@oracle.com>
    Acked-by: Ying Xue <ying.xue@windriver.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/net/tipc/socket.c b/net/tipc/socket.c
index 6dd5bd95236a..094710519477 100644
--- a/net/tipc/socket.c
+++ b/net/tipc/socket.c
@@ -1851,6 +1851,8 @@ static int tipc_connect(struct socket *sock, struct sockaddr *dest,
 		if (dst->family == AF_UNSPEC) {
 			memset(&tsk->remote, 0, sizeof(struct sockaddr_tipc));
 			tsk->connected = 0;
+		} else if (destlen != sizeof(struct sockaddr_tipc)) {
+			res = -EINVAL;
 		} else {
 			memcpy(&tsk->remote, dest, destlen);
 			tsk->connected = 1;

