commit ce0fb39219db82cef286c997a1163dcca10185ef
Author: qiangbei <1137465774@qq.com>
Date:   Sun Oct 8 20:49:05 2017 +0800

    detect/state: fix offset mask logic
    
    changed 0xef to 0x7f

diff --git a/src/detect-engine-state.c b/src/detect-engine-state.c
index 8506f2a1..b9a79e93 100644
--- a/src/detect-engine-state.c
+++ b/src/detect-engine-state.c
@@ -375,7 +375,7 @@ int DeStateDetectStartDetection(ThreadVars *tv, DetectEngineCtx *de_ctx,
 
     /* if continue detection already inspected this rule for this tx,
      * continue with the first not-inspected tx */
-    uint8_t offset = det_ctx->de_state_sig_array[s->num] & 0xef;
+    uint8_t offset = det_ctx->de_state_sig_array[s->num] & 0x7f;
     uint64_t tx_id = AppLayerParserGetTransactionInspectId(f->alparser, flags);
     if (offset > 0) {
         SCLogDebug("using stored_tx_id %"PRIu64" instead of %"PRIu64, tx_id+offset, tx_id);

