commit cf78623a28cd3ecdc6889256d8b678201bc10afe
Author: pancake <pancake@nopcode.org>
Date:   Fri Sep 27 01:37:57 2013 +0200

    Fix #222 - Malformed ARM ELF causes segfault

diff --git a/libr/bin/format/elf/elf.c b/libr/bin/format/elf/elf.c
index f250f6fce..1812d4ed2 100644
--- a/libr/bin/format/elf/elf.c
+++ b/libr/bin/format/elf/elf.c
@@ -244,6 +244,8 @@ static ut64 Elf_(get_import_addr)(struct Elf_(r_bin_elf_obj_t) *bin, int sym) {
 		(got_addr = Elf_(r_bin_elf_get_section_addr) (bin, ".got.plt")) == -1)
 		return -1;
 	for (i = 0; i < bin->ehdr.e_shnum; i++) {
+		if (bin->shdr[i].sh_name > bin->shstrtab_section->sh_size)
+			continue;
 		if (!strcmp (&bin->strtab[bin->shdr[i].sh_name], ".rel.plt"))
 			tsize = sizeof (Elf_(Rel));
 		else if (!strcmp (&bin->strtab[bin->shdr[i].sh_name], ".rela.plt"))

