commit c7c976c6d7051804f96e3106688c1963d1238ae0
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Tue Apr 17 14:44:06 2012 +0200

    oggdec: Safety check against stream counts being inconsistent in seek()
    
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavformat/oggdec.c b/libavformat/oggdec.c
index ab523790ec..6a55f89f97 100644
--- a/libavformat/oggdec.c
+++ b/libavformat/oggdec.c
@@ -29,6 +29,7 @@
  */
 
 #include <stdio.h>
+#include "libavutil/avassert.h"
 #include "oggdec.h"
 #include "avformat.h"
 #include "internal.h"
@@ -690,6 +691,7 @@ static int ogg_read_seek(AVFormatContext *s, int stream_index,
     struct ogg_stream *os = ogg->streams + stream_index;
     int ret;
 
+    av_assert0(stream_index < ogg->nstreams);
     // Ensure everything is reset even when seeking via
     // the generated index.
     ogg_reset(ogg);

