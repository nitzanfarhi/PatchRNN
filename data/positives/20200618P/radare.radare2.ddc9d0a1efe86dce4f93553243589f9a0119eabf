commit ddc9d0a1efe86dce4f93553243589f9a0119eabf
Author: pancake <pancake@nopcode.org>
Date:   Wed Jul 4 17:04:57 2018 +0200

    Fix #10596 - oobread in java parser

diff --git a/shlr/java/class.c b/shlr/java/class.c
index ae3cf51d0..6cc16a0c3 100644
--- a/shlr/java/class.c
+++ b/shlr/java/class.c
@@ -4524,6 +4524,9 @@ R_API RBinJavaAttrInfo *r_bin_java_stack_map_table_attr_new(ut8 *buffer, ut64 sz
 	ut64 offset = 0;
 	RBinJavaStackMapFrame *stack_frame = NULL, *new_stack_frame = NULL;
 	RBinJavaAttrInfo *attr = r_bin_java_default_attr_new (buffer, sz, buf_offset);
+	if (sz < 10) {
+		return NULL;
+	}
 	offset += 6;
 	IFDBG eprintf("r_bin_java_stack_map_table_attr_new: New stack map allocated.\n");
 	if (!attr) {

