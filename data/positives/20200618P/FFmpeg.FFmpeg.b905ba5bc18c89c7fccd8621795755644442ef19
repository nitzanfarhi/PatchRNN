commit b905ba5bc18c89c7fccd8621795755644442ef19
Author: Matthew Gregan <kinetik@flim.org>
Date:   Wed Apr 12 14:12:17 2017 +1200

    avformat/movenc: Fix potential leak of sgpd_entries array.
    
    Signed-off-by: Matthew Gregan <kinetik@flim.org>
    Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>

diff --git a/libavformat/movenc.c b/libavformat/movenc.c
index e6a70bffc0..e6e2313c53 100644
--- a/libavformat/movenc.c
+++ b/libavformat/movenc.c
@@ -2286,8 +2286,10 @@ static int mov_preroll_write_stbl_atoms(AVIOContext *pb, MOVTrack *track)
     }
     entries++;
 
-    if (!group)
+    if (!group) {
+        av_free(sgpd_entries);
         return 0;
+    }
 
     /* Write sgpd tag */
     avio_wb32(pb, 24 + (group * 2)); /* size */

