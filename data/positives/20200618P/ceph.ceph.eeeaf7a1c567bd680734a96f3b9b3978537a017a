commit eeeaf7a1c567bd680734a96f3b9b3978537a017a
Author: Sage Weil <sage@newdream.net>
Date:   Sun Sep 12 09:18:13 2010 -0700

    moncaps: fix array out of bounds in parsing

diff --git a/src/mon/MonCaps.cc b/src/mon/MonCaps.cc
index 9460595251..13728f3578 100644
--- a/src/mon/MonCaps.cc
+++ b/src/mon/MonCaps.cc
@@ -8,16 +8,16 @@ bool MonCaps::get_next_token(string s, size_t& pos, string& token)
   int start = s.find_first_not_of(" \t", pos);
   int end;
 
+  if (start < 0) {
+    return false; 
+  }
+
   if (s[start] == '=' || s[start] == ',' || s[start] == ';') {
     end = start + 1;
   } else {
     end = s.find_first_of(";,= \t", start+1);
   }
 
-  if (start < 0) {
-    return false; 
-  }
-
   if (end < 0) {
     end=s.size();
   }

