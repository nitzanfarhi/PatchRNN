commit 54e9e3ef56d2931d9d7a03301a5f028a12e43745
Author: Alexander V. Lukyanov <lavv17f@gmail.com>
Date:   Tue Sep 12 12:22:41 2017 +0300

    Http.cc: canonify Location value in some cases.

diff --git a/src/Http.cc b/src/Http.cc
index acf99bb7..1a1a84c6 100644
--- a/src/Http.cc
+++ b/src/Http.cc
@@ -1046,7 +1046,12 @@ void Http::HandleHeaderLine(const char *name,const char *value)
       return;
    }
    case_hh("Location",'L')
-      location.set(value);
+      if(value[0]=='/' && value[1]=='/')
+	 location.vset(GetProto(),":",value,NULL);
+      else if(value[0]=='/')
+	 location.vset(GetConnectURL().get(),value,NULL);
+      else
+	 location.set(value);
       return;
 
    case_hh("Retry-After",'R')

