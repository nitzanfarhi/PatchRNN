commit d9b889ddb7e466837e363b45ae6713c0bcf0f6db
Author: Armin Novak <armin.novak@gmail.com>
Date:   Mon Nov 17 00:33:37 2014 +0100

    Fixed memory leak.

diff --git a/server/shadow/shadow_client.c b/server/shadow/shadow_client.c
index 774ce2cff..a230509bb 100644
--- a/server/shadow/shadow_client.c
+++ b/server/shadow/shadow_client.c
@@ -218,7 +218,11 @@ void shadow_client_refresh_rect(rdpShadowClient* client, BYTE count, RECTANGLE_1
 	wParam = (SHADOW_MSG_IN_REFRESH_OUTPUT*) calloc(1, sizeof(SHADOW_MSG_IN_REFRESH_OUTPUT));
 
 	if (!wParam || !areas)
+	{
+		if (wParam)
+			free (wParam);
 		return;
+	}
 
 	wParam->numRects = (UINT32) count;
 

