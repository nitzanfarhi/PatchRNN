commit 82e10ed753368e0e3f517dd1c57c26089b424f7c
Author: Maijin <maijin@malware.lu>
Date:   Fri Jan 17 00:10:09 2014 +0100

    Resource leaks fixes CID 1134987

diff --git a/binr/rabin2/rabin2.c b/binr/rabin2/rabin2.c
index 426c74035..0a054a1ca 100644
--- a/binr/rabin2/rabin2.c
+++ b/binr/rabin2/rabin2.c
@@ -160,9 +160,13 @@ static int rabin_dump_symbols(int len) {
 		else if (symbol->size == 0 && olen == 0)
 			len = 32;
 		else len = olen;
-
-		if (!(buf = malloc (len)) || !(ret = malloc (len*2+1)))
+		if (!(buf = malloc (len))) {
 			return R_FALSE;
+		}
+		if (!(ret = malloc (len*2+1))) {
+			free (buf);
+			return R_FALSE;
+		}
 		r_buf_read_at (bin->cur.buf, symbol->offset, buf, len);
 		r_hex_bin2str (buf, len, ret);
 		printf ("%s %s\n", symbol->name, ret);

