commit 214dda4a36329fdd631e3aac0fee6e6fa369db62
Author: Allan Stephens <Allan.Stephens@windriver.com>
Date:   Mon Jan 24 16:22:43 2011 -0500

    tipc: Add in missing lock during link initialization
    
    Ensure that the routine that starts up processing on a newly created
    link endpoint takes the spinlock of the node object that owns the link,
    to prevent possible conflicts with processing involving other links
    owned by that node object.
    
    Signed-off-by: Allan Stephens <Allan.Stephens@windriver.com>
    Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>

diff --git a/net/tipc/link.c b/net/tipc/link.c
index 754e3109038b..89fbb6d6e956 100644
--- a/net/tipc/link.c
+++ b/net/tipc/link.c
@@ -388,7 +388,9 @@ void tipc_link_delete(struct link *l_ptr)
 
 static void link_start(struct link *l_ptr)
 {
+	tipc_node_lock(l_ptr->owner);
 	link_state_event(l_ptr, STARTING_EVT);
+	tipc_node_unlock(l_ptr->owner);
 }
 
 /**

