commit a6c9b781687df7fabd83d26fec6a49f626d09484
Author: David Raynor <draynor@sourcefire.com>
Date:   Wed Apr 10 15:28:20 2013 -0400

    libclamav: cli_cvdverify() patch

diff --git a/libclamav/cvd.c b/libclamav/cvd.c
index 0e1cb6988..29353c301 100644
--- a/libclamav/cvd.c
+++ b/libclamav/cvd.c
@@ -524,6 +524,11 @@ static int cli_cvdverify(FILE *fs, struct cl_cvd *cvdpt, unsigned int skipsig)
     }
 
     md5 = cli_hashstream(fs, NULL, 1);
+    if (md5 == NULL) {
+	cli_dbgmsg("cli_cvdverify: Cannot generate hash, out of memory\n");
+	cl_cvdfree(cvd);
+	return CL_EMEM;
+    }
     cli_dbgmsg("MD5(.tar.gz) = %s\n", md5);
 
     if(strncmp(md5, cvd->md5, 32)) {

