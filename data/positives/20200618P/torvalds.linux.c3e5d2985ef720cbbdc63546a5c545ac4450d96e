commit c3e5d2985ef720cbbdc63546a5c545ac4450d96e
Author: Valentine Barshak <valentine.barshak@cogentembedded.com>
Date:   Mon Dec 9 23:40:33 2013 +0400

    usb: phy: r-car gen2: use usb_add_phy_dev
    
    Use usb_add_phy_dev instead of usb_add_phy, so that devices can
    be bound to the phy. This is needed to set up USB phy for
    some internal PCI USB host controllers on R-Car Gen2.
    
    Signed-off-by: Valentine Barshak <valentine.barshak@cogentembedded.com>
    Signed-off-by: Felipe Balbi <balbi@ti.com>

diff --git a/drivers/usb/phy/phy-rcar-gen2-usb.c b/drivers/usb/phy/phy-rcar-gen2-usb.c
index a99a6953f11c..9f57091bc9e0 100644
--- a/drivers/usb/phy/phy-rcar-gen2-usb.c
+++ b/drivers/usb/phy/phy-rcar-gen2-usb.c
@@ -213,7 +213,7 @@ static int rcar_gen2_usb_phy_probe(struct platform_device *pdev)
 	priv->phy.shutdown = rcar_gen2_usb_phy_shutdown;
 	priv->phy.set_suspend = rcar_gen2_usb_phy_set_suspend;
 
-	retval = usb_add_phy(&priv->phy, USB_PHY_TYPE_USB2);
+	retval = usb_add_phy_dev(&priv->phy);
 	if (retval < 0) {
 		dev_err(dev, "Failed to add USB phy\n");
 		return retval;

