commit b3f047619da5ade23577dc35a4974f24de148e67
Author: Jakub Jelen <jjelen@redhat.com>
Date:   Wed Jan 4 15:43:17 2017 +0100

    Prevent leaking memory from PIV readers

diff --git a/src/libopensc/pkcs15-pubkey.c b/src/libopensc/pkcs15-pubkey.c
index 75a57821..abe00cd0 100644
--- a/src/libopensc/pkcs15-pubkey.c
+++ b/src/libopensc/pkcs15-pubkey.c
@@ -1200,6 +1200,10 @@ sc_pkcs15_free_pubkey_info(sc_pkcs15_pubkey_info_t *info)
 {
 	if (info->subject.value)
 		free(info->subject.value);
+	if (info->direct.spki.value)
+		free(info->direct.spki.value);
+	if (info->direct.raw.value)
+		free(info->direct.raw.value);
 	sc_pkcs15_free_key_params(&info->params);
 	free(info);
 }

