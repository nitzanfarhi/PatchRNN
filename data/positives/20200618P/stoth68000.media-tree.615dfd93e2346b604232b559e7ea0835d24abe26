commit 615dfd93e2346b604232b559e7ea0835d24abe26
Author: Len Brown <len.brown@intel.com>
Date:   Thu Apr 23 23:21:29 2009 -0400

    ACPI: prevent processor.max_cstate=0 boot crash
    
    As processor.max_cstate is an init-time-only modparam,
    sanity checking it at init-time is sufficient.
    
    http://bugzilla.kernel.org/show_bug.cgi?id=13142
    
    Signed-off-by: Len Brown <len.brown@intel.com>

diff --git a/drivers/acpi/processor_idle.c b/drivers/acpi/processor_idle.c
index 6fe121434ffb..436127e0eec3 100644
--- a/drivers/acpi/processor_idle.c
+++ b/drivers/acpi/processor_idle.c
@@ -1037,6 +1037,9 @@ static int acpi_processor_setup_cpuidle(struct acpi_processor *pr)
 		dev->states[i].desc[0] = '\0';
 	}
 
+	if (max_cstate == 0)
+		max_cstate = 1;
+
 	for (i = 1; i < ACPI_PROCESSOR_MAX_POWER && i <= max_cstate; i++) {
 		cx = &pr->power.states[i];
 		state = &dev->states[count];

