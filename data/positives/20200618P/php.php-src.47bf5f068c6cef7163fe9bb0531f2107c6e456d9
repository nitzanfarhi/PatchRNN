commit 47bf5f068c6cef7163fe9bb0531f2107c6e456d9
Author: Ilia Alshanetsky <iliaa@php.net>
Date:   Sun Oct 9 18:59:27 2005 +0000

    Fixed bug #34777 (Crash in dblib when fetching non-existent error info).

diff --git a/ext/pdo_dblib/dblib_driver.c b/ext/pdo_dblib/dblib_driver.c
index c3065b92bc..996b0034c8 100644
--- a/ext/pdo_dblib/dblib_driver.c
+++ b/ext/pdo_dblib/dblib_driver.c
@@ -61,7 +61,9 @@ static int dblib_fetch_error(pdo_dbh_t *dbh, pdo_stmt_t *stmt, zval *info TSRMLS
 	add_next_index_string(info, message, 0);
 	add_next_index_long(info, einfo->oserr);
 	add_next_index_long(info, einfo->severity);
-	add_next_index_string(info, einfo->oserrstr, 1);
+	if (einfo->oserrstr) {
+		add_next_index_string(info, einfo->oserrstr, 1);
+	}
 
 	return 1;
 }

