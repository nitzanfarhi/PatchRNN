commit 07982ed1efcf7c1d3eee7fe15731e6bd24b5d176
Author: Lennart Poettering <lennart@poettering.net>
Date:   Mon Jan 22 15:32:57 2018 +0100

    tmpfiles: add missing OOM check

diff --git a/src/tmpfiles/tmpfiles.c b/src/tmpfiles/tmpfiles.c
index f96f400aa..d4a606ffb 100644
--- a/src/tmpfiles/tmpfiles.c
+++ b/src/tmpfiles/tmpfiles.c
@@ -2261,6 +2261,9 @@ static int parse_line(const char *fname, unsigned line, const char *buffer, bool
                 }
         } else {
                 existing = new0(ItemArray, 1);
+                if (!existing)
+                        return log_oom();
+
                 r = ordered_hashmap_put(h, i.path, existing);
                 if (r < 0)
                         return log_oom();

