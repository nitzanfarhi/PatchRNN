commit a0d739928b6ca8ebe37a8e446066215dbf0c342c
Author: jsg <jsg@openbsd.org>
Date:   Mon Oct 26 09:22:03 2015 +0000

    avoid a potential double free
    ok gilles@

diff --git a/usr.sbin/smtpd/mda.c b/usr.sbin/smtpd/mda.c
index 0ea145f087d..e2989387552 100644
--- a/usr.sbin/smtpd/mda.c
+++ b/usr.sbin/smtpd/mda.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: mda.c,v 1.110 2015/10/11 12:09:06 sunil Exp $	*/
+/*	$OpenBSD: mda.c,v 1.111 2015/10/26 09:22:03 jsg Exp $	*/
 
 /*
  * Copyright (c) 2008 Gilles Chehade <gilles@poolp.org>
@@ -511,6 +511,7 @@ mda_io(struct io *io, int evt)
 		}
 
 		free(ln);
+		ln = NULL;
 		if (ferror(s->datafp)) {
 			log_debug("debug: mda: ferror on session %016"PRIx64,
 			    s->id);

