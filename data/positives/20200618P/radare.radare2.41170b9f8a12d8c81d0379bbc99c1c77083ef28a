commit 41170b9f8a12d8c81d0379bbc99c1c77083ef28a
Author: Alvaro Felipe <alvaro@alvaro.home>
Date:   Fri May 8 11:15:23 2015 +0200

    Fix #2524

diff --git a/libr/bin/format/mach0/mach0.c b/libr/bin/format/mach0/mach0.c
index 15fd66f26..612c1049b 100644
--- a/libr/bin/format/mach0/mach0.c
+++ b/libr/bin/format/mach0/mach0.c
@@ -1182,7 +1182,7 @@ struct reloc_t* MACH0_(get_relocs)(struct MACH0_(obj_t)* bin) {
 				case BIND_OPCODE_SET_SYMBOL_TRAILING_FLAGS_IMM: {
 					char *sym_name = (char*)p;
 					//ut8 sym_flags = imm;
-					while (*p++);
+					while (*p++ && p<end);
 					sym_ord = -1;
 					if (bin->symtab && bin->dysymtab.nundefsym<0xffff)
 					for (j = 0; j < bin->dysymtab.nundefsym; j++) {

