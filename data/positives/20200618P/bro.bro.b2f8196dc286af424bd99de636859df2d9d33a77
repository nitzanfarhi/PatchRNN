commit b2f8196dc286af424bd99de636859df2d9d33a77
Author: Bernhard Amann <bernhard@icsi.berkeley.edu>
Date:   Mon Mar 31 14:06:34 2014 -0700

    fix potential memleak in x509 parser reported by coverity

diff --git a/src/file_analysis/analyzer/x509/X509.cc b/src/file_analysis/analyzer/x509/X509.cc
index 3bdfb034a..86f13f876 100644
--- a/src/file_analysis/analyzer/x509/X509.cc
+++ b/src/file_analysis/analyzer/x509/X509.cc
@@ -223,11 +223,11 @@ void file_analysis::X509::ParseBasicConstraints(X509_EXTENSION* ex)
 	{
 	assert(OBJ_obj2nid(X509_EXTENSION_get_object(ex)) == NID_basic_constraints);
 
-	RecordVal* pBasicConstraint = new RecordVal(BifType::Record::X509::BasicConstraints);
 	BASIC_CONSTRAINTS *constr = (BASIC_CONSTRAINTS *) X509V3_EXT_d2i(ex);
 
 	if ( constr )
 		{
+		RecordVal* pBasicConstraint = new RecordVal(BifType::Record::X509::BasicConstraints);
 		pBasicConstraint->Assign(0, new Val(constr->ca ? 1 : 0, TYPE_BOOL));
 
 		if ( constr->pathlen )

