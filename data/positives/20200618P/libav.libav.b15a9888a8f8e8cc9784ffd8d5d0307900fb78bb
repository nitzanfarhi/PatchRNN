commit b15a9888a8f8e8cc9784ffd8d5d0307900fb78bb
Author: Justin Ruggles <justin.ruggles@gmail.com>
Date:   Fri Sep 23 21:43:43 2011 -0400

    sol: return error if av_get_packet() fails.
    
    This prevents sending a packet with data=NULL size=AVERROR_EOF.

diff --git a/libavformat/sol.c b/libavformat/sol.c
index 6ca8d1c1e..920582f3d 100644
--- a/libavformat/sol.c
+++ b/libavformat/sol.c
@@ -132,6 +132,8 @@ static int sol_read_packet(AVFormatContext *s,
     if (s->pb->eof_reached)
         return AVERROR(EIO);
     ret= av_get_packet(s->pb, pkt, MAX_SIZE);
+    if (ret < 0)
+        return ret;
     pkt->stream_index = 0;
 
     /* note: we need to modify the packet size here to handle the last

