commit e1962da708ef75385f8818d02e7cac9991b9a2bb
Author: Greg Beaver <cellog@php.net>
Date:   Fri Jul 24 16:21:40 2009 +0000

    fix minor memory leak

diff --git a/ext/phar/zip.c b/ext/phar/zip.c
index 181d561fc4..d7c24ae989 100644
--- a/ext/phar/zip.c
+++ b/ext/phar/zip.c
@@ -310,6 +310,9 @@ foundit:
 			if (mydata->metadata) { \
 				zval_dtor(mydata->metadata); \
 			} \
+			if (mydata->signature) { \
+				efree(mydata->signature); \
+			} \
 			if (error) { \
 				spprintf(error, 4096, "phar error: %s in zip-based phar \"%s\"", errmsg, mydata->fname); \
 			} \
@@ -331,6 +334,9 @@ foundit:
 			if (mydata->metadata) { \
 				zval_dtor(mydata->metadata); \
 			} \
+			if (mydata->signature) { \
+				efree(mydata->signature); \
+			} \
 			if (error) { \
 				spprintf(error, 4096, "phar error: %s in zip-based phar \"%s\"", errmsg, mydata->fname); \
 			} \

