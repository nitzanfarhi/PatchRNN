commit 3623589edc7b1257bb45aa9e52c9631e133f22b6
Author: Anton Khirnov <anton@khirnov.net>
Date:   Wed Mar 27 18:18:38 2013 +0100

    dfa: check for invalid access in decode_wdlt().
    
    This can happen when the number of skipped lines is not consistent with
    the number of coded lines.
    
    Reported-by: Mateusz "j00ru" Jurczyk and Gynvael Coldwind
    CC: libav-stable@libav.org

diff --git a/libavcodec/dfa.c b/libavcodec/dfa.c
index bbe4ce288..6619b9830 100644
--- a/libavcodec/dfa.c
+++ b/libavcodec/dfa.c
@@ -255,6 +255,8 @@ static int decode_wdlt(GetByteContext *gb, uint8_t *frame, int width, int height
             segments = bytestream2_get_le16(gb);
         }
         line_ptr = frame;
+        if (frame_end - frame < width)
+            return AVERROR_INVALIDDATA;
         frame += width;
         y++;
         while (segments--) {

