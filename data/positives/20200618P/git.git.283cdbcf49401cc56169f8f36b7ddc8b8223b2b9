commit 283cdbcf49401cc56169f8f36b7ddc8b8223b2b9
Author: Martin Koegler <mkoegler@auto.tuwien.ac.at>
Date:   Mon Feb 18 21:47:53 2008 +0100

    get_sha1_oneline: check return value of parse_object
    
    Signed-off-by: Martin Koegler <mkoegler@auto.tuwien.ac.at>
    Signed-off-by: Junio C Hamano <gitster@pobox.com>

diff --git a/sha1_name.c b/sha1_name.c
index 13e11645e..4c0bc9c5b 100644
--- a/sha1_name.c
+++ b/sha1_name.c
@@ -617,7 +617,8 @@ static int get_sha1_oneline(const char *prefix, unsigned char *sha1)
 		unsigned long size;
 
 		commit = pop_most_recent_commit(&list, ONELINE_SEEN);
-		parse_object(commit->object.sha1);
+		if (!parse_object(commit->object.sha1))
+			continue;
 		if (temp_commit_buffer)
 			free(temp_commit_buffer);
 		if (commit->buffer)

