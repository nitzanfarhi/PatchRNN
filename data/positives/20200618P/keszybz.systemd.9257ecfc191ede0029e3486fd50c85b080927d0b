commit 9257ecfc191ede0029e3486fd50c85b080927d0b
Author: Florian Zumbiehl <florz@florz.de>
Date:   Tue Sep 1 12:15:54 2009 +0200

    ude_rules.c: fix possible NULL pointer dereference in get_key()

diff --git a/udev/udev-rules.c b/udev/udev-rules.c
index a45a8138f..96645e8f0 100644
--- a/udev/udev-rules.c
+++ b/udev/udev-rules.c
@@ -878,7 +878,7 @@ static int get_key(struct udev *udev, char **line, char **key, enum operation_ty
 	char *temp;
 
 	linepos = *line;
-	if (linepos == NULL && linepos[0] == '\0')
+	if (linepos == NULL || linepos[0] == '\0')
 		return -1;
 
 	/* skip whitespace */

