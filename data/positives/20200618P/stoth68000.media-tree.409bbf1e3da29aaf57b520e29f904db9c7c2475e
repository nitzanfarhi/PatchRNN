commit 409bbf1e3da29aaf57b520e29f904db9c7c2475e
Author: Damien Lespiau <damien.lespiau@intel.com>
Date:   Mon Mar 3 23:59:07 2014 +0000

    drm: Check if the allocation has succeeded before dereferencing newmode
    
    We allocate memory in drm_display_mode_from_vic_index() and use it
    without checking the pointer is valid. Fix that.
    
    Signed-off-by: Damien Lespiau <damien.lespiau@intel.com>
    Reviewed-by: Alex Deucher <alexander.deucher@amd.com>
    Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>

diff --git a/drivers/gpu/drm/drm_edid.c b/drivers/gpu/drm/drm_edid.c
index f8d8a1de9573..f3cde90c1d98 100644
--- a/drivers/gpu/drm/drm_edid.c
+++ b/drivers/gpu/drm/drm_edid.c
@@ -2580,6 +2580,9 @@ drm_display_mode_from_vic_index(struct drm_connector *connector,
 		return NULL;
 
 	newmode = drm_mode_duplicate(dev, &edid_cea_modes[cea_mode]);
+	if (!newmode)
+		return NULL;
+
 	newmode->vrefresh = 0;
 
 	return newmode;

