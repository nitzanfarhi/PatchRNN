commit 2475f1a83ccf313d828b25f1769e3a37442ecf64
Author: Laurent Aimar <fenrir@videolan.org>
Date:   Fri Sep 30 23:42:32 2011 +0000

    anm: prevent infinite loop
    
    Signed-off-by: Janne Grunau <janne-libav@jannau.net>

diff --git a/libavcodec/anm.c b/libavcodec/anm.c
index 94cac5e3c..59de98430 100644
--- a/libavcodec/anm.c
+++ b/libavcodec/anm.c
@@ -81,6 +81,8 @@ static inline int op(uint8_t **dst, const uint8_t *dst_end,
         int striplen = FFMIN(count, remaining);
         if (buf) {
             striplen = FFMIN(striplen, buf_end - *buf);
+            if (*buf >= buf_end)
+                goto exhausted;
             memcpy(*dst, *buf, striplen);
             *buf += striplen;
         } else if (pixel >= 0)

