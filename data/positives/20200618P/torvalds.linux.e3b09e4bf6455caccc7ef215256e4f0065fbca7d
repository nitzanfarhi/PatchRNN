commit e3b09e4bf6455caccc7ef215256e4f0065fbca7d
Author: Jesper Juhl <jj@chaosbits.net>
Date:   Mon Jan 16 21:28:37 2012 +0100

    staging, vt6656/wpactl.c: Fix mem leak in wpa_ioctl()
    
    If we hit the default case in the switch statement in wpa_ioctl()
    we'll leak the memory allocated to 'param' when the variable goes out
    of scope without having been assigned to anything.
    
    This patch fixes the leak by kfree()'ing the memory before we return
    from the function.
    
    Signed-off-by: Jesper Juhl <jj@chaosbits.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

diff --git a/drivers/staging/vt6656/wpactl.c b/drivers/staging/vt6656/wpactl.c
index 9d1486866352..5435e8205b2c 100644
--- a/drivers/staging/vt6656/wpactl.c
+++ b/drivers/staging/vt6656/wpactl.c
@@ -902,6 +902,7 @@ int wpa_ioctl(PSDevice pDevice, struct iw_point *p)
 	default:
 		DBG_PRT(MSG_LEVEL_DEBUG, KERN_INFO "wpa_ioctl: unknown cmd=%d\n",
 			param->cmd);
+		kfree(param);
 		return -EOPNOTSUPP;
 	}
 

