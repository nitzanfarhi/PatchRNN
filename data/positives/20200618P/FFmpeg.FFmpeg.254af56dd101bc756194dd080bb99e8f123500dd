commit 254af56dd101bc756194dd080bb99e8f123500dd
Author: Laurent Aimar <fenrir@videolan.org>
Date:   Tue Sep 27 01:02:17 2011 +0200

    Check for out of bound writes when building tree in bink decoder.
    
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavcodec/bink.c b/libavcodec/bink.c
index 3c2148b3c6..ac12a4bdc4 100644
--- a/libavcodec/bink.c
+++ b/libavcodec/bink.c
@@ -247,7 +247,7 @@ static void read_tree(GetBitContext *gb, Tree *tree)
             tree->syms[i] = get_bits(gb, 4);
             tmp1[tree->syms[i]] = 1;
         }
-        for (i = 0; i < 16; i++)
+        for (i = 0; i < 16 && len < 16 - 1; i++)
             if (!tmp1[i])
                 tree->syms[++len] = i;
     } else {

