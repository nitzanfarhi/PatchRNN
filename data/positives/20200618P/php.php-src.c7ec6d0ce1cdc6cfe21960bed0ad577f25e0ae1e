commit c7ec6d0ce1cdc6cfe21960bed0ad577f25e0ae1e
Author: Marcus Boerger <helly@php.net>
Date:   Sat Mar 12 00:50:20 2005 +0000

    - Errcode might be empty

diff --git a/ext/sqlite/pdo_sqlite2.c b/ext/sqlite/pdo_sqlite2.c
index 563a191713..3151fa19e7 100644
--- a/ext/sqlite/pdo_sqlite2.c
+++ b/ext/sqlite/pdo_sqlite2.c
@@ -310,7 +310,9 @@ static int pdo_sqlite2_fetch_error_func(pdo_dbh_t *dbh, pdo_stmt_t *stmt, zval *
 
 	if (einfo->errcode) {
 		add_next_index_long(info, einfo->errcode);
-		add_next_index_string(info, einfo->errmsg, 1);
+		if (einfo->errmsg) {
+			add_next_index_string(info, einfo->errmsg, 1);
+		}
 	}
 
 	return 1;

