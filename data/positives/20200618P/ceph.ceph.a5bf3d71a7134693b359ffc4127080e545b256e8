commit a5bf3d71a7134693b359ffc4127080e545b256e8
Author: Samuel Just <sam.just@inktank.com>
Date:   Tue May 22 10:09:29 2012 -0700

    OSD: lock recovery_wq before debug output on finish_recovery_op
    
    Signed-off-by: Samuel Just <sam.just@inktank.com>

diff --git a/src/osd/OSD.cc b/src/osd/OSD.cc
index 13d1b8b2a0..9d3077f3a3 100644
--- a/src/osd/OSD.cc
+++ b/src/osd/OSD.cc
@@ -4893,11 +4893,11 @@ void OSD::start_recovery_op(PG *pg, const hobject_t& soid)
 
 void OSD::finish_recovery_op(PG *pg, const hobject_t& soid, bool dequeue)
 {
+  recovery_wq.lock();
   dout(10) << "finish_recovery_op " << *pg << " " << soid
 	   << " dequeue=" << dequeue
 	   << " (" << recovery_ops_active << "/" << g_conf->osd_recovery_max_active << " rops)"
 	   << dendl;
-  recovery_wq.lock();
 
   // adjust count
   recovery_ops_active--;

