commit fbfa06deb707fbf9d3340c5776e71a33d7aff902
Author: Nguyen Anh Quynh <aquynh@gmail.com>
Date:   Fri Feb 27 17:31:24 2015 +0800

    mips: sanity check for input code length of Mips64

diff --git a/arch/Mips/MipsDisassembler.c b/arch/Mips/MipsDisassembler.c
index 2d222f2a..5240a807 100644
--- a/arch/Mips/MipsDisassembler.c
+++ b/arch/Mips/MipsDisassembler.c
@@ -410,6 +410,14 @@ static DecodeStatus Mips64Disassembler_getInstruction(int mode, MCInst *instr,
 {
 	uint32_t Insn;
 
+	if (code_len < 4)
+		// not enough data
+		return MCDisassembler_Fail;
+
+	if (instr->flat_insn->detail) {
+		memset(instr->flat_insn->detail, 0, sizeof(cs_detail));
+	}
+
 	DecodeStatus Result = readInstruction32((unsigned char*)code, &Insn, isBigEndian, false);
 	if (Result == MCDisassembler_Fail)
 		return MCDisassembler_Fail;

