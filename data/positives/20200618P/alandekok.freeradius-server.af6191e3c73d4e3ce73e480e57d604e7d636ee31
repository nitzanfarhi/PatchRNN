commit af6191e3c73d4e3ce73e480e57d604e7d636ee31
Author: Alan T. DeKok <aland@freeradius.org>
Date:   Fri Mar 6 08:36:24 2009 +0100

    Skip creation of zero-sized VSAs

diff --git a/src/lib/radius.c b/src/lib/radius.c
index c1fcb5f57..e3bb49d16 100644
--- a/src/lib/radius.c
+++ b/src/lib/radius.c
@@ -2463,7 +2463,7 @@ static uint8_t *rad_coalesce(int attribute, size_t length, uint8_t *data,
 static VALUE_PAIR *rad_continuation2vp(const RADIUS_PACKET *packet,
 				       const RADIUS_PACKET *original,
 				       const char *secret, int attribute,
-				       int length,
+				       int length, /* CANNOT be zero */
 				       uint8_t *data, size_t packet_length,
 				       int flag, DICT_ATTR *da)
 {
@@ -2845,6 +2845,11 @@ int rad_decode(RADIUS_PACKET *packet, RADIUS_PACKET *original,
 		if (vendorlen == 0) vendorcode = 0;
 		packet_length -= (vsa_tlen + vsa_llen + vsa_offset);
 
+		/*
+		 *	Ignore VSAs that have no data.
+		 */
+		if (attrlen == 0) goto next;
+
 		/*
 		 *	WiMAX attributes of type 0 are ignored.  They
 		 *	are a secret flag to us that the attribute has

