commit ead7be62cc004c44bdccb98534822d9743340711
Author: alobbs <alvaro@alobbs.com>
Date:   Sat May 21 17:22:58 2011 +0000

    "Pointer 'n' returned from call to function 'malloc' at line 90 may be
    NULL and will be dereferenced at line 92." (Klocwork.com Issue #92).
    
    git-svn-id: svn://cherokee-project.com/cherokee/trunk@6667 5dc97367-97f1-0310-9951-d761b3857238

diff --git a/cherokee/handler_cgi_base.c b/cherokee/handler_cgi_base.c
index 24fe3694..e86ca097 100644
--- a/cherokee/handler_cgi_base.c
+++ b/cherokee/handler_cgi_base.c
@@ -87,7 +87,12 @@ typedef struct {
 static env_item_t *
 env_item_new (cherokee_buffer_t *key, cherokee_buffer_t *val)
 {
-	env_item_t *n = malloc (sizeof (env_item_t));
+	env_item_t *n;
+
+	n = malloc (sizeof (env_item_t));
+	if (unlikely (n == NULL)) {
+		return NULL;
+	}
 
 	INIT_LIST_HEAD (&n->entry);
 	cherokee_buffer_init (&n->env);

