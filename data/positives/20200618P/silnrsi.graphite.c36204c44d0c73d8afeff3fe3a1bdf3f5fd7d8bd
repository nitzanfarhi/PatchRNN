commit c36204c44d0c73d8afeff3fe3a1bdf3f5fd7d8bd
Author: Martin Hosken <martin_hosken@sil.org>
Date:   Wed Mar 9 10:46:33 2016 +0700

    More cmap4 bounds checks

diff --git a/src/TtfUtil.cpp b/src/TtfUtil.cpp
index a80dda8..75e8da1 100644
--- a/src/TtfUtil.cpp
+++ b/src/TtfUtil.cpp
@@ -906,7 +906,7 @@ bool CheckCmapSubtable4(const void * pCmapSubtable4, const void * pCmapEnd /*, u
     if (length < sizeof(Sfnt::CmapSubTableFormat4))
         return false;
     uint16 nRanges = be::swap(pTable4->seg_count_x2) >> 1;
-    if (length < sizeof(Sfnt::CmapSubTableFormat4) + 4 * nRanges * sizeof(uint16))
+    if (!nRanges || length < sizeof(Sfnt::CmapSubTableFormat4) + 4 * nRanges * sizeof(uint16))
         return false;
     // check last range is properly terminated
     uint16 chEnd = be::peek<uint16>(pTable4->end_code + nRanges - 1);

