commit d93181ef3eacdb862d93448f31c97765a523d1db
Author: Andreas Cadhalpun <andreas.cadhalpun@googlemail.com>
Date:   Tue May 5 23:51:48 2015 +0200

    diracdec: check if reference could not be allocated
    
    s->ref_pics[i] is later used as ref argument of interpolate_refplane,
    where it is dereferenced.
    
    If it is NULL, it causes a segmentation fault.
    
    Signed-off-by: Andreas Cadhalpun <Andreas.Cadhalpun@googlemail.com>
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavcodec/diracdec.c b/libavcodec/diracdec.c
index adbe331e95..bb0f2c77d9 100644
--- a/libavcodec/diracdec.c
+++ b/libavcodec/diracdec.c
@@ -1745,6 +1745,12 @@ static int dirac_decode_picture_header(DiracContext *s)
                     get_buffer_with_edge(s->avctx, s->ref_pics[i]->avframe, AV_GET_BUFFER_FLAG_REF);
                     break;
                 }
+
+        if (!s->ref_pics[i]) {
+            av_log(s->avctx, AV_LOG_ERROR, "Reference could not be allocated\n");
+            return -1;
+        }
+
     }
 
     /* retire the reference frames that are not used anymore */

