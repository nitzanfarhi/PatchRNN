commit 5c210ac67c1562823c0ed9d3455544e07ceb3a6b
Author: Xing Zhang <xing.z.zhang@oracle.com>
Date:   Fri Aug 11 20:19:20 2017 +0800

    Bug #25426632: STRNXFRM RUNS SLOWER WHEN TAILORING RULE CONTAINS CONTRACTION
    
    Post push fix: free allocated memory if user defined collation is failed
                   to load.
    
    Change-Id: Ide0f2269ee83e68d03b721275e671065c52e5a2d

diff --git a/strings/ctype-uca.cc b/strings/ctype-uca.cc
index d612d38cc7b..2eb73426992 100644
--- a/strings/ctype-uca.cc
+++ b/strings/ctype-uca.cc
@@ -5126,7 +5126,11 @@ create_tailoring(CHARSET_INFO *cs, MY_CHARSET_LOADER *loader)
 ex:
   (loader->mem_free)(rules.rule);
   if (rc != 0 && loader->error[0])
+  {
+    if (new_uca.contraction_nodes)
+      delete new_uca.contraction_nodes;
     loader->reporter(ERROR_LEVEL, "%s", loader->error);
+  }
   return rc;
 }
 

