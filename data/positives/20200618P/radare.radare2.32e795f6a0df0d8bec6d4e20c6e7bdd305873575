commit 32e795f6a0df0d8bec6d4e20c6e7bdd305873575
Author: Anton Kochkov <anton.kochkov@gmail.com>
Date:   Wed Apr 30 03:08:24 2014 +0400

    Fix CID 1135019

diff --git a/libr/bin/format/pe/pe.c b/libr/bin/format/pe/pe.c
index 6d9eded38..aff6bfe57 100644
--- a/libr/bin/format/pe/pe.c
+++ b/libr/bin/format/pe/pe.c
@@ -671,6 +671,7 @@ struct r_bin_pe_lib_t* PE_(r_bin_pe_get_libs)(struct PE_(r_bin_pe_obj_t) *bin) {
 			if (r_buf_read_at(bin->b, PE_(r_bin_pe_rva_to_offset)(bin, bin->import_directory[i].Name),
 					(ut8*)libs[j].name, PE_STRING_LENGTH) == -1) {
 				eprintf("Error: read (libs - import dirs)\n");
+				free (libs);
 				return NULL;
 			}
 			if (PE_(r_bin_pe_rva_to_offset)(bin, bin->import_directory[i].Characteristics) == 0 &&

