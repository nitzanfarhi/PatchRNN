commit 295e65ca02e7cdf2d809b36a84b264c7935bfdfc
Author: toddouska <todd@wolfssl.com>
Date:   Mon Dec 1 14:23:10 2014 -0800

    add sanity size check to iv fill in case block size is bad

diff --git a/src/internal.c b/src/internal.c
index 700ddfa6..d395b977 100644
--- a/src/internal.c
+++ b/src/internal.c
@@ -7166,6 +7166,9 @@ static int BuildMessage(CYASSL* ssl, byte* output, int outSz,
             ivSz = blockSz;
             sz  += ivSz;
 
+            if (ivSz > (word32)sizeof(iv))
+                return BUFFER_E;
+
             ret = RNG_GenerateBlock(ssl->rng, iv, ivSz);
             if (ret != 0)
                 return ret;

