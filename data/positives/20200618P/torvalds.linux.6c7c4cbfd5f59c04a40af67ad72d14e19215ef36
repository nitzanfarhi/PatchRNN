commit 6c7c4cbfd5f59c04a40af67ad72d14e19215ef36
Author: Thomas Pedersen <thomas@cozybit.com>
Date:   Thu Jun 20 23:50:59 2013 -0700

    mac80211: initialize power mode for mesh STAs
    
    Previously the default mesh STA nonpeer power mode was
    UNKNOWN (0) make the default mesh STA power mode ACTIVE,
    to prevent unnecessary  frame buffering while peering is
    not yet complete. Fixes a panic in ath9k_htc when adding
    stations from userspace, and mcast buffered frames are
    later released.
    
    Thanks to Bob Copeland for his help debugging this.
    
    Signed-off-by: Thomas Pedersen <thomas@cozybit.com>
    Signed-off-by: Johannes Berg <johannes.berg@intel.com>

diff --git a/net/mac80211/sta_info.c b/net/mac80211/sta_info.c
index aaf68d297221..aeb967a0aeed 100644
--- a/net/mac80211/sta_info.c
+++ b/net/mac80211/sta_info.c
@@ -347,6 +347,7 @@ struct sta_info *sta_info_alloc(struct ieee80211_sub_if_data *sdata,
 	if (ieee80211_vif_is_mesh(&sdata->vif) &&
 	    !sdata->u.mesh.user_mpm)
 		init_timer(&sta->plink_timer);
+	sta->nonpeer_pm = NL80211_MESH_POWER_ACTIVE;
 #endif
 
 	memcpy(sta->sta.addr, addr, ETH_ALEN);

