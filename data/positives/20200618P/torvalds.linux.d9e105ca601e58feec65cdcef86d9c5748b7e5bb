commit d9e105ca601e58feec65cdcef86d9c5748b7e5bb
Author: Robin Murphy <robin.murphy@arm.com>
Date:   Thu Mar 3 16:35:35 2016 +0000

    tty: amba-pl011: don't dereference NULL platform data
    
    When only a TX DMA channel is specified in DT, pl011_dma_probe() falls
    back to looking for the optional RX channel in platform data. What it
    doesn't do is check whether that platform data actually exists...
    
    Add the missing check to avoid crashing the kernel.
    
    Signed-off-by: Robin Murphy <robin.murphy@arm.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

diff --git a/drivers/tty/serial/amba-pl011.c b/drivers/tty/serial/amba-pl011.c
index 500232ad38f3..3f169275f9fa 100644
--- a/drivers/tty/serial/amba-pl011.c
+++ b/drivers/tty/serial/amba-pl011.c
@@ -420,7 +420,7 @@ static void pl011_dma_probe(struct uart_amba_port *uap)
 	/* Optionally make use of an RX channel as well */
 	chan = dma_request_slave_channel(dev, "rx");
 
-	if (!chan && plat->dma_rx_param) {
+	if (!chan && plat && plat->dma_rx_param) {
 		chan = dma_request_channel(mask, plat->dma_filter, plat->dma_rx_param);
 
 		if (!chan) {

