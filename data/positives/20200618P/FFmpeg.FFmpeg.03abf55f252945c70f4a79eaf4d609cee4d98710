commit 03abf55f252945c70f4a79eaf4d609cee4d98710
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Sat Dec 6 00:18:29 2014 +0100

    avformat/rmdec: Check for overflow in ff_rm_read_mdpr_codecdata()
    
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavformat/rmdec.c b/libavformat/rmdec.c
index e267b01a1a..299c74237c 100644
--- a/libavformat/rmdec.c
+++ b/libavformat/rmdec.c
@@ -414,7 +414,11 @@ int ff_rm_read_mdpr_codecdata(AVFormatContext *s, AVIOContext *pb,
 skip:
     /* skip codec info */
     size = avio_tell(pb) - codec_pos;
-    avio_skip(pb, codec_data_size - size);
+    if (codec_data_size >= size) {
+        avio_skip(pb, codec_data_size - size);
+    } else {
+        av_log(s, AV_LOG_WARNING, "codec_data_size %u < size %d\n", codec_data_size, size);
+    }
 
     return 0;
 }

