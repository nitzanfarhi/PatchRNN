commit 97b0e99e2a46012d7f8cafe6591c137af4dc3fca
Author: Quora Dodrill <quora@lavabit.com>
Date:   Wed Aug 14 09:54:57 2013 -0700

    libratbox/openssl: Fix possible memory leak with SSL certificate fingerprints

diff --git a/libratbox/src/openssl.c b/libratbox/src/openssl.c
index f00d14ad..693a49d5 100644
--- a/libratbox/src/openssl.c
+++ b/libratbox/src/openssl.c
@@ -644,6 +644,7 @@ rb_get_ssl_certfp(rb_fde_t *F, uint8_t certfp[RB_SSL_CERTFP_LEN])
 				res == X509_V_ERR_DEPTH_ZERO_SELF_SIGNED_CERT)
 		{
 			memcpy(certfp, cert->sha1_hash, RB_SSL_CERTFP_LEN);
+			X509_free(cert);
 			return 1;
 		}
 		X509_free(cert);

