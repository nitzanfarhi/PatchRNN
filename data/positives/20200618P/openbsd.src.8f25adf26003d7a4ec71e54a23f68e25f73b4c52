commit 8f25adf26003d7a4ec71e54a23f68e25f73b4c52
Author: deraadt <deraadt@openbsd.org>
Date:   Tue Mar 11 02:32:29 2003 +0000

    strcpy -> strlcpy; Hans-Joerg.Hoexer@yerbouti.franken.de

diff --git a/sbin/mount_portal/pt_tcp.c b/sbin/mount_portal/pt_tcp.c
index e5f0908332a..5e9c61a9004 100644
--- a/sbin/mount_portal/pt_tcp.c
+++ b/sbin/mount_portal/pt_tcp.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: pt_tcp.c,v 1.5 1997/08/18 03:11:25 millert Exp $	*/
+/*	$OpenBSD: pt_tcp.c,v 1.6 2003/03/11 02:32:29 deraadt Exp $	*/
 /*	$NetBSD: pt_tcp.c,v 1.9 1995/05/21 15:33:22 mycroft Exp $	*/
 
 /*
@@ -88,7 +88,7 @@ portal_tcp(pcr, key, v, kso, fdp)
 	if (q == 0 || q - p >= sizeof(host))
 		return (EINVAL);
 	*q = '\0';
-	(void)strcpy(host, p);
+	(void)strlcpy(host, p, sizeof(host));
 	p = q + 1;
 
 	q = strchr(p, '/');
@@ -96,7 +96,7 @@ portal_tcp(pcr, key, v, kso, fdp)
 		*q = '\0';
 	if (strlen(p) >= sizeof(port))
 		return (EINVAL);
-	(void)strcpy(port, p);
+	(void)strlcpy(port, p, sizeof(port));
 	if (q) {
 		p = q + 1;
 		if (strcmp(p, "priv") == 0) {
diff --git a/sbin/quotacheck/quotacheck.c b/sbin/quotacheck/quotacheck.c
index f7394031e21..3093983ce1d 100644
--- a/sbin/quotacheck/quotacheck.c
+++ b/sbin/quotacheck/quotacheck.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: quotacheck.c,v 1.14 2002/07/03 22:32:33 deraadt Exp $	*/
+/*	$OpenBSD: quotacheck.c,v 1.15 2003/03/11 02:32:31 deraadt Exp $	*/
 /*	$NetBSD: quotacheck.c,v 1.12 1996/03/30 22:34:25 mark Exp $	*/
 
 /*
@@ -47,7 +47,7 @@ static char copyright[] =
 #if 0
 static char sccsid[] = "@(#)quotacheck.c	8.3 (Berkeley) 1/29/94";
 #else
-static char rcsid[] = "$OpenBSD: quotacheck.c,v 1.14 2002/07/03 22:32:33 deraadt Exp $";
+static char rcsid[] = "$OpenBSD: quotacheck.c,v 1.15 2003/03/11 02:32:31 deraadt Exp $";
 #endif
 #endif /* not lint */
 
@@ -489,7 +489,7 @@ hasquota(struct fstab *fs, int type, char **qfnamep)
 		    "%s%s", qfextension[GRPQUOTA], qfname);
 		initname = 1;
 	}
-	strcpy(buf, fs->fs_mntops);
+	(void)strlcpy(buf, fs->fs_mntops, sizeof(buf));
 	for (opt = strtok(buf, ","); opt; opt = strtok(NULL, ",")) {
 		if ((cp = strchr(opt, '=')) != NULL)
 			*cp++ = '\0';
diff --git a/sbin/route/route.c b/sbin/route/route.c
index 6f239e6882e..91b81cf0fe2 100644
--- a/sbin/route/route.c
+++ b/sbin/route/route.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: route.c,v 1.54 2003/01/31 17:51:16 millert Exp $	*/
+/*	$OpenBSD: route.c,v 1.55 2003/03/11 02:32:31 deraadt Exp $	*/
 /*	$NetBSD: route.c,v 1.16 1996/04/15 18:27:05 cgd Exp $	*/
 
 /*
@@ -44,7 +44,7 @@ static const char copyright[] =
 #if 0
 static const char sccsid[] = "@(#)route.c	8.3 (Berkeley) 3/19/94";
 #else
-static const char rcsid[] = "$OpenBSD: route.c,v 1.54 2003/01/31 17:51:16 millert Exp $";
+static const char rcsid[] = "$OpenBSD: route.c,v 1.55 2003/03/11 02:32:31 deraadt Exp $";
 #endif
 #endif /* not lint */
 
@@ -372,14 +372,14 @@ routename(struct sockaddr *sa)
 		first = 0;
 		if (gethostname(domain, sizeof domain) == 0 &&
 		    (cp = strchr(domain, '.')))
-			(void) strcpy(domain, cp + 1);
+			(void) strlcpy(domain, cp + 1, sizeof domain);
 		else
 			domain[0] = 0;
 		cp = NULL;
 	}
 
 	if (sa->sa_len == 0)
-		strcpy(line, "default");
+		(void) strlcpy(line, "default", sizeof line);
 	else switch (sa->sa_family) {
 
 	case AF_INET:
diff --git a/sbin/routed/rtquery/rtquery.c b/sbin/routed/rtquery/rtquery.c
index 89a9a91eff3..99e34a931d9 100644
--- a/sbin/routed/rtquery/rtquery.c
+++ b/sbin/routed/rtquery/rtquery.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: rtquery.c,v 1.10 2001/03/08 21:41:49 deraadt Exp $	*/
+/*	$OpenBSD: rtquery.c,v 1.11 2003/03/11 02:32:31 deraadt Exp $	*/
 
 /*-
  * Copyright (c) 1982, 1986, 1993
@@ -488,7 +488,7 @@ rip_input(struct sockaddr_in *from,
 		name = "";
 		if (n->n_family == RIP_AF_INET) {
 			in.s_addr = n->n_dst;
-			(void)strcpy(net_buf, inet_ntoa(in));
+			(void)strlcpy(net_buf, inet_ntoa(in), sizeof(net_buf));
 
 			mask = ntohl(n->n_mask);
 			dmask = mask & -mask;

