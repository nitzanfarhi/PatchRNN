commit 777e5d3ed55749e44febe3ae18dd9f0050bb8102
Author: Chase Southwood <chase.southwood@yahoo.com>
Date:   Fri Feb 7 23:02:27 2014 -0600

    Staging: comedi: fix memory leak in comedi_bond.c
    
    We allocate bdev and then krealloc the devs pointer in order to add bdev
    at the end of the devpriv->devs array list.  But if for some reason this
    krealloc fails, we need to free bdev before returning an error otherwise
    this memory is leaked.
    
    Signed-off-by: Chase Southwood <chase.southwood@yahoo.com>
    Acked-by: Ian Abbott <abbotti@mev.co.uk>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

diff --git a/drivers/staging/comedi/drivers/comedi_bond.c b/drivers/staging/comedi/drivers/comedi_bond.c
index 51a59e5b8ec5..406aedb5382e 100644
--- a/drivers/staging/comedi/drivers/comedi_bond.c
+++ b/drivers/staging/comedi/drivers/comedi_bond.c
@@ -254,6 +254,7 @@ static int do_dev_config(struct comedi_device *dev, struct comedi_devconfig *it)
 			if (!devs) {
 				dev_err(dev->class_dev,
 					"Could not allocate memory. Out of memory?\n");
+				kfree(bdev);
 				return -ENOMEM;
 			}
 			devpriv->devs = devs;

