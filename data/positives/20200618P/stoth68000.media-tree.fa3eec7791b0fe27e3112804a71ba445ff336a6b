commit fa3eec7791b0fe27e3112804a71ba445ff336a6b
Author: Mark Brown <broonie@kernel.org>
Date:   Wed Jul 1 23:51:43 2015 +0100

    regmap: Silence warning on invalid zero length read
    
    Zero length reads make no sense in a regmap context and are likely to
    trigger bugs further down the stack so insert an error check, also
    silencing compiler warnings about use of ret in cases where we iterate
    per register.
    
    Reported-by: Russell King <rmk+kernel@arm.linux.org.uk>
    Signed-off-by: Mark Brown <broonie@kernel.org>

diff --git a/drivers/base/regmap/regmap.c b/drivers/base/regmap/regmap.c
index 8894b992043e..9c1f856842a3 100644
--- a/drivers/base/regmap/regmap.c
+++ b/drivers/base/regmap/regmap.c
@@ -2180,6 +2180,8 @@ int regmap_raw_read(struct regmap *map, unsigned int reg, void *val,
 		return -EINVAL;
 	if (reg % map->reg_stride)
 		return -EINVAL;
+	if (val_count == 0)
+		return -EINVAL;
 
 	map->lock(map->lock_arg);
 

