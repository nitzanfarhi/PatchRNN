commit 1f492fa7437122492e988d545dc60bfdd81ae691
Author: Andrew Beekhof <andrew@beekhof.net>
Date:   Mon Jul 23 20:57:52 2012 +1000

    High: ipc: Prevent use-of-NULL when destroying an non-existant IPC server

diff --git a/lib/common/mainloop.c b/lib/common/mainloop.c
index 159b1cc78..9063a2797 100644
--- a/lib/common/mainloop.c
+++ b/lib/common/mainloop.c
@@ -421,7 +421,9 @@ gio_poll_dispatch_del(int32_t fd)
     crm_trace("Looking for fd=%d", fd);
     if (qb_array_index(gio_map, fd, (void**)&adaptor) == 0) {
         crm_trace("Marking adaptor %p unused", adaptor);
-        g_io_channel_unref(adaptor->channel);
+        if(adaptor->channel) {
+            g_io_channel_unref(adaptor->channel);
+        }
         adaptor->is_used = QB_FALSE;
     }
     return 0;
@@ -478,7 +480,9 @@ qb_ipcs_service_t *mainloop_add_ipc_server(
 
 void mainloop_del_ipc_server(qb_ipcs_service_t *server) 
 {
-    qb_ipcs_destroy(server);
+    if(server) {
+        qb_ipcs_destroy(server);
+    }
 }
 
 struct mainloop_io_s

