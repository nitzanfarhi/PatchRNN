commit 1d2932de4cefcc200f175863a42c311916269981
Author: Eric Dequin <Dequin_Eric@emc.com>
Date:   Thu Feb 12 10:44:30 2015 -0500

    Missing OPENSSL_free on error path.
    
    Reviewed-by: Andy Polyakov <appro@openssl.org>
    Reviewed-by: Richard Levitte <levitte@openssl.org>

diff --git a/ssl/t1_enc.c b/ssl/t1_enc.c
index 0c49619b5d..7333ba926b 100644
--- a/ssl/t1_enc.c
+++ b/ssl/t1_enc.c
@@ -649,6 +649,7 @@ int tls1_setup_key_block(SSL *s)
 
     if ((p2 = (unsigned char *)OPENSSL_malloc(num)) == NULL) {
         SSLerr(SSL_F_TLS1_SETUP_KEY_BLOCK, ERR_R_MALLOC_FAILURE);
+        OPENSSL_free(p1);
         goto err;
     }
 #ifdef TLS_DEBUG

