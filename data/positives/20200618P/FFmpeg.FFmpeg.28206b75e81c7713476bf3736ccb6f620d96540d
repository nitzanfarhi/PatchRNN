commit 28206b75e81c7713476bf3736ccb6f620d96540d
Author: John Adlum <john.adlum@nospam>
Date:   Wed Jul 1 16:08:05 2015 +0200

    avformat/asfdec_f: Correct skip to key code
    
    Fixes Ticket3978
    
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavformat/asfdec_f.c b/libavformat/asfdec_f.c
index db8791e980..554989e068 100644
--- a/libavformat/asfdec_f.c
+++ b/libavformat/asfdec_f.c
@@ -1208,7 +1208,8 @@ static int asf_parse_packet(AVFormatContext *s, AVIOContext *pb, AVPacket *pkt)
                 continue;
             }
             asf->asf_st = &asf->streams[s->streams[asf->stream_index]->id];
-            asf->asf_st->skip_to_key = 0;
+            if (!asf->packet_frag_offset)
+                asf->asf_st->skip_to_key = 0;
         }
         asf_st = asf->asf_st;
         av_assert0(asf_st);

