commit ab5e8625e64d9738d8c2ec9a963f24b590bc1e17
Author: Gao,Yan <ygao@suse.com>
Date:   Mon Oct 8 18:22:34 2012 +0800

    High: PE: Fix memory leak on processing message (bnc#780224)

diff --git a/pengine/pengine.c b/pengine/pengine.c
index 4ccf97901..9db241ab7 100644
--- a/pengine/pengine.c
+++ b/pengine/pengine.c
@@ -114,10 +114,12 @@ process_pe_message(xmlNode * msg, xmlNode * xml_data, qb_ipcs_connection_t* send
             crm_xml_add_int(data_set.graph, "transition_id", 0);
             crm_xml_add_int(data_set.graph, "cluster-delay", 0);
             process = FALSE;
+            free(digest);
 
         } else if (safe_str_eq(digest, last_digest)) {
             crm_info("Input has not changed since last time, not saving to disk");
             is_repoke = TRUE;
+            free(digest);
 
         } else {
             free(last_digest);

