commit 92896a8aabdb9a9b5b98d4a48e686d4eb78131cf
Author: Love Hörnquist Åstrand <lha@kth.se>
Date:   Thu Dec 11 05:01:20 2008 +0000

    check that ctx is not a null ptr before deref cid#140
    
    git-svn-id: svn://svn.h5l.se/heimdal/trunk/heimdal@24110 ec53bebd-3082-4978-b11e-865c3cabbd6b

diff --git a/lib/gssapi/mech/gss_pseudo_random.c b/lib/gssapi/mech/gss_pseudo_random.c
index b907f9403..771efcb43 100644
--- a/lib/gssapi/mech/gss_pseudo_random.c
+++ b/lib/gssapi/mech/gss_pseudo_random.c
@@ -45,7 +45,7 @@ gss_pseudo_random(OM_uint32 *minor_status,
 		  gss_buffer_t prf_out)
 {
     struct _gss_context *ctx = (struct _gss_context *) context;
-    gssapi_mech_interface m = ctx->gc_mech;
+    gssapi_mech_interface m;
     OM_uint32 major_status;
 
     _mg_buffer_zero(prf_out);
@@ -56,6 +56,8 @@ gss_pseudo_random(OM_uint32 *minor_status,
 	return GSS_S_NO_CONTEXT;
     }
 
+    m = ctx->gc_mech;
+
     if (m->gm_pseudo_random == NULL)
 	return GSS_S_UNAVAILABLE;
 

