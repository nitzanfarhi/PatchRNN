commit 1f7de853306499b83e627a09b15281fd6d566a51
Author: Dominik Dingel <dingel@linux.vnet.ibm.com>
Date:   Mon Apr 29 04:52:05 2013 +0000

    S390: BIOS check for file
    
    Add a check if the BIOS blob exists before trying to load.
    
    Signed-off-by: Dominik Dingel <dingel@linux.vnet.ibm.com>
    Signed-off-by: Alexander Graf <agraf@suse.de>

diff --git a/hw/s390x/ipl.c b/hw/s390x/ipl.c
index ace5ff50d1..cc3cd2352b 100644
--- a/hw/s390x/ipl.c
+++ b/hw/s390x/ipl.c
@@ -82,6 +82,10 @@ static int s390_ipl_init(SysBusDevice *dev)
         }
 
         bios_filename = qemu_find_file(QEMU_FILE_TYPE_BIOS, bios_name);
+        if (bios_filename == NULL) {
+            hw_error("could not find stage1 bootloader\n");
+        }
+
         bios_size = load_elf(bios_filename, NULL, NULL, &ipl->start_addr, NULL,
                              NULL, 1, ELF_MACHINE, 0);
         if (bios_size == -1UL) {

