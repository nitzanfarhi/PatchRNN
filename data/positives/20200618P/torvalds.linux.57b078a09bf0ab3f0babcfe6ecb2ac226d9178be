commit 57b078a09bf0ab3f0babcfe6ecb2ac226d9178be
Author: Liu Shuo <b35362@freescale.com>
Date:   Tue Jun 28 09:50:51 2011 +0800

    mtd: nand: don't free the global data too early
    
    The global data fsl_lbc_ctrl_dev->nand don't have to be freed in
    fsl_elbc_chip_remove(). The right place to do that is in fsl_elbc_nand_remove()
    if elbc_fcm_ctrl->counter is zero.
    
    Signed-off-by: Liu Shuo <b35362@freescale.com>
    Signed-off-by: Artem Bityutskiy <dedekind1@gmail.com>

diff --git a/drivers/mtd/nand/fsl_elbc_nand.c b/drivers/mtd/nand/fsl_elbc_nand.c
index 915b4a4c06c2..3c2f03c55cac 100644
--- a/drivers/mtd/nand/fsl_elbc_nand.c
+++ b/drivers/mtd/nand/fsl_elbc_nand.c
@@ -829,7 +829,6 @@ static int fsl_elbc_chip_remove(struct fsl_elbc_mtd *priv)
 
 	elbc_fcm_ctrl->chips[priv->bank] = NULL;
 	kfree(priv);
-	kfree(elbc_fcm_ctrl);
 	return 0;
 }
 

