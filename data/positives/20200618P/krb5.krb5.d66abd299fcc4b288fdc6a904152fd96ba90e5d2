commit d66abd299fcc4b288fdc6a904152fd96ba90e5d2
Author: Greg Hudson <ghudson@mit.edu>
Date:   Sun Feb 13 18:48:06 2011 +0000

    Reposition a trace call which was dereferencing freed memory after
    r24616.
    
    ticket: 6855
    
    git-svn-id: svn://anonsvn.mit.edu/krb5/trunk@24633 dc483132-0cff-0310-8789-dd5450dbe970

diff --git a/src/lib/krb5/krb/rd_req_dec.c b/src/lib/krb5/krb/rd_req_dec.c
index e065e2157..80d5cc50f 100644
--- a/src/lib/krb5/krb/rd_req_dec.c
+++ b/src/lib/krb5/krb/rd_req_dec.c
@@ -146,11 +146,12 @@ try_one_princ(krb5_context context, const krb5_ap_req *req,
     if (ret)
         return ret;
     ret = try_one_entry(context, req, &ent, keyblock_out);
+    if (ret == 0)
+        TRACE_RD_REQ_DECRYPT_SPECIFIC(context, ent.principal, &ent.key);
     (void)krb5_free_keytab_entry_contents(context, &ent);
     if (ret)
         return ret;
 
-    TRACE_RD_REQ_DECRYPT_SPECIFIC(context, ent.principal, &ent.key);
     return 0;
 }
 

