commit a009b9b5c13924c5fd017a231c99f6d9e8d0d330
Author: ps57422 <none@none>
Date:   Mon Jun 26 07:04:03 2006 -0700

    6434595  Memory leak in passwdutil.so.1

diff --git a/usr/src/lib/passwdutil/files_attr.c b/usr/src/lib/passwdutil/files_attr.c
index 9f1eab04f2..ff6bf63898 100644
--- a/usr/src/lib/passwdutil/files_attr.c
+++ b/usr/src/lib/passwdutil/files_attr.c
@@ -601,6 +601,7 @@ getattr_exit:
 	if (pwbuf->pwd) free(pwbuf->pwd);
 	if (pwbuf->pwd_scratch) free(pwbuf->pwd_scratch);
 	if (pwbuf->spwd) free(pwbuf->spwd);
+	if (pwbuf->spwd_scratch) free(pwbuf->spwd_scratch);
 	free(pwbuf);
 
 	return (res);

