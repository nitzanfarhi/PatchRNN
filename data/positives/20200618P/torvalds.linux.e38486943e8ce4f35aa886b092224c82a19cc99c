commit e38486943e8ce4f35aa886b092224c82a19cc99c
Author: Mika Kuoppala <mika.kuoppala@linux.intel.com>
Date:   Fri Jan 31 17:14:02 2014 +0200

    drm/i915: release mutex in i915_gem_init()'s error path
    
    Found with smatch.
    
    Signed-off-by: Mika Kuoppala <mika.kuoppala@intel.com>
    Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>

diff --git a/drivers/gpu/drm/i915/i915_gem.c b/drivers/gpu/drm/i915/i915_gem.c
index d230c3bbb4ff..4054ce47a805 100644
--- a/drivers/gpu/drm/i915/i915_gem.c
+++ b/drivers/gpu/drm/i915/i915_gem.c
@@ -4467,8 +4467,10 @@ int i915_gem_init(struct drm_device *dev)
 	i915_gem_init_global_gtt(dev);
 
 	ret = i915_gem_context_init(dev);
-	if (ret)
+	if (ret) {
+		mutex_unlock(&dev->struct_mutex);
 		return ret;
+	}
 
 	ret = i915_gem_init_hw(dev);
 	mutex_unlock(&dev->struct_mutex);

