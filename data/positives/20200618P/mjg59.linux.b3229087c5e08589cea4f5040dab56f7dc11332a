commit b3229087c5e08589cea4f5040dab56f7dc11332a
Author: Greg Kroah-Hartman <gregkh@suse.de>
Date:   Thu Mar 16 15:44:26 2006 -0800

    [PATCH] sysfs: fix a kobject leak in sysfs_add_link on the error path
    
    As pointed out by Oliver Neukum.
    
    Cc: Maneesh Soni <maneesh@in.ibm.com>
    Cc: Oliver Neukum <oliver@neukum.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

diff --git a/fs/sysfs/symlink.c b/fs/sysfs/symlink.c
index fe23f47f6e43..d2eac3ceed5f 100644
--- a/fs/sysfs/symlink.c
+++ b/fs/sysfs/symlink.c
@@ -66,6 +66,7 @@ static int sysfs_add_link(struct dentry * parent, const char * name, struct kobj
 	if (!error)
 		return 0;
 
+	kobject_put(target);
 	kfree(sl->link_name);
 exit2:
 	kfree(sl);

