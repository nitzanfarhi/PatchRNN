commit ece76e198755dc1c30582b54fb710a7d7a813b0a
Author: angelos <angelos@openbsd.org>
Date:   Sun May 27 03:54:12 2001 +0000

    Free IPsec authentication material on PCB tear down.

diff --git a/sys/netinet/in_pcb.c b/sys/netinet/in_pcb.c
index 88b6d935cb5..d90485ec3c8 100644
--- a/sys/netinet/in_pcb.c
+++ b/sys/netinet/in_pcb.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: in_pcb.c,v 1.51 2001/05/21 03:02:18 angelos Exp $	*/
+/*	$OpenBSD: in_pcb.c,v 1.52 2001/05/27 03:54:12 angelos Exp $	*/
 /*	$NetBSD: in_pcb.c,v 1.25 1996/02/13 23:41:53 christos Exp $	*/
 
 /*
@@ -568,6 +568,8 @@ in_pcbdetach(v)
 		ipsp_reffree(inp->inp_ipsec_localcred);
 	if (inp->inp_ipsec_remotecred)
 		ipsp_reffree(inp->inp_ipsec_remotecred);
+	if (inp->inp_ipsec_auth)
+		ipsp_reffree(inp->inp_ipsec_auth);
 	splx(s);
 #endif
 	s = splnet();

