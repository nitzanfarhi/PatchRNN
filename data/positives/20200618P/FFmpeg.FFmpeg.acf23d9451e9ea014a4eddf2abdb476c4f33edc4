commit acf23d9451e9ea014a4eddf2abdb476c4f33edc4
Author: Michael Niedermayer <michael@niedermayer.cc>
Date:   Sat Oct 17 02:44:43 2015 +0200

    avformat/genh: Check av_new_packet() return value
    
    Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>

diff --git a/libavformat/genh.c b/libavformat/genh.c
index 103912bf98..3a4faf9152 100644
--- a/libavformat/genh.c
+++ b/libavformat/genh.c
@@ -153,7 +153,9 @@ static int genh_read_packet(AVFormatContext *s, AVPacket *pkt)
 
         if (avio_feof(s->pb))
             return AVERROR_EOF;
-        av_new_packet(pkt, 8 * codec->channels);
+        ret = av_new_packet(pkt, 8 * codec->channels);
+        if (ret < 0)
+            return ret;
         for (i = 0; i < 8 / c->interleave_size; i++) {
             for (ch = 0; ch < codec->channels; ch++) {
                 pkt->data[ch * 8 + i*c->interleave_size+0] = avio_r8(s->pb);

