commit 6cc0c259d034c6ab48f4e12f505213988e73d380
Author: Colin Ian King <colin.king@canonical.com>
Date:   Tue Feb 28 11:47:33 2017 +0000

    staging: wilc1000: add check for kmalloc allocation failure.
    
    Add a sanity check that wid.val has been allocated, fixes a null
    pointer deference on stamac when calling ether_add_copy.
    
    Detected by CoverityScan, CID#1369537 ("Dereference null return value")
    
    Signed-off-by: Colin Ian King <colin.king@canonical.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

diff --git a/drivers/staging/wilc1000/host_interface.c b/drivers/staging/wilc1000/host_interface.c
index c2a3424c35cb..f848bb85ff1f 100644
--- a/drivers/staging/wilc1000/host_interface.c
+++ b/drivers/staging/wilc1000/host_interface.c
@@ -1928,6 +1928,8 @@ static s32 Handle_Get_InActiveTime(struct wilc_vif *vif,
 	wid.type = WID_STR;
 	wid.size = ETH_ALEN;
 	wid.val = kmalloc(wid.size, GFP_KERNEL);
+	if (!wid.val)
+		return -ENOMEM;
 
 	stamac = wid.val;
 	ether_addr_copy(stamac, strHostIfStaInactiveT->mac);

