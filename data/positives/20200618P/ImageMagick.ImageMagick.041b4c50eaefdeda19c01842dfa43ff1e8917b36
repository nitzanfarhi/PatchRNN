commit 041b4c50eaefdeda19c01842dfa43ff1e8917b36
Author: Cristy <urban-warrior@imagemagick.org>
Date:   Sun Feb 4 15:11:57 2018 -0500

    https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=5382

diff --git a/coders/xps.c b/coders/xps.c
index af33671d0..5a2e5bcaa 100644
--- a/coders/xps.c
+++ b/coders/xps.c
@@ -273,7 +273,10 @@ static Image *ReadXPSImage(const ImageInfo *image_info,ExceptionInfo *exception)
      else
        delegate_info=GetDelegateInfo("xps:color",(char *) NULL,exception);
   if (delegate_info == (const DelegateInfo *) NULL)
-    return((Image *) NULL);
+    {
+      image=DestroyImage(image);
+      return((Image *) NULL);
+    }
   density=AcquireString("");
   options=AcquireString("");
   (void) FormatLocaleString(density,MagickPathExtent,"%gx%g",

