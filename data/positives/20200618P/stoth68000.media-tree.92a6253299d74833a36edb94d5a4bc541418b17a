commit 92a6253299d74833a36edb94d5a4bc541418b17a
Author: Dan Carpenter <dan.carpenter@oracle.com>
Date:   Fri Mar 2 09:59:55 2012 +0300

    Staging: ozwpan: prevent bogus dereference
    
    app_id comes from the network and can't be trusted.  If it's zero then
    it will lead to a kernel crash.
    
    Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
    Acked-by: Chris Kelly <ckelly@ozmodevices.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

diff --git a/drivers/staging/ozwpan/ozpd.c b/drivers/staging/ozwpan/ozpd.c
index 8c460f075aec..e3381add51a4 100644
--- a/drivers/staging/ozwpan/ozpd.c
+++ b/drivers/staging/ozwpan/ozpd.c
@@ -806,7 +806,7 @@ void oz_apps_term(void)
 void oz_handle_app_elt(struct oz_pd *pd, u8 app_id, struct oz_elt *elt)
 {
 	struct oz_app_if *ai;
-	if (app_id > OZ_APPID_MAX)
+	if (app_id == 0 || app_id > OZ_APPID_MAX)
 		return;
 	ai = &g_app_if[app_id-1];
 	ai->rx(pd, elt);

