commit 196b3167efd13a02cdd34acc1a12316b9f45f41d
Author: Roel Kluin <roel.kluin@gmail.com>
Date:   Thu Oct 1 15:44:24 2009 -0700

    cyclades: fix read buffer overflow
    
    irq is declared with size NR_CARDS (4), but the loop containing this
    segment runs up until NR_ISA_ADDRS (16), possibly reading from irq[i] (and
    trying to use the result)
    
    Identified by the Parfait static scanner.
    
    Signed-off-by: Roel Kluin <roel.kluin@gmail.com>
    Acked-by: Jiri Slaby <jirislaby@gmail.com>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

diff --git a/drivers/char/cyclades.c b/drivers/char/cyclades.c
index df5038bbcbc2..4254457d3911 100644
--- a/drivers/char/cyclades.c
+++ b/drivers/char/cyclades.c
@@ -3354,7 +3354,7 @@ static int __init cy_detect_isa(void)
 			continue;
 		}
 #ifdef MODULE
-		if (isparam && irq[i])
+		if (isparam && i < NR_CARDS && irq[i])
 			cy_isa_irq = irq[i];
 		else
 #endif

