commit 3a72170fc894b12e12d3832e17b182f02def7371
Author: Shawn Webb <swebb@sourcefire.com>
Date:   Tue Feb 12 12:40:08 2013 -0500

    Fix CID 11338 by freeing prior to return

diff --git a/libclamav/message.c b/libclamav/message.c
index ca7f51197..e4ccc1f25 100644
--- a/libclamav/message.c
+++ b/libclamav/message.c
@@ -548,6 +548,7 @@ messageAddArguments(message *m, const char *s)
 				ptr = strchr(kcopy, ':');
                 if (ptr == NULL) {
                     cli_dbgmsg("Can't parse header \"%s\"\n", s);
+                    free(kcopy);
                     return;
                 }
             }

