commit d08c95b1d25037ea06824598647731586f7d9fc2
Author: Erik Lax <erik@halon.se>
Date:   Sun Mar 22 14:56:01 2015 -0700

    Leak in socket_select() when returning while having buffered data available
    
    Summary: This example leaks memory.
    
    ```
    $fp = pfsockopen('www.example.com', 80);
    fwrite($fp, "GET / HTTP/1.0\r\nHost: www.example.com\r\n\r\n");
    echo fgets($fp);
    while (1) {
            socket_select(array($fp), NULL, NULL, 0);
    }
    ```
    Closes https://github.com/facebook/hhvm/pull/5053
    
    Reviewed By: @JoelMarcey
    
    Differential Revision: D1933042

diff --git a/hphp/runtime/ext/sockets/ext_sockets.cpp b/hphp/runtime/ext/sockets/ext_sockets.cpp
index 2bab092ba1..58cbe07d44 100644
--- a/hphp/runtime/ext/sockets/ext_sockets.cpp
+++ b/hphp/runtime/ext/sockets/ext_sockets.cpp
@@ -899,6 +899,7 @@ Variant HHVM_FUNCTION(socket_select,
         except = empty_array();
       }
       read = hasData;
+      free(fds);
       return hasData.size();
     }
   }

