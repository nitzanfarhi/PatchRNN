commit 86f4d0123b1fddb47d35b9a893f8c0b94bf89abe
Author: Dan Carpenter <error27@gmail.com>
Date:   Sun Jul 19 14:47:45 2009 +0300

    intel-iommu: double kfree()
    
    g_iommus is freed after we "goto error;".
    
    Found by smatch (http://repo.or.cz/w/smatch.git).
    
    Signed-off-by: Dan Carpenter <error27@gmail.com>
    Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>

diff --git a/drivers/pci/intel-iommu.c b/drivers/pci/intel-iommu.c
index 86a83946a8f5..097d5da2fae1 100644
--- a/drivers/pci/intel-iommu.c
+++ b/drivers/pci/intel-iommu.c
@@ -2224,7 +2224,6 @@ int __init init_dmars(void)
 	deferred_flush = kzalloc(g_num_of_iommus *
 		sizeof(struct deferred_flush_tables), GFP_KERNEL);
 	if (!deferred_flush) {
-		kfree(g_iommus);
 		ret = -ENOMEM;
 		goto error;
 	}

