commit 793b346d86a03223e1289e5594616d8503553f4c
Author: Paul Wouters <paul@xelerance.com>
Date:   Tue May 13 12:26:03 2008 -0400

    Avoid malloc(0) by doing an early abort in show_connections_status() when
    there are 0 connections loaded.

diff --git a/programs/pluto/connections.c b/programs/pluto/connections.c
index cf898ed13..80916a15c 100644
--- a/programs/pluto/connections.c
+++ b/programs/pluto/connections.c
@@ -2959,6 +2959,10 @@ show_connections_status(void)
     {
 	count++;
     }
+    if(count == 0) 
+	/* abort early to avoid a malloc(0) that uclibc does not like */
+	return;
+
     array = alloc_bytes(sizeof(struct connection *)*count, "connection array");
 
     count=0;

