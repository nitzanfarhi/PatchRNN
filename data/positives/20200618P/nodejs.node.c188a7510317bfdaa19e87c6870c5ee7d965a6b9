commit c188a7510317bfdaa19e87c6870c5ee7d965a6b9
Author: Ben Noordhuis <info@bnoordhuis.nl>
Date:   Sun May 26 21:42:23 2013 +0200

    buffer: guard against integer overflow

diff --git a/src/node_buffer.cc b/src/node_buffer.cc
index 78d6aa4559..687545a205 100644
--- a/src/node_buffer.cc
+++ b/src/node_buffer.cc
@@ -404,7 +404,7 @@ Handle<Value> ReadFloatGeneric(const Arguments& args) {
       return ThrowTypeError("offset is not uint");
     size_t len = static_cast<size_t>(
                     args.This()->GetIndexedPropertiesExternalArrayDataLength());
-    if (offset + sizeof(T) > len)
+    if (offset + sizeof(T) > len || offset + sizeof(T) < offset)
       return ThrowRangeError("Trying to read beyond buffer length");
   }
 

