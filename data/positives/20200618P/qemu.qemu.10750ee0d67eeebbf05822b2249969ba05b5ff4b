commit 10750ee0d67eeebbf05822b2249969ba05b5ff4b
Author: Gerd Hoffmann <kraxel@redhat.com>
Date:   Mon Jul 10 09:04:32 2017 +0200

    virtio-gpu: skip update cursor in post_load if we don't have one
    
    If the cursor resource id isn't set the guest didn't define a cursor.
    Skip the cursor update in post_load in that that case.
    
    Reported-by: wanghaibin <wanghaibin.wang@huawei.com>
    Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
    Tested-by: wanghaibin <wanghaibin.wang@huawei.com>
    Message-id: 20170710070432.856-1-kraxel@redhat.com
    Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>

diff --git a/hw/display/virtio-gpu.c b/hw/display/virtio-gpu.c
index 0506d2c1b0..6aae147324 100644
--- a/hw/display/virtio-gpu.c
+++ b/hw/display/virtio-gpu.c
@@ -1092,7 +1092,9 @@ static int virtio_gpu_load(QEMUFile *f, void *opaque, size_t size,
 
         dpy_gfx_replace_surface(scanout->con, scanout->ds);
         dpy_gfx_update(scanout->con, 0, 0, scanout->width, scanout->height);
-        update_cursor(g, &scanout->cursor);
+        if (scanout->cursor.resource_id) {
+            update_cursor(g, &scanout->cursor);
+        }
         res->scanout_bitmask |= (1 << i);
     }
 

