commit 54241395a9dee247b5645fd44635c146af25c436
Author: Luke Dashjr <luke-jr+git@utopios.org>
Date:   Thu Sep 13 04:32:55 2012 +0000

    Bugfix: When comparing current block, only pay attention to the prevblock header
    
    Formerly, it included the version, which might not always be the same between pools

diff --git a/cgminer.c b/cgminer.c
index 45f4df07..441c8696 100644
--- a/cgminer.c
+++ b/cgminer.c
@@ -2558,7 +2558,7 @@ static void test_work_current(struct work *work)
 
 	uint32_t block_id = ((uint32_t*)(work->data))[1];
 
-	hexstr = bin2hex(work->data, 18);
+	hexstr = bin2hex(&work->data[4], 18);
 	if (unlikely(!hexstr)) {
 		applog(LOG_ERR, "stage_thread OOM");
 		return;

