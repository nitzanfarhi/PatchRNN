commit feedb4577030f0b4a8bec2edaadc22e728590082
Author: Victor Julien <victor@inliniac.net>
Date:   Wed Jan 22 09:36:28 2014 +0100

    stream: cast memcap checks to uint64_t

diff --git a/src/stream-tcp-reassemble.c b/src/stream-tcp-reassemble.c
index 3ae9dd7c..65de6175 100644
--- a/src/stream-tcp-reassemble.c
+++ b/src/stream-tcp-reassemble.c
@@ -154,7 +154,8 @@ void StreamTcpReassembleMemuseCounter(ThreadVars *tv, TcpReassemblyThreadCtx *rt
  * \retval 0 if not in bounds
  */
 int StreamTcpReassembleCheckMemcap(uint32_t size) {
-    if (stream_config.reassembly_memcap == 0 || size + SC_ATOMIC_GET(ra_memuse) <= stream_config.reassembly_memcap)
+    if (stream_config.reassembly_memcap == 0 ||
+            (uint64_t)((uint64_t)size + SC_ATOMIC_GET(ra_memuse)) <= stream_config.reassembly_memcap)
         return 1;
     return 0;
 }

