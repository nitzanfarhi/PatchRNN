commit c6e921e45f1257913848110189eab82a34aa2f8b
Author: Victor Seva <linuxmaniac@torreviejawireless.org>
Date:   Thu Oct 5 13:17:18 2017 +0200

    core: add safety check to rval_get_tmp_str()
    
    See #1263

diff --git a/src/core/rvalue.c b/src/core/rvalue.c
index 540f26620..fcb238d11 100644
--- a/src/core/rvalue.c
+++ b/src/core/rvalue.c
@@ -1099,6 +1099,10 @@ int rval_get_tmp_str(struct run_act_ctx* h, struct sip_msg* msg,
 	avp_t* r_avp;
 	int i;
 
+	if(rv==NULL) {
+		return -1;
+	}
+
 	switch(rv->type){
 		case RV_INT:
 			tmpv->s=sint2strbuf(rv->v.l, tmp_cache->i2s,

