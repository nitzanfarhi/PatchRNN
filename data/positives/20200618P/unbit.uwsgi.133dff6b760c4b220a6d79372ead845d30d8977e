commit 133dff6b760c4b220a6d79372ead845d30d8977e
Author: Riccardo Magliocchetti <riccardo.magliocchetti@gmail.com>
Date:   Sun Mar 3 18:51:46 2013 +0100

    core/alarm: fix memory leak in uwsgi_alarm_thread_loop
    
    Rpoerted by Coverity as CID #989247.

diff --git a/core/alarm.c b/core/alarm.c
index 46c53e66..2a60423a 100644
--- a/core/alarm.c
+++ b/core/alarm.c
@@ -201,11 +201,13 @@ static void uwsgi_alarm_thread_loop(struct uwsgi_thread *ut) {
 				long ptr = 0;
 				memcpy(&ptr, buf, sizeof(long));
 				struct uwsgi_alarm_instance *uai = (struct uwsgi_alarm_instance *) ptr;
-				if (!uai) return;
+				if (!uai)
+					break;
 				uwsgi_alarm_run(uai, msg, msg_size);
 			}
 		}
 	}
+	free(buf);
 }
 
 // initialize alarms, instances and log regexps

