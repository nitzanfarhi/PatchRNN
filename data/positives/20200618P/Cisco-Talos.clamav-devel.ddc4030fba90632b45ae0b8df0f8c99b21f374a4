commit ddc4030fba90632b45ae0b8df0f8c99b21f374a4
Author: Kevin Lin <klin@sourcefire.com>
Date:   Thu Feb 12 12:10:14 2015 -0800

    different initialization for ytable

diff --git a/libclamav/readdb.c b/libclamav/readdb.c
index 228ba6e53..783f82d16 100644
--- a/libclamav/readdb.c
+++ b/libclamav/readdb.c
@@ -2982,6 +2982,7 @@ static unsigned int yara_total, yara_loaded, yara_malform, yara_complex;
 static int load_oneyara(YR_RULE *rule, struct cl_engine *engine, unsigned int options, unsigned int *sigs)
 {
     YR_STRING *string;
+    struct cli_ytable ytable;
     int str_error = 0, i = 0, ret = CL_SUCCESS;
     struct cli_lsig_tdb tdb;
     uint32_t lsigid[2];
@@ -2993,10 +2994,10 @@ static int load_oneyara(YR_RULE *rule, struct cl_engine *engine, unsigned int op
     uint8_t has_short_string;
     char *exp_op = "|";
 
-    struct cli_ytable ytable = { 0 };
-
     cli_yaramsg("load_oneyara: attempting to load %s\n", rule->id);
 
+    memset(&ytable, 0, sizeof(ytable));
+
     if (!rule) {
         cli_errmsg("load_oneyara: empty rule passed as argument\n");
         return CL_ENULLARG;

