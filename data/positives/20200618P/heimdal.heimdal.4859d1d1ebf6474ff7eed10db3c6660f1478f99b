commit 4859d1d1ebf6474ff7eed10db3c6660f1478f99b
Author: Love Hörnquist Åstrand <lha@kth.se>
Date:   Thu Jan 19 18:33:20 2006 +0000

    (hx509_revoke_free): free all memory
    
    
    git-svn-id: svn://svn.h5l.se/heimdal/trunk/heimdal@16622 ec53bebd-3082-4978-b11e-865c3cabbd6b

diff --git a/lib/hx509/revoke.c b/lib/hx509/revoke.c
index d655e927b..d4e16564e 100644
--- a/lib/hx509/revoke.c
+++ b/lib/hx509/revoke.c
@@ -69,6 +69,7 @@ hx509_revoke_free(hx509_revoke_ctx *revoke)
 	free((*revoke)->crls.val[i].path);
 	free_CRLCertificateList(&(*revoke)->crls.val[i].crl);
     }
+    free((*revoke)->crls.val);
 
     memset(*revoke, 0, sizeof(**revoke));
     free(*revoke);
@@ -128,7 +129,8 @@ hx509_revoke_add_crl(hx509_context context,
 {
     size_t length, size;
     void *data;
-    int ret, i;
+    size_t i;
+    int ret;
 
     if (strncmp(path, "FILE:", 5) != 0)
 	return EINVAL;

