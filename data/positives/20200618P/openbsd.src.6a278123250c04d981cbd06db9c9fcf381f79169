commit 6a278123250c04d981cbd06db9c9fcf381f79169
Author: millert <millert@openbsd.org>
Date:   Sun Mar 1 20:06:30 1998 +0000

    If an /etc/exports entry has a single host that cannot be looked
    up, throw out the entire line.  A previous change that only throws
    out unknown hosts could leave the export host list null (ie:
    everyone) if all the listed hosts are unknown.

diff --git a/sbin/mountd/mountd.c b/sbin/mountd/mountd.c
index ab1731a1f3c..c96fc628a00 100644
--- a/sbin/mountd/mountd.c
+++ b/sbin/mountd/mountd.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: mountd.c,v 1.23 1997/12/19 09:21:40 deraadt Exp $	*/
+/*	$OpenBSD: mountd.c,v 1.24 1998/03/01 20:06:30 millert Exp $	*/
 /*	$NetBSD: mountd.c,v 1.31 1996/02/18 11:57:53 fvdl Exp $	*/
 
 /*
@@ -886,6 +886,10 @@ get_exportlist()
 			nextfield(&cp, &endcp);
 			len = endcp - cp;
 		}
+		if (has_host == FALSE && tgrp->gr_type == GT_NULL)  {
+			getexp_err(ep, tgrp);
+			goto nextline;
+		}
 		if (check_options(dirhead)) {
 			getexp_err(ep, tgrp);
 			goto nextline;

