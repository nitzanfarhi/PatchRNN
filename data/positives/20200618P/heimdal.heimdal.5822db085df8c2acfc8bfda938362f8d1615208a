commit 5822db085df8c2acfc8bfda938362f8d1615208a
Author: Nicolas Williams <nico@cryptonector.com>
Date:   Wed Apr 15 12:00:07 2015 -0500

    Fix memory leak in _gss_acquire_mech_cred

diff --git a/lib/gssapi/mech/gss_acquire_cred_ext.c b/lib/gssapi/mech/gss_acquire_cred_ext.c
index e2ae35752..9f2674c26 100644
--- a/lib/gssapi/mech/gss_acquire_cred_ext.c
+++ b/lib/gssapi/mech/gss_acquire_cred_ext.c
@@ -100,7 +100,10 @@ _gss_acquire_mech_cred(OM_uint32 *minor_status,
 	mc= NULL;
     }
 
-    *output_cred_handle = mc;
+    if (major_status != GSS_S_COMPLETE)
+        free(mc);
+    else
+        *output_cred_handle = mc;
     return major_status;
 }
 

