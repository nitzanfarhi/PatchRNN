commit cef701ede302a70f52bb1951f2dec2c0f88c2e5f
Author: Christian Brauner <christian.brauner@ubuntu.com>
Date:   Mon Apr 30 12:18:23 2018 +0200

    coverity: #1435263
    
    Use after free
    
    Signed-off-by: Christian Brauner <christian.brauner@ubuntu.com>

diff --git a/src/lxc/lxccontainer.c b/src/lxc/lxccontainer.c
index 568e102b..30efeaff 100644
--- a/src/lxc/lxccontainer.c
+++ b/src/lxc/lxccontainer.c
@@ -1634,11 +1634,12 @@ static bool prepend_lxc_header(char *path, const char *t, char *const argv[])
 	}
 
 	ret = sha1sum_file(tpath, md_value);
-	free(tpath);
 	if (ret < 0) {
 		ERROR("Failed to get sha1sum of %s", tpath);
+		free(tpath);
 		goto out_free_contents;
 	}
+	free(tpath);
 #endif
 
 	f = fopen(path, "w");

