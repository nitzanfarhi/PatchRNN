commit b01d001df22ef47b107a4abedd1c1a91a74650b7
Author: Timo Sirainen <timo.sirainen@dovecot.fi>
Date:   Wed May 31 00:07:46 2017 +0300

    imapc: Don't send UID FETCH 1:* after SELECT if mailbox is empty

diff --git a/src/lib-storage/index/imapc/imapc-sync.c b/src/lib-storage/index/imapc/imapc-sync.c
index 957b80a49..1e07e4a4e 100644
--- a/src/lib-storage/index/imapc/imapc-sync.c
+++ b/src/lib-storage/index/imapc/imapc-sync.c
@@ -401,6 +401,11 @@ imapc_sync_send_commands(struct imapc_sync_context *ctx, uint32_t first_uid)
 {
 	string_t *cmd = t_str_new(64);
 
+	if (ctx->mbox->exists_count == 0) {
+		/* empty mailbox - no point in fetching anything */
+		return;
+	}
+
 	str_printfa(cmd, "UID FETCH %u:* (FLAGS", first_uid);
 	if (imapc_mailbox_has_modseqs(ctx->mbox)) {
 		str_append(cmd, " MODSEQ");

