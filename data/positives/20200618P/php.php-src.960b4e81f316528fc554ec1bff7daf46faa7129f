commit 960b4e81f316528fc554ec1bff7daf46faa7129f
Author: Felipe Pena <felipensp@gmail.com>
Date:   Sat Oct 12 18:06:20 2013 -0300

    - Fixed possible memory leak

diff --git a/win32/readdir.c b/win32/readdir.c
index 9525fc0d6b..0edd5764d4 100644
--- a/win32/readdir.c
+++ b/win32/readdir.c
@@ -45,6 +45,7 @@ DIR *opendir(const char *dir)
 
 	dp = (DIR *) malloc(sizeof(DIR));
 	if (dp == NULL) {
+		free(filespec);
 		return NULL;
 	}
 	dp->offset = 0;

