commit 9dd04f6d8cdd1c10c28b2cb4252c1a41df581915
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Tue May 7 21:58:27 2013 +0200

    sanm: Check dimensions before use
    
    Fixes integer overflow and out of array accesses
    
    Found-by: Mateusz "j00ru" Jurczyk and Gynvael Coldwind
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavcodec/sanm.c b/libavcodec/sanm.c
index f217ef36bb..e6e866ef8e 100644
--- a/libavcodec/sanm.c
+++ b/libavcodec/sanm.c
@@ -732,6 +732,11 @@ static int process_frame_obj(SANMVideoContext *ctx)
     w     = bytestream2_get_le16u(&ctx->gb);
     h     = bytestream2_get_le16u(&ctx->gb);
 
+    if (!w || !h) {
+        av_log(ctx->avctx, AV_LOG_ERROR, "dimensions are invalid\n");
+        return AVERROR_INVALIDDATA;
+    }
+
     if (ctx->width < left + w || ctx->height < top + h) {
         if (av_image_check_size(FFMAX(left + w, ctx->width),
                                 FFMAX(top  + h, ctx->height), 0, ctx->avctx) < 0)

