commit d31284733637b207690735461851c243f3e1a165
Author: Danny Al-Gaaf <danny.al-gaaf@bisect.de>
Date:   Mon Apr 27 16:25:51 2015 +0200

    librbd/internal.cc: close resource leak
    
    Fix for:
    
    CID 1295405 (#1 of 1): Resource leak (RESOURCE_LEAK)
     leaked_storage: Variable req_comp going out of scope leaks
     the storage it points to.
    
    Signed-off-by: Danny Al-Gaaf <danny.al-gaaf@bisect.de>

diff --git a/src/librbd/internal.cc b/src/librbd/internal.cc
index a0b590f441..d076ab1120 100644
--- a/src/librbd/internal.cc
+++ b/src/librbd/internal.cc
@@ -3936,6 +3936,7 @@ reprotect_and_return_err:
                               req_comp);
       } else {
 	if(ictx->cct->_conf->rbd_skip_partial_discard) {
+	  delete req_comp;
 	  continue;
 	}
 	req = new AioZero(ictx, p->oid.name, p->objectno, p->offset, p->length,

