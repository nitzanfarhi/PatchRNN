commit 8814b7c1d103567289fbf9d92269f2a4506b5819
Author: alobbs <alvaro@alobbs.com>
Date:   Sun Jan 2 09:48:23 2011 +0000

    Fixes a memory management issue. The 'extensions' rule match could
    access a byte of uninitialized memory under some circumstances.
    Fixes bug #1103: http://bugs.cherokee-project.com/1103
    
    git-svn-id: svn://cherokee-project.com/cherokee/trunk@6056 5dc97367-97f1-0310-9951-d761b3857238

diff --git a/cherokee/rule_extensions.c b/cherokee/rule_extensions.c
index 80909ba4..7925291f 100644
--- a/cherokee/rule_extensions.c
+++ b/cherokee/rule_extensions.c
@@ -129,7 +129,9 @@ local_file_exists (cherokee_rule_extensions_t *rule,
 	ret = cherokee_io_stat (srv->iocache, tmp, rule->use_iocache,
 				&nocache_info, &io_entry, &info);
 
-	is_file = S_ISREG(info->st_mode);
+	if (ret == ret_ok) {
+		is_file = S_ISREG(info->st_mode);
+	}
 
 	if (io_entry) {
 		cherokee_iocache_entry_unref (&io_entry);

