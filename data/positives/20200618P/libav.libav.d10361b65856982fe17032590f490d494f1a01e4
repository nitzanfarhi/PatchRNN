commit d10361b65856982fe17032590f490d494f1a01e4
Author: Martin Storsjö <martin@martin.st>
Date:   Wed Nov 9 00:48:40 2011 +0200

    avio: Free URLContext private data allocated via AVOptions
    
    Signed-off-by: Martin Storsjö <martin@martin.st>

diff --git a/libavformat/avio.c b/libavformat/avio.c
index a954aa817..8e1854976 100644
--- a/libavformat/avio.c
+++ b/libavformat/avio.c
@@ -335,8 +335,11 @@ int ffurl_close(URLContext *h)
 #if CONFIG_NETWORK
     ff_network_close();
 #endif
-    if (h->prot->priv_data_size)
+    if (h->prot->priv_data_size) {
+        if (h->prot->priv_data_class)
+            av_opt_free(h->priv_data);
         av_free(h->priv_data);
+    }
     av_free(h);
     return ret;
 }

