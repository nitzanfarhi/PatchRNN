commit d132683ddd4050d3fe103ca88c73258c3442dc34
Author: Michael Niedermayer <michael@niedermayer.cc>
Date:   Thu Aug 17 20:32:03 2017 +0200

    avcodec/snowdec: Fix off by 1 error
    
    Fixes: runtime error: index 4 out of bounds for type 'int8_t [4]'
    Fixes: 3023/clusterfuzz-testcase-minimized-6421736130084864
    
    Found-by: continuous fuzzing process https://github.com/google/oss-fuzz/tree/master/projects/ffmpeg
    Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>

diff --git a/libavcodec/snowdec.c b/libavcodec/snowdec.c
index c80901b754..734f43e7d1 100644
--- a/libavcodec/snowdec.c
+++ b/libavcodec/snowdec.c
@@ -355,7 +355,7 @@ static int decode_header(SnowContext *s){
                 Plane *p= &s->plane[plane_index];
                 p->diag_mc= get_rac(&s->c, s->header_state);
                 htaps= get_symbol(&s->c, s->header_state, 0)*2 + 2;
-                if((unsigned)htaps > HTAPS_MAX || htaps==0)
+                if((unsigned)htaps >= HTAPS_MAX || htaps==0)
                     return AVERROR_INVALIDDATA;
                 p->htaps= htaps;
                 for(i= htaps/2; i; i--){

