commit 87c8cffeea07cb0d9a278df6f7e98e4cb22d2f20
Author: jvoisin <julien.voisin@dustri.org>
Date:   Thu May 1 19:13:52 2014 +0200

    Fix CID 1134996, 1135005, 1135002, 1134993

diff --git a/libr/bin/format/elf/elf.c b/libr/bin/format/elf/elf.c
index 103e0770f..2aeeb91ea 100644
--- a/libr/bin/format/elf/elf.c
+++ b/libr/bin/format/elf/elf.c
@@ -980,6 +980,8 @@ if (
 
 			if ((sym = (Elf_(Sym) *)malloc (1+bin->shdr[i].sh_size)) == NULL) {
 				eprintf ("malloc (syms)");
+				free (ret);
+				free (strtab);
 				return NULL;
 			}
 			nsym = (int)(bin->shdr[i].sh_size/sizeof (Elf_(Sym)));

