commit e9fbc9dc9214d6a9de7d62627be5414804fd7b9f
Author: Arjan van de Ven <arjan@linux.intel.com>
Date:   Sat Jun 6 21:22:33 2009 +0200

    perf_counter tools: Initialize a stack variable before use
    
    the "perf report" utility crashed in some circumstances
    because the "sym" stack variable was not initialized before used
    (as also proven by valgrind).
    
    With this fix both the crash goes away and valgrind no longer complains.
    
    Signed-off-by: Arjan van de Ven <arjan@linux.intel.com>
    Cc: Peter Zijlstra <a.p.zijlstra@chello.nl>
    Cc: Mike Galbraith <efault@gmx.de>
    Cc: Paul Mackerras <paulus@samba.org>
    Cc: Arnaldo Carvalho de Melo <acme@redhat.com>
    LKML-Reference: <new-submission>
    Signed-off-by: Ingo Molnar <mingo@elte.hu>

diff --git a/tools/perf/util/symbol.c b/tools/perf/util/symbol.c
index 253821d1efdb..158588c7f6b1 100644
--- a/tools/perf/util/symbol.c
+++ b/tools/perf/util/symbol.c
@@ -457,6 +457,8 @@ static int dso__load_sym(struct dso *self, int fd, const char *name,
 
 	nr_syms = shdr.sh_size / shdr.sh_entsize;
 
+	memset(&sym, 0, sizeof(sym));
+
 	elf_symtab__for_each_symbol(syms, nr_syms, index, sym) {
 		struct symbol *f;
 		uint64_t obj_start;

