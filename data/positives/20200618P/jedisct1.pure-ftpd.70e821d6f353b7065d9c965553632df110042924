commit 70e821d6f353b7065d9c965553632df110042924
Author: Frank Denis (Jedi/Sector One) <github@pureftpd.org>
Date:   Sat Oct 24 15:52:32 2009 +0200

    Henning Brauer: "there is an old trap in ldap with this mode. when
    the password is empty the auth always suceeds, so you have to check
    for a non-empty password... you handle that?"
    
    Apparently not.

diff --git a/src/log_ldap.c b/src/log_ldap.c
index d4b076c..433238c 100644
--- a/src/log_ldap.c
+++ b/src/log_ldap.c
@@ -482,6 +482,9 @@ void pw_ldap_check(AuthResult * const result,
         char *dn = (char *) result->backend_data;
         
         /* Verify password by binding to LDAP */
+        if (password == NULL || *password == 0) {
+            return;
+        }
         if ((ld = pw_ldap_connect(dn, password)) != NULL) {
              ldap_unbind(ld);
         } else {

