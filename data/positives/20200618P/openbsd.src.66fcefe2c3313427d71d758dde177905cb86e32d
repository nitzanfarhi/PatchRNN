commit 66fcefe2c3313427d71d758dde177905cb86e32d
Author: henning <henning@openbsd.org>
Date:   Thu Nov 17 11:14:51 2005 +0000

    missing strdup() check, From: David Hill <dhill@mindcry.org>

diff --git a/usr.sbin/bgpctl/bgpctl.c b/usr.sbin/bgpctl/bgpctl.c
index 0db49f27791..f8ea3d5681e 100644
--- a/usr.sbin/bgpctl/bgpctl.c
+++ b/usr.sbin/bgpctl/bgpctl.c
@@ -1,4 +1,4 @@
-/*	$OpenBSD: bgpctl.c,v 1.92 2005/10/19 12:32:17 henning Exp $ */
+/*	$OpenBSD: bgpctl.c,v 1.93 2005/11/17 11:14:51 henning Exp $ */
 
 /*
  * Copyright (c) 2003 Henning Brauer <henning@openbsd.org>
@@ -418,7 +418,8 @@ show_neighbor_msg(struct imsg *imsg, enum neighbor_views nv)
 			    p->conf.remote_masklen) == -1)
 				err(1, NULL);
 		} else
-			s = strdup(log_addr(&p->conf.remote_addr));
+			if ((s = strdup(log_addr(&p->conf.remote_addr))) == NULL)
+				err(1, "strdup");
 
 		ina.s_addr = p->remote_bgpid;
 		printf("BGP neighbor is %s, ", s);

