commit 49221513155a123cb1e4503c2c6c22148b0f4e7d
Author: fwarmerdam <fwarmerdam>
Date:   Sun May 25 03:11:33 2008 +0000

    fix unchecked malloc result

diff --git a/libtiff/tif_dirread.c b/libtiff/tif_dirread.c
index 68c474d3..bceebb86 100644
--- a/libtiff/tif_dirread.c
+++ b/libtiff/tif_dirread.c
@@ -4138,6 +4138,9 @@ EstimateStripByteCounts(TIFF* tif, TIFFDirEntry* dir, uint16 dircount)
 	td->td_stripbytecount = (uint64*)
 	    _TIFFCheckMalloc(tif, td->td_nstrips, sizeof (uint64),
 		"for \"StripByteCounts\" array");
+        if( td->td_stripbytecount == NULL )
+            return -1;
+
 	if (td->td_compression != COMPRESSION_NONE) {
 		uint64 space;
 		uint64 filesize;

