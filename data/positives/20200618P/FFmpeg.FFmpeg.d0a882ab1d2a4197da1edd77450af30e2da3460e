commit d0a882ab1d2a4197da1edd77450af30e2da3460e
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Wed Aug 7 17:18:19 2013 +0200

    avformat/oggparsevorbis: fix leak of ct
    
    Fixes CID1061058
    Fixes fate
    
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavformat/oggparsevorbis.c b/libavformat/oggparsevorbis.c
index 719cf7b12d..effc7a54ed 100644
--- a/libavformat/oggparsevorbis.c
+++ b/libavformat/oggparsevorbis.c
@@ -136,11 +136,13 @@ ff_vorbis_comment(AVFormatContext * as, AVDictionary **m, const uint8_t *buf, in
 
                 if (!pict) {
                     av_log(as, AV_LOG_WARNING, "out-of-memory error. Skipping cover art block.\n");
+                    av_freep(&ct);
                     continue;
                 }
                 if ((ret = av_base64_decode(pict, ct, vl)) > 0)
                     ret = ff_flac_parse_picture(as, pict, ret);
                 av_freep(&pict);
+                av_freep(&ct);
                 if (ret < 0) {
                     av_log(as, AV_LOG_WARNING, "Failed to parse cover art block.\n");
                     continue;

