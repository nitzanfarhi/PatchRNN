commit 1b880b5675fbfa7dd949c958ccb988a8e1712ea2
Author: Frank Morgner <frankmorgner@gmail.com>
Date:   Fri Aug 4 01:02:17 2017 +0200

    fixed uninitialized buffer

diff --git a/src/libopensc/card-cardos.c b/src/libopensc/card-cardos.c
index 4d2ad6f3..5dfc6d79 100644
--- a/src/libopensc/card-cardos.c
+++ b/src/libopensc/card-cardos.c
@@ -599,6 +599,8 @@ static int cardos_construct_fcp(sc_card_t *card, const sc_file_t *file,
 	/* we will add the length later  */
 	p++;
 
+	memset(buf, 0, sizeof(buf));
+
 	/* set the length */
 	buf[0] = (file->size >> 8) & 0xff;
 	buf[1] = file->size        & 0xff;
diff --git a/src/libopensc/card-gids.c b/src/libopensc/card-gids.c
index a10de902..c9a1c350 100644
--- a/src/libopensc/card-gids.c
+++ b/src/libopensc/card-gids.c
@@ -743,6 +743,7 @@ static int gids_set_security_env(sc_card_t *card,
 	assert(card != NULL && env != NULL);
 
 	SC_FUNC_CALLED(card->ctx, SC_LOG_DEBUG_NORMAL);
+	memset(sbuf, 0, sizeof(sbuf));
 
 	sc_format_apdu(card, &apdu, SC_APDU_CASE_3_SHORT, INS_MANAGE_SECURITY_ENVIRONMENT, P1_DECIPHERMENT_INTERNAL_AUTHENTICATE_KEY_AGREEMENT, 0);
 	switch (env->operation) {

