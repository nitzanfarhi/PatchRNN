commit 2b83e8b7005d531bc78b0fd4f699e9faa54ce9bb
Author: Ronald S. Bultje <rsbultje@gmail.com>
Date:   Wed Feb 22 12:19:52 2012 -0800

    truemotion2: error out if the huffman tree has no nodes.
    
    This prevents crashers and errors further down when reading nodes in the
    empty tree.
    
    Found-by: Mateusz "j00ru" Jurczyk and Gynvael Coldwind
    CC: libav-stable@libav.org

diff --git a/libavcodec/truemotion2.c b/libavcodec/truemotion2.c
index 9e45045342..7be148c602 100644
--- a/libavcodec/truemotion2.c
+++ b/libavcodec/truemotion2.c
@@ -132,7 +132,7 @@ static int tm2_build_huff_table(TM2Context *ctx, TM2Codes *code)
                huff.val_bits, huff.max_bits);
         return -1;
     }
-    if((huff.nodes < 0) || (huff.nodes > 0x10000)) {
+    if((huff.nodes <= 0) || (huff.nodes > 0x10000)) {
         av_log(ctx->avctx, AV_LOG_ERROR, "Incorrect number of Huffman tree nodes: %i\n", huff.nodes);
         return -1;
     }

