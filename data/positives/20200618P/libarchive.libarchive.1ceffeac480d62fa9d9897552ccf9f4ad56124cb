commit 1ceffeac480d62fa9d9897552ccf9f4ad56124cb
Author: Michihiro NAKAJIMA <ggcueroad@gmail.com>
Date:   Wed Dec 19 07:31:10 2012 +0900

    Fix issue 293; plug memory leaks.

diff --git a/libarchive/archive_read_disk_entry_from_file.c b/libarchive/archive_read_disk_entry_from_file.c
index 8b0c3651..a2d8d6b3 100644
--- a/libarchive/archive_read_disk_entry_from_file.c
+++ b/libarchive/archive_read_disk_entry_from_file.c
@@ -292,7 +292,7 @@ setup_mac_metadata(struct archive_read_disk *a,
 	int copyfile_flags = COPYFILE_NOFOLLOW | COPYFILE_ACL | COPYFILE_XATTR;
 	struct stat copyfile_stat;
 	int ret = ARCHIVE_OK;
-	void *buff;
+	void *buff = NULL;
 	int have_attrs;
 	const char *name, *tempdir;
 	struct archive_string tempfile;
@@ -379,6 +379,7 @@ cleanup:
 		unlink(tempfile.s);
 	}
 	archive_string_free(&tempfile);
+	free(buff);
 	return (ret);
 }
 

