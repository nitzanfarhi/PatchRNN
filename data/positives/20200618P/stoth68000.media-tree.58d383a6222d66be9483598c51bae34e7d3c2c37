commit 58d383a6222d66be9483598c51bae34e7d3c2c37
Author: Segher Boessenkool <segher@kernel.crashing.org>
Date:   Mon Jul 10 04:44:45 2006 -0700

    [PATCH] powerpc: make OF interrupt tree parsing more strict
    
    This patch fixes a bit of boundchecking in the new Open Firmware interrupt
    tree parsing code.  It's important that it fails when things aren't correct in
    order to trigger fallback mecanisms that are necessary to make some machines
    work properly.
    
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Cc: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

diff --git a/arch/powerpc/kernel/prom_parse.c b/arch/powerpc/kernel/prom_parse.c
index 21009b1f7869..6a7e997c401d 100644
--- a/arch/powerpc/kernel/prom_parse.c
+++ b/arch/powerpc/kernel/prom_parse.c
@@ -881,7 +881,7 @@ int of_irq_map_one(struct device_node *device, int index, struct of_irq *out_irq
 	intsize = *tmp;
 
 	/* Check index */
-	if (index * intsize >= intlen)
+	if ((index + 1) * intsize > intlen)
 		return -EINVAL;
 
 	/* Get new specifier and map it */

