commit cab9a128dad0fa0c8400a03d9375c781dda43982
Author: Rickard Strandqvist <rickard_strandqvist@spectrumdigital.se>
Date:   Sun May 18 18:02:57 2014 +0200

    PCI: cpqphp: Fix possible null pointer dereference
    
    There is otherwise a risk of a null pointer dereference.
    
    Found by cppcheck, a static code analysis program.
    
    Signed-off-by: Rickard Strandqvist <rickard_strandqvist@spectrumdigital.se>
    Signed-off-by: Bjorn Helgaas <bhelgaas@google.com>

diff --git a/drivers/pci/hotplug/cpqphp_ctrl.c b/drivers/pci/hotplug/cpqphp_ctrl.c
index 11845b796799..f593585f2784 100644
--- a/drivers/pci/hotplug/cpqphp_ctrl.c
+++ b/drivers/pci/hotplug/cpqphp_ctrl.c
@@ -709,7 +709,8 @@ static struct pci_resource *get_max_resource(struct pci_resource **head, u32 siz
 				temp = temp->next;
 			}
 
-			temp->next = max->next;
+			if (temp)
+				temp->next = max->next;
 		}
 
 		max->next = NULL;

