commit bf9de18c6307da153c636372940ff4ee2a653cde
Author: Anton Kochkov <anton.kochkov@gmail.com>
Date:   Mon May 19 06:03:41 2014 +0400

    Fix CID 1134993, 1135005, 1135004, 1134996, 1134995, 1135002

diff --git a/libr/bin/format/elf/elf.c b/libr/bin/format/elf/elf.c
index ee78e058b..e67b3f33b 100644
--- a/libr/bin/format/elf/elf.c
+++ b/libr/bin/format/elf/elf.c
@@ -999,6 +999,9 @@ if (
 #endif
 					nsym) == -1) {
 				eprintf ("Warning: read (sym)\n");
+				free (ret);
+				free (sym);
+				free (strtab);
 				return NULL;
 			}
 			for (j = k = ret_ctr = 0; j < bin->shdr[i].sh_size; j += sizeof (Elf_(Sym)), k++) {

