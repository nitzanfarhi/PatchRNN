commit 1cd0a5516396bd6fb54e4df1e7c88ed18416299b
Author: Laurent Aimar <fenrir@videolan.org>
Date:   Thu Sep 29 03:12:07 2011 +0000

    motionpixels: Prevent calling init_vlc() with invalid parameters
    
    Signed-off-by: Janne Grunau <janne-libav@jannau.net>

diff --git a/libavcodec/motionpixels.c b/libavcodec/motionpixels.c
index 1564ea1151..d054e00342 100644
--- a/libavcodec/motionpixels.c
+++ b/libavcodec/motionpixels.c
@@ -281,6 +281,8 @@ static int mp_decode_frame(AVCodecContext *avctx,
     if (sz == 0)
         goto end;
 
+    if (mp->max_codes_bits <= 0)
+        goto end;
     if (init_vlc(&mp->vlc, mp->max_codes_bits, mp->codes_count, &mp->codes[0].size, sizeof(HuffCode), 1, &mp->codes[0].code, sizeof(HuffCode), 4, 0))
         goto end;
     mp_decode_frame_helper(mp, &gb);

