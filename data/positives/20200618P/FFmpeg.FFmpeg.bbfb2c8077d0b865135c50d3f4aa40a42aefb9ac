commit bbfb2c8077d0b865135c50d3f4aa40a42aefb9ac
Author: Jai Menon <jmenon86@gmail.com>
Date:   Sat Jul 17 05:40:18 2010 +0000

    avidec : Free packet if dv_produce_packet fails.
    
    Originally committed as revision 24281 to svn://svn.ffmpeg.org/ffmpeg/trunk

diff --git a/libavformat/avidec.c b/libavformat/avidec.c
index 058acd5263..05cfd98cbe 100644
--- a/libavformat/avidec.c
+++ b/libavformat/avidec.c
@@ -808,6 +808,8 @@ resync:
                                     pkt->data, pkt->size);
             pkt->destruct = dstr;
             pkt->flags |= AV_PKT_FLAG_KEY;
+            if (size < 0)
+                av_free_packet(pkt);
         } else {
             /* XXX: How to handle B-frames in AVI? */
             pkt->dts = ast->frame_offset;

