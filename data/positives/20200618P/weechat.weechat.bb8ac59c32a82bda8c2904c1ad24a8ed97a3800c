commit bb8ac59c32a82bda8c2904c1ad24a8ed97a3800c
Author: SÃ©bastien Helleu <flashcode@flashtux.org>
Date:   Wed Aug 15 09:32:56 2018 +0200

    core: fix memory leak when removing a line hook

diff --git a/src/core/hook/wee-hook-line.c b/src/core/hook/wee-hook-line.c
index d65fb5e6d..a3a96b718 100644
--- a/src/core/hook/wee-hook-line.c
+++ b/src/core/hook/wee-hook-line.c
@@ -187,6 +187,11 @@ hook_line_free_data (struct t_hook *hook)
     if (!hook || !hook->hook_data)
         return;
 
+    if (HOOK_LINE(hook, buffers))
+    {
+        string_free_split (HOOK_LINE(hook, buffers));
+        HOOK_LINE(hook, buffers) = NULL;
+    }
     if (HOOK_LINE(hook, tags_array))
     {
         string_free_split_tags (HOOK_LINE(hook, tags_array));

