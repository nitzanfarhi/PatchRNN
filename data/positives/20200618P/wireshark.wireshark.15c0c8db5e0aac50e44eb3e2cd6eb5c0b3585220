commit 15c0c8db5e0aac50e44eb3e2cd6eb5c0b3585220
Author: Stig Bjørlykke <stig@bjorlykke.org>
Date:   Sat Aug 5 12:19:02 2017 +0200

    Lua: Check for PseudoHeader.none
    
    Don't dereference pointer when using PseudoHeader.none.
    
    Bug: 13944
    Change-Id: I4e509269ac4983531912f3f9b2cc6b7cf00fbeae
    Reviewed-on: https://code.wireshark.org/review/22945
    Petri-Dish: Stig Bjørlykke <stig@bjorlykke.org>
    Reviewed-by: Stig Bjørlykke <stig@bjorlykke.org>

diff --git a/epan/wslua/wslua_dumper.c b/epan/wslua/wslua_dumper.c
index 2aa8618f29..23f7daee77 100644
--- a/epan/wslua/wslua_dumper.c
+++ b/epan/wslua/wslua_dumper.c
@@ -331,7 +331,9 @@ WSLUA_METHOD Dumper_dump(lua_State* L) {
     pkthdr.len       = ba->len;
     pkthdr.caplen    = ba->len;
     pkthdr.pkt_encap = DUMPER_ENCAP(d);
-    pkthdr.pseudo_header = *ph->wph;
+    if (ph->wph) {
+        pkthdr.pseudo_header = *ph->wph;
+    }
 
     /* TODO: Can we get access to pinfo->pkt_comment here somehow? We
      * should be copying it to pkthdr.opt_comment if we can. */

