commit ffe2f138ab62c48467645a953fb0617bf2f1b39b
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sat Apr 7 13:36:31 2018 +0800

    ws_pipe: Zero an array.
    
    Make sure we zero-initialize pipeinsts, otherwise ConnectNamedPipe will
    have indeterminate behavior according to the MSDN documentation for the
    OVERLAPPED structure.
    
    Change-Id: I38d9680cf01b0a8f9e566a85a7a330f6c0aa9a48
    Ping-Bug: 14532
    Reviewed-on: https://code.wireshark.org/review/26784
    Reviewed-by: Gerald Combs <gerald@wireshark.org>
    Petri-Dish: Gerald Combs <gerald@wireshark.org>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Anders Broman <a.broman58@gmail.com>

diff --git a/wsutil/ws_pipe.c b/wsutil/ws_pipe.c
index a18897adfb..52e331c919 100644
--- a/wsutil/ws_pipe.c
+++ b/wsutil/ws_pipe.c
@@ -291,6 +291,8 @@ ws_pipe_wait_for_pipe(HANDLE * pipe_handles, int num_pipe_handles, HANDLE pid)
     int num_waiting_to_connect = 0;
     int num_handles = num_pipe_handles + 1; // PID handle is also added to list of handles.
 
+    SecureZeroMemory(pipeinsts, sizeof(pipeinsts));
+
     if (num_pipe_handles == 0 || num_pipe_handles > 3)
     {
         g_log(LOG_DOMAIN_CAPTURE, G_LOG_LEVEL_DEBUG, "Invalid number of pipes given as argument.");

