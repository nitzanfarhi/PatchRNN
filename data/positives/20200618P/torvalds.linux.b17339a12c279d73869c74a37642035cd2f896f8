commit b17339a12c279d73869c74a37642035cd2f896f8
Author: Haavard Skinnemoen <haavard.skinnemoen@atmel.com>
Date:   Fri Sep 19 21:09:28 2008 +0200

    atmel-mci: Fix memory leak in atmci_regs_show
    
    The debugfs hook atmci_regs_show allocates a temporary buffer for
    storing a register snapshot, but it doesn't free it before returning.
    Plug this leak.
    
    Signed-off-by: Haavard Skinnemoen <haavard.skinnemoen@atmel.com>
    Signed-off-by: Pierre Ossman <drzeus@drzeus.cx>

diff --git a/drivers/mmc/host/atmel-mci.c b/drivers/mmc/host/atmel-mci.c
index 6de773d3a0cf..becca9145070 100644
--- a/drivers/mmc/host/atmel-mci.c
+++ b/drivers/mmc/host/atmel-mci.c
@@ -218,6 +218,8 @@ static int atmci_regs_show(struct seq_file *s, void *v)
 	atmci_show_status_reg(s, "SR", buf[MCI_SR / 4]);
 	atmci_show_status_reg(s, "IMR", buf[MCI_IMR / 4]);
 
+	kfree(buf);
+
 	return 0;
 }
 

