commit 53c96dfdd0c0ccbba7aee84c60ce0f2aa466413f
Author: Zeng Zhaoming <zengzm.kernel@gmail.com>
Date:   Fri Nov 19 00:46:19 2010 +0800

    ACPI, hp-wmi: Fix memory leak in acpi query
    
    Free acpi return memory after query.
    
    Signed-off-by: Zeng Zhaoming <zengzm.kernel@gmail.com>
    Signed-off-by: Matthew Garrett <mjg@redhat.com>

diff --git a/drivers/platform/x86/hp-wmi.c b/drivers/platform/x86/hp-wmi.c
index 1dac659b5e0c..9e05af9c41cb 100644
--- a/drivers/platform/x86/hp-wmi.c
+++ b/drivers/platform/x86/hp-wmi.c
@@ -172,6 +172,8 @@ static int hp_wmi_perform_query(int query, int write, u32 *buffer,
 	bios_return = *((struct bios_return *)obj->buffer.pointer);
 
 	memcpy(buffer, &bios_return.value, sizeof(bios_return.value));
+
+	kfree(obj);
 	return 0;
 }
 

