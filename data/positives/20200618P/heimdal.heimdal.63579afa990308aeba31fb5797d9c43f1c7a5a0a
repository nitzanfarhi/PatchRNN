commit 63579afa990308aeba31fb5797d9c43f1c7a5a0a
Author: Love Hörnquist Åstrand <lha@kth.se>
Date:   Mon Dec 4 23:27:08 2006 +0000

    Report to syslog strings that start with NUL; prevents negative index
    array access. Ray Lai of OpenBSD via Björn Sandell.
    
    
    git-svn-id: svn://svn.h5l.se/heimdal/trunk/heimdal@19212 ec53bebd-3082-4978-b11e-865c3cabbd6b

diff --git a/appl/login/limits_conf.c b/appl/login/limits_conf.c
index 5bbcb5798..afa8539c4 100644
--- a/appl/login/limits_conf.c
+++ b/appl/login/limits_conf.c
@@ -120,6 +120,10 @@ read_limits_conf(const char *file, const struct passwd *pwd)
 
 	lineno++;
 
+	if(buf[0] == '\0') {
+	    syslog(LOG_ERR, "%s: line %d: NUL character", file, lineno);
+	    continue;
+	}
 	if(buf[strlen(buf) - 1] != '\n') {
 	    /* file did not end with a newline, figure out if we're at
                the EOF, or if our buffer was too small */

