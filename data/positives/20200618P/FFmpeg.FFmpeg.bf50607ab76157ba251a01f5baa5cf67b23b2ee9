commit bf50607ab76157ba251a01f5baa5cf67b23b2ee9
Author: Andreas Cadhalpun <andreas.cadhalpun@googlemail.com>
Date:   Wed Jan 6 20:59:58 2016 +0100

    asfdec: check for too small size in asf_read_unknown
    
    This fixes infinite loops due to seeking back.
    
    Signed-off-by: Alexandra Hájková <alexandra@khirnov.net>
    Signed-off-by: Luca Barbato <lu_zero@gentoo.org>

diff --git a/libavformat/asfdec.c b/libavformat/asfdec.c
index aef61bbdd4..cbab9a2dd6 100644
--- a/libavformat/asfdec.c
+++ b/libavformat/asfdec.c
@@ -190,8 +190,13 @@ static int asf_read_unknown(AVFormatContext *s, const GUIDParseTable *g)
         if ((ret = detect_unknown_subobject(s, asf->unknown_offset,
                                             asf->unknown_size)) < 0)
             return ret;
-    } else
+    } else {
+        if (size < 24) {
+            av_log(s, AV_LOG_ERROR, "Too small size %"PRIu64" (< 24).\n", size);
+            return AVERROR_INVALIDDATA;
+        }
         avio_skip(pb, size - 24);
+    }
 
     return 0;
 }

