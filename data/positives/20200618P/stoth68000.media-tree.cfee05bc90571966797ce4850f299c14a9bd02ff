commit cfee05bc90571966797ce4850f299c14a9bd02ff
Author: Monk Liu <Monk.Liu@amd.com>
Date:   Mon Dec 12 17:18:37 2016 +0800

    drm/amdgpu:bypass RLC init for SRIOV
    
    one issue unresolved for RLC:
    rlc will go wrong completely if there is a soft_reset
    before RLC ucode loading.
    
    to workaround above issue, we can totally ignore RLC
    in guest driver side due to there was already full
    initialization on RLC side by GIM
    
    Signed-off-by: Monk Liu <Monk.Liu@amd.com>
    Signed-off-by: Xiangliang Yu <Xiangliang.Yu@amd.com>
    Reviewed-by: Alex Deucher <alexander.deucher@amd.com>
    Acked-by: Christian KÃ¶nig <christian.koenig@amd.com>
    Signed-off-by: Alex Deucher <alexander.deucher@amd.com>

diff --git a/drivers/gpu/drm/amd/amdgpu/gfx_v9_0.c b/drivers/gpu/drm/amd/amdgpu/gfx_v9_0.c
index 9df3e834e7af..64bf70521af9 100644
--- a/drivers/gpu/drm/amd/amdgpu/gfx_v9_0.c
+++ b/drivers/gpu/drm/amd/amdgpu/gfx_v9_0.c
@@ -1465,6 +1465,9 @@ static int gfx_v9_0_rlc_resume(struct amdgpu_device *adev)
 {
 	int r;
 
+	if (amdgpu_sriov_vf(adev))
+		return 0;
+
 	gfx_v9_0_rlc_stop(adev);
 
 	/* disable CG */

