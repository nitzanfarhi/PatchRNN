commit d8e451b9466b1e2f829da851224ba4d51fa63d2f
Author: Stephen Fisher <steve@stephen-fisher.com>
Date:   Fri Oct 31 00:30:23 2008 +0000

    Fix bug #3019: Fix potential memory leaks
    
    
    svn path=/trunk/; revision=26635

diff --git a/gtk/follow_udp.c b/gtk/follow_udp.c
index 2a9525f3a8..6186ad6de5 100644
--- a/gtk/follow_udp.c
+++ b/gtk/follow_udp.c
@@ -120,6 +120,7 @@ follow_udp_stream_cb(GtkWidget *w, gpointer data _U_)
 			simple_dialog(ESD_TYPE_ERROR, ESD_BTN_OK,
 				      "Error creating filter for this stream.\n"
 				      "A network layer header is needed");
+			g_free(follow_info);
 			return;
 		}
 
@@ -155,6 +156,7 @@ follow_udp_stream_cb(GtkWidget *w, gpointer data _U_)
 		simple_dialog(ESD_TYPE_ERROR, ESD_BTN_OK,
 			      "Can't register udp_follow tap: %s\n",
 			      msg->str);
+		g_free(follow_info);
 		return;
 	}
 

