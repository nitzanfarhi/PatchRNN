commit 97fa032ae494e736f3b96d31e7831f0cb11c39e0
Author: nbk <nbk>
Date:   Wed Jul 13 16:51:37 2005 +0000

            Missing rad_free()

diff --git a/src/main/radclient.c b/src/main/radclient.c
index 6ffd200ee..7c4e34df8 100644
--- a/src/main/radclient.c
+++ b/src/main/radclient.c
@@ -676,6 +676,7 @@ static int recv_one_packet(int wait_time)
 	node = rbtree_find(request_tree, &myclient);
 	if (!node) {
 		fprintf(stderr, "radclient: received response to request we did not send.\n");
+		rad_free(&reply);
 		return -1;	/* got reply to packet we didn't send */
 	}
 
@@ -693,6 +694,7 @@ static int recv_one_packet(int wait_time)
 	 */
 	if (rad_decode(reply, radclient->request, secret) != 0) {
 		librad_perror("rad_decode");
+		rad_free(&radclient->reply);
 		totallost++;
 		return -1;
 	}

