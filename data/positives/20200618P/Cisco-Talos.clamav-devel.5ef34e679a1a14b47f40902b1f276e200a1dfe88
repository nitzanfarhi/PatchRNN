commit 5ef34e679a1a14b47f40902b1f276e200a1dfe88
Author: cwu <cwu@sourcefire.com>
Date:   Wed Feb 13 14:02:12 2013 -0800

    fix CID# 10538

diff --git a/sigtool/sigtool.c b/sigtool/sigtool.c
index 0ff8f5f1d..40eff5913 100644
--- a/sigtool/sigtool.c
+++ b/sigtool/sigtool.c
@@ -2029,6 +2029,7 @@ static char *decodehexstr(const char *hex, unsigned int *dlen)
 
     decoded = calloc(len + 1 + wildcard * 32, sizeof(char));
     if(!decoded) {
+        free(str16);
 	mprintf("!decodehexstr: Can't allocate memory for decoded\n");
 	return NULL;
     }
@@ -2051,6 +2052,7 @@ static char *decodehexstr(const char *hex, unsigned int *dlen)
 		default:
 		    mprintf("!decodehexstr: Unknown wildcard (0x%x@%u)\n", str16[i] & CLI_MATCH_WILDCARD, i);
 		    free(decoded);
+		    free(str16);
 		    return NULL;
 	    }
 	} else {
@@ -2061,7 +2063,7 @@ static char *decodehexstr(const char *hex, unsigned int *dlen)
 
     if(dlen)
 	*dlen = p;
-
+    free(str16);
     return decoded;
 }
 

