commit 0840b13612a0b7ef1ce7441cf811dcfc6b463fba
Author: Breno Silva <breno.silva@gmail.com>
Date:   Thu Apr 4 11:04:22 2013 -0400

    Fixed: chuck null pointer when unknown CT is sent and over in-memory limit

diff --git a/apache2/msc_reqbody.c b/apache2/msc_reqbody.c
index b76056ba..55e2e6dc 100644
--- a/apache2/msc_reqbody.c
+++ b/apache2/msc_reqbody.c
@@ -170,6 +170,7 @@ static apr_status_t modsecurity_request_body_store_memory(modsec_rec *msr,
 
     /* Would storing this chunk mean going over the limit? */
     if ((msr->msc_reqbody_spilltodisk)
+        && (msr->txcfg->reqbody_buffering != REQUEST_BODY_FORCEBUF_ON)
         && (msr->msc_reqbody_length + length > (apr_size_t)msr->txcfg->reqbody_inmemory_limit))
     {
         msc_data_chunk **chunks;

