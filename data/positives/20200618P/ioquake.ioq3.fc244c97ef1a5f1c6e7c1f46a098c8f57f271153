commit fc244c97ef1a5f1c6e7c1f46a098c8f57f271153
Author: Thilo Schulz <arny@ats.s.bawue.de>
Date:   Thu Jul 6 00:37:56 2006 +0000

    Fix critical buffer overflow in cgame, see exploit at http://www.milw0rm.com/exploits/1977

diff --git a/code/cgame/cg_main.c b/code/cgame/cg_main.c
index bfb111c1..8d887265 100644
--- a/code/cgame/cg_main.c
+++ b/code/cgame/cg_main.c
@@ -703,7 +703,7 @@ static void CG_RegisterSounds( void ) {
 	}
 
 	// only register the items that the server says we need
-	strcpy( items, CG_ConfigString( CS_ITEMS ) );
+	Q_strncpyz(items, CG_ConfigString(CS_ITEMS), sizeof(items));
 
 	for ( i = 1 ; i < bg_numItems ; i++ ) {
 //		if ( items[ i ] == '1' || cg_buildScript.integer ) {
@@ -1016,7 +1016,7 @@ static void CG_RegisterGraphics( void ) {
 	memset( cg_weapons, 0, sizeof( cg_weapons ) );
 
 	// only register the items that the server says we need
-	strcpy( items, CG_ConfigString( CS_ITEMS) );
+	Q_strncpyz(items, CG_ConfigString(CS_ITEMS), sizeof(items));
 
 	for ( i = 1 ; i < bg_numItems ; i++ ) {
 		if ( items[ i ] == '1' || cg_buildScript.integer ) {

