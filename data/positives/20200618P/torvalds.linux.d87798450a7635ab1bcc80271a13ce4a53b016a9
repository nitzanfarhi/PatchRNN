commit d87798450a7635ab1bcc80271a13ce4a53b016a9
Author: David S. Miller <davem@davemloft.net>
Date:   Tue Sep 23 20:47:22 2008 -0700

    aoe: Fix OOPS after SKB queue changes.
    
    Reported by Thomas Graf.
    
    If we don't unlink the SKB from the queue when we send it
    out in aoenet_xmit(), dev_hard_start_xmit() will see skb->next
    as non-NULL and interpret this to mean the SKB is part of a
    GSO segment list.
    
    Add __skb_unlink() call to fix that.
    
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/drivers/block/aoe/aoenet.c b/drivers/block/aoe/aoenet.c
index 8fb26030eba8..9157d64270cb 100644
--- a/drivers/block/aoe/aoenet.c
+++ b/drivers/block/aoe/aoenet.c
@@ -99,8 +99,10 @@ aoenet_xmit(struct sk_buff_head *queue)
 {
 	struct sk_buff *skb, *tmp;
 
-	skb_queue_walk_safe(queue, skb, tmp)
+	skb_queue_walk_safe(queue, skb, tmp) {
+		__skb_unlink(skb, queue);
 		dev_queue_xmit(skb);
+	}
 }
 
 /* 

