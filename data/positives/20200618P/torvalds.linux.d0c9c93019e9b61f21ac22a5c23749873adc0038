commit d0c9c93019e9b61f21ac22a5c23749873adc0038
Author: Toshi Kani <toshi.kani@hpe.com>
Date:   Thu Sep 24 13:59:27 2015 -0600

    EDAC: Don't allow empty DIMM labels
    
    Updating dimm_label to an empty string does not make much sense. Change
    the sysfs dimm_label store operation to fail a request when an input
    string is empty.
    
    Suggested-by: Borislav Petkov <bp@alien8.de>
    Signed-off-by: Toshi Kani <toshi.kani@hpe.com>
    Cc: elliott@hpe.com
    Cc: Mauro Carvalho Chehab <mchehab@osg.samsung.com>
    Cc: Tony Luck <tony.luck@intel.com>
    Cc: linux-edac <linux-edac@vger.kernel.org>
    Link: http://lkml.kernel.org/r/1443124767.25474.172.camel@hpe.com
    Signed-off-by: Borislav Petkov <bp@suse.de>

diff --git a/drivers/edac/edac_mc_sysfs.c b/drivers/edac/edac_mc_sysfs.c
index bf6b6802105c..3929391f0b92 100644
--- a/drivers/edac/edac_mc_sysfs.c
+++ b/drivers/edac/edac_mc_sysfs.c
@@ -248,7 +248,7 @@ static ssize_t channel_dimm_label_store(struct device *dev,
 	if (data[count - 1] == '\0' || data[count - 1] == '\n')
 		copy_count -= 1;
 
-	if (copy_count >= sizeof(rank->dimm->label))
+	if (copy_count == 0 || copy_count >= sizeof(rank->dimm->label))
 		return -EINVAL;
 
 	strncpy(rank->dimm->label, data, copy_count);
@@ -509,7 +509,7 @@ static ssize_t dimmdev_label_store(struct device *dev,
 	if (data[count - 1] == '\0' || data[count - 1] == '\n')
 		copy_count -= 1;
 
-	if (copy_count >= sizeof(dimm->label))
+	if (copy_count == 0 || copy_count >= sizeof(dimm->label))
 		return -EINVAL;
 
 	strncpy(dimm->label, data, copy_count);

