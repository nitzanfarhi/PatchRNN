commit 68e6b5eea28a83cdfd8f136e658febb9a85bc8ca
Author: beck <beck@openbsd.org>
Date:   Fri Feb 13 00:46:03 2015 +0000

    fix leaking of bn, coverity issue 105351
    ok doug@

diff --git a/lib/libcrypto/ec/ecp_mont.c b/lib/libcrypto/ec/ecp_mont.c
index af8014ed389..a3ad4e1ce9d 100644
--- a/lib/libcrypto/ec/ecp_mont.c
+++ b/lib/libcrypto/ec/ecp_mont.c
@@ -1,4 +1,4 @@
-/* $OpenBSD: ecp_mont.c,v 1.9 2014/07/12 16:03:37 miod Exp $ */
+/* $OpenBSD: ecp_mont.c,v 1.10 2015/02/13 00:46:03 beck Exp $ */
 /*
  * Originally written by Bodo Moeller for the OpenSSL project.
  */
@@ -228,6 +228,7 @@ ec_GFp_mont_group_set_curve(EC_GROUP *group, const BIGNUM *p, const BIGNUM *a,
 err:
 	BN_CTX_free(new_ctx);
 	BN_MONT_CTX_free(mont);
+	BN_free(one);
 	return ret;
 }
 
diff --git a/lib/libssl/src/crypto/ec/ecp_mont.c b/lib/libssl/src/crypto/ec/ecp_mont.c
index af8014ed389..a3ad4e1ce9d 100644
--- a/lib/libssl/src/crypto/ec/ecp_mont.c
+++ b/lib/libssl/src/crypto/ec/ecp_mont.c
@@ -1,4 +1,4 @@
-/* $OpenBSD: ecp_mont.c,v 1.9 2014/07/12 16:03:37 miod Exp $ */
+/* $OpenBSD: ecp_mont.c,v 1.10 2015/02/13 00:46:03 beck Exp $ */
 /*
  * Originally written by Bodo Moeller for the OpenSSL project.
  */
@@ -228,6 +228,7 @@ ec_GFp_mont_group_set_curve(EC_GROUP *group, const BIGNUM *p, const BIGNUM *a,
 err:
 	BN_CTX_free(new_ctx);
 	BN_MONT_CTX_free(mont);
+	BN_free(one);
 	return ret;
 }
 

