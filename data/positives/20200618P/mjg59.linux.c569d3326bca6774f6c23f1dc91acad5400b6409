commit c569d3326bca6774f6c23f1dc91acad5400b6409
Author: Frederik Deweerdt <frederik.deweerdt@xprog.eu>
Date:   Thu Sep 23 22:19:01 2010 +0200

    perf ui hist browser: Fix segfault on 'a' for annotate
    
    There a typo in util/ui/browsers/hists.c that leads to a segfault when you
    press the 'a' key on a non-resolved symbol (plain hex address).
    
    LKML-Reference: <20100923201901.GE31726@gambetta>
    Signed-off-by: Frederik Deweerdt <frederik.deweerdt@xprog.eu>
    Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>

diff --git a/tools/perf/util/ui/browsers/hists.c b/tools/perf/util/ui/browsers/hists.c
index dafdf6775d77..6866aa4c41e0 100644
--- a/tools/perf/util/ui/browsers/hists.c
+++ b/tools/perf/util/ui/browsers/hists.c
@@ -773,7 +773,7 @@ int hists__browse(struct hists *self, const char *helpline, const char *ev_name)
 
 			switch (key) {
 			case 'a':
-				if (browser->selection->map == NULL &&
+				if (browser->selection->map == NULL ||
 				    browser->selection->map->dso->annotate_warned)
 					continue;
 				goto do_annotate;

