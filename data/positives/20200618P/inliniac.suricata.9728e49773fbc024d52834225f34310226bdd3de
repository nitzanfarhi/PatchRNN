commit 9728e49773fbc024d52834225f34310226bdd3de
Author: William Metcalf <william.metcalf@gmail.com>
Date:   Thu May 20 13:16:02 2010 -0500

    Null deref fix for detect-tls-version.c

diff --git a/src/detect-tls-version.c b/src/detect-tls-version.c
index bb154a87..fdfacdda 100644
--- a/src/detect-tls-version.c
+++ b/src/detect-tls-version.c
@@ -177,6 +177,10 @@ DetectTlsVersionData *DetectTlsVersionParse (char *str)
 
         orig = SCStrdup((char*)str_ptr);
         tmp_str=orig;
+        if (tmp_str == NULL) {
+            goto error;
+        }
+
         /* Let's see if we need to scape "'s */
         if (tmp_str[0] == '"')
         {

