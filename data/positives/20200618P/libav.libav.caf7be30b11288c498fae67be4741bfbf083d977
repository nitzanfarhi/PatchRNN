commit caf7be30b11288c498fae67be4741bfbf083d977
Author: Janne Grunau <janne-libav@jannau.net>
Date:   Mon Jun 8 13:31:04 2015 +0200

    mpjpgdec: free AVIOContext leak on early probe fail

diff --git a/libavformat/mpjpegdec.c b/libavformat/mpjpegdec.c
index 354278c6c..72891e7cd 100644
--- a/libavformat/mpjpegdec.c
+++ b/libavformat/mpjpegdec.c
@@ -88,7 +88,7 @@ static int mpjpeg_read_probe(AVProbeData *p)
         return AVERROR(ENOMEM);
 
     if (p->buf_size < 2 || p->buf[0] != '-' || p->buf[1] != '-')
-        return 0;
+        goto end;
 
     while (!pb->eof_reached) {
         ret = get_line(pb, line, sizeof(line));
@@ -101,7 +101,7 @@ static int mpjpeg_read_probe(AVProbeData *p)
             break;
         }
     }
-
+end:
     av_free(pb);
 
     return ret;

