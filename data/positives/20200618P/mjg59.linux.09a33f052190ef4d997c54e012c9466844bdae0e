commit 09a33f052190ef4d997c54e012c9466844bdae0e
Author: Hartmut Knaack <knaack.h@gmx.de>
Date:   Wed Jun 10 21:51:19 2015 +0200

    tools:iio:iio_event_monitor: check if event is fully read
    
    Check that the read event is of the expected size.
    
    Signed-off-by: Hartmut Knaack <knaack.h@gmx.de>
    Signed-off-by: Jonathan Cameron <jic23@kernel.org>

diff --git a/tools/iio/iio_event_monitor.c b/tools/iio/iio_event_monitor.c
index 1dba09062a64..703f4cb0e8e9 100644
--- a/tools/iio/iio_event_monitor.c
+++ b/tools/iio/iio_event_monitor.c
@@ -310,6 +310,12 @@ int main(int argc, char **argv)
 			}
 		}
 
+		if (ret != sizeof(event)) {
+			printf("Reading event failed!\n");
+			ret = -EIO;
+			break;
+		}
+
 		print_event(&event);
 	}
 

