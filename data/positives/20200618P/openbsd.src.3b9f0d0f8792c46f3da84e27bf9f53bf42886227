commit 3b9f0d0f8792c46f3da84e27bf9f53bf42886227
Author: djm <djm@openbsd.org>
Date:   Sun Nov 8 21:59:11 2015 +0000

    fix OOB read in packet code caused by missing return statement
    found by Ben Hawkes; ok markus@ deraadt@

diff --git a/usr.bin/ssh/packet.c b/usr.bin/ssh/packet.c
index a5ca6855108..04eff2dca7c 100644
--- a/usr.bin/ssh/packet.c
+++ b/usr.bin/ssh/packet.c
@@ -1,4 +1,4 @@
-/* $OpenBSD: packet.c,v 1.216 2015/10/21 11:33:03 gsoares Exp $ */
+/* $OpenBSD: packet.c,v 1.217 2015/11/08 21:59:11 djm Exp $ */
 /*
  * Author: Tatu Ylonen <ylo@cs.hut.fi>
  * Copyright (c) 1995 Tatu Ylonen <ylo@cs.hut.fi>, Espoo, Finland
@@ -1569,6 +1569,7 @@ ssh_packet_read_poll2(struct ssh *ssh, u_char *typep, u_int32_t *seqnr_p)
 			logit("Bad packet length %u.", state->packlen);
 			if ((r = sshpkt_disconnect(ssh, "Packet corrupt")) != 0)
 				return r;
+			return SSH_ERR_CONN_CORRUPT;
 		}
 		sshbuf_reset(state->incoming_packet);
 	} else if (state->packlen == 0) {

