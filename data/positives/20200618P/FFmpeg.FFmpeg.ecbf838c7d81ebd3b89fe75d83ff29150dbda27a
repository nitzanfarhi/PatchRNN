commit ecbf838c7d81ebd3b89fe75d83ff29150dbda27a
Author: Michael Niedermayer <michaelni@gmx.at>
Date:   Sun Aug 25 03:01:19 2013 +0200

    h264: prevent rbsp_buffer values from becoming duplicated
    
    Signed-off-by: Michael Niedermayer <michaelni@gmx.at>

diff --git a/libavcodec/h264.c b/libavcodec/h264.c
index fbcf280dd0..e17807339d 100644
--- a/libavcodec/h264.c
+++ b/libavcodec/h264.c
@@ -1681,6 +1681,10 @@ static int decode_init_thread_copy(AVCodecContext *avctx)
     memset(h->sps_buffers, 0, sizeof(h->sps_buffers));
     memset(h->pps_buffers, 0, sizeof(h->pps_buffers));
 
+    h->rbsp_buffer[0] = NULL;
+    h->rbsp_buffer[1] = NULL;
+    h->rbsp_buffer_size[0] = 0;
+    h->rbsp_buffer_size[1] = 0;
     h->context_initialized = 0;
 
     return 0;

