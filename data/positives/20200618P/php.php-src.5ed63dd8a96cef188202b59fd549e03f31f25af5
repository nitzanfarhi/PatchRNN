commit 5ed63dd8a96cef188202b59fd549e03f31f25af5
Author: Ilia Alshanetsky <iliaa@php.net>
Date:   Wed Mar 14 15:02:20 2007 +0000

    Fixed a possible memory leak on open_basedir validation

diff --git a/ext/zip/php_zip.c b/ext/zip/php_zip.c
index f99450e425..be071bed42 100644
--- a/ext/zip/php_zip.c
+++ b/ext/zip/php_zip.c
@@ -160,6 +160,7 @@ static int php_zip_extract_file(struct zip * za, char *dest, char *file, int fil
 	 * safemode status as its parent folder?
 	 */
 	if (OPENBASEDIR_CHECKPATH(fullpath)) {
+		efree(fullpath);
 		efree(file_dirname_fullpath);
 		efree(file_basename);
 		return 0;

