commit 888f65b07da0715694f0fcf3e2afa6ee16076296
Author: jbj <devnull@localhost>
Date:   Tue Jan 16 14:10:21 2001 +0000

    fix: segfault through python bindings with fd to non-package (#24089).
    
    CVS patchset: 4453
    CVS date: 2001/01/16 14:10:21

diff --git a/lib/package.c b/lib/package.c
index 2db161cc5..f91d4ba35 100644
--- a/lib/package.c
+++ b/lib/package.c
@@ -155,6 +155,8 @@ static int readPackageHeaders(FD_t fd, /*@out@*/ struct rpmlead * leadPtr,
 int rpmReadPackageInfo(FD_t fd, Header * sigp, Header * hdrp)
 {
     int rc = readPackageHeaders(fd, NULL, sigp, hdrp);
+    if (rc)
+	return rc;
     if (hdrp && *hdrp && sigp && *sigp)
 	headerMergeLegacySigs(*hdrp, *sigp);
     return rc;

