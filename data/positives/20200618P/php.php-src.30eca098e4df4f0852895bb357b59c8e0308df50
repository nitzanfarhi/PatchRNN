commit 30eca098e4df4f0852895bb357b59c8e0308df50
Author: Greg Beaver <cellog@php.net>
Date:   Mon May 12 17:40:14 2008 +0000

    fix minor memleak

diff --git a/ext/phar/zip.c b/ext/phar/zip.c
index 55d06b589c..4b20690467 100644
--- a/ext/phar/zip.c
+++ b/ext/phar/zip.c
@@ -416,6 +416,8 @@ foundit:
 					PHAR_ZIP_FAIL("unable to decompress alias, zlib filter creation failed");
 				}
 				php_stream_filter_append(&fp->readfilters, filter);
+				efree(mydata->alias);
+				mydata->alias = NULL;
 				if (!(entry.uncompressed_filesize = php_stream_copy_to_mem(fp, &(mydata->alias), entry.uncompressed_filesize, 0)) || !mydata->alias) {
 					efree(entry.filename);
 					PHAR_ZIP_FAIL("unable to read in alias, truncated");
@@ -431,6 +433,8 @@ foundit:
 				}
 				php_stream_filter_append(&fp->readfilters, filter);
 				php_stream_filter_append(&fp->readfilters, filter);
+				efree(mydata->alias);
+				mydata->alias = NULL;
 				if (!(entry.uncompressed_filesize = php_stream_copy_to_mem(fp, &(mydata->alias), entry.uncompressed_filesize, 0)) || !mydata->alias) {
 					efree(entry.filename);
 					PHAR_ZIP_FAIL("unable to read in alias, truncated");
@@ -438,6 +442,8 @@ foundit:
 				php_stream_filter_flush(filter, 1);
 				php_stream_filter_remove(filter, 1 TSRMLS_CC);
 			} else {
+				efree(mydata->alias);
+				mydata->alias = NULL;
 				if (!(entry.uncompressed_filesize = php_stream_copy_to_mem(fp, &(mydata->alias), entry.uncompressed_filesize, 0)) || !mydata->alias) {
 					efree(entry.filename);
 					PHAR_ZIP_FAIL("unable to read in alias, truncated");

