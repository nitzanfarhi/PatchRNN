commit 03c2419fc99249039ebc7174c8f61c0f3fb04ce9
Author: Gregor Jasny <gjasny@googlemail.com>
Date:   Wed Jun 7 09:08:40 2017 +0200

    ares: Fix memory leak in PTR reply parser

diff --git a/rutil/dns/ares/ares_parse_ptr_reply.c b/rutil/dns/ares/ares_parse_ptr_reply.c
index d4ecd7c1e..0f247add6 100644
--- a/rutil/dns/ares/ares_parse_ptr_reply.c
+++ b/rutil/dns/ares/ares_parse_ptr_reply.c
@@ -93,7 +93,10 @@ int ares_parse_ptr_reply(const unsigned char *abuf, int alen, const void *addr,
 	  /* Decode the RR data and set hostname to it. */
 	  status = ares_expand_name(aptr, abuf, alen, &rr_data, &len);
 	  if (status != ARES_SUCCESS)
-	    break;
+	    {
+	      free(rr_name);
+	      break;
+	    }
 	  if (hostname)
 	    free(hostname);
 	  hostname = rr_data;
@@ -104,7 +107,10 @@ int ares_parse_ptr_reply(const unsigned char *abuf, int alen, const void *addr,
 	  /* Decode the RR data and replace ptrname with it. */
 	  status = ares_expand_name(aptr, abuf, alen, &rr_data, &len);
 	  if (status != ARES_SUCCESS)
-	    break;
+	    {
+	      free(rr_name);
+	      break;
+	    }
 	  free(ptrname);
 	  ptrname = rr_data;
 	}

