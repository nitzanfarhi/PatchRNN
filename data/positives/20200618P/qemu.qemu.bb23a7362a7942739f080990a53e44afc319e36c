commit bb23a7362a7942739f080990a53e44afc319e36c
Author: Marc-André Lureau <marcandre.lureau@redhat.com>
Date:   Thu Jul 5 18:16:29 2018 +0200

    qga: fix 'driver' leak in guest-get-fsinfo
    
    'driver' is leaked when the loop is not broken.
    
    Leak introduced by commit 743c71d03c20d64f2bae5fba6f26cdf5e4b1bda6,
    spotted by ASAN.
    
    Signed-off-by: Marc-André Lureau <marcandre.lureau@redhat.com>
    Reviewed-by: Laszlo Ersek <lersek@redhat.com>
    Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>

diff --git a/qga/commands-posix.c b/qga/commands-posix.c
index 233f78a406..c46767b0dd 100644
--- a/qga/commands-posix.c
+++ b/qga/commands-posix.c
@@ -890,6 +890,7 @@ static void build_guest_fsinfo_for_real_device(char const *syspath,
             break;
         }
 
+        g_free(driver);
         if (sscanf(p, "/%x:%x:%x.%x%n",
                           pci, pci + 1, pci + 2, pci + 3, &pcilen) == 4) {
             p += pcilen;

