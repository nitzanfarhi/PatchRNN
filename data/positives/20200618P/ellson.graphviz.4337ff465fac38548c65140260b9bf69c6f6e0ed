commit 4337ff465fac38548c65140260b9bf69c6f6e0ed
Author: ellson <devnull@localhost>
Date:   Tue Jul 24 20:04:53 2007 +0000

    Fix crash in "dot -Tsvgz -O KW91.dot" cause by attempt to fclose(NULL)

diff --git a/lib/gvc/gvdevice.c b/lib/gvc/gvdevice.c
index 84d6c863a..b693390e3 100644
--- a/lib/gvc/gvdevice.c
+++ b/lib/gvc/gvdevice.c
@@ -112,8 +112,10 @@ void gvdevice_finalize(GVJ_t * firstjob)
 	if (job->output_filename
 	  && job->output_file != stdout 
 	  && ! job->external_surface) {
-	    fclose(job->output_file);
-	    job->output_file = NULL;
+	    if (job->output_file) {
+	        fclose(job->output_file);
+	        job->output_file = NULL;
+	    }
             job->output_filename = NULL;
 	}
     }

