commit cfb1b9000534c3a80fb45ddb9f97778abd67a481
Author: pekka@mysql.com <>
Date:   Sun May 22 20:47:08 2005 +0200

    ndb - NdbDictionaryImpl.cpp: fix access to freed memory

diff --git a/ndb/src/ndbapi/NdbDictionaryImpl.cpp b/ndb/src/ndbapi/NdbDictionaryImpl.cpp
index fe2df815f1f..baf5c7e5c83 100644
--- a/ndb/src/ndbapi/NdbDictionaryImpl.cpp
+++ b/ndb/src/ndbapi/NdbDictionaryImpl.cpp
@@ -2049,12 +2049,22 @@ NdbDictionaryImpl::getIndexImpl(const char * externalName,
     return 0;
   }
 
+  /*
+   * internalName may be pointer to m_ndb.theImpl->m_internalname.c_str()
+   * and may get deallocated in next call.
+   *
+   * Passing around pointers to volatile internal members may not be
+   * optimal.  Suggest use BaseString instances passed by value.
+   */
+
+  BaseString save_me(internalName);
   NdbTableImpl* prim = getTable(tab->m_primaryTable.c_str());
   if(prim == 0){
     m_error.code = 4243;
     return 0;
   }
-  
+  internalName = save_me.c_str();
+
   /**
    * Create index impl
    */

