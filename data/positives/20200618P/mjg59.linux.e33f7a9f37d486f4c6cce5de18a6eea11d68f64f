commit e33f7a9f37d486f4c6cce5de18a6eea11d68f64f
Author: Tim Chen <tim.c.chen@linux.intel.com>
Date:   Tue Aug 9 06:48:32 2011 +0000

    scm: Capture the full credentials of the scm sender
    
    This patch corrects an erroneous update of credential's gid with uid
    introduced in commit 257b5358b32f17 since 2.6.36.
    
    Signed-off-by: Tim Chen <tim.c.chen@linux.intel.com>
    Acked-by: Eric Dumazet <eric.dumazet@gmail.com>
    Reviewed-by: James Morris <jmorris@namei.org>
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/net/core/scm.c b/net/core/scm.c
index 4c1ef026d695..811b53fb330e 100644
--- a/net/core/scm.c
+++ b/net/core/scm.c
@@ -192,7 +192,7 @@ int __scm_send(struct socket *sock, struct msghdr *msg, struct scm_cookie *p)
 					goto error;
 
 				cred->uid = cred->euid = p->creds.uid;
-				cred->gid = cred->egid = p->creds.uid;
+				cred->gid = cred->egid = p->creds.gid;
 				put_cred(p->cred);
 				p->cred = cred;
 			}

