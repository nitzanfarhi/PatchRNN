From 7d282fac1cc455b5a5eca2bb56375efcbf879b06 Mon Sep 17 00:00:00 2001
From: Clement Lecigne <clecigne@google.com>
Date: Tue, 20 Dec 2011 17:44:10 +0200
Subject: [PATCH] TiVo: fix double free
MIME-Version: 1.0
Content-Type: text/plain; charset=utf8
Content-Transfer-Encoding: 8bit

Signed-off-by: RÃ©mi Denis-Courmont <remi@remlab.net>
---
 modules/demux/ty.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/modules/demux/ty.c b/modules/demux/ty.c
index e916b41147..b181a6a73b 100644
--- a/modules/demux/ty.c
+++ b/modules/demux/ty.c
@@ -1887,6 +1887,7 @@ static int get_chunk_header(demux_t *p_demux)
     /*msg_Dbg( p_demux, "chunk has %d records", i_num_recs );*/
 
     free(p_sys->rec_hdrs);
+    p_sys->rec_hdrs = NULL;
 
     /* skip past the 4 bytes we "peeked" earlier */
     stream_Read( p_demux->s, NULL, 4 );
-- 
2.11.0

