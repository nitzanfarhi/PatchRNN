From 4dc7800b866f889a1247685bbaa6dd4238a56279 Mon Sep 17 00:00:00 2001
From: "Alan T. DeKok" <aland@freeradius.org>
Date: Sat, 29 May 2010 11:26:56 +0200
Subject: [PATCH] Fix endless loop when there are multiple DHCP options

---
 src/lib/dhcp.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/lib/dhcp.c b/src/lib/dhcp.c
index d90ae2c728..2a8859453e 100644
--- a/src/lib/dhcp.c
+++ b/src/lib/dhcp.c
@@ -714,7 +714,7 @@ int fr_dhcp_decode(RADIUS_PACKET *packet)
 			}
 
 			*tail = vp;
-			while (*tail) tail = &vp->next;
+			while (*tail) tail = &(*tail)->next;
 			p += alen;
 		} /* loop over array entries */
 	} /* loop over the entire packet */
