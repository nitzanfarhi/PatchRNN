From b9b9f6738fba5c32e87cb9c36b358355b444fb9b Mon Sep 17 00:00:00 2001
From: Amitay Isaacs <amitay@gmail.com>
Date: Thu, 3 Oct 2013 15:13:41 +1000
Subject: [PATCH] tcp: Create socket lock in /var/run/ctdb instead of /tmp

Signed-off-by: Amitay Isaacs <amitay@gmail.com>
Pair-programmed-with: Martin Schwenke <martin@meltin.net>
---
 tcp/tcp_connect.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/tcp/tcp_connect.c b/tcp/tcp_connect.c
index 383d7264..9df33000 100644
--- a/tcp/tcp_connect.c
+++ b/tcp/tcp_connect.c
@@ -284,7 +284,7 @@ static int ctdb_tcp_listen_automatic(struct ctdb_context *ctdb)
 						struct ctdb_tcp);
         ctdb_sock_addr sock;
 	int lock_fd, i;
-	const char *lock_path = "/tmp/.ctdb_socket_lock";
+	const char *lock_path = VARDIR "/run/ctdb/.socket_lock";
 	struct flock lock;
 	int one = 1;
 	int sock_size;
-- 
2.17.1

