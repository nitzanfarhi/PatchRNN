From 1291d6bbee93b6109eb07e8f7916ff1b7fcc13e1 Mon Sep 17 00:00:00 2001
From: Stanislav Malyshev <stas@php.net>
Date: Tue, 17 Mar 2015 12:47:58 -0700
Subject: [PATCH] Fix bug #69207 - move_uploaded_file allows nulls in path

---
 NEWS                           | 3 +++
 ext/standard/basic_functions.c | 2 +-
 2 files changed, 4 insertions(+), 1 deletion(-)

diff --git a/NEWS b/NEWS
index b8dad75..9b45a99 100644
--- a/NEWS
+++ b/NEWS
@@ -2,6 +2,9 @@ PHP                                                                        NEWS
 |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
 ?? ??? 2015 PHP 5.4.39
 
+- Core:
+  . Fixed bug #69207 (move_uploaded_file allows nulls in path). (Stas)
+
 19 Feb 2015 PHP 5.4.38
 
 - Core:
diff --git a/ext/standard/basic_functions.c b/ext/standard/basic_functions.c
index 9a9df30..c3e2230 100644
--- a/ext/standard/basic_functions.c
+++ b/ext/standard/basic_functions.c
@@ -5775,7 +5775,7 @@ PHP_FUNCTION(move_uploaded_file)
 		RETURN_FALSE;
 	}
 
-	if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, "ss", &path, &path_len, &new_path, &new_path_len) == FAILURE) {
+	if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, "sp", &path, &path_len, &new_path, &new_path_len) == FAILURE) {
 		return;
 	}
 
-- 
2.1.4

