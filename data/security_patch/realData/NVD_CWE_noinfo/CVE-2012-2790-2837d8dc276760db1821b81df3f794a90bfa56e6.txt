From 2837d8dc276760db1821b81df3f794a90bfa56e6 Mon Sep 17 00:00:00 2001
From: Thilo Borgmann <thilo.borgmann@googlemail.com>
Date: Sun, 15 Apr 2012 18:07:12 +0200
Subject: [PATCH] alsdec: fix number of decoded samples in first sub-block in
 BGMC mode.

Found-by: Mateusz "j00ru" Jurczyk and Gynvael Coldwind
Signed-off-by: Michael Niedermayer <michaelni@gmx.at>
---
 libavcodec/alsdec.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/libavcodec/alsdec.c b/libavcodec/alsdec.c
index bae9df6173..20ef40774e 100644
--- a/libavcodec/alsdec.c
+++ b/libavcodec/alsdec.c
@@ -785,10 +785,10 @@ static int read_var_block_data(ALSDecContext *ctx, ALSBlockData *bd)
             k    [sb] = s[sb] > b ? s[sb] - b : 0;
             delta[sb] = 5 - s[sb] + k[sb];
 
-            ff_bgmc_decode(gb, sb_length, current_res,
+            ff_bgmc_decode(gb, sb_length - i, current_res,
                         delta[sb], sx[sb], &high, &low, &value, ctx->bgmc_lut, ctx->bgmc_lut_status);
 
-            current_res += sb_length;
+            current_res += sb_length - i;
         }
 
         ff_bgmc_decode_end(gb);
-- 
2.11.0

