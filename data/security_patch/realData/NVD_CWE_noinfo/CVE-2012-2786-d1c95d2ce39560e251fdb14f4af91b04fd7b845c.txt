From d1c95d2ce39560e251fdb14f4af91b04fd7b845c Mon Sep 17 00:00:00 2001
From: Michael Niedermayer <michaelni@gmx.at>
Date: Fri, 13 Apr 2012 22:52:16 +0200
Subject: [PATCH] dfa: fix out of array write in decode_wdlt()

Found-by: Mateusz "j00ru" Jurczyk and Gynvael Coldwind
Signed-off-by: Michael Niedermayer <michaelni@gmx.at>
---
 libavcodec/dfa.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/libavcodec/dfa.c b/libavcodec/dfa.c
index d8516b2f50..13637d6a05 100644
--- a/libavcodec/dfa.c
+++ b/libavcodec/dfa.c
@@ -242,6 +242,8 @@ static int decode_wdlt(GetByteContext *gb, uint8_t *frame, int width, int height
             frame    += delta;
             segments = bytestream2_get_le16(gb);
         }
+        if (frame_end <= frame)
+            return -1;
         if (segments & 0x8000) {
             frame[width - 1] = segments & 0xFF;
             segments = bytestream2_get_le16(gb);
-- 
2.11.0

