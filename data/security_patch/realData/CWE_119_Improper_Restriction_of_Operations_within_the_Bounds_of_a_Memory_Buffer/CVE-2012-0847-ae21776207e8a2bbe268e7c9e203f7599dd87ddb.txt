From ae21776207e8a2bbe268e7c9e203f7599dd87ddb Mon Sep 17 00:00:00 2001
From: Stefano Sabatini <stefasab@gmail.com>
Date: Tue, 27 Dec 2011 15:15:02 +0100
Subject: [PATCH] lavfi: add missing check in avfilter_filter_samples()

Avoid out-of-buffer data access when nb_channels is 8.
---
 libavfilter/avfilter.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/libavfilter/avfilter.c b/libavfilter/avfilter.c
index b4c9fa6593..97f78e4629 100644
--- a/libavfilter/avfilter.c
+++ b/libavfilter/avfilter.c
@@ -678,7 +678,7 @@ void avfilter_filter_samples(AVFilterLink *link, AVFilterBufferRef *samplesref)
         link->cur_buf->audio->sample_rate = samplesref->audio->sample_rate;
 
         /* Copy actual data into new samples buffer */
-        for (i = 0; samplesref->data[i]; i++)
+        for (i = 0; samplesref->data[i] && i < 8; i++)
             memcpy(link->cur_buf->data[i], samplesref->data[i], samplesref->linesize[0]);
 
         avfilter_unref_buffer(samplesref);
-- 
2.11.0

