From 16e9e126333fb7acb47d363366fee3deadc8331e Mon Sep 17 00:00:00 2001
From: =?utf8?q?Hugo=20Beauz=C3=A9e-Luyssen?= <beauze.h@gmail.com>
Date: Mon, 30 Apr 2012 11:50:17 +0200
Subject: [PATCH] ogg: Fix a heap buffer overflow.

Reported by: An anonymous contributor working with the SecuriTeam Secure
Disclosure
program (http://www.beyondsecurity.com/ssd.html)
(cherry picked from commit 6a41b030f5b7fcbe5ad7249c374172c0fdc29add)

Signed-off-by: Jean-Baptiste Kempf <jb@videolan.org>
---
 modules/demux/ogg.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/modules/demux/ogg.c b/modules/demux/ogg.c
index e659b9cb00..da6dab3033 100644
--- a/modules/demux/ogg.c
+++ b/modules/demux/ogg.c
@@ -624,7 +624,7 @@ static void Ogg_DecodePacket( demux_t *p_demux,
             if( p_stream->p_headers )
             {
                 memcpy( (unsigned char *)p_stream->p_headers + p_stream->i_headers - p_oggpacket->bytes,
-                        p_oggpacket->packet, p_stream->i_headers );
+                        p_oggpacket->packet, p_oggpacket->bytes );
             }
             else
             {
-- 
2.11.0

