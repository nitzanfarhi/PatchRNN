From eb0fb72b3c5307ec8e33effb6bf947e38cfdffe8 Mon Sep 17 00:00:00 2001
From: pancake <pancake@nopcode.org>
Date: Wed, 27 Jun 2018 01:17:05 +0200
Subject: [PATCH] Fix #10498 - Crash in fuzzed java file

---
 shlr/java/class.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/shlr/java/class.c b/shlr/java/class.c
index 4d6bf0666f..0825acb401 100644
--- a/shlr/java/class.c
+++ b/shlr/java/class.c
@@ -3789,6 +3789,9 @@ R_API RBinJavaAttrInfo *r_bin_java_line_number_table_attr_new(ut8 *buffer, ut64
 		if (!lnattr) {
 			break;
 		}
+		if (offset + 8 >= sz) {
+			break;
+		}
 		lnattr->start_pc = R_BIN_JAVA_USHORT (buffer, offset);
 		offset += 2;
 		lnattr->line_number = R_BIN_JAVA_USHORT (buffer, offset);
