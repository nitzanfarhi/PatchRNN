From 21270cffaeab2f67a613907516b2b0cd6c9eacf4 Mon Sep 17 00:00:00 2001
From: Michael Niedermayer <michaelni@gmx.at>
Date: Thu, 15 Dec 2011 04:59:21 +0100
Subject: [PATCH] h263dec: Fix regression / crash with lowres. Fixes Ticket757
 Bug Found by: ami_stuff

Signed-off-by: Michael Niedermayer <michaelni@gmx.at>
---
 libavcodec/mpegvideo.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/libavcodec/mpegvideo.c b/libavcodec/mpegvideo.c
index bb57bb1e2a..98a771c463 100644
--- a/libavcodec/mpegvideo.c
+++ b/libavcodec/mpegvideo.c
@@ -1232,8 +1232,8 @@ int MPV_frame_start(MpegEncContext *s, AVCodecContext *avctx)
                 return -1;
 
             if(s->codec_id == CODEC_ID_FLV1 || s->codec_id == CODEC_ID_H263){
-                for(i=0; i<s->height; i++)
-                    memset(s->last_picture_ptr->f.data[0] + s->last_picture_ptr->f.linesize[0]*i, 16, s->width);
+                for(i=0; i<avctx->height; i++)
+                    memset(s->last_picture_ptr->f.data[0] + s->last_picture_ptr->f.linesize[0]*i, 16, avctx->width);
             }
 
             ff_thread_report_progress((AVFrame*)s->last_picture_ptr, INT_MAX, 0);
-- 
2.11.0

