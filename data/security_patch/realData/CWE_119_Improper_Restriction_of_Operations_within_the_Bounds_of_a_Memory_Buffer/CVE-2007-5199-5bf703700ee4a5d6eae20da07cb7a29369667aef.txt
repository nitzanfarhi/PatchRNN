From 5bf703700ee4a5d6eae20da07cb7a29369667aef Mon Sep 17 00:00:00 2001
From: Matthieu Herrb <matthieu@bluenote.herrb.com>
Date: Fri, 28 Sep 2007 08:17:57 +0200
Subject: catalogue.c: prevent a one character overflow

this occurs if readlink writes a result that's exactly the
size of the buffer that's passed to it. Reported by
Joerg Sonnenberger.

Re
---
 src/fontfile/catalogue.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/fontfile/catalogue.c b/src/fontfile/catalogue.c
index 33d4434..c0d90f8 100644
--- a/src/fontfile/catalogue.c
+++ b/src/fontfile/catalogue.c
@@ -156,7 +156,7 @@ CatalogueRescan (FontPathElementPtr fpe)
     while (entry = readdir(dir), entry != NULL)
     {
 	snprintf(link, sizeof link, "%s/%s", path, entry->d_name);
-	len = readlink(link, dest, sizeof dest);
+	len = readlink(link, dest, sizeof dest - 1);
 	if (len < 0)
 	    continue;
 
-- 
cgit v1.1

