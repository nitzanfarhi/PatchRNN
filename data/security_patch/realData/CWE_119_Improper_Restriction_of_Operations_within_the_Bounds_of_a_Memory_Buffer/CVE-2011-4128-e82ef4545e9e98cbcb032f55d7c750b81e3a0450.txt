From e82ef4545e9e98cbcb032f55d7c750b81e3a0450 Mon Sep 17 00:00:00 2001
From: Nikos Mavrogiannopoulos <nmav@gnutls.org>
Date: Tue, 8 Nov 2011 07:52:56 +0100
Subject: [PATCH] bug fix in gnutls_session_get_data().

---
 lib/gnutls_session.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/lib/gnutls_session.c b/lib/gnutls_session.c
index 418a2ba..fd012fe 100644
--- a/lib/gnutls_session.c
+++ b/lib/gnutls_session.c
@@ -66,6 +66,7 @@ gnutls_session_get_data (gnutls_session_t session,
 
   if (psession.size > *session_data_size)
     {
+      *session_data_size = psession.size;
       ret = GNUTLS_E_SHORT_MEMORY_BUFFER;
       goto error;
     }
-- 
1.9.1

