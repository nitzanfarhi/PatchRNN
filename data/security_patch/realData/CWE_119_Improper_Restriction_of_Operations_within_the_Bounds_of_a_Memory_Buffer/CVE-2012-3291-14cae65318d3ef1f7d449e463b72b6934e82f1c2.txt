From 14cae65318d3ef1f7d449e463b72b6934e82f1c2 Mon Sep 17 00:00:00 2001
From: David Woodhouse <David.Woodhouse@intel.com>
Date: Mon, 23 Apr 2012 02:09:33 +0100
Subject: [PATCH] Fix potential buffer overflow in banner handling

Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
---
 tun.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/tun.c b/tun.c
index 6fb898b8..0eadced9 100644
--- a/tun.c
+++ b/tun.c
@@ -224,7 +224,7 @@ static void set_banner(struct openconnect_info *vpninfo)
 	char *banner, *q;
 	const char *p;
 
-	if (!vpninfo->banner || !(banner = malloc(strlen(vpninfo->banner)))) {
+	if (!vpninfo->banner || !(banner = malloc(strlen(vpninfo->banner)+1))) {
 		unsetenv("CISCO_BANNER");
 		return;
 	}
-- 
2.21.0

