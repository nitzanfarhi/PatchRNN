From e60a9038b13b5eb805a76755efc5c6d5e080180f Mon Sep 17 00:00:00 2001
From: =?utf8?q?R=C3=A9mi=20Duraffort?= <ivoire@videolan.org>
Date: Wed, 24 Jun 2009 16:20:40 +0200
Subject: [PATCH] Fix a segfault (buffer overflow for win32 only).

---
 modules/access/smb.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/modules/access/smb.c b/modules/access/smb.c
index 5d735f011c..1f1af5b734 100644
--- a/modules/access/smb.c
+++ b/modules/access/smb.c
@@ -473,7 +473,7 @@ static void Win32AddConnection( access_t *p_access, char *psz_path,
             strlcpy( psz_share, psz_parser, sizeof( psz_share ) );
    }
 
-    sprintf( psz_remote, "\\\\%s\\%s", psz_server, psz_share );
+    snprintf( psz_remote, sizeof( psz_remote ), "\\\\%s\\%s", psz_server, psz_share );
     net_resource.lpRemoteName = psz_remote;
 
     i_result = OurWNetAddConnection2( &net_resource, psz_pwd, psz_user, 0 );
-- 
2.11.0

