From f36525c5beafb78959c3a07d6622c9028de348da Mon Sep 17 00:00:00 2001
From: Aurelien David <aurelien.david@telecom-paristech.fr>
Date: Thu, 11 Apr 2019 14:54:53 +0200
Subject: [PATCH] fix buffer overrun in gf_bin128_parse

closes #1204
closes #1205
---
 src/utils/os_divers.c | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/src/utils/os_divers.c b/src/utils/os_divers.c
index fef591ef6..130f64e12 100644
--- a/src/utils/os_divers.c
+++ b/src/utils/os_divers.c
@@ -1990,6 +1990,11 @@ GF_Err gf_bin128_parse(const char *string, bin128 value)
 			sscanf(szV, "%x", &v);
 			value[i] = v;
 			i++;
+			if (i > 15) {
+				// force error check below
+				i++;
+				break;
+			}
 		}
 	}
 	if (i != 16) {
