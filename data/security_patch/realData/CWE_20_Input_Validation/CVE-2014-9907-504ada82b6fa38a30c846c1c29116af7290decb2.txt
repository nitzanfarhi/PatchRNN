From 504ada82b6fa38a30c846c1c29116af7290decb2 Mon Sep 17 00:00:00 2001
From: dirk <dirk@git.imagemagick.org>
Date: Mon, 29 Dec 2014 19:50:06 +0000
Subject: [PATCH] Added check for bogus num_images value.

---
 coders/dds.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/coders/dds.c b/coders/dds.c
index 17c9bf0e8e..404a78a939 100644
--- a/coders/dds.c
+++ b/coders/dds.c
@@ -1836,6 +1836,8 @@ static Image *ReadDDSImage(const ImageInfo *image_info,ExceptionInfo *exception)
   {
     if (n != 0)
       {
+        if (EOFBlob(image) != MagickFalse)
+          ThrowReaderException(CorruptImageError,"UnexpectedEndOfFile");
         /* Start a new image */
         AcquireNextImage(image_info,image);
         if (GetNextImageInList(image) == (Image *) NULL)
