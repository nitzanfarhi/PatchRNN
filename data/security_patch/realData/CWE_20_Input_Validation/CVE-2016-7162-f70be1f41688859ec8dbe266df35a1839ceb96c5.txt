From f70be1f41688859ec8dbe266df35a1839ceb96c5 Mon Sep 17 00:00:00 2001
From: Paolo Bacchilega <paobac@src.gnome.org>
Date: Wed, 17 Aug 2016 15:41:35 +0200
Subject: [PATCH] do not follow symlinks when deleting a folder recursively

[bug #698554]
---
 src/file-utils.c | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)

diff --git a/src/file-utils.c b/src/file-utils.c
index a60fca25..bddf894e 100644
--- a/src/file-utils.c
+++ b/src/file-utils.c
@@ -411,9 +411,8 @@ _g_file_remove_directory (GFile         *directory,
 		return TRUE;
 
 	enumerator = g_file_enumerate_children (directory,
-					        G_FILE_ATTRIBUTE_STANDARD_NAME ","
-					        G_FILE_ATTRIBUTE_STANDARD_TYPE,
-					        0,
+					        G_FILE_ATTRIBUTE_STANDARD_NAME "," G_FILE_ATTRIBUTE_STANDARD_TYPE,
+						G_FILE_QUERY_INFO_NOFOLLOW_SYMLINKS,
 					        cancellable,
 					        error);
 
-- 
2.21.0

