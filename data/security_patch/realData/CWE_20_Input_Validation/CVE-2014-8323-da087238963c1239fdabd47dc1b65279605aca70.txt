From da087238963c1239fdabd47dc1b65279605aca70 Mon Sep 17 00:00:00 2001
From: Thomas d'Otreppe <tdotreppe@aircrack-ng.org>
Date: Fri, 3 Oct 2014 01:58:02 +0000
Subject: [PATCH] Buddy-ng: Fixed segmentation fault (Closes #15 on GitHub).

git-svn-id: http://svn.aircrack-ng.org/trunk@2418 28c6078b-6c39-48e3-add9-af49d547ecab
---
 src/buddy-ng.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/src/buddy-ng.c b/src/buddy-ng.c
index 8a7927c7..8da8996d 100644
--- a/src/buddy-ng.c
+++ b/src/buddy-ng.c
@@ -83,6 +83,8 @@ int handle(int s, unsigned char* data, int len, struct sockaddr_in *s_in)
 	*cmd++ = htons(S_CMD_PACKET);
 	*cmd++ = *pid;
 	plen = len - 2;
+    if (plen < 0)
+        return 0;
 
 	last_id = ntohs(*pid);
 	if (last_id > 20000)
