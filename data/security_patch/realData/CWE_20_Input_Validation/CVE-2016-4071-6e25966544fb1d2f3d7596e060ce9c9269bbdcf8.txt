From 6e25966544fb1d2f3d7596e060ce9c9269bbdcf8 Mon Sep 17 00:00:00 2001
From: Anatol Belski <ab@php.net>
Date: Wed, 16 Mar 2016 09:48:40 +0100
Subject: [PATCH] Fixed bug #71704 php_snmp_error() Format String Vulnerability

---
 ext/snmp/snmp.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/ext/snmp/snmp.c b/ext/snmp/snmp.c
index be8888c..67e39f1 100644
--- a/ext/snmp/snmp.c
+++ b/ext/snmp/snmp.c
@@ -530,7 +530,7 @@ static void php_snmp_error(zval *object, const char *docref, int type, const cha
 	}
 
 	if (object && (snmp_object->exceptions_enabled & type)) {
-		zend_throw_exception_ex(php_snmp_exception_ce, type, snmp_object->snmp_errstr);
+		zend_throw_exception_ex(php_snmp_exception_ce, type, "%s", snmp_object->snmp_errstr);
 	} else {
 		va_start(args, format);
 		php_verror(docref, "", E_WARNING, format, args);
-- 
2.1.4

