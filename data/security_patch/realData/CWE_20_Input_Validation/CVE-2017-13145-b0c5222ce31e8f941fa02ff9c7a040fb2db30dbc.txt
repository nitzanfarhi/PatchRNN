From b0c5222ce31e8f941fa02ff9c7a040fb2db30dbc Mon Sep 17 00:00:00 2001
From: Cristy <urban-warrior@imagemagick.org>
Date: Sun, 28 May 2017 06:43:22 -0400
Subject: [PATCH] https://github.com/ImageMagick/ImageMagick/issues/501

---
 coders/jp2.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/coders/jp2.c b/coders/jp2.c
index 2d519e692e..25b1798fdc 100644
--- a/coders/jp2.c
+++ b/coders/jp2.c
@@ -393,7 +393,7 @@ static Image *ReadJP2Image(const ImageInfo *image_info,ExceptionInfo *exception)
         (jp2_image->comps[0].dy != jp2_image->comps[i].dy) ||
         (jp2_image->comps[0].prec != jp2_image->comps[i].prec) ||
         (jp2_image->comps[0].sgnd != jp2_image->comps[i].sgnd) ||
-        (jp2_image->comps[i].data == NULL))
+        ((image->ping == MagickFalse) && (jp2_image->comps[i].data == NULL)))
       {
         opj_destroy_codec(jp2_codec);
         opj_image_destroy(jp2_image);
