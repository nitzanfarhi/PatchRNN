From 337e3505b0e6cd4309db6bf6062b33fa56e06cf8 Mon Sep 17 00:00:00 2001
From: Tom Kistner <tom@tahini.csx.cam.ac.uk>
Date: Sat, 30 Apr 2011 13:20:17 +0100
Subject: [PATCH] Bugzilla #1106: Don't pass DKIM compound log line as format
 string

---
 src/src/dkim.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/src/dkim.c b/src/src/dkim.c
index e25ff8c..2318cc3 100644
--- a/src/src/dkim.c
+++ b/src/src/dkim.c
@@ -108,7 +108,7 @@ void dkim_exim_verify_finish(void) {
     /* Log a line for each signature */
     uschar *logmsg = string_append(NULL, &size, &ptr, 5,
 
-      string_sprintf( "DKIM: d=%s s=%s c=%s/%s a=%s ",
+      string_sprintf( "d=%s s=%s c=%s/%s a=%s ",
                       sig->domain,
                       sig->selector,
                       (sig->canon_headers == PDKIM_CANON_SIMPLE)?"simple":"relaxed",
@@ -176,7 +176,7 @@ void dkim_exim_verify_finish(void) {
     }
 
     logmsg[ptr] = '\0';
-    log_write(0, LOG_MAIN, (char *)logmsg);
+    log_write(0, LOG_MAIN, "DKIM: %s", logmsg);
 
     /* Build a colon-separated list of signing domains (and identities, if present) in dkim_signers */
     dkim_signers = string_append(dkim_signers,
-- 
1.9.1

