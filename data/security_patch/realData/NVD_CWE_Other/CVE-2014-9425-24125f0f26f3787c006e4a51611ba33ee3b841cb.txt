From 24125f0f26f3787c006e4a51611ba33ee3b841cb Mon Sep 17 00:00:00 2001
From: Kalle Sommer Nielsen <kalle@php.net>
Date: Mon, 29 Dec 2014 10:57:42 +0100
Subject: [PATCH] Fixed bug #68676 (Explicit Double Free)

---
 NEWS                | 3 ++-
 Zend/zend_ts_hash.c | 2 +-
 2 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/NEWS b/NEWS
index af00bf6..0ad3fa0 100644
--- a/NEWS
+++ b/NEWS
@@ -1,4 +1,4 @@
-PHP                                                                        NEWS
+ï»¿PHP                                                                        NEWS
 |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
 ?? ??? 2015, PHP 5.6.5
 
@@ -15,6 +15,7 @@ PHP                                                                        NEWS
   . Fixed bug #68583 (Crash in timeout thread). (Anatol)
   . Fixed bug #65576 (Constructor from trait conflicts with inherited
     constructor). (dunglas at gmail dot com)
+  . Fixed bug #68676 (Explicit Double Free). (Kalle)
 
 - cURL:
   . Fixed bug #67643 (curl_multi_getcontent returns '' when
diff --git a/Zend/zend_ts_hash.c b/Zend/zend_ts_hash.c
index 100bcf1..024f817 100644
--- a/Zend/zend_ts_hash.c
+++ b/Zend/zend_ts_hash.c
@@ -151,7 +151,7 @@ ZEND_API void zend_ts_hash_graceful_destroy(TsHashTable *ht)
 
 #ifdef ZTS
 	tsrm_mutex_free(ht->mx_reader);
-	tsrm_mutex_free(ht->mx_reader);
+	tsrm_mutex_free(ht->mx_writer);
 #endif
 }
 
-- 
2.1.4

