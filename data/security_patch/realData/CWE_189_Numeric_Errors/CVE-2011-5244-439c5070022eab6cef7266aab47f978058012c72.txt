From 439c5070022eab6cef7266aab47f978058012c72 Mon Sep 17 00:00:00 2001
From: Vincent Untz <vuntz@gnome.org>
Date: Thu, 17 Feb 2011 15:23:39 +0100
Subject: [PATCH] backends: Fix another security issue in the dvi-backend

This is similar to one of the fixes from d4139205.

https://bugzilla.gnome.org/show_bug.cgi?id=640923
---
 backend/dvi/mdvi-lib/afmparse.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/backend/dvi/mdvi-lib/afmparse.c b/backend/dvi/mdvi-lib/afmparse.c
index 361e23d6..e1cd1156 100644
--- a/backend/dvi/mdvi-lib/afmparse.c
+++ b/backend/dvi/mdvi-lib/afmparse.c
@@ -190,7 +190,7 @@ static char *linetoken(FILE *stream)
     while ((ch = fgetc(stream)) == ' ' || ch == '\t' ); 
     
     idx = 0;
-    while (ch != EOF && ch != lineterm) 
+    while (ch != EOF && ch != lineterm && idx < MAX_NAME)
     {
         ident[idx++] = ch;
         ch = fgetc(stream);
-- 
2.21.0

