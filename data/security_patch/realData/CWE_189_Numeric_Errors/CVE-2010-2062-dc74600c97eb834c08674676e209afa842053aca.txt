From dc74600c97eb834c08674676e209afa842053aca Mon Sep 17 00:00:00 2001
From: =?utf8?q?R=C3=A9mi=20Denis-Courmont?= <remi@remlab.net>
Date: Sun, 26 Jul 2009 18:39:42 +0300
Subject: [PATCH] Real pseudo-RTSP: prevent integer underflow

Pointed-out-by: tixxDZ <tixxdz@gmail.com> - DZCORE Labs, Algeria
---
 modules/access/rtsp/real.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/modules/access/rtsp/real.c b/modules/access/rtsp/real.c
index ccc7e54a05..fdd8dd1972 100644
--- a/modules/access/rtsp/real.c
+++ b/modules/access/rtsp/real.c
@@ -600,6 +600,7 @@ int real_get_rdt_chunk(rtsp_client_t *rtsp_session, rmff_pheader_t *ph,
 
   int n;
   rmff_dump_pheader(ph, (char*)*buffer);
+  if (pf->length<12) return 0;
   n=rtsp_read_data(rtsp_session, (uint8_t*)(*buffer + 12), ph->length - 12);
   return (n <= 0) ? 0 : n+12;
 }
-- 
2.11.0

