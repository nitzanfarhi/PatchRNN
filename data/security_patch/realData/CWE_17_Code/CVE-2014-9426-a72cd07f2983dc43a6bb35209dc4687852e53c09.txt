From a72cd07f2983dc43a6bb35209dc4687852e53c09 Mon Sep 17 00:00:00 2001
From: Anatol Belski <ab@php.net>
Date: Sun, 28 Dec 2014 13:58:01 +0100
Subject: [PATCH] Fixed bug #68665 (Invalid free)

---
 ext/fileinfo/libmagic/apprentice.c | 1 -
 1 file changed, 1 deletion(-)

diff --git a/ext/fileinfo/libmagic/apprentice.c b/ext/fileinfo/libmagic/apprentice.c
index 543bce5..e7d0a61 100644
--- a/ext/fileinfo/libmagic/apprentice.c
+++ b/ext/fileinfo/libmagic/apprentice.c
@@ -1197,7 +1197,6 @@ apprentice_load(struct magic_set *ms, const char *fn, int action)
 				if ((filearr = CAST(char **,
 				    erealloc(filearr, mlen))) == NULL) {
 					file_oomem(ms, mlen);
-					efree(mfn);
 					php_stream_closedir(dir);
 					errs++;
 					goto out;
-- 
2.1.4

