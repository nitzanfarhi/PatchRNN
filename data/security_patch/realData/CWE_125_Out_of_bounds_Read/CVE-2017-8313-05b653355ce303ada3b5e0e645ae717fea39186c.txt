From 05b653355ce303ada3b5e0e645ae717fea39186c Mon Sep 17 00:00:00 2001
From: =?utf8?q?Filip=20Ros=C3=A9en?= <filip@atch.se>
Date: Mon, 20 Feb 2017 14:59:37 +0100
Subject: [PATCH] demux/subtitle: ParseJSS: fix out-of-bounds read
MIME-Version: 1.0
Content-Type: text/plain; charset=utf8
Content-Transfer-Encoding: 8bit

The previous loop would continue until a space is found, which of course means
that it would step out of bounds if the string did not contain such.

These changes simply terminates the loop if the end of the string is reached.

Signed-off-by: Jean-Baptiste Kempf <jb@videolan.org>
(cherry picked from commit 181117ea2362ea2ccda69371ce8109970717d318)
Signed-off-by: Hugo BeauzÃ©e-Luyssen <hugo@beauzee.fr>

Missing backport pointed out by: Yannay Livneh <yannayl@checkpoint.com>
                                 Omri Herscovici <omrih@checkpoint.com>
                                 Omer Gull <omergu@checkpoint.com>
---
 modules/demux/subtitle.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/modules/demux/subtitle.c b/modules/demux/subtitle.c
index 6470756507..3e790fd307 100644
--- a/modules/demux/subtitle.c
+++ b/modules/demux/subtitle.c
@@ -1809,8 +1809,8 @@ static int ParseJSS( demux_t *p_demux, subtitle_t *p_subtitle, int i_idx )
     /* Parse the directives */
     if( isalpha( (unsigned char)*psz_text ) || *psz_text == '[' )
     {
-        while( *psz_text != ' ' )
-        { psz_text++ ;};
+        while( *psz_text && *psz_text != ' ' )
+            ++psz_text;
 
         /* Directives are NOT parsed yet */
         /* This has probably a better place in a decoder ? */
-- 
2.11.0

