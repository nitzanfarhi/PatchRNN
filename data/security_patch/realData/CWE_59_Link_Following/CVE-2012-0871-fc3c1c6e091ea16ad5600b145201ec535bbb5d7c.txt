From fc3c1c6e091ea16ad5600b145201ec535bbb5d7c Mon Sep 17 00:00:00 2001
From: Lennart Poettering <lennart@poettering.net>
Date: Tue, 17 Jan 2012 14:03:00 +0100
Subject: logind: move X11 socket

---
 src/login/logind-session.c | 6 ++----
 1 file changed, 2 insertions(+), 4 deletions(-)

diff --git a/src/login/logind-session.c b/src/login/logind-session.c
index e78af02..bb802e5 100644
--- a/src/login/logind-session.c
+++ b/src/login/logind-session.c
@@ -376,15 +376,13 @@ static int session_link_x11_socket(Session *s) {
                 return -ENOENT;
         }
 
-        t = strappend(s->user->runtime_path, "/X11/display");
+        t = strappend(s->user->runtime_path, "/X11-display");
         if (!t) {
                 log_error("Out of memory");
                 free(f);
                 return -ENOMEM;
         }
 
-        mkdir_parents(t, 0755);
-
         if (link(f, t) < 0) {
                 if (errno == EEXIST) {
                         unlink(t);
@@ -637,7 +635,7 @@ static int session_unlink_x11_socket(Session *s) {
 
         s->user->display = NULL;
 
-        t = strappend(s->user->runtime_path, "/X11/display");
+        t = strappend(s->user->runtime_path, "/X11-display");
         if (!t) {
                 log_error("Out of memory");
                 return -ENOMEM;
-- 
cgit v1.1

